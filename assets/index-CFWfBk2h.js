var Rv=o=>{throw TypeError(o)};var qd=(o,t,e)=>t.has(o)||Rv("Cannot "+e);var ae=(o,t,e)=>(qd(o,t,"read from private field"),e?e.call(o):t.get(o)),fi=(o,t,e)=>t.has(o)?Rv("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(o):t.set(o,e),dn=(o,t,e,n)=>(qd(o,t,"write to private field"),n?n.call(o,e):t.set(o,e),e),gi=(o,t,e)=>(qd(o,t,"access private method"),e);var Dv=(o,t,e,n)=>({set _(s){dn(o,t,s,e)},get _(){return ae(o,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();function ng(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function x0(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var t=o.default;if(typeof t=="function"){var e=function n(){var s=!1;try{s=this instanceof n}catch{}return s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(o).forEach(function(n){var s=Object.getOwnPropertyDescriptor(o,n);Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:function(){return o[n]}})}),e}var Gd={exports:{}},Oo={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ov;function WA(){if(Ov)return Oo;Ov=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,s,a){var l=null;if(a!==void 0&&(l=""+a),s.key!==void 0&&(l=""+s.key),"key"in s){a={};for(var u in s)u!=="key"&&(a[u]=s[u])}else a=s;return s=a.ref,{$$typeof:o,type:n,key:l,ref:s!==void 0?s:null,props:a}}return Oo.Fragment=t,Oo.jsx=e,Oo.jsxs=e,Oo}var Mv;function KA(){return Mv||(Mv=1,Gd.exports=WA()),Gd.exports}var Q=KA(),Vd={exports:{}},xt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kv;function QA(){if(kv)return xt;kv=1;var o=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),m=Symbol.iterator;function v(P){return P===null||typeof P!="object"?null:(P=m&&P[m]||P["@@iterator"],typeof P=="function"?P:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,w={};function A(P,z,Y){this.props=P,this.context=z,this.refs=w,this.updater=Y||b}A.prototype.isReactComponent={},A.prototype.setState=function(P,z){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,z,"setState")},A.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function _(){}_.prototype=A.prototype;function E(P,z,Y){this.props=P,this.context=z,this.refs=w,this.updater=Y||b}var x=E.prototype=new _;x.constructor=E,S(x,A.prototype),x.isPureReactComponent=!0;var O=Array.isArray,C={H:null,A:null,T:null,S:null,V:null},D=Object.prototype.hasOwnProperty;function R(P,z,Y,U,et,nt){return Y=nt.ref,{$$typeof:o,type:P,key:z,ref:Y!==void 0?Y:null,props:nt}}function k(P,z){return R(P.type,z,void 0,void 0,void 0,P.props)}function L(P){return typeof P=="object"&&P!==null&&P.$$typeof===o}function V(P){var z={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(Y){return z[Y]})}var q=/\/+/g;function it(P,z){return typeof P=="object"&&P!==null&&P.key!=null?V(""+P.key):z.toString(36)}function rt(){}function st(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(rt,rt):(P.status="pending",P.then(function(z){P.status==="pending"&&(P.status="fulfilled",P.value=z)},function(z){P.status==="pending"&&(P.status="rejected",P.reason=z)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function ot(P,z,Y,U,et){var nt=typeof P;(nt==="undefined"||nt==="boolean")&&(P=null);var at=!1;if(P===null)at=!0;else switch(nt){case"bigint":case"string":case"number":at=!0;break;case"object":switch(P.$$typeof){case o:case t:at=!0;break;case g:return at=P._init,ot(at(P._payload),z,Y,U,et)}}if(at)return et=et(P),at=U===""?"."+it(P,0):U,O(et)?(Y="",at!=null&&(Y=at.replace(q,"$&/")+"/"),ot(et,z,Y,"",function(It){return It})):et!=null&&(L(et)&&(et=k(et,Y+(et.key==null||P&&P.key===et.key?"":(""+et.key).replace(q,"$&/")+"/")+at)),z.push(et)),1;at=0;var ft=U===""?".":U+":";if(O(P))for(var vt=0;vt<P.length;vt++)U=P[vt],nt=ft+it(U,vt),at+=ot(U,z,Y,nt,et);else if(vt=v(P),typeof vt=="function")for(P=vt.call(P),vt=0;!(U=P.next()).done;)U=U.value,nt=ft+it(U,vt++),at+=ot(U,z,Y,nt,et);else if(nt==="object"){if(typeof P.then=="function")return ot(st(P),z,Y,U,et);throw z=String(P),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return at}function B(P,z,Y){if(P==null)return P;var U=[],et=0;return ot(P,U,"","",function(nt){return z.call(Y,nt,et++)}),U}function H(P){if(P._status===-1){var z=P._result;z=z(),z.then(function(Y){(P._status===0||P._status===-1)&&(P._status=1,P._result=Y)},function(Y){(P._status===0||P._status===-1)&&(P._status=2,P._result=Y)}),P._status===-1&&(P._status=0,P._result=z)}if(P._status===1)return P._result.default;throw P._result}var tt=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)};function lt(){}return xt.Children={map:B,forEach:function(P,z,Y){B(P,function(){z.apply(this,arguments)},Y)},count:function(P){var z=0;return B(P,function(){z++}),z},toArray:function(P){return B(P,function(z){return z})||[]},only:function(P){if(!L(P))throw Error("React.Children.only expected to receive a single React element child.");return P}},xt.Component=A,xt.Fragment=e,xt.Profiler=s,xt.PureComponent=E,xt.StrictMode=n,xt.Suspense=d,xt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,xt.__COMPILER_RUNTIME={__proto__:null,c:function(P){return C.H.useMemoCache(P)}},xt.cache=function(P){return function(){return P.apply(null,arguments)}},xt.cloneElement=function(P,z,Y){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var U=S({},P.props),et=P.key,nt=void 0;if(z!=null)for(at in z.ref!==void 0&&(nt=void 0),z.key!==void 0&&(et=""+z.key),z)!D.call(z,at)||at==="key"||at==="__self"||at==="__source"||at==="ref"&&z.ref===void 0||(U[at]=z[at]);var at=arguments.length-2;if(at===1)U.children=Y;else if(1<at){for(var ft=Array(at),vt=0;vt<at;vt++)ft[vt]=arguments[vt+2];U.children=ft}return R(P.type,et,void 0,void 0,nt,U)},xt.createContext=function(P){return P={$$typeof:l,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:a,_context:P},P},xt.createElement=function(P,z,Y){var U,et={},nt=null;if(z!=null)for(U in z.key!==void 0&&(nt=""+z.key),z)D.call(z,U)&&U!=="key"&&U!=="__self"&&U!=="__source"&&(et[U]=z[U]);var at=arguments.length-2;if(at===1)et.children=Y;else if(1<at){for(var ft=Array(at),vt=0;vt<at;vt++)ft[vt]=arguments[vt+2];et.children=ft}if(P&&P.defaultProps)for(U in at=P.defaultProps,at)et[U]===void 0&&(et[U]=at[U]);return R(P,nt,void 0,void 0,null,et)},xt.createRef=function(){return{current:null}},xt.forwardRef=function(P){return{$$typeof:u,render:P}},xt.isValidElement=L,xt.lazy=function(P){return{$$typeof:g,_payload:{_status:-1,_result:P},_init:H}},xt.memo=function(P,z){return{$$typeof:f,type:P,compare:z===void 0?null:z}},xt.startTransition=function(P){var z=C.T,Y={};C.T=Y;try{var U=P(),et=C.S;et!==null&&et(Y,U),typeof U=="object"&&U!==null&&typeof U.then=="function"&&U.then(lt,tt)}catch(nt){tt(nt)}finally{C.T=z}},xt.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},xt.use=function(P){return C.H.use(P)},xt.useActionState=function(P,z,Y){return C.H.useActionState(P,z,Y)},xt.useCallback=function(P,z){return C.H.useCallback(P,z)},xt.useContext=function(P){return C.H.useContext(P)},xt.useDebugValue=function(){},xt.useDeferredValue=function(P,z){return C.H.useDeferredValue(P,z)},xt.useEffect=function(P,z,Y){var U=C.H;if(typeof Y=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return U.useEffect(P,z)},xt.useId=function(){return C.H.useId()},xt.useImperativeHandle=function(P,z,Y){return C.H.useImperativeHandle(P,z,Y)},xt.useInsertionEffect=function(P,z){return C.H.useInsertionEffect(P,z)},xt.useLayoutEffect=function(P,z){return C.H.useLayoutEffect(P,z)},xt.useMemo=function(P,z){return C.H.useMemo(P,z)},xt.useOptimistic=function(P,z){return C.H.useOptimistic(P,z)},xt.useReducer=function(P,z,Y){return C.H.useReducer(P,z,Y)},xt.useRef=function(P){return C.H.useRef(P)},xt.useState=function(P){return C.H.useState(P)},xt.useSyncExternalStore=function(P,z,Y){return C.H.useSyncExternalStore(P,z,Y)},xt.useTransition=function(){return C.H.useTransition()},xt.version="19.1.0",xt}var Pv;function Cs(){return Pv||(Pv=1,Vd.exports=QA()),Vd.exports}var j=Cs();const Gn=ng(j);var Xd={exports:{}},Mo={},Yd={exports:{}},Wd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nv;function ZA(){return Nv||(Nv=1,function(o){function t(B,H){var tt=B.length;B.push(H);t:for(;0<tt;){var lt=tt-1>>>1,P=B[lt];if(0<s(P,H))B[lt]=H,B[tt]=P,tt=lt;else break t}}function e(B){return B.length===0?null:B[0]}function n(B){if(B.length===0)return null;var H=B[0],tt=B.pop();if(tt!==H){B[0]=tt;t:for(var lt=0,P=B.length,z=P>>>1;lt<z;){var Y=2*(lt+1)-1,U=B[Y],et=Y+1,nt=B[et];if(0>s(U,tt))et<P&&0>s(nt,U)?(B[lt]=nt,B[et]=tt,lt=et):(B[lt]=U,B[Y]=tt,lt=Y);else if(et<P&&0>s(nt,tt))B[lt]=nt,B[et]=tt,lt=et;else break t}}return H}function s(B,H){var tt=B.sortIndex-H.sortIndex;return tt!==0?tt:B.id-H.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;o.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();o.unstable_now=function(){return l.now()-u}}var d=[],f=[],g=1,m=null,v=3,b=!1,S=!1,w=!1,A=!1,_=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function O(B){for(var H=e(f);H!==null;){if(H.callback===null)n(f);else if(H.startTime<=B)n(f),H.sortIndex=H.expirationTime,t(d,H);else break;H=e(f)}}function C(B){if(w=!1,O(B),!S)if(e(d)!==null)S=!0,D||(D=!0,it());else{var H=e(f);H!==null&&ot(C,H.startTime-B)}}var D=!1,R=-1,k=5,L=-1;function V(){return A?!0:!(o.unstable_now()-L<k)}function q(){if(A=!1,D){var B=o.unstable_now();L=B;var H=!0;try{t:{S=!1,w&&(w=!1,E(R),R=-1),b=!0;var tt=v;try{e:{for(O(B),m=e(d);m!==null&&!(m.expirationTime>B&&V());){var lt=m.callback;if(typeof lt=="function"){m.callback=null,v=m.priorityLevel;var P=lt(m.expirationTime<=B);if(B=o.unstable_now(),typeof P=="function"){m.callback=P,O(B),H=!0;break e}m===e(d)&&n(d),O(B)}else n(d);m=e(d)}if(m!==null)H=!0;else{var z=e(f);z!==null&&ot(C,z.startTime-B),H=!1}}break t}finally{m=null,v=tt,b=!1}H=void 0}}finally{H?it():D=!1}}}var it;if(typeof x=="function")it=function(){x(q)};else if(typeof MessageChannel<"u"){var rt=new MessageChannel,st=rt.port2;rt.port1.onmessage=q,it=function(){st.postMessage(null)}}else it=function(){_(q,0)};function ot(B,H){R=_(function(){B(o.unstable_now())},H)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(B){B.callback=null},o.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<B?Math.floor(1e3/B):5},o.unstable_getCurrentPriorityLevel=function(){return v},o.unstable_next=function(B){switch(v){case 1:case 2:case 3:var H=3;break;default:H=v}var tt=v;v=H;try{return B()}finally{v=tt}},o.unstable_requestPaint=function(){A=!0},o.unstable_runWithPriority=function(B,H){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var tt=v;v=B;try{return H()}finally{v=tt}},o.unstable_scheduleCallback=function(B,H,tt){var lt=o.unstable_now();switch(typeof tt=="object"&&tt!==null?(tt=tt.delay,tt=typeof tt=="number"&&0<tt?lt+tt:lt):tt=lt,B){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=tt+P,B={id:g++,callback:H,priorityLevel:B,startTime:tt,expirationTime:P,sortIndex:-1},tt>lt?(B.sortIndex=tt,t(f,B),e(d)===null&&B===e(f)&&(w?(E(R),R=-1):w=!0,ot(C,tt-lt))):(B.sortIndex=P,t(d,B),S||b||(S=!0,D||(D=!0,it()))),B},o.unstable_shouldYield=V,o.unstable_wrapCallback=function(B){var H=v;return function(){var tt=v;v=H;try{return B.apply(this,arguments)}finally{v=tt}}}}(Wd)),Wd}var Lv;function JA(){return Lv||(Lv=1,Yd.exports=ZA()),Yd.exports}var Kd={exports:{}},Ke={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bv;function tE(){if(Bv)return Ke;Bv=1;var o=Cs();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(d,f,g){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:m==null?null:""+m,children:d,containerInfo:f,implementation:g}}var l=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Ke.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Ke.createPortal=function(d,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return a(d,f,null,g)},Ke.flushSync=function(d){var f=l.T,g=n.p;try{if(l.T=null,n.p=2,d)return d()}finally{l.T=f,n.p=g,n.d.f()}},Ke.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(d,f))},Ke.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},Ke.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var g=f.as,m=u(g,f.crossOrigin),v=typeof f.integrity=="string"?f.integrity:void 0,b=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?n.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:m,integrity:v,fetchPriority:b}):g==="script"&&n.d.X(d,{crossOrigin:m,integrity:v,fetchPriority:b,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Ke.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=u(f.as,f.crossOrigin);n.d.M(d,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(d)},Ke.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,m=u(g,f.crossOrigin);n.d.L(d,g,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Ke.preloadModule=function(d,f){if(typeof d=="string")if(f){var g=u(f.as,f.crossOrigin);n.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(d)},Ke.requestFormReset=function(d){n.d.r(d)},Ke.unstable_batchedUpdates=function(d,f){return d(f)},Ke.useFormState=function(d,f,g){return l.H.useFormState(d,f,g)},Ke.useFormStatus=function(){return l.H.useHostTransitionStatus()},Ke.version="19.1.0",Ke}var jv;function Su(){if(jv)return Kd.exports;jv=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),Kd.exports=tE(),Kd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iv;function eE(){if(Iv)return Mo;Iv=1;var o=JA(),t=Cs(),e=Su();function n(i){var r="https://react.dev/errors/"+i;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)r+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function a(i){var r=i,c=i;if(i.alternate)for(;r.return;)r=r.return;else{i=r;do r=i,(r.flags&4098)!==0&&(c=r.return),i=r.return;while(i)}return r.tag===3?c:null}function l(i){if(i.tag===13){var r=i.memoizedState;if(r===null&&(i=i.alternate,i!==null&&(r=i.memoizedState)),r!==null)return r.dehydrated}return null}function u(i){if(a(i)!==i)throw Error(n(188))}function d(i){var r=i.alternate;if(!r){if(r=a(i),r===null)throw Error(n(188));return r!==i?null:i}for(var c=i,h=r;;){var p=c.return;if(p===null)break;var y=p.alternate;if(y===null){if(h=p.return,h!==null){c=h;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===c)return u(p),i;if(y===h)return u(p),r;y=y.sibling}throw Error(n(188))}if(c.return!==h.return)c=p,h=y;else{for(var T=!1,M=p.child;M;){if(M===c){T=!0,c=p,h=y;break}if(M===h){T=!0,h=p,c=y;break}M=M.sibling}if(!T){for(M=y.child;M;){if(M===c){T=!0,c=y,h=p;break}if(M===h){T=!0,h=y,c=p;break}M=M.sibling}if(!T)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?i:r}function f(i){var r=i.tag;if(r===5||r===26||r===27||r===6)return i;for(i=i.child;i!==null;){if(r=f(i),r!==null)return r;i=i.sibling}return null}var g=Object.assign,m=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),E=Symbol.for("react.consumer"),x=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function it(i){return i===null||typeof i!="object"?null:(i=q&&i[q]||i["@@iterator"],typeof i=="function"?i:null)}var rt=Symbol.for("react.client.reference");function st(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===rt?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case S:return"Fragment";case A:return"Profiler";case w:return"StrictMode";case C:return"Suspense";case D:return"SuspenseList";case L:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case b:return"Portal";case x:return(i.displayName||"Context")+".Provider";case E:return(i._context.displayName||"Context")+".Consumer";case O:var r=i.render;return i=i.displayName,i||(i=r.displayName||r.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case R:return r=i.displayName||null,r!==null?r:st(i.type)||"Memo";case k:r=i._payload,i=i._init;try{return st(i(r))}catch{}}return null}var ot=Array.isArray,B=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,tt={pending:!1,data:null,method:null,action:null},lt=[],P=-1;function z(i){return{current:i}}function Y(i){0>P||(i.current=lt[P],lt[P]=null,P--)}function U(i,r){P++,lt[P]=i.current,i.current=r}var et=z(null),nt=z(null),at=z(null),ft=z(null);function vt(i,r){switch(U(at,r),U(nt,i),U(et,null),r.nodeType){case 9:case 11:i=(i=r.documentElement)&&(i=i.namespaceURI)?nv(i):0;break;default:if(i=r.tagName,r=r.namespaceURI)r=nv(r),i=iv(r,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}Y(et),U(et,i)}function It(){Y(et),Y(nt),Y(at)}function St(i){i.memoizedState!==null&&U(ft,i);var r=et.current,c=iv(r,i.type);r!==c&&(U(nt,i),U(et,c))}function Ae(i){nt.current===i&&(Y(et),Y(nt)),ft.current===i&&(Y(ft),To._currentValue=tt)}var le=Object.prototype.hasOwnProperty,Dt=o.unstable_scheduleCallback,Pt=o.unstable_cancelCallback,Jt=o.unstable_shouldYield,Yt=o.unstable_requestPaint,Ee=o.unstable_now,si=o.unstable_getCurrentPriorityLevel,ri=o.unstable_ImmediatePriority,mn=o.unstable_UserBlockingPriority,on=o.unstable_NormalPriority,Gi=o.unstable_LowPriority,Ds=o.unstable_IdlePriority,gr=o.log,Na=o.unstable_setDisableYieldValue,Si=null,Ft=null;function ge(i){if(typeof gr=="function"&&Na(i),Ft&&typeof Ft.setStrictMode=="function")try{Ft.setStrictMode(Si,i)}catch{}}var $t=Math.clz32?Math.clz32:El,Vi=Math.log,ai=Math.LN2;function El(i){return i>>>=0,i===0?32:31-(Vi(i)/ai|0)|0}var pr=256,mr=4194304;function Xn(i){var r=i&42;if(r!==0)return r;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Os(i,r,c){var h=i.pendingLanes;if(h===0)return 0;var p=0,y=i.suspendedLanes,T=i.pingedLanes;i=i.warmLanes;var M=h&134217727;return M!==0?(h=M&~y,h!==0?p=Xn(h):(T&=M,T!==0?p=Xn(T):c||(c=M&~i,c!==0&&(p=Xn(c))))):(M=h&~y,M!==0?p=Xn(M):T!==0?p=Xn(T):c||(c=h&~i,c!==0&&(p=Xn(c)))),p===0?0:r!==0&&r!==p&&(r&y)===0&&(y=p&-p,c=r&-r,y>=c||y===32&&(c&4194048)!==0)?r:p}function Ms(i,r){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&r)===0}function Tl(i,r){switch(i){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xl(){var i=pr;return pr<<=1,(pr&4194048)===0&&(pr=256),i}function Cl(){var i=mr;return mr<<=1,(mr&62914560)===0&&(mr=4194304),i}function La(i){for(var r=[],c=0;31>c;c++)r.push(i);return r}function pe(i,r){i.pendingLanes|=r,r!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function nn(i,r,c,h,p,y){var T=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var M=i.entanglements,N=i.expirationTimes,G=i.hiddenUpdates;for(c=T&~c;0<c;){var K=31-$t(c),J=1<<K;M[K]=0,N[K]=-1;var X=G[K];if(X!==null)for(G[K]=null,K=0;K<X.length;K++){var W=X[K];W!==null&&(W.lane&=-536870913)}c&=~J}h!==0&&Ve(i,h,0),y!==0&&p===0&&i.tag!==0&&(i.suspendedLanes|=y&~(T&~r))}function Ve(i,r,c){i.pendingLanes|=r,i.suspendedLanes&=~r;var h=31-$t(r);i.entangledLanes|=r,i.entanglements[h]=i.entanglements[h]|1073741824|c&4194090}function Yn(i,r){var c=i.entangledLanes|=r;for(i=i.entanglements;c;){var h=31-$t(c),p=1<<h;p&r|i[h]&r&&(i[h]|=r),c&=~p}}function Xe(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Fe(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function yn(){var i=H.p;return i!==0?i:(i=window.event,i===void 0?32:Sv(i.type))}function Xi(i,r){var c=H.p;try{return H.p=i,r()}finally{H.p=c}}var te=Math.random().toString(36).slice(2),ie="__reactFiber$"+te,se="__reactProps$"+te,Ye="__reactContainer$"+te,Ai="__reactEvents$"+te,ks="__reactListeners$"+te,oi="__reactHandles$"+te,Yi="__reactResources$"+te,Ei="__reactMarker$"+te;function ju(i){delete i[ie],delete i[se],delete i[Ai],delete i[ks],delete i[oi]}function yr(i){var r=i[ie];if(r)return r;for(var c=i.parentNode;c;){if(r=c[Ye]||c[ie]){if(c=r.alternate,r.child!==null||c!==null&&c.child!==null)for(i=ov(i);i!==null;){if(c=i[ie])return c;i=ov(i)}return r}i=c,c=i.parentNode}return null}function vr(i){if(i=i[ie]||i[Ye]){var r=i.tag;if(r===5||r===6||r===13||r===26||r===27||r===3)return i}return null}function Ba(i){var r=i.tag;if(r===5||r===26||r===27||r===6)return i.stateNode;throw Error(n(33))}function br(i){var r=i[Yi];return r||(r=i[Yi]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function ke(i){i[Ei]=!0}var Gg=new Set,Vg={};function Ps(i,r){wr(i,r),wr(i+"Capture",r)}function wr(i,r){for(Vg[i]=r,i=0;i<r.length;i++)Gg.add(r[i])}var z_=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Xg={},Yg={};function H_(i){return le.call(Yg,i)?!0:le.call(Xg,i)?!1:z_.test(i)?Yg[i]=!0:(Xg[i]=!0,!1)}function Rl(i,r,c){if(H_(r))if(c===null)i.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(r);return;case"boolean":var h=r.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){i.removeAttribute(r);return}}i.setAttribute(r,""+c)}}function Dl(i,r,c){if(c===null)i.removeAttribute(r);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(r);return}i.setAttribute(r,""+c)}}function Ti(i,r,c,h){if(h===null)i.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(r,c,""+h)}}var Iu,Wg;function _r(i){if(Iu===void 0)try{throw Error()}catch(c){var r=c.stack.trim().match(/\n( *(at )?)/);Iu=r&&r[1]||"",Wg=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Iu+i+Wg}var Uu=!1;function Fu(i,r){if(!i||Uu)return"";Uu=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(r){var J=function(){throw Error()};if(Object.defineProperty(J.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(J,[])}catch(W){var X=W}Reflect.construct(i,[],J)}else{try{J.call()}catch(W){X=W}i.call(J.prototype)}}else{try{throw Error()}catch(W){X=W}(J=i())&&typeof J.catch=="function"&&J.catch(function(){})}}catch(W){if(W&&X&&typeof W.stack=="string")return[W.stack,X.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=h.DetermineComponentFrameRoot(),T=y[0],M=y[1];if(T&&M){var N=T.split(`
`),G=M.split(`
`);for(p=h=0;h<N.length&&!N[h].includes("DetermineComponentFrameRoot");)h++;for(;p<G.length&&!G[p].includes("DetermineComponentFrameRoot");)p++;if(h===N.length||p===G.length)for(h=N.length-1,p=G.length-1;1<=h&&0<=p&&N[h]!==G[p];)p--;for(;1<=h&&0<=p;h--,p--)if(N[h]!==G[p]){if(h!==1||p!==1)do if(h--,p--,0>p||N[h]!==G[p]){var K=`
`+N[h].replace(" at new "," at ");return i.displayName&&K.includes("<anonymous>")&&(K=K.replace("<anonymous>",i.displayName)),K}while(1<=h&&0<=p);break}}}finally{Uu=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?_r(c):""}function $_(i){switch(i.tag){case 26:case 27:case 5:return _r(i.type);case 16:return _r("Lazy");case 13:return _r("Suspense");case 19:return _r("SuspenseList");case 0:case 15:return Fu(i.type,!1);case 11:return Fu(i.type.render,!1);case 1:return Fu(i.type,!0);case 31:return _r("Activity");default:return""}}function Kg(i){try{var r="";do r+=$_(i),i=i.return;while(i);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function kn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Qg(i){var r=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function q_(i){var r=Qg(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,r),h=""+i[r];if(!i.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,y=c.set;return Object.defineProperty(i,r,{configurable:!0,get:function(){return p.call(this)},set:function(T){h=""+T,y.call(this,T)}}),Object.defineProperty(i,r,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(T){h=""+T},stopTracking:function(){i._valueTracker=null,delete i[r]}}}}function Ol(i){i._valueTracker||(i._valueTracker=q_(i))}function Zg(i){if(!i)return!1;var r=i._valueTracker;if(!r)return!0;var c=r.getValue(),h="";return i&&(h=Qg(i)?i.checked?"true":"false":i.value),i=h,i!==c?(r.setValue(i),!0):!1}function Ml(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var G_=/[\n"\\]/g;function Pn(i){return i.replace(G_,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function zu(i,r,c,h,p,y,T,M){i.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?i.type=T:i.removeAttribute("type"),r!=null?T==="number"?(r===0&&i.value===""||i.value!=r)&&(i.value=""+kn(r)):i.value!==""+kn(r)&&(i.value=""+kn(r)):T!=="submit"&&T!=="reset"||i.removeAttribute("value"),r!=null?Hu(i,T,kn(r)):c!=null?Hu(i,T,kn(c)):h!=null&&i.removeAttribute("value"),p==null&&y!=null&&(i.defaultChecked=!!y),p!=null&&(i.checked=p&&typeof p!="function"&&typeof p!="symbol"),M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?i.name=""+kn(M):i.removeAttribute("name")}function Jg(i,r,c,h,p,y,T,M){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(i.type=y),r!=null||c!=null){if(!(y!=="submit"&&y!=="reset"||r!=null))return;c=c!=null?""+kn(c):"",r=r!=null?""+kn(r):c,M||r===i.value||(i.value=r),i.defaultValue=r}h=h??p,h=typeof h!="function"&&typeof h!="symbol"&&!!h,i.checked=M?i.checked:!!h,i.defaultChecked=!!h,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(i.name=T)}function Hu(i,r,c){r==="number"&&Ml(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function Sr(i,r,c,h){if(i=i.options,r){r={};for(var p=0;p<c.length;p++)r["$"+c[p]]=!0;for(c=0;c<i.length;c++)p=r.hasOwnProperty("$"+i[c].value),i[c].selected!==p&&(i[c].selected=p),p&&h&&(i[c].defaultSelected=!0)}else{for(c=""+kn(c),r=null,p=0;p<i.length;p++){if(i[p].value===c){i[p].selected=!0,h&&(i[p].defaultSelected=!0);return}r!==null||i[p].disabled||(r=i[p])}r!==null&&(r.selected=!0)}}function tp(i,r,c){if(r!=null&&(r=""+kn(r),r!==i.value&&(i.value=r),c==null)){i.defaultValue!==r&&(i.defaultValue=r);return}i.defaultValue=c!=null?""+kn(c):""}function ep(i,r,c,h){if(r==null){if(h!=null){if(c!=null)throw Error(n(92));if(ot(h)){if(1<h.length)throw Error(n(93));h=h[0]}c=h}c==null&&(c=""),r=c}c=kn(r),i.defaultValue=c,h=i.textContent,h===c&&h!==""&&h!==null&&(i.value=h)}function Ar(i,r){if(r){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=r;return}}i.textContent=r}var V_=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function np(i,r,c){var h=r.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?i.setProperty(r,""):r==="float"?i.cssFloat="":i[r]="":h?i.setProperty(r,c):typeof c!="number"||c===0||V_.has(r)?r==="float"?i.cssFloat=c:i[r]=(""+c).trim():i[r]=c+"px"}function ip(i,r,c){if(r!=null&&typeof r!="object")throw Error(n(62));if(i=i.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||r!=null&&r.hasOwnProperty(h)||(h.indexOf("--")===0?i.setProperty(h,""):h==="float"?i.cssFloat="":i[h]="");for(var p in r)h=r[p],r.hasOwnProperty(p)&&c[p]!==h&&np(i,p,h)}else for(var y in r)r.hasOwnProperty(y)&&np(i,y,r[y])}function $u(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var X_=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Y_=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function kl(i){return Y_.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var qu=null;function Gu(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Er=null,Tr=null;function sp(i){var r=vr(i);if(r&&(i=r.stateNode)){var c=i[se]||null;t:switch(i=r.stateNode,r.type){case"input":if(zu(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),r=c.name,c.type==="radio"&&r!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Pn(""+r)+'"][type="radio"]'),r=0;r<c.length;r++){var h=c[r];if(h!==i&&h.form===i.form){var p=h[se]||null;if(!p)throw Error(n(90));zu(h,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(r=0;r<c.length;r++)h=c[r],h.form===i.form&&Zg(h)}break t;case"textarea":tp(i,c.value,c.defaultValue);break t;case"select":r=c.value,r!=null&&Sr(i,!!c.multiple,r,!1)}}}var Vu=!1;function rp(i,r,c){if(Vu)return i(r,c);Vu=!0;try{var h=i(r);return h}finally{if(Vu=!1,(Er!==null||Tr!==null)&&(yc(),Er&&(r=Er,i=Tr,Tr=Er=null,sp(r),i)))for(r=0;r<i.length;r++)sp(i[r])}}function ja(i,r){var c=i.stateNode;if(c===null)return null;var h=c[se]||null;if(h===null)return null;c=h[r];t:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break t;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(n(231,r,typeof c));return c}var xi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xu=!1;if(xi)try{var Ia={};Object.defineProperty(Ia,"passive",{get:function(){Xu=!0}}),window.addEventListener("test",Ia,Ia),window.removeEventListener("test",Ia,Ia)}catch{Xu=!1}var Wi=null,Yu=null,Pl=null;function ap(){if(Pl)return Pl;var i,r=Yu,c=r.length,h,p="value"in Wi?Wi.value:Wi.textContent,y=p.length;for(i=0;i<c&&r[i]===p[i];i++);var T=c-i;for(h=1;h<=T&&r[c-h]===p[y-h];h++);return Pl=p.slice(i,1<h?1-h:void 0)}function Nl(i){var r=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&r===13&&(i=13)):i=r,i===10&&(i=13),32<=i||i===13?i:0}function Ll(){return!0}function op(){return!1}function ln(i){function r(c,h,p,y,T){this._reactName=c,this._targetInst=p,this.type=h,this.nativeEvent=y,this.target=T,this.currentTarget=null;for(var M in i)i.hasOwnProperty(M)&&(c=i[M],this[M]=c?c(y):y[M]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Ll:op,this.isPropagationStopped=op,this}return g(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ll)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ll)},persist:function(){},isPersistent:Ll}),r}var Ns={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bl=ln(Ns),Ua=g({},Ns,{view:0,detail:0}),W_=ln(Ua),Wu,Ku,Fa,jl=g({},Ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zu,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Fa&&(Fa&&i.type==="mousemove"?(Wu=i.screenX-Fa.screenX,Ku=i.screenY-Fa.screenY):Ku=Wu=0,Fa=i),Wu)},movementY:function(i){return"movementY"in i?i.movementY:Ku}}),lp=ln(jl),K_=g({},jl,{dataTransfer:0}),Q_=ln(K_),Z_=g({},Ua,{relatedTarget:0}),Qu=ln(Z_),J_=g({},Ns,{animationName:0,elapsedTime:0,pseudoElement:0}),tS=ln(J_),eS=g({},Ns,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),nS=ln(eS),iS=g({},Ns,{data:0}),cp=ln(iS),sS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function oS(i){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(i):(i=aS[i])?!!r[i]:!1}function Zu(){return oS}var lS=g({},Ua,{key:function(i){if(i.key){var r=sS[i.key]||i.key;if(r!=="Unidentified")return r}return i.type==="keypress"?(i=Nl(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?rS[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zu,charCode:function(i){return i.type==="keypress"?Nl(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Nl(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),cS=ln(lS),uS=g({},jl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),up=ln(uS),hS=g({},Ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zu}),dS=ln(hS),fS=g({},Ns,{propertyName:0,elapsedTime:0,pseudoElement:0}),gS=ln(fS),pS=g({},jl,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),mS=ln(pS),yS=g({},Ns,{newState:0,oldState:0}),vS=ln(yS),bS=[9,13,27,32],Ju=xi&&"CompositionEvent"in window,za=null;xi&&"documentMode"in document&&(za=document.documentMode);var wS=xi&&"TextEvent"in window&&!za,hp=xi&&(!Ju||za&&8<za&&11>=za),dp=" ",fp=!1;function gp(i,r){switch(i){case"keyup":return bS.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pp(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var xr=!1;function _S(i,r){switch(i){case"compositionend":return pp(r);case"keypress":return r.which!==32?null:(fp=!0,dp);case"textInput":return i=r.data,i===dp&&fp?null:i;default:return null}}function SS(i,r){if(xr)return i==="compositionend"||!Ju&&gp(i,r)?(i=ap(),Pl=Yu=Wi=null,xr=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return hp&&r.locale!=="ko"?null:r.data;default:return null}}var AS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mp(i){var r=i&&i.nodeName&&i.nodeName.toLowerCase();return r==="input"?!!AS[i.type]:r==="textarea"}function yp(i,r,c,h){Er?Tr?Tr.push(h):Tr=[h]:Er=h,r=Ac(r,"onChange"),0<r.length&&(c=new Bl("onChange","change",null,c,h),i.push({event:c,listeners:r}))}var Ha=null,$a=null;function ES(i){Qy(i,0)}function Il(i){var r=Ba(i);if(Zg(r))return i}function vp(i,r){if(i==="change")return r}var bp=!1;if(xi){var th;if(xi){var eh="oninput"in document;if(!eh){var wp=document.createElement("div");wp.setAttribute("oninput","return;"),eh=typeof wp.oninput=="function"}th=eh}else th=!1;bp=th&&(!document.documentMode||9<document.documentMode)}function _p(){Ha&&(Ha.detachEvent("onpropertychange",Sp),$a=Ha=null)}function Sp(i){if(i.propertyName==="value"&&Il($a)){var r=[];yp(r,$a,i,Gu(i)),rp(ES,r)}}function TS(i,r,c){i==="focusin"?(_p(),Ha=r,$a=c,Ha.attachEvent("onpropertychange",Sp)):i==="focusout"&&_p()}function xS(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Il($a)}function CS(i,r){if(i==="click")return Il(r)}function RS(i,r){if(i==="input"||i==="change")return Il(r)}function DS(i,r){return i===r&&(i!==0||1/i===1/r)||i!==i&&r!==r}var vn=typeof Object.is=="function"?Object.is:DS;function qa(i,r){if(vn(i,r))return!0;if(typeof i!="object"||i===null||typeof r!="object"||r===null)return!1;var c=Object.keys(i),h=Object.keys(r);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var p=c[h];if(!le.call(r,p)||!vn(i[p],r[p]))return!1}return!0}function Ap(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Ep(i,r){var c=Ap(i);i=0;for(var h;c;){if(c.nodeType===3){if(h=i+c.textContent.length,i<=r&&h>=r)return{node:c,offset:r-i};i=h}t:{for(;c;){if(c.nextSibling){c=c.nextSibling;break t}c=c.parentNode}c=void 0}c=Ap(c)}}function Tp(i,r){return i&&r?i===r?!0:i&&i.nodeType===3?!1:r&&r.nodeType===3?Tp(i,r.parentNode):"contains"in i?i.contains(r):i.compareDocumentPosition?!!(i.compareDocumentPosition(r)&16):!1:!1}function xp(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var r=Ml(i.document);r instanceof i.HTMLIFrameElement;){try{var c=typeof r.contentWindow.location.href=="string"}catch{c=!1}if(c)i=r.contentWindow;else break;r=Ml(i.document)}return r}function nh(i){var r=i&&i.nodeName&&i.nodeName.toLowerCase();return r&&(r==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||r==="textarea"||i.contentEditable==="true")}var OS=xi&&"documentMode"in document&&11>=document.documentMode,Cr=null,ih=null,Ga=null,sh=!1;function Cp(i,r,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;sh||Cr==null||Cr!==Ml(h)||(h=Cr,"selectionStart"in h&&nh(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Ga&&qa(Ga,h)||(Ga=h,h=Ac(ih,"onSelect"),0<h.length&&(r=new Bl("onSelect","select",null,r,c),i.push({event:r,listeners:h}),r.target=Cr)))}function Ls(i,r){var c={};return c[i.toLowerCase()]=r.toLowerCase(),c["Webkit"+i]="webkit"+r,c["Moz"+i]="moz"+r,c}var Rr={animationend:Ls("Animation","AnimationEnd"),animationiteration:Ls("Animation","AnimationIteration"),animationstart:Ls("Animation","AnimationStart"),transitionrun:Ls("Transition","TransitionRun"),transitionstart:Ls("Transition","TransitionStart"),transitioncancel:Ls("Transition","TransitionCancel"),transitionend:Ls("Transition","TransitionEnd")},rh={},Rp={};xi&&(Rp=document.createElement("div").style,"AnimationEvent"in window||(delete Rr.animationend.animation,delete Rr.animationiteration.animation,delete Rr.animationstart.animation),"TransitionEvent"in window||delete Rr.transitionend.transition);function Bs(i){if(rh[i])return rh[i];if(!Rr[i])return i;var r=Rr[i],c;for(c in r)if(r.hasOwnProperty(c)&&c in Rp)return rh[i]=r[c];return i}var Dp=Bs("animationend"),Op=Bs("animationiteration"),Mp=Bs("animationstart"),MS=Bs("transitionrun"),kS=Bs("transitionstart"),PS=Bs("transitioncancel"),kp=Bs("transitionend"),Pp=new Map,ah="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ah.push("scrollEnd");function Wn(i,r){Pp.set(i,r),Ps(r,[i])}var Np=new WeakMap;function Nn(i,r){if(typeof i=="object"&&i!==null){var c=Np.get(i);return c!==void 0?c:(r={value:i,source:r,stack:Kg(r)},Np.set(i,r),r)}return{value:i,source:r,stack:Kg(r)}}var Ln=[],Dr=0,oh=0;function Ul(){for(var i=Dr,r=oh=Dr=0;r<i;){var c=Ln[r];Ln[r++]=null;var h=Ln[r];Ln[r++]=null;var p=Ln[r];Ln[r++]=null;var y=Ln[r];if(Ln[r++]=null,h!==null&&p!==null){var T=h.pending;T===null?p.next=p:(p.next=T.next,T.next=p),h.pending=p}y!==0&&Lp(c,p,y)}}function Fl(i,r,c,h){Ln[Dr++]=i,Ln[Dr++]=r,Ln[Dr++]=c,Ln[Dr++]=h,oh|=h,i.lanes|=h,i=i.alternate,i!==null&&(i.lanes|=h)}function lh(i,r,c,h){return Fl(i,r,c,h),zl(i)}function Or(i,r){return Fl(i,null,null,r),zl(i)}function Lp(i,r,c){i.lanes|=c;var h=i.alternate;h!==null&&(h.lanes|=c);for(var p=!1,y=i.return;y!==null;)y.childLanes|=c,h=y.alternate,h!==null&&(h.childLanes|=c),y.tag===22&&(i=y.stateNode,i===null||i._visibility&1||(p=!0)),i=y,y=y.return;return i.tag===3?(y=i.stateNode,p&&r!==null&&(p=31-$t(c),i=y.hiddenUpdates,h=i[p],h===null?i[p]=[r]:h.push(r),r.lane=c|536870912),y):null}function zl(i){if(50<yo)throw yo=0,gd=null,Error(n(185));for(var r=i.return;r!==null;)i=r,r=i.return;return i.tag===3?i.stateNode:null}var Mr={};function NS(i,r,c,h){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bn(i,r,c,h){return new NS(i,r,c,h)}function ch(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ci(i,r){var c=i.alternate;return c===null?(c=bn(i.tag,r,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=r,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,r=i.dependencies,c.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function Bp(i,r){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=r,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,r=c.dependencies,i.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),i}function Hl(i,r,c,h,p,y){var T=0;if(h=i,typeof i=="function")ch(i)&&(T=1);else if(typeof i=="string")T=BA(i,c,et.current)?26:i==="html"||i==="head"||i==="body"?27:5;else t:switch(i){case L:return i=bn(31,c,r,p),i.elementType=L,i.lanes=y,i;case S:return js(c.children,p,y,r);case w:T=8,p|=24;break;case A:return i=bn(12,c,r,p|2),i.elementType=A,i.lanes=y,i;case C:return i=bn(13,c,r,p),i.elementType=C,i.lanes=y,i;case D:return i=bn(19,c,r,p),i.elementType=D,i.lanes=y,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case _:case x:T=10;break t;case E:T=9;break t;case O:T=11;break t;case R:T=14;break t;case k:T=16,h=null;break t}T=29,c=Error(n(130,i===null?"null":typeof i,"")),h=null}return r=bn(T,c,r,p),r.elementType=i,r.type=h,r.lanes=y,r}function js(i,r,c,h){return i=bn(7,i,h,r),i.lanes=c,i}function uh(i,r,c){return i=bn(6,i,null,r),i.lanes=c,i}function hh(i,r,c){return r=bn(4,i.children!==null?i.children:[],i.key,r),r.lanes=c,r.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},r}var kr=[],Pr=0,$l=null,ql=0,Bn=[],jn=0,Is=null,Ri=1,Di="";function Us(i,r){kr[Pr++]=ql,kr[Pr++]=$l,$l=i,ql=r}function jp(i,r,c){Bn[jn++]=Ri,Bn[jn++]=Di,Bn[jn++]=Is,Is=i;var h=Ri;i=Di;var p=32-$t(h)-1;h&=~(1<<p),c+=1;var y=32-$t(r)+p;if(30<y){var T=p-p%5;y=(h&(1<<T)-1).toString(32),h>>=T,p-=T,Ri=1<<32-$t(r)+p|c<<p|h,Di=y+i}else Ri=1<<y|c<<p|h,Di=i}function dh(i){i.return!==null&&(Us(i,1),jp(i,1,0))}function fh(i){for(;i===$l;)$l=kr[--Pr],kr[Pr]=null,ql=kr[--Pr],kr[Pr]=null;for(;i===Is;)Is=Bn[--jn],Bn[jn]=null,Di=Bn[--jn],Bn[jn]=null,Ri=Bn[--jn],Bn[jn]=null}var sn=null,me=null,Ut=!1,Fs=null,li=!1,gh=Error(n(519));function zs(i){var r=Error(n(418,""));throw Ya(Nn(r,i)),gh}function Ip(i){var r=i.stateNode,c=i.type,h=i.memoizedProps;switch(r[ie]=i,r[se]=h,c){case"dialog":kt("cancel",r),kt("close",r);break;case"iframe":case"object":case"embed":kt("load",r);break;case"video":case"audio":for(c=0;c<bo.length;c++)kt(bo[c],r);break;case"source":kt("error",r);break;case"img":case"image":case"link":kt("error",r),kt("load",r);break;case"details":kt("toggle",r);break;case"input":kt("invalid",r),Jg(r,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0),Ol(r);break;case"select":kt("invalid",r);break;case"textarea":kt("invalid",r),ep(r,h.value,h.defaultValue,h.children),Ol(r)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||r.textContent===""+c||h.suppressHydrationWarning===!0||ev(r.textContent,c)?(h.popover!=null&&(kt("beforetoggle",r),kt("toggle",r)),h.onScroll!=null&&kt("scroll",r),h.onScrollEnd!=null&&kt("scrollend",r),h.onClick!=null&&(r.onclick=Ec),r=!0):r=!1,r||zs(i)}function Up(i){for(sn=i.return;sn;)switch(sn.tag){case 5:case 13:li=!1;return;case 27:case 3:li=!0;return;default:sn=sn.return}}function Va(i){if(i!==sn)return!1;if(!Ut)return Up(i),Ut=!0,!1;var r=i.tag,c;if((c=r!==3&&r!==27)&&((c=r===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||Od(i.type,i.memoizedProps)),c=!c),c&&me&&zs(i),Up(i),r===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));t:{for(i=i.nextSibling,r=0;i;){if(i.nodeType===8)if(c=i.data,c==="/$"){if(r===0){me=Qn(i.nextSibling);break t}r--}else c!=="$"&&c!=="$!"&&c!=="$?"||r++;i=i.nextSibling}me=null}}else r===27?(r=me,hs(i.type)?(i=Nd,Nd=null,me=i):me=r):me=sn?Qn(i.stateNode.nextSibling):null;return!0}function Xa(){me=sn=null,Ut=!1}function Fp(){var i=Fs;return i!==null&&(hn===null?hn=i:hn.push.apply(hn,i),Fs=null),i}function Ya(i){Fs===null?Fs=[i]:Fs.push(i)}var ph=z(null),Hs=null,Oi=null;function Ki(i,r,c){U(ph,r._currentValue),r._currentValue=c}function Mi(i){i._currentValue=ph.current,Y(ph)}function mh(i,r,c){for(;i!==null;){var h=i.alternate;if((i.childLanes&r)!==r?(i.childLanes|=r,h!==null&&(h.childLanes|=r)):h!==null&&(h.childLanes&r)!==r&&(h.childLanes|=r),i===c)break;i=i.return}}function yh(i,r,c,h){var p=i.child;for(p!==null&&(p.return=i);p!==null;){var y=p.dependencies;if(y!==null){var T=p.child;y=y.firstContext;t:for(;y!==null;){var M=y;y=p;for(var N=0;N<r.length;N++)if(M.context===r[N]){y.lanes|=c,M=y.alternate,M!==null&&(M.lanes|=c),mh(y.return,c,i),h||(T=null);break t}y=M.next}}else if(p.tag===18){if(T=p.return,T===null)throw Error(n(341));T.lanes|=c,y=T.alternate,y!==null&&(y.lanes|=c),mh(T,c,i),T=null}else T=p.child;if(T!==null)T.return=p;else for(T=p;T!==null;){if(T===i){T=null;break}if(p=T.sibling,p!==null){p.return=T.return,T=p;break}T=T.return}p=T}}function Wa(i,r,c,h){i=null;for(var p=r,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var T=p.alternate;if(T===null)throw Error(n(387));if(T=T.memoizedProps,T!==null){var M=p.type;vn(p.pendingProps.value,T.value)||(i!==null?i.push(M):i=[M])}}else if(p===ft.current){if(T=p.alternate,T===null)throw Error(n(387));T.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(i!==null?i.push(To):i=[To])}p=p.return}i!==null&&yh(r,i,c,h),r.flags|=262144}function Gl(i){for(i=i.firstContext;i!==null;){if(!vn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function $s(i){Hs=i,Oi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function We(i){return zp(Hs,i)}function Vl(i,r){return Hs===null&&$s(i),zp(i,r)}function zp(i,r){var c=r._currentValue;if(r={context:r,memoizedValue:c,next:null},Oi===null){if(i===null)throw Error(n(308));Oi=r,i.dependencies={lanes:0,firstContext:r},i.flags|=524288}else Oi=Oi.next=r;return c}var LS=typeof AbortController<"u"?AbortController:function(){var i=[],r=this.signal={aborted:!1,addEventListener:function(c,h){i.push(h)}};this.abort=function(){r.aborted=!0,i.forEach(function(c){return c()})}},BS=o.unstable_scheduleCallback,jS=o.unstable_NormalPriority,De={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function vh(){return{controller:new LS,data:new Map,refCount:0}}function Ka(i){i.refCount--,i.refCount===0&&BS(jS,function(){i.controller.abort()})}var Qa=null,bh=0,Nr=0,Lr=null;function IS(i,r){if(Qa===null){var c=Qa=[];bh=0,Nr=_d(),Lr={status:"pending",value:void 0,then:function(h){c.push(h)}}}return bh++,r.then(Hp,Hp),r}function Hp(){if(--bh===0&&Qa!==null){Lr!==null&&(Lr.status="fulfilled");var i=Qa;Qa=null,Nr=0,Lr=null;for(var r=0;r<i.length;r++)(0,i[r])()}}function US(i,r){var c=[],h={status:"pending",value:null,reason:null,then:function(p){c.push(p)}};return i.then(function(){h.status="fulfilled",h.value=r;for(var p=0;p<c.length;p++)(0,c[p])(r)},function(p){for(h.status="rejected",h.reason=p,p=0;p<c.length;p++)(0,c[p])(void 0)}),h}var $p=B.S;B.S=function(i,r){typeof r=="object"&&r!==null&&typeof r.then=="function"&&IS(i,r),$p!==null&&$p(i,r)};var qs=z(null);function wh(){var i=qs.current;return i!==null?i:ee.pooledCache}function Xl(i,r){r===null?U(qs,qs.current):U(qs,r.pool)}function qp(){var i=wh();return i===null?null:{parent:De._currentValue,pool:i}}var Za=Error(n(460)),Gp=Error(n(474)),Yl=Error(n(542)),_h={then:function(){}};function Vp(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Wl(){}function Xp(i,r,c){switch(c=i[c],c===void 0?i.push(r):c!==r&&(r.then(Wl,Wl),r=c),r.status){case"fulfilled":return r.value;case"rejected":throw i=r.reason,Wp(i),i;default:if(typeof r.status=="string")r.then(Wl,Wl);else{if(i=ee,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=r,i.status="pending",i.then(function(h){if(r.status==="pending"){var p=r;p.status="fulfilled",p.value=h}},function(h){if(r.status==="pending"){var p=r;p.status="rejected",p.reason=h}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw i=r.reason,Wp(i),i}throw Ja=r,Za}}var Ja=null;function Yp(){if(Ja===null)throw Error(n(459));var i=Ja;return Ja=null,i}function Wp(i){if(i===Za||i===Yl)throw Error(n(483))}var Qi=!1;function Sh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ah(i,r){i=i.updateQueue,r.updateQueue===i&&(r.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Zi(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Ji(i,r,c){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(zt&2)!==0){var p=h.pending;return p===null?r.next=r:(r.next=p.next,p.next=r),h.pending=r,r=zl(i),Lp(i,null,c),r}return Fl(i,h,r,c),zl(i)}function to(i,r,c){if(r=r.updateQueue,r!==null&&(r=r.shared,(c&4194048)!==0)){var h=r.lanes;h&=i.pendingLanes,c|=h,r.lanes=c,Yn(i,c)}}function Eh(i,r){var c=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var p=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var T={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};y===null?p=y=T:y=y.next=T,c=c.next}while(c!==null);y===null?p=y=r:y=y.next=r}else p=y=r;c={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:h.shared,callbacks:h.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=r:i.next=r,c.lastBaseUpdate=r}var Th=!1;function eo(){if(Th){var i=Lr;if(i!==null)throw i}}function no(i,r,c,h){Th=!1;var p=i.updateQueue;Qi=!1;var y=p.firstBaseUpdate,T=p.lastBaseUpdate,M=p.shared.pending;if(M!==null){p.shared.pending=null;var N=M,G=N.next;N.next=null,T===null?y=G:T.next=G,T=N;var K=i.alternate;K!==null&&(K=K.updateQueue,M=K.lastBaseUpdate,M!==T&&(M===null?K.firstBaseUpdate=G:M.next=G,K.lastBaseUpdate=N))}if(y!==null){var J=p.baseState;T=0,K=G=N=null,M=y;do{var X=M.lane&-536870913,W=X!==M.lane;if(W?(Bt&X)===X:(h&X)===X){X!==0&&X===Nr&&(Th=!0),K!==null&&(K=K.next={lane:0,tag:M.tag,payload:M.payload,callback:null,next:null});t:{var _t=i,yt=M;X=r;var Vt=c;switch(yt.tag){case 1:if(_t=yt.payload,typeof _t=="function"){J=_t.call(Vt,J,X);break t}J=_t;break t;case 3:_t.flags=_t.flags&-65537|128;case 0:if(_t=yt.payload,X=typeof _t=="function"?_t.call(Vt,J,X):_t,X==null)break t;J=g({},J,X);break t;case 2:Qi=!0}}X=M.callback,X!==null&&(i.flags|=64,W&&(i.flags|=8192),W=p.callbacks,W===null?p.callbacks=[X]:W.push(X))}else W={lane:X,tag:M.tag,payload:M.payload,callback:M.callback,next:null},K===null?(G=K=W,N=J):K=K.next=W,T|=X;if(M=M.next,M===null){if(M=p.shared.pending,M===null)break;W=M,M=W.next,W.next=null,p.lastBaseUpdate=W,p.shared.pending=null}}while(!0);K===null&&(N=J),p.baseState=N,p.firstBaseUpdate=G,p.lastBaseUpdate=K,y===null&&(p.shared.lanes=0),os|=T,i.lanes=T,i.memoizedState=J}}function Kp(i,r){if(typeof i!="function")throw Error(n(191,i));i.call(r)}function Qp(i,r){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)Kp(c[i],r)}var Br=z(null),Kl=z(0);function Zp(i,r){i=Ii,U(Kl,i),U(Br,r),Ii=i|r.baseLanes}function xh(){U(Kl,Ii),U(Br,Br.current)}function Ch(){Ii=Kl.current,Y(Br),Y(Kl)}var ts=0,Rt=null,qt=null,Te=null,Ql=!1,jr=!1,Gs=!1,Zl=0,io=0,Ir=null,FS=0;function ve(){throw Error(n(321))}function Rh(i,r){if(r===null)return!1;for(var c=0;c<r.length&&c<i.length;c++)if(!vn(i[c],r[c]))return!1;return!0}function Dh(i,r,c,h,p,y){return ts=y,Rt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,B.H=i===null||i.memoizedState===null?Lm:Bm,Gs=!1,y=c(h,p),Gs=!1,jr&&(y=tm(r,c,h,p)),Jp(i),y}function Jp(i){B.H=sc;var r=qt!==null&&qt.next!==null;if(ts=0,Te=qt=Rt=null,Ql=!1,io=0,Ir=null,r)throw Error(n(300));i===null||Pe||(i=i.dependencies,i!==null&&Gl(i)&&(Pe=!0))}function tm(i,r,c,h){Rt=i;var p=0;do{if(jr&&(Ir=null),io=0,jr=!1,25<=p)throw Error(n(301));if(p+=1,Te=qt=null,i.updateQueue!=null){var y=i.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}B.H=XS,y=r(c,h)}while(jr);return y}function zS(){var i=B.H,r=i.useState()[0];return r=typeof r.then=="function"?so(r):r,i=i.useState()[0],(qt!==null?qt.memoizedState:null)!==i&&(Rt.flags|=1024),r}function Oh(){var i=Zl!==0;return Zl=0,i}function Mh(i,r,c){r.updateQueue=i.updateQueue,r.flags&=-2053,i.lanes&=~c}function kh(i){if(Ql){for(i=i.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Ql=!1}ts=0,Te=qt=Rt=null,jr=!1,io=Zl=0,Ir=null}function cn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Te===null?Rt.memoizedState=Te=i:Te=Te.next=i,Te}function xe(){if(qt===null){var i=Rt.alternate;i=i!==null?i.memoizedState:null}else i=qt.next;var r=Te===null?Rt.memoizedState:Te.next;if(r!==null)Te=r,qt=i;else{if(i===null)throw Rt.alternate===null?Error(n(467)):Error(n(310));qt=i,i={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},Te===null?Rt.memoizedState=Te=i:Te=Te.next=i}return Te}function Ph(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function so(i){var r=io;return io+=1,Ir===null&&(Ir=[]),i=Xp(Ir,i,r),r=Rt,(Te===null?r.memoizedState:Te.next)===null&&(r=r.alternate,B.H=r===null||r.memoizedState===null?Lm:Bm),i}function Jl(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return so(i);if(i.$$typeof===x)return We(i)}throw Error(n(438,String(i)))}function Nh(i){var r=null,c=Rt.updateQueue;if(c!==null&&(r=c.memoCache),r==null){var h=Rt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(r={data:h.data.map(function(p){return p.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),c===null&&(c=Ph(),Rt.updateQueue=c),c.memoCache=r,c=r.data[r.index],c===void 0)for(c=r.data[r.index]=Array(i),h=0;h<i;h++)c[h]=V;return r.index++,c}function ki(i,r){return typeof r=="function"?r(i):r}function tc(i){var r=xe();return Lh(r,qt,i)}function Lh(i,r,c){var h=i.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=c;var p=i.baseQueue,y=h.pending;if(y!==null){if(p!==null){var T=p.next;p.next=y.next,y.next=T}r.baseQueue=p=y,h.pending=null}if(y=i.baseState,p===null)i.memoizedState=y;else{r=p.next;var M=T=null,N=null,G=r,K=!1;do{var J=G.lane&-536870913;if(J!==G.lane?(Bt&J)===J:(ts&J)===J){var X=G.revertLane;if(X===0)N!==null&&(N=N.next={lane:0,revertLane:0,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null}),J===Nr&&(K=!0);else if((ts&X)===X){G=G.next,X===Nr&&(K=!0);continue}else J={lane:0,revertLane:G.revertLane,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null},N===null?(M=N=J,T=y):N=N.next=J,Rt.lanes|=X,os|=X;J=G.action,Gs&&c(y,J),y=G.hasEagerState?G.eagerState:c(y,J)}else X={lane:J,revertLane:G.revertLane,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null},N===null?(M=N=X,T=y):N=N.next=X,Rt.lanes|=J,os|=J;G=G.next}while(G!==null&&G!==r);if(N===null?T=y:N.next=M,!vn(y,i.memoizedState)&&(Pe=!0,K&&(c=Lr,c!==null)))throw c;i.memoizedState=y,i.baseState=T,i.baseQueue=N,h.lastRenderedState=y}return p===null&&(h.lanes=0),[i.memoizedState,h.dispatch]}function Bh(i){var r=xe(),c=r.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=i;var h=c.dispatch,p=c.pending,y=r.memoizedState;if(p!==null){c.pending=null;var T=p=p.next;do y=i(y,T.action),T=T.next;while(T!==p);vn(y,r.memoizedState)||(Pe=!0),r.memoizedState=y,r.baseQueue===null&&(r.baseState=y),c.lastRenderedState=y}return[y,h]}function em(i,r,c){var h=Rt,p=xe(),y=Ut;if(y){if(c===void 0)throw Error(n(407));c=c()}else c=r();var T=!vn((qt||p).memoizedState,c);T&&(p.memoizedState=c,Pe=!0),p=p.queue;var M=sm.bind(null,h,p,i);if(ro(2048,8,M,[i]),p.getSnapshot!==r||T||Te!==null&&Te.memoizedState.tag&1){if(h.flags|=2048,Ur(9,ec(),im.bind(null,h,p,c,r),null),ee===null)throw Error(n(349));y||(ts&124)!==0||nm(h,r,c)}return c}function nm(i,r,c){i.flags|=16384,i={getSnapshot:r,value:c},r=Rt.updateQueue,r===null?(r=Ph(),Rt.updateQueue=r,r.stores=[i]):(c=r.stores,c===null?r.stores=[i]:c.push(i))}function im(i,r,c,h){r.value=c,r.getSnapshot=h,rm(r)&&am(i)}function sm(i,r,c){return c(function(){rm(r)&&am(i)})}function rm(i){var r=i.getSnapshot;i=i.value;try{var c=r();return!vn(i,c)}catch{return!0}}function am(i){var r=Or(i,2);r!==null&&En(r,i,2)}function jh(i){var r=cn();if(typeof i=="function"){var c=i;if(i=c(),Gs){ge(!0);try{c()}finally{ge(!1)}}}return r.memoizedState=r.baseState=i,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ki,lastRenderedState:i},r}function om(i,r,c,h){return i.baseState=c,Lh(i,qt,typeof h=="function"?h:ki)}function HS(i,r,c,h,p){if(ic(i))throw Error(n(485));if(i=r.action,i!==null){var y={payload:p,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){y.listeners.push(T)}};B.T!==null?c(!0):y.isTransition=!1,h(y),c=r.pending,c===null?(y.next=r.pending=y,lm(r,y)):(y.next=c.next,r.pending=c.next=y)}}function lm(i,r){var c=r.action,h=r.payload,p=i.state;if(r.isTransition){var y=B.T,T={};B.T=T;try{var M=c(p,h),N=B.S;N!==null&&N(T,M),cm(i,r,M)}catch(G){Ih(i,r,G)}finally{B.T=y}}else try{y=c(p,h),cm(i,r,y)}catch(G){Ih(i,r,G)}}function cm(i,r,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){um(i,r,h)},function(h){return Ih(i,r,h)}):um(i,r,c)}function um(i,r,c){r.status="fulfilled",r.value=c,hm(r),i.state=c,r=i.pending,r!==null&&(c=r.next,c===r?i.pending=null:(c=c.next,r.next=c,lm(i,c)))}function Ih(i,r,c){var h=i.pending;if(i.pending=null,h!==null){h=h.next;do r.status="rejected",r.reason=c,hm(r),r=r.next;while(r!==h)}i.action=null}function hm(i){i=i.listeners;for(var r=0;r<i.length;r++)(0,i[r])()}function dm(i,r){return r}function fm(i,r){if(Ut){var c=ee.formState;if(c!==null){t:{var h=Rt;if(Ut){if(me){e:{for(var p=me,y=li;p.nodeType!==8;){if(!y){p=null;break e}if(p=Qn(p.nextSibling),p===null){p=null;break e}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){me=Qn(p.nextSibling),h=p.data==="F!";break t}}zs(h)}h=!1}h&&(r=c[0])}}return c=cn(),c.memoizedState=c.baseState=r,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dm,lastRenderedState:r},c.queue=h,c=km.bind(null,Rt,h),h.dispatch=c,h=jh(!1),y=$h.bind(null,Rt,!1,h.queue),h=cn(),p={state:r,dispatch:null,action:i,pending:null},h.queue=p,c=HS.bind(null,Rt,p,y,c),p.dispatch=c,h.memoizedState=i,[r,c,!1]}function gm(i){var r=xe();return pm(r,qt,i)}function pm(i,r,c){if(r=Lh(i,r,dm)[0],i=tc(ki)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var h=so(r)}catch(T){throw T===Za?Yl:T}else h=r;r=xe();var p=r.queue,y=p.dispatch;return c!==r.memoizedState&&(Rt.flags|=2048,Ur(9,ec(),$S.bind(null,p,c),null)),[h,y,i]}function $S(i,r){i.action=r}function mm(i){var r=xe(),c=qt;if(c!==null)return pm(r,c,i);xe(),r=r.memoizedState,c=xe();var h=c.queue.dispatch;return c.memoizedState=i,[r,h,!1]}function Ur(i,r,c,h){return i={tag:i,create:c,deps:h,inst:r,next:null},r=Rt.updateQueue,r===null&&(r=Ph(),Rt.updateQueue=r),c=r.lastEffect,c===null?r.lastEffect=i.next=i:(h=c.next,c.next=i,i.next=h,r.lastEffect=i),i}function ec(){return{destroy:void 0,resource:void 0}}function ym(){return xe().memoizedState}function nc(i,r,c,h){var p=cn();h=h===void 0?null:h,Rt.flags|=i,p.memoizedState=Ur(1|r,ec(),c,h)}function ro(i,r,c,h){var p=xe();h=h===void 0?null:h;var y=p.memoizedState.inst;qt!==null&&h!==null&&Rh(h,qt.memoizedState.deps)?p.memoizedState=Ur(r,y,c,h):(Rt.flags|=i,p.memoizedState=Ur(1|r,y,c,h))}function vm(i,r){nc(8390656,8,i,r)}function bm(i,r){ro(2048,8,i,r)}function wm(i,r){return ro(4,2,i,r)}function _m(i,r){return ro(4,4,i,r)}function Sm(i,r){if(typeof r=="function"){i=i();var c=r(i);return function(){typeof c=="function"?c():r(null)}}if(r!=null)return i=i(),r.current=i,function(){r.current=null}}function Am(i,r,c){c=c!=null?c.concat([i]):null,ro(4,4,Sm.bind(null,r,i),c)}function Uh(){}function Em(i,r){var c=xe();r=r===void 0?null:r;var h=c.memoizedState;return r!==null&&Rh(r,h[1])?h[0]:(c.memoizedState=[i,r],i)}function Tm(i,r){var c=xe();r=r===void 0?null:r;var h=c.memoizedState;if(r!==null&&Rh(r,h[1]))return h[0];if(h=i(),Gs){ge(!0);try{i()}finally{ge(!1)}}return c.memoizedState=[h,r],h}function Fh(i,r,c){return c===void 0||(ts&1073741824)!==0?i.memoizedState=r:(i.memoizedState=c,i=Ry(),Rt.lanes|=i,os|=i,c)}function xm(i,r,c,h){return vn(c,r)?c:Br.current!==null?(i=Fh(i,c,h),vn(i,r)||(Pe=!0),i):(ts&42)===0?(Pe=!0,i.memoizedState=c):(i=Ry(),Rt.lanes|=i,os|=i,r)}function Cm(i,r,c,h,p){var y=H.p;H.p=y!==0&&8>y?y:8;var T=B.T,M={};B.T=M,$h(i,!1,r,c);try{var N=p(),G=B.S;if(G!==null&&G(M,N),N!==null&&typeof N=="object"&&typeof N.then=="function"){var K=US(N,h);ao(i,r,K,An(i))}else ao(i,r,h,An(i))}catch(J){ao(i,r,{then:function(){},status:"rejected",reason:J},An())}finally{H.p=y,B.T=T}}function qS(){}function zh(i,r,c,h){if(i.tag!==5)throw Error(n(476));var p=Rm(i).queue;Cm(i,p,r,tt,c===null?qS:function(){return Dm(i),c(h)})}function Rm(i){var r=i.memoizedState;if(r!==null)return r;r={memoizedState:tt,baseState:tt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ki,lastRenderedState:tt},next:null};var c={};return r.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ki,lastRenderedState:c},next:null},i.memoizedState=r,i=i.alternate,i!==null&&(i.memoizedState=r),r}function Dm(i){var r=Rm(i).next.queue;ao(i,r,{},An())}function Hh(){return We(To)}function Om(){return xe().memoizedState}function Mm(){return xe().memoizedState}function GS(i){for(var r=i.return;r!==null;){switch(r.tag){case 24:case 3:var c=An();i=Zi(c);var h=Ji(r,i,c);h!==null&&(En(h,r,c),to(h,r,c)),r={cache:vh()},i.payload=r;return}r=r.return}}function VS(i,r,c){var h=An();c={lane:h,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},ic(i)?Pm(r,c):(c=lh(i,r,c,h),c!==null&&(En(c,i,h),Nm(c,r,h)))}function km(i,r,c){var h=An();ao(i,r,c,h)}function ao(i,r,c,h){var p={lane:h,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(ic(i))Pm(r,p);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=r.lastRenderedReducer,y!==null))try{var T=r.lastRenderedState,M=y(T,c);if(p.hasEagerState=!0,p.eagerState=M,vn(M,T))return Fl(i,r,p,0),ee===null&&Ul(),!1}catch{}finally{}if(c=lh(i,r,p,h),c!==null)return En(c,i,h),Nm(c,r,h),!0}return!1}function $h(i,r,c,h){if(h={lane:2,revertLane:_d(),action:h,hasEagerState:!1,eagerState:null,next:null},ic(i)){if(r)throw Error(n(479))}else r=lh(i,c,h,2),r!==null&&En(r,i,2)}function ic(i){var r=i.alternate;return i===Rt||r!==null&&r===Rt}function Pm(i,r){jr=Ql=!0;var c=i.pending;c===null?r.next=r:(r.next=c.next,c.next=r),i.pending=r}function Nm(i,r,c){if((c&4194048)!==0){var h=r.lanes;h&=i.pendingLanes,c|=h,r.lanes=c,Yn(i,c)}}var sc={readContext:We,use:Jl,useCallback:ve,useContext:ve,useEffect:ve,useImperativeHandle:ve,useLayoutEffect:ve,useInsertionEffect:ve,useMemo:ve,useReducer:ve,useRef:ve,useState:ve,useDebugValue:ve,useDeferredValue:ve,useTransition:ve,useSyncExternalStore:ve,useId:ve,useHostTransitionStatus:ve,useFormState:ve,useActionState:ve,useOptimistic:ve,useMemoCache:ve,useCacheRefresh:ve},Lm={readContext:We,use:Jl,useCallback:function(i,r){return cn().memoizedState=[i,r===void 0?null:r],i},useContext:We,useEffect:vm,useImperativeHandle:function(i,r,c){c=c!=null?c.concat([i]):null,nc(4194308,4,Sm.bind(null,r,i),c)},useLayoutEffect:function(i,r){return nc(4194308,4,i,r)},useInsertionEffect:function(i,r){nc(4,2,i,r)},useMemo:function(i,r){var c=cn();r=r===void 0?null:r;var h=i();if(Gs){ge(!0);try{i()}finally{ge(!1)}}return c.memoizedState=[h,r],h},useReducer:function(i,r,c){var h=cn();if(c!==void 0){var p=c(r);if(Gs){ge(!0);try{c(r)}finally{ge(!1)}}}else p=r;return h.memoizedState=h.baseState=p,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:p},h.queue=i,i=i.dispatch=VS.bind(null,Rt,i),[h.memoizedState,i]},useRef:function(i){var r=cn();return i={current:i},r.memoizedState=i},useState:function(i){i=jh(i);var r=i.queue,c=km.bind(null,Rt,r);return r.dispatch=c,[i.memoizedState,c]},useDebugValue:Uh,useDeferredValue:function(i,r){var c=cn();return Fh(c,i,r)},useTransition:function(){var i=jh(!1);return i=Cm.bind(null,Rt,i.queue,!0,!1),cn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,r,c){var h=Rt,p=cn();if(Ut){if(c===void 0)throw Error(n(407));c=c()}else{if(c=r(),ee===null)throw Error(n(349));(Bt&124)!==0||nm(h,r,c)}p.memoizedState=c;var y={value:c,getSnapshot:r};return p.queue=y,vm(sm.bind(null,h,y,i),[i]),h.flags|=2048,Ur(9,ec(),im.bind(null,h,y,c,r),null),c},useId:function(){var i=cn(),r=ee.identifierPrefix;if(Ut){var c=Di,h=Ri;c=(h&~(1<<32-$t(h)-1)).toString(32)+c,r=""+r+"R"+c,c=Zl++,0<c&&(r+="H"+c.toString(32)),r+=""}else c=FS++,r=""+r+"r"+c.toString(32)+"";return i.memoizedState=r},useHostTransitionStatus:Hh,useFormState:fm,useActionState:fm,useOptimistic:function(i){var r=cn();r.memoizedState=r.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=c,r=$h.bind(null,Rt,!0,c),c.dispatch=r,[i,r]},useMemoCache:Nh,useCacheRefresh:function(){return cn().memoizedState=GS.bind(null,Rt)}},Bm={readContext:We,use:Jl,useCallback:Em,useContext:We,useEffect:bm,useImperativeHandle:Am,useInsertionEffect:wm,useLayoutEffect:_m,useMemo:Tm,useReducer:tc,useRef:ym,useState:function(){return tc(ki)},useDebugValue:Uh,useDeferredValue:function(i,r){var c=xe();return xm(c,qt.memoizedState,i,r)},useTransition:function(){var i=tc(ki)[0],r=xe().memoizedState;return[typeof i=="boolean"?i:so(i),r]},useSyncExternalStore:em,useId:Om,useHostTransitionStatus:Hh,useFormState:gm,useActionState:gm,useOptimistic:function(i,r){var c=xe();return om(c,qt,i,r)},useMemoCache:Nh,useCacheRefresh:Mm},XS={readContext:We,use:Jl,useCallback:Em,useContext:We,useEffect:bm,useImperativeHandle:Am,useInsertionEffect:wm,useLayoutEffect:_m,useMemo:Tm,useReducer:Bh,useRef:ym,useState:function(){return Bh(ki)},useDebugValue:Uh,useDeferredValue:function(i,r){var c=xe();return qt===null?Fh(c,i,r):xm(c,qt.memoizedState,i,r)},useTransition:function(){var i=Bh(ki)[0],r=xe().memoizedState;return[typeof i=="boolean"?i:so(i),r]},useSyncExternalStore:em,useId:Om,useHostTransitionStatus:Hh,useFormState:mm,useActionState:mm,useOptimistic:function(i,r){var c=xe();return qt!==null?om(c,qt,i,r):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:Nh,useCacheRefresh:Mm},Fr=null,oo=0;function rc(i){var r=oo;return oo+=1,Fr===null&&(Fr=[]),Xp(Fr,i,r)}function lo(i,r){r=r.props.ref,i.ref=r!==void 0?r:null}function ac(i,r){throw r.$$typeof===m?Error(n(525)):(i=Object.prototype.toString.call(r),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":i)))}function jm(i){var r=i._init;return r(i._payload)}function Im(i){function r(F,I){if(i){var $=F.deletions;$===null?(F.deletions=[I],F.flags|=16):$.push(I)}}function c(F,I){if(!i)return null;for(;I!==null;)r(F,I),I=I.sibling;return null}function h(F){for(var I=new Map;F!==null;)F.key!==null?I.set(F.key,F):I.set(F.index,F),F=F.sibling;return I}function p(F,I){return F=Ci(F,I),F.index=0,F.sibling=null,F}function y(F,I,$){return F.index=$,i?($=F.alternate,$!==null?($=$.index,$<I?(F.flags|=67108866,I):$):(F.flags|=67108866,I)):(F.flags|=1048576,I)}function T(F){return i&&F.alternate===null&&(F.flags|=67108866),F}function M(F,I,$,Z){return I===null||I.tag!==6?(I=uh($,F.mode,Z),I.return=F,I):(I=p(I,$),I.return=F,I)}function N(F,I,$,Z){var ht=$.type;return ht===S?K(F,I,$.props.children,Z,$.key):I!==null&&(I.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===k&&jm(ht)===I.type)?(I=p(I,$.props),lo(I,$),I.return=F,I):(I=Hl($.type,$.key,$.props,null,F.mode,Z),lo(I,$),I.return=F,I)}function G(F,I,$,Z){return I===null||I.tag!==4||I.stateNode.containerInfo!==$.containerInfo||I.stateNode.implementation!==$.implementation?(I=hh($,F.mode,Z),I.return=F,I):(I=p(I,$.children||[]),I.return=F,I)}function K(F,I,$,Z,ht){return I===null||I.tag!==7?(I=js($,F.mode,Z,ht),I.return=F,I):(I=p(I,$),I.return=F,I)}function J(F,I,$){if(typeof I=="string"&&I!==""||typeof I=="number"||typeof I=="bigint")return I=uh(""+I,F.mode,$),I.return=F,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case v:return $=Hl(I.type,I.key,I.props,null,F.mode,$),lo($,I),$.return=F,$;case b:return I=hh(I,F.mode,$),I.return=F,I;case k:var Z=I._init;return I=Z(I._payload),J(F,I,$)}if(ot(I)||it(I))return I=js(I,F.mode,$,null),I.return=F,I;if(typeof I.then=="function")return J(F,rc(I),$);if(I.$$typeof===x)return J(F,Vl(F,I),$);ac(F,I)}return null}function X(F,I,$,Z){var ht=I!==null?I.key:null;if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return ht!==null?null:M(F,I,""+$,Z);if(typeof $=="object"&&$!==null){switch($.$$typeof){case v:return $.key===ht?N(F,I,$,Z):null;case b:return $.key===ht?G(F,I,$,Z):null;case k:return ht=$._init,$=ht($._payload),X(F,I,$,Z)}if(ot($)||it($))return ht!==null?null:K(F,I,$,Z,null);if(typeof $.then=="function")return X(F,I,rc($),Z);if($.$$typeof===x)return X(F,I,Vl(F,$),Z);ac(F,$)}return null}function W(F,I,$,Z,ht){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return F=F.get($)||null,M(I,F,""+Z,ht);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case v:return F=F.get(Z.key===null?$:Z.key)||null,N(I,F,Z,ht);case b:return F=F.get(Z.key===null?$:Z.key)||null,G(I,F,Z,ht);case k:var Ot=Z._init;return Z=Ot(Z._payload),W(F,I,$,Z,ht)}if(ot(Z)||it(Z))return F=F.get($)||null,K(I,F,Z,ht,null);if(typeof Z.then=="function")return W(F,I,$,rc(Z),ht);if(Z.$$typeof===x)return W(F,I,$,Vl(I,Z),ht);ac(I,Z)}return null}function _t(F,I,$,Z){for(var ht=null,Ot=null,gt=I,bt=I=0,Le=null;gt!==null&&bt<$.length;bt++){gt.index>bt?(Le=gt,gt=null):Le=gt.sibling;var jt=X(F,gt,$[bt],Z);if(jt===null){gt===null&&(gt=Le);break}i&&gt&&jt.alternate===null&&r(F,gt),I=y(jt,I,bt),Ot===null?ht=jt:Ot.sibling=jt,Ot=jt,gt=Le}if(bt===$.length)return c(F,gt),Ut&&Us(F,bt),ht;if(gt===null){for(;bt<$.length;bt++)gt=J(F,$[bt],Z),gt!==null&&(I=y(gt,I,bt),Ot===null?ht=gt:Ot.sibling=gt,Ot=gt);return Ut&&Us(F,bt),ht}for(gt=h(gt);bt<$.length;bt++)Le=W(gt,F,bt,$[bt],Z),Le!==null&&(i&&Le.alternate!==null&&gt.delete(Le.key===null?bt:Le.key),I=y(Le,I,bt),Ot===null?ht=Le:Ot.sibling=Le,Ot=Le);return i&&gt.forEach(function(ms){return r(F,ms)}),Ut&&Us(F,bt),ht}function yt(F,I,$,Z){if($==null)throw Error(n(151));for(var ht=null,Ot=null,gt=I,bt=I=0,Le=null,jt=$.next();gt!==null&&!jt.done;bt++,jt=$.next()){gt.index>bt?(Le=gt,gt=null):Le=gt.sibling;var ms=X(F,gt,jt.value,Z);if(ms===null){gt===null&&(gt=Le);break}i&&gt&&ms.alternate===null&&r(F,gt),I=y(ms,I,bt),Ot===null?ht=ms:Ot.sibling=ms,Ot=ms,gt=Le}if(jt.done)return c(F,gt),Ut&&Us(F,bt),ht;if(gt===null){for(;!jt.done;bt++,jt=$.next())jt=J(F,jt.value,Z),jt!==null&&(I=y(jt,I,bt),Ot===null?ht=jt:Ot.sibling=jt,Ot=jt);return Ut&&Us(F,bt),ht}for(gt=h(gt);!jt.done;bt++,jt=$.next())jt=W(gt,F,bt,jt.value,Z),jt!==null&&(i&&jt.alternate!==null&&gt.delete(jt.key===null?bt:jt.key),I=y(jt,I,bt),Ot===null?ht=jt:Ot.sibling=jt,Ot=jt);return i&&gt.forEach(function(YA){return r(F,YA)}),Ut&&Us(F,bt),ht}function Vt(F,I,$,Z){if(typeof $=="object"&&$!==null&&$.type===S&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case v:t:{for(var ht=$.key;I!==null;){if(I.key===ht){if(ht=$.type,ht===S){if(I.tag===7){c(F,I.sibling),Z=p(I,$.props.children),Z.return=F,F=Z;break t}}else if(I.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===k&&jm(ht)===I.type){c(F,I.sibling),Z=p(I,$.props),lo(Z,$),Z.return=F,F=Z;break t}c(F,I);break}else r(F,I);I=I.sibling}$.type===S?(Z=js($.props.children,F.mode,Z,$.key),Z.return=F,F=Z):(Z=Hl($.type,$.key,$.props,null,F.mode,Z),lo(Z,$),Z.return=F,F=Z)}return T(F);case b:t:{for(ht=$.key;I!==null;){if(I.key===ht)if(I.tag===4&&I.stateNode.containerInfo===$.containerInfo&&I.stateNode.implementation===$.implementation){c(F,I.sibling),Z=p(I,$.children||[]),Z.return=F,F=Z;break t}else{c(F,I);break}else r(F,I);I=I.sibling}Z=hh($,F.mode,Z),Z.return=F,F=Z}return T(F);case k:return ht=$._init,$=ht($._payload),Vt(F,I,$,Z)}if(ot($))return _t(F,I,$,Z);if(it($)){if(ht=it($),typeof ht!="function")throw Error(n(150));return $=ht.call($),yt(F,I,$,Z)}if(typeof $.then=="function")return Vt(F,I,rc($),Z);if($.$$typeof===x)return Vt(F,I,Vl(F,$),Z);ac(F,$)}return typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint"?($=""+$,I!==null&&I.tag===6?(c(F,I.sibling),Z=p(I,$),Z.return=F,F=Z):(c(F,I),Z=uh($,F.mode,Z),Z.return=F,F=Z),T(F)):c(F,I)}return function(F,I,$,Z){try{oo=0;var ht=Vt(F,I,$,Z);return Fr=null,ht}catch(gt){if(gt===Za||gt===Yl)throw gt;var Ot=bn(29,gt,null,F.mode);return Ot.lanes=Z,Ot.return=F,Ot}finally{}}}var zr=Im(!0),Um=Im(!1),In=z(null),ci=null;function es(i){var r=i.alternate;U(Oe,Oe.current&1),U(In,i),ci===null&&(r===null||Br.current!==null||r.memoizedState!==null)&&(ci=i)}function Fm(i){if(i.tag===22){if(U(Oe,Oe.current),U(In,i),ci===null){var r=i.alternate;r!==null&&r.memoizedState!==null&&(ci=i)}}else ns()}function ns(){U(Oe,Oe.current),U(In,In.current)}function Pi(i){Y(In),ci===i&&(ci=null),Y(Oe)}var Oe=z(0);function oc(i){for(var r=i;r!==null;){if(r.tag===13){var c=r.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||Pd(c)))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break;for(;r.sibling===null;){if(r.return===null||r.return===i)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}function qh(i,r,c,h){r=i.memoizedState,c=c(h,r),c=c==null?r:g({},r,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var Gh={enqueueSetState:function(i,r,c){i=i._reactInternals;var h=An(),p=Zi(h);p.payload=r,c!=null&&(p.callback=c),r=Ji(i,p,h),r!==null&&(En(r,i,h),to(r,i,h))},enqueueReplaceState:function(i,r,c){i=i._reactInternals;var h=An(),p=Zi(h);p.tag=1,p.payload=r,c!=null&&(p.callback=c),r=Ji(i,p,h),r!==null&&(En(r,i,h),to(r,i,h))},enqueueForceUpdate:function(i,r){i=i._reactInternals;var c=An(),h=Zi(c);h.tag=2,r!=null&&(h.callback=r),r=Ji(i,h,c),r!==null&&(En(r,i,c),to(r,i,c))}};function zm(i,r,c,h,p,y,T){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,y,T):r.prototype&&r.prototype.isPureReactComponent?!qa(c,h)||!qa(p,y):!0}function Hm(i,r,c,h){i=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(c,h),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(c,h),r.state!==i&&Gh.enqueueReplaceState(r,r.state,null)}function Vs(i,r){var c=r;if("ref"in r){c={};for(var h in r)h!=="ref"&&(c[h]=r[h])}if(i=i.defaultProps){c===r&&(c=g({},c));for(var p in i)c[p]===void 0&&(c[p]=i[p])}return c}var lc=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function $m(i){lc(i)}function qm(i){console.error(i)}function Gm(i){lc(i)}function cc(i,r){try{var c=i.onUncaughtError;c(r.value,{componentStack:r.stack})}catch(h){setTimeout(function(){throw h})}}function Vm(i,r,c){try{var h=i.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Vh(i,r,c){return c=Zi(c),c.tag=3,c.payload={element:null},c.callback=function(){cc(i,r)},c}function Xm(i){return i=Zi(i),i.tag=3,i}function Ym(i,r,c,h){var p=c.type.getDerivedStateFromError;if(typeof p=="function"){var y=h.value;i.payload=function(){return p(y)},i.callback=function(){Vm(r,c,h)}}var T=c.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(i.callback=function(){Vm(r,c,h),typeof p!="function"&&(ls===null?ls=new Set([this]):ls.add(this));var M=h.stack;this.componentDidCatch(h.value,{componentStack:M!==null?M:""})})}function YS(i,r,c,h,p){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(r=c.alternate,r!==null&&Wa(r,c,p,!0),c=In.current,c!==null){switch(c.tag){case 13:return ci===null?md():c.alternate===null&&ye===0&&(ye=3),c.flags&=-257,c.flags|=65536,c.lanes=p,h===_h?c.flags|=16384:(r=c.updateQueue,r===null?c.updateQueue=new Set([h]):r.add(h),vd(i,h,p)),!1;case 22:return c.flags|=65536,h===_h?c.flags|=16384:(r=c.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=r):(c=r.retryQueue,c===null?r.retryQueue=new Set([h]):c.add(h)),vd(i,h,p)),!1}throw Error(n(435,c.tag))}return vd(i,h,p),md(),!1}if(Ut)return r=In.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=p,h!==gh&&(i=Error(n(422),{cause:h}),Ya(Nn(i,c)))):(h!==gh&&(r=Error(n(423),{cause:h}),Ya(Nn(r,c))),i=i.current.alternate,i.flags|=65536,p&=-p,i.lanes|=p,h=Nn(h,c),p=Vh(i.stateNode,h,p),Eh(i,p),ye!==4&&(ye=2)),!1;var y=Error(n(520),{cause:h});if(y=Nn(y,c),mo===null?mo=[y]:mo.push(y),ye!==4&&(ye=2),r===null)return!0;h=Nn(h,c),c=r;do{switch(c.tag){case 3:return c.flags|=65536,i=p&-p,c.lanes|=i,i=Vh(c.stateNode,h,i),Eh(c,i),!1;case 1:if(r=c.type,y=c.stateNode,(c.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ls===null||!ls.has(y))))return c.flags|=65536,p&=-p,c.lanes|=p,p=Xm(p),Ym(p,i,c,h),Eh(c,p),!1}c=c.return}while(c!==null);return!1}var Wm=Error(n(461)),Pe=!1;function ze(i,r,c,h){r.child=i===null?Um(r,null,c,h):zr(r,i.child,c,h)}function Km(i,r,c,h,p){c=c.render;var y=r.ref;if("ref"in h){var T={};for(var M in h)M!=="ref"&&(T[M]=h[M])}else T=h;return $s(r),h=Dh(i,r,c,T,y,p),M=Oh(),i!==null&&!Pe?(Mh(i,r,p),Ni(i,r,p)):(Ut&&M&&dh(r),r.flags|=1,ze(i,r,h,p),r.child)}function Qm(i,r,c,h,p){if(i===null){var y=c.type;return typeof y=="function"&&!ch(y)&&y.defaultProps===void 0&&c.compare===null?(r.tag=15,r.type=y,Zm(i,r,y,h,p)):(i=Hl(c.type,null,h,r,r.mode,p),i.ref=r.ref,i.return=r,r.child=i)}if(y=i.child,!td(i,p)){var T=y.memoizedProps;if(c=c.compare,c=c!==null?c:qa,c(T,h)&&i.ref===r.ref)return Ni(i,r,p)}return r.flags|=1,i=Ci(y,h),i.ref=r.ref,i.return=r,r.child=i}function Zm(i,r,c,h,p){if(i!==null){var y=i.memoizedProps;if(qa(y,h)&&i.ref===r.ref)if(Pe=!1,r.pendingProps=h=y,td(i,p))(i.flags&131072)!==0&&(Pe=!0);else return r.lanes=i.lanes,Ni(i,r,p)}return Xh(i,r,c,h,p)}function Jm(i,r,c){var h=r.pendingProps,p=h.children,y=i!==null?i.memoizedState:null;if(h.mode==="hidden"){if((r.flags&128)!==0){if(h=y!==null?y.baseLanes|c:c,i!==null){for(p=r.child=i.child,y=0;p!==null;)y=y|p.lanes|p.childLanes,p=p.sibling;r.childLanes=y&~h}else r.childLanes=0,r.child=null;return ty(i,r,h,c)}if((c&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},i!==null&&Xl(r,y!==null?y.cachePool:null),y!==null?Zp(r,y):xh(),Fm(r);else return r.lanes=r.childLanes=536870912,ty(i,r,y!==null?y.baseLanes|c:c,c)}else y!==null?(Xl(r,y.cachePool),Zp(r,y),ns(),r.memoizedState=null):(i!==null&&Xl(r,null),xh(),ns());return ze(i,r,p,c),r.child}function ty(i,r,c,h){var p=wh();return p=p===null?null:{parent:De._currentValue,pool:p},r.memoizedState={baseLanes:c,cachePool:p},i!==null&&Xl(r,null),xh(),Fm(r),i!==null&&Wa(i,r,h,!0),null}function uc(i,r){var c=r.ref;if(c===null)i!==null&&i.ref!==null&&(r.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(i===null||i.ref!==c)&&(r.flags|=4194816)}}function Xh(i,r,c,h,p){return $s(r),c=Dh(i,r,c,h,void 0,p),h=Oh(),i!==null&&!Pe?(Mh(i,r,p),Ni(i,r,p)):(Ut&&h&&dh(r),r.flags|=1,ze(i,r,c,p),r.child)}function ey(i,r,c,h,p,y){return $s(r),r.updateQueue=null,c=tm(r,h,c,p),Jp(i),h=Oh(),i!==null&&!Pe?(Mh(i,r,y),Ni(i,r,y)):(Ut&&h&&dh(r),r.flags|=1,ze(i,r,c,y),r.child)}function ny(i,r,c,h,p){if($s(r),r.stateNode===null){var y=Mr,T=c.contextType;typeof T=="object"&&T!==null&&(y=We(T)),y=new c(h,y),r.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Gh,r.stateNode=y,y._reactInternals=r,y=r.stateNode,y.props=h,y.state=r.memoizedState,y.refs={},Sh(r),T=c.contextType,y.context=typeof T=="object"&&T!==null?We(T):Mr,y.state=r.memoizedState,T=c.getDerivedStateFromProps,typeof T=="function"&&(qh(r,c,T,h),y.state=r.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(T=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),T!==y.state&&Gh.enqueueReplaceState(y,y.state,null),no(r,h,y,p),eo(),y.state=r.memoizedState),typeof y.componentDidMount=="function"&&(r.flags|=4194308),h=!0}else if(i===null){y=r.stateNode;var M=r.memoizedProps,N=Vs(c,M);y.props=N;var G=y.context,K=c.contextType;T=Mr,typeof K=="object"&&K!==null&&(T=We(K));var J=c.getDerivedStateFromProps;K=typeof J=="function"||typeof y.getSnapshotBeforeUpdate=="function",M=r.pendingProps!==M,K||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(M||G!==T)&&Hm(r,y,h,T),Qi=!1;var X=r.memoizedState;y.state=X,no(r,h,y,p),eo(),G=r.memoizedState,M||X!==G||Qi?(typeof J=="function"&&(qh(r,c,J,h),G=r.memoizedState),(N=Qi||zm(r,c,N,h,X,G,T))?(K||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(r.flags|=4194308)):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=h,r.memoizedState=G),y.props=h,y.state=G,y.context=T,h=N):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),h=!1)}else{y=r.stateNode,Ah(i,r),T=r.memoizedProps,K=Vs(c,T),y.props=K,J=r.pendingProps,X=y.context,G=c.contextType,N=Mr,typeof G=="object"&&G!==null&&(N=We(G)),M=c.getDerivedStateFromProps,(G=typeof M=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(T!==J||X!==N)&&Hm(r,y,h,N),Qi=!1,X=r.memoizedState,y.state=X,no(r,h,y,p),eo();var W=r.memoizedState;T!==J||X!==W||Qi||i!==null&&i.dependencies!==null&&Gl(i.dependencies)?(typeof M=="function"&&(qh(r,c,M,h),W=r.memoizedState),(K=Qi||zm(r,c,K,h,X,W,N)||i!==null&&i.dependencies!==null&&Gl(i.dependencies))?(G||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(h,W,N),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(h,W,N)),typeof y.componentDidUpdate=="function"&&(r.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof y.componentDidUpdate!="function"||T===i.memoizedProps&&X===i.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||T===i.memoizedProps&&X===i.memoizedState||(r.flags|=1024),r.memoizedProps=h,r.memoizedState=W),y.props=h,y.state=W,y.context=N,h=K):(typeof y.componentDidUpdate!="function"||T===i.memoizedProps&&X===i.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||T===i.memoizedProps&&X===i.memoizedState||(r.flags|=1024),h=!1)}return y=h,uc(i,r),h=(r.flags&128)!==0,y||h?(y=r.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:y.render(),r.flags|=1,i!==null&&h?(r.child=zr(r,i.child,null,p),r.child=zr(r,null,c,p)):ze(i,r,c,p),r.memoizedState=y.state,i=r.child):i=Ni(i,r,p),i}function iy(i,r,c,h){return Xa(),r.flags|=256,ze(i,r,c,h),r.child}var Yh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Wh(i){return{baseLanes:i,cachePool:qp()}}function Kh(i,r,c){return i=i!==null?i.childLanes&~c:0,r&&(i|=Un),i}function sy(i,r,c){var h=r.pendingProps,p=!1,y=(r.flags&128)!==0,T;if((T=y)||(T=i!==null&&i.memoizedState===null?!1:(Oe.current&2)!==0),T&&(p=!0,r.flags&=-129),T=(r.flags&32)!==0,r.flags&=-33,i===null){if(Ut){if(p?es(r):ns(),Ut){var M=me,N;if(N=M){t:{for(N=M,M=li;N.nodeType!==8;){if(!M){M=null;break t}if(N=Qn(N.nextSibling),N===null){M=null;break t}}M=N}M!==null?(r.memoizedState={dehydrated:M,treeContext:Is!==null?{id:Ri,overflow:Di}:null,retryLane:536870912,hydrationErrors:null},N=bn(18,null,null,0),N.stateNode=M,N.return=r,r.child=N,sn=r,me=null,N=!0):N=!1}N||zs(r)}if(M=r.memoizedState,M!==null&&(M=M.dehydrated,M!==null))return Pd(M)?r.lanes=32:r.lanes=536870912,null;Pi(r)}return M=h.children,h=h.fallback,p?(ns(),p=r.mode,M=hc({mode:"hidden",children:M},p),h=js(h,p,c,null),M.return=r,h.return=r,M.sibling=h,r.child=M,p=r.child,p.memoizedState=Wh(c),p.childLanes=Kh(i,T,c),r.memoizedState=Yh,h):(es(r),Qh(r,M))}if(N=i.memoizedState,N!==null&&(M=N.dehydrated,M!==null)){if(y)r.flags&256?(es(r),r.flags&=-257,r=Zh(i,r,c)):r.memoizedState!==null?(ns(),r.child=i.child,r.flags|=128,r=null):(ns(),p=h.fallback,M=r.mode,h=hc({mode:"visible",children:h.children},M),p=js(p,M,c,null),p.flags|=2,h.return=r,p.return=r,h.sibling=p,r.child=h,zr(r,i.child,null,c),h=r.child,h.memoizedState=Wh(c),h.childLanes=Kh(i,T,c),r.memoizedState=Yh,r=p);else if(es(r),Pd(M)){if(T=M.nextSibling&&M.nextSibling.dataset,T)var G=T.dgst;T=G,h=Error(n(419)),h.stack="",h.digest=T,Ya({value:h,source:null,stack:null}),r=Zh(i,r,c)}else if(Pe||Wa(i,r,c,!1),T=(c&i.childLanes)!==0,Pe||T){if(T=ee,T!==null&&(h=c&-c,h=(h&42)!==0?1:Xe(h),h=(h&(T.suspendedLanes|c))!==0?0:h,h!==0&&h!==N.retryLane))throw N.retryLane=h,Or(i,h),En(T,i,h),Wm;M.data==="$?"||md(),r=Zh(i,r,c)}else M.data==="$?"?(r.flags|=192,r.child=i.child,r=null):(i=N.treeContext,me=Qn(M.nextSibling),sn=r,Ut=!0,Fs=null,li=!1,i!==null&&(Bn[jn++]=Ri,Bn[jn++]=Di,Bn[jn++]=Is,Ri=i.id,Di=i.overflow,Is=r),r=Qh(r,h.children),r.flags|=4096);return r}return p?(ns(),p=h.fallback,M=r.mode,N=i.child,G=N.sibling,h=Ci(N,{mode:"hidden",children:h.children}),h.subtreeFlags=N.subtreeFlags&65011712,G!==null?p=Ci(G,p):(p=js(p,M,c,null),p.flags|=2),p.return=r,h.return=r,h.sibling=p,r.child=h,h=p,p=r.child,M=i.child.memoizedState,M===null?M=Wh(c):(N=M.cachePool,N!==null?(G=De._currentValue,N=N.parent!==G?{parent:G,pool:G}:N):N=qp(),M={baseLanes:M.baseLanes|c,cachePool:N}),p.memoizedState=M,p.childLanes=Kh(i,T,c),r.memoizedState=Yh,h):(es(r),c=i.child,i=c.sibling,c=Ci(c,{mode:"visible",children:h.children}),c.return=r,c.sibling=null,i!==null&&(T=r.deletions,T===null?(r.deletions=[i],r.flags|=16):T.push(i)),r.child=c,r.memoizedState=null,c)}function Qh(i,r){return r=hc({mode:"visible",children:r},i.mode),r.return=i,i.child=r}function hc(i,r){return i=bn(22,i,null,r),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function Zh(i,r,c){return zr(r,i.child,null,c),i=Qh(r,r.pendingProps.children),i.flags|=2,r.memoizedState=null,i}function ry(i,r,c){i.lanes|=r;var h=i.alternate;h!==null&&(h.lanes|=r),mh(i.return,r,c)}function Jh(i,r,c,h,p){var y=i.memoizedState;y===null?i.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:p}:(y.isBackwards=r,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=c,y.tailMode=p)}function ay(i,r,c){var h=r.pendingProps,p=h.revealOrder,y=h.tail;if(ze(i,r,h.children,c),h=Oe.current,(h&2)!==0)h=h&1|2,r.flags|=128;else{if(i!==null&&(i.flags&128)!==0)t:for(i=r.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&ry(i,c,r);else if(i.tag===19)ry(i,c,r);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break t;for(;i.sibling===null;){if(i.return===null||i.return===r)break t;i=i.return}i.sibling.return=i.return,i=i.sibling}h&=1}switch(U(Oe,h),p){case"forwards":for(c=r.child,p=null;c!==null;)i=c.alternate,i!==null&&oc(i)===null&&(p=c),c=c.sibling;c=p,c===null?(p=r.child,r.child=null):(p=c.sibling,c.sibling=null),Jh(r,!1,p,c,y);break;case"backwards":for(c=null,p=r.child,r.child=null;p!==null;){if(i=p.alternate,i!==null&&oc(i)===null){r.child=p;break}i=p.sibling,p.sibling=c,c=p,p=i}Jh(r,!0,c,null,y);break;case"together":Jh(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function Ni(i,r,c){if(i!==null&&(r.dependencies=i.dependencies),os|=r.lanes,(c&r.childLanes)===0)if(i!==null){if(Wa(i,r,c,!1),(c&r.childLanes)===0)return null}else return null;if(i!==null&&r.child!==i.child)throw Error(n(153));if(r.child!==null){for(i=r.child,c=Ci(i,i.pendingProps),r.child=c,c.return=r;i.sibling!==null;)i=i.sibling,c=c.sibling=Ci(i,i.pendingProps),c.return=r;c.sibling=null}return r.child}function td(i,r){return(i.lanes&r)!==0?!0:(i=i.dependencies,!!(i!==null&&Gl(i)))}function WS(i,r,c){switch(r.tag){case 3:vt(r,r.stateNode.containerInfo),Ki(r,De,i.memoizedState.cache),Xa();break;case 27:case 5:St(r);break;case 4:vt(r,r.stateNode.containerInfo);break;case 10:Ki(r,r.type,r.memoizedProps.value);break;case 13:var h=r.memoizedState;if(h!==null)return h.dehydrated!==null?(es(r),r.flags|=128,null):(c&r.child.childLanes)!==0?sy(i,r,c):(es(r),i=Ni(i,r,c),i!==null?i.sibling:null);es(r);break;case 19:var p=(i.flags&128)!==0;if(h=(c&r.childLanes)!==0,h||(Wa(i,r,c,!1),h=(c&r.childLanes)!==0),p){if(h)return ay(i,r,c);r.flags|=128}if(p=r.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),U(Oe,Oe.current),h)break;return null;case 22:case 23:return r.lanes=0,Jm(i,r,c);case 24:Ki(r,De,i.memoizedState.cache)}return Ni(i,r,c)}function oy(i,r,c){if(i!==null)if(i.memoizedProps!==r.pendingProps)Pe=!0;else{if(!td(i,c)&&(r.flags&128)===0)return Pe=!1,WS(i,r,c);Pe=(i.flags&131072)!==0}else Pe=!1,Ut&&(r.flags&1048576)!==0&&jp(r,ql,r.index);switch(r.lanes=0,r.tag){case 16:t:{i=r.pendingProps;var h=r.elementType,p=h._init;if(h=p(h._payload),r.type=h,typeof h=="function")ch(h)?(i=Vs(h,i),r.tag=1,r=ny(null,r,h,i,c)):(r.tag=0,r=Xh(null,r,h,i,c));else{if(h!=null){if(p=h.$$typeof,p===O){r.tag=11,r=Km(null,r,h,i,c);break t}else if(p===R){r.tag=14,r=Qm(null,r,h,i,c);break t}}throw r=st(h)||h,Error(n(306,r,""))}}return r;case 0:return Xh(i,r,r.type,r.pendingProps,c);case 1:return h=r.type,p=Vs(h,r.pendingProps),ny(i,r,h,p,c);case 3:t:{if(vt(r,r.stateNode.containerInfo),i===null)throw Error(n(387));h=r.pendingProps;var y=r.memoizedState;p=y.element,Ah(i,r),no(r,h,null,c);var T=r.memoizedState;if(h=T.cache,Ki(r,De,h),h!==y.cache&&yh(r,[De],c,!0),eo(),h=T.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:T.cache},r.updateQueue.baseState=y,r.memoizedState=y,r.flags&256){r=iy(i,r,h,c);break t}else if(h!==p){p=Nn(Error(n(424)),r),Ya(p),r=iy(i,r,h,c);break t}else{switch(i=r.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(me=Qn(i.firstChild),sn=r,Ut=!0,Fs=null,li=!0,c=Um(r,null,h,c),r.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Xa(),h===p){r=Ni(i,r,c);break t}ze(i,r,h,c)}r=r.child}return r;case 26:return uc(i,r),i===null?(c=hv(r.type,null,r.pendingProps,null))?r.memoizedState=c:Ut||(c=r.type,i=r.pendingProps,h=Tc(at.current).createElement(c),h[ie]=r,h[se]=i,$e(h,c,i),ke(h),r.stateNode=h):r.memoizedState=hv(r.type,i.memoizedProps,r.pendingProps,i.memoizedState),null;case 27:return St(r),i===null&&Ut&&(h=r.stateNode=lv(r.type,r.pendingProps,at.current),sn=r,li=!0,p=me,hs(r.type)?(Nd=p,me=Qn(h.firstChild)):me=p),ze(i,r,r.pendingProps.children,c),uc(i,r),i===null&&(r.flags|=4194304),r.child;case 5:return i===null&&Ut&&((p=h=me)&&(h=AA(h,r.type,r.pendingProps,li),h!==null?(r.stateNode=h,sn=r,me=Qn(h.firstChild),li=!1,p=!0):p=!1),p||zs(r)),St(r),p=r.type,y=r.pendingProps,T=i!==null?i.memoizedProps:null,h=y.children,Od(p,y)?h=null:T!==null&&Od(p,T)&&(r.flags|=32),r.memoizedState!==null&&(p=Dh(i,r,zS,null,null,c),To._currentValue=p),uc(i,r),ze(i,r,h,c),r.child;case 6:return i===null&&Ut&&((i=c=me)&&(c=EA(c,r.pendingProps,li),c!==null?(r.stateNode=c,sn=r,me=null,i=!0):i=!1),i||zs(r)),null;case 13:return sy(i,r,c);case 4:return vt(r,r.stateNode.containerInfo),h=r.pendingProps,i===null?r.child=zr(r,null,h,c):ze(i,r,h,c),r.child;case 11:return Km(i,r,r.type,r.pendingProps,c);case 7:return ze(i,r,r.pendingProps,c),r.child;case 8:return ze(i,r,r.pendingProps.children,c),r.child;case 12:return ze(i,r,r.pendingProps.children,c),r.child;case 10:return h=r.pendingProps,Ki(r,r.type,h.value),ze(i,r,h.children,c),r.child;case 9:return p=r.type._context,h=r.pendingProps.children,$s(r),p=We(p),h=h(p),r.flags|=1,ze(i,r,h,c),r.child;case 14:return Qm(i,r,r.type,r.pendingProps,c);case 15:return Zm(i,r,r.type,r.pendingProps,c);case 19:return ay(i,r,c);case 31:return h=r.pendingProps,c=r.mode,h={mode:h.mode,children:h.children},i===null?(c=hc(h,c),c.ref=r.ref,r.child=c,c.return=r,r=c):(c=Ci(i.child,h),c.ref=r.ref,r.child=c,c.return=r,r=c),r;case 22:return Jm(i,r,c);case 24:return $s(r),h=We(De),i===null?(p=wh(),p===null&&(p=ee,y=vh(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=c),p=y),r.memoizedState={parent:h,cache:p},Sh(r),Ki(r,De,p)):((i.lanes&c)!==0&&(Ah(i,r),no(r,null,null,c),eo()),p=i.memoizedState,y=r.memoizedState,p.parent!==h?(p={parent:h,cache:h},r.memoizedState=p,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=p),Ki(r,De,h)):(h=y.cache,Ki(r,De,h),h!==p.cache&&yh(r,[De],c,!0))),ze(i,r,r.pendingProps.children,c),r.child;case 29:throw r.pendingProps}throw Error(n(156,r.tag))}function Li(i){i.flags|=4}function ly(i,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!mv(r)){if(r=In.current,r!==null&&((Bt&4194048)===Bt?ci!==null:(Bt&62914560)!==Bt&&(Bt&536870912)===0||r!==ci))throw Ja=_h,Gp;i.flags|=8192}}function dc(i,r){r!==null&&(i.flags|=4),i.flags&16384&&(r=i.tag!==22?Cl():536870912,i.lanes|=r,Gr|=r)}function co(i,r){if(!Ut)switch(i.tailMode){case"hidden":r=i.tail;for(var c=null;r!==null;)r.alternate!==null&&(c=r),r=r.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?r||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function ce(i){var r=i.alternate!==null&&i.alternate.child===i.child,c=0,h=0;if(r)for(var p=i.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags&65011712,h|=p.flags&65011712,p.return=i,p=p.sibling;else for(p=i.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=i,p=p.sibling;return i.subtreeFlags|=h,i.childLanes=c,r}function KS(i,r,c){var h=r.pendingProps;switch(fh(r),r.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ce(r),null;case 1:return ce(r),null;case 3:return c=r.stateNode,h=null,i!==null&&(h=i.memoizedState.cache),r.memoizedState.cache!==h&&(r.flags|=2048),Mi(De),It(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(Va(r)?Li(r):i===null||i.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Fp())),ce(r),null;case 26:return c=r.memoizedState,i===null?(Li(r),c!==null?(ce(r),ly(r,c)):(ce(r),r.flags&=-16777217)):c?c!==i.memoizedState?(Li(r),ce(r),ly(r,c)):(ce(r),r.flags&=-16777217):(i.memoizedProps!==h&&Li(r),ce(r),r.flags&=-16777217),null;case 27:Ae(r),c=at.current;var p=r.type;if(i!==null&&r.stateNode!=null)i.memoizedProps!==h&&Li(r);else{if(!h){if(r.stateNode===null)throw Error(n(166));return ce(r),null}i=et.current,Va(r)?Ip(r):(i=lv(p,h,c),r.stateNode=i,Li(r))}return ce(r),null;case 5:if(Ae(r),c=r.type,i!==null&&r.stateNode!=null)i.memoizedProps!==h&&Li(r);else{if(!h){if(r.stateNode===null)throw Error(n(166));return ce(r),null}if(i=et.current,Va(r))Ip(r);else{switch(p=Tc(at.current),i){case 1:i=p.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:i=p.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":i=p.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":i=p.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":i=p.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof h.is=="string"?p.createElement("select",{is:h.is}):p.createElement("select"),h.multiple?i.multiple=!0:h.size&&(i.size=h.size);break;default:i=typeof h.is=="string"?p.createElement(c,{is:h.is}):p.createElement(c)}}i[ie]=r,i[se]=h;t:for(p=r.child;p!==null;){if(p.tag===5||p.tag===6)i.appendChild(p.stateNode);else if(p.tag!==4&&p.tag!==27&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===r)break t;for(;p.sibling===null;){if(p.return===null||p.return===r)break t;p=p.return}p.sibling.return=p.return,p=p.sibling}r.stateNode=i;t:switch($e(i,c,h),c){case"button":case"input":case"select":case"textarea":i=!!h.autoFocus;break t;case"img":i=!0;break t;default:i=!1}i&&Li(r)}}return ce(r),r.flags&=-16777217,null;case 6:if(i&&r.stateNode!=null)i.memoizedProps!==h&&Li(r);else{if(typeof h!="string"&&r.stateNode===null)throw Error(n(166));if(i=at.current,Va(r)){if(i=r.stateNode,c=r.memoizedProps,h=null,p=sn,p!==null)switch(p.tag){case 27:case 5:h=p.memoizedProps}i[ie]=r,i=!!(i.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||ev(i.nodeValue,c)),i||zs(r)}else i=Tc(i).createTextNode(h),i[ie]=r,r.stateNode=i}return ce(r),null;case 13:if(h=r.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(p=Va(r),h!==null&&h.dehydrated!==null){if(i===null){if(!p)throw Error(n(318));if(p=r.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(n(317));p[ie]=r}else Xa(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ce(r),p=!1}else p=Fp(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=p),p=!0;if(!p)return r.flags&256?(Pi(r),r):(Pi(r),null)}if(Pi(r),(r.flags&128)!==0)return r.lanes=c,r;if(c=h!==null,i=i!==null&&i.memoizedState!==null,c){h=r.child,p=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(p=h.alternate.memoizedState.cachePool.pool);var y=null;h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(y=h.memoizedState.cachePool.pool),y!==p&&(h.flags|=2048)}return c!==i&&c&&(r.child.flags|=8192),dc(r,r.updateQueue),ce(r),null;case 4:return It(),i===null&&Td(r.stateNode.containerInfo),ce(r),null;case 10:return Mi(r.type),ce(r),null;case 19:if(Y(Oe),p=r.memoizedState,p===null)return ce(r),null;if(h=(r.flags&128)!==0,y=p.rendering,y===null)if(h)co(p,!1);else{if(ye!==0||i!==null&&(i.flags&128)!==0)for(i=r.child;i!==null;){if(y=oc(i),y!==null){for(r.flags|=128,co(p,!1),i=y.updateQueue,r.updateQueue=i,dc(r,i),r.subtreeFlags=0,i=c,c=r.child;c!==null;)Bp(c,i),c=c.sibling;return U(Oe,Oe.current&1|2),r.child}i=i.sibling}p.tail!==null&&Ee()>pc&&(r.flags|=128,h=!0,co(p,!1),r.lanes=4194304)}else{if(!h)if(i=oc(y),i!==null){if(r.flags|=128,h=!0,i=i.updateQueue,r.updateQueue=i,dc(r,i),co(p,!0),p.tail===null&&p.tailMode==="hidden"&&!y.alternate&&!Ut)return ce(r),null}else 2*Ee()-p.renderingStartTime>pc&&c!==536870912&&(r.flags|=128,h=!0,co(p,!1),r.lanes=4194304);p.isBackwards?(y.sibling=r.child,r.child=y):(i=p.last,i!==null?i.sibling=y:r.child=y,p.last=y)}return p.tail!==null?(r=p.tail,p.rendering=r,p.tail=r.sibling,p.renderingStartTime=Ee(),r.sibling=null,i=Oe.current,U(Oe,h?i&1|2:i&1),r):(ce(r),null);case 22:case 23:return Pi(r),Ch(),h=r.memoizedState!==null,i!==null?i.memoizedState!==null!==h&&(r.flags|=8192):h&&(r.flags|=8192),h?(c&536870912)!==0&&(r.flags&128)===0&&(ce(r),r.subtreeFlags&6&&(r.flags|=8192)):ce(r),c=r.updateQueue,c!==null&&dc(r,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),h=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),h!==c&&(r.flags|=2048),i!==null&&Y(qs),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Mi(De),ce(r),null;case 25:return null;case 30:return null}throw Error(n(156,r.tag))}function QS(i,r){switch(fh(r),r.tag){case 1:return i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 3:return Mi(De),It(),i=r.flags,(i&65536)!==0&&(i&128)===0?(r.flags=i&-65537|128,r):null;case 26:case 27:case 5:return Ae(r),null;case 13:if(Pi(r),i=r.memoizedState,i!==null&&i.dehydrated!==null){if(r.alternate===null)throw Error(n(340));Xa()}return i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 19:return Y(Oe),null;case 4:return It(),null;case 10:return Mi(r.type),null;case 22:case 23:return Pi(r),Ch(),i!==null&&Y(qs),i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 24:return Mi(De),null;case 25:return null;default:return null}}function cy(i,r){switch(fh(r),r.tag){case 3:Mi(De),It();break;case 26:case 27:case 5:Ae(r);break;case 4:It();break;case 13:Pi(r);break;case 19:Y(Oe);break;case 10:Mi(r.type);break;case 22:case 23:Pi(r),Ch(),i!==null&&Y(qs);break;case 24:Mi(De)}}function uo(i,r){try{var c=r.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var p=h.next;c=p;do{if((c.tag&i)===i){h=void 0;var y=c.create,T=c.inst;h=y(),T.destroy=h}c=c.next}while(c!==p)}}catch(M){Wt(r,r.return,M)}}function is(i,r,c){try{var h=r.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var y=p.next;h=y;do{if((h.tag&i)===i){var T=h.inst,M=T.destroy;if(M!==void 0){T.destroy=void 0,p=r;var N=c,G=M;try{G()}catch(K){Wt(p,N,K)}}}h=h.next}while(h!==y)}}catch(K){Wt(r,r.return,K)}}function uy(i){var r=i.updateQueue;if(r!==null){var c=i.stateNode;try{Qp(r,c)}catch(h){Wt(i,i.return,h)}}}function hy(i,r,c){c.props=Vs(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(h){Wt(i,r,h)}}function ho(i,r){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var h=i.stateNode;break;case 30:h=i.stateNode;break;default:h=i.stateNode}typeof c=="function"?i.refCleanup=c(h):c.current=h}}catch(p){Wt(i,r,p)}}function ui(i,r){var c=i.ref,h=i.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(p){Wt(i,r,p)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(p){Wt(i,r,p)}else c.current=null}function dy(i){var r=i.type,c=i.memoizedProps,h=i.stateNode;try{t:switch(r){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break t;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(p){Wt(i,i.return,p)}}function ed(i,r,c){try{var h=i.stateNode;vA(h,i.type,c,r),h[se]=r}catch(p){Wt(i,i.return,p)}}function fy(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&hs(i.type)||i.tag===4}function nd(i){t:for(;;){for(;i.sibling===null;){if(i.return===null||fy(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&hs(i.type)||i.flags&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function id(i,r,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,r?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,r):(r=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,r.appendChild(i),c=c._reactRootContainer,c!=null||r.onclick!==null||(r.onclick=Ec));else if(h!==4&&(h===27&&hs(i.type)&&(c=i.stateNode,r=null),i=i.child,i!==null))for(id(i,r,c),i=i.sibling;i!==null;)id(i,r,c),i=i.sibling}function fc(i,r,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,r?c.insertBefore(i,r):c.appendChild(i);else if(h!==4&&(h===27&&hs(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(fc(i,r,c),i=i.sibling;i!==null;)fc(i,r,c),i=i.sibling}function gy(i){var r=i.stateNode,c=i.memoizedProps;try{for(var h=i.type,p=r.attributes;p.length;)r.removeAttributeNode(p[0]);$e(r,h,c),r[ie]=i,r[se]=c}catch(y){Wt(i,i.return,y)}}var Bi=!1,be=!1,sd=!1,py=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function ZS(i,r){if(i=i.containerInfo,Rd=Mc,i=xp(i),nh(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else t:{c=(c=i.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var p=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break t}var T=0,M=-1,N=-1,G=0,K=0,J=i,X=null;e:for(;;){for(var W;J!==c||p!==0&&J.nodeType!==3||(M=T+p),J!==y||h!==0&&J.nodeType!==3||(N=T+h),J.nodeType===3&&(T+=J.nodeValue.length),(W=J.firstChild)!==null;)X=J,J=W;for(;;){if(J===i)break e;if(X===c&&++G===p&&(M=T),X===y&&++K===h&&(N=T),(W=J.nextSibling)!==null)break;J=X,X=J.parentNode}J=W}c=M===-1||N===-1?null:{start:M,end:N}}else c=null}c=c||{start:0,end:0}}else c=null;for(Dd={focusedElem:i,selectionRange:c},Mc=!1,Ne=r;Ne!==null;)if(r=Ne,i=r.child,(r.subtreeFlags&1024)!==0&&i!==null)i.return=r,Ne=i;else for(;Ne!==null;){switch(r=Ne,y=r.alternate,i=r.flags,r.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&y!==null){i=void 0,c=r,p=y.memoizedProps,y=y.memoizedState,h=c.stateNode;try{var _t=Vs(c.type,p,c.elementType===c.type);i=h.getSnapshotBeforeUpdate(_t,y),h.__reactInternalSnapshotBeforeUpdate=i}catch(yt){Wt(c,c.return,yt)}}break;case 3:if((i&1024)!==0){if(i=r.stateNode.containerInfo,c=i.nodeType,c===9)kd(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":kd(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=r.sibling,i!==null){i.return=r.return,Ne=i;break}Ne=r.return}}function my(i,r,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:ss(i,c),h&4&&uo(5,c);break;case 1:if(ss(i,c),h&4)if(i=c.stateNode,r===null)try{i.componentDidMount()}catch(T){Wt(c,c.return,T)}else{var p=Vs(c.type,r.memoizedProps);r=r.memoizedState;try{i.componentDidUpdate(p,r,i.__reactInternalSnapshotBeforeUpdate)}catch(T){Wt(c,c.return,T)}}h&64&&uy(c),h&512&&ho(c,c.return);break;case 3:if(ss(i,c),h&64&&(i=c.updateQueue,i!==null)){if(r=null,c.child!==null)switch(c.child.tag){case 27:case 5:r=c.child.stateNode;break;case 1:r=c.child.stateNode}try{Qp(i,r)}catch(T){Wt(c,c.return,T)}}break;case 27:r===null&&h&4&&gy(c);case 26:case 5:ss(i,c),r===null&&h&4&&dy(c),h&512&&ho(c,c.return);break;case 12:ss(i,c);break;case 13:ss(i,c),h&4&&by(i,c),h&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=oA.bind(null,c),TA(i,c))));break;case 22:if(h=c.memoizedState!==null||Bi,!h){r=r!==null&&r.memoizedState!==null||be,p=Bi;var y=be;Bi=h,(be=r)&&!y?rs(i,c,(c.subtreeFlags&8772)!==0):ss(i,c),Bi=p,be=y}break;case 30:break;default:ss(i,c)}}function yy(i){var r=i.alternate;r!==null&&(i.alternate=null,yy(r)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(r=i.stateNode,r!==null&&ju(r)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var re=null,un=!1;function ji(i,r,c){for(c=c.child;c!==null;)vy(i,r,c),c=c.sibling}function vy(i,r,c){if(Ft&&typeof Ft.onCommitFiberUnmount=="function")try{Ft.onCommitFiberUnmount(Si,c)}catch{}switch(c.tag){case 26:be||ui(c,r),ji(i,r,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:be||ui(c,r);var h=re,p=un;hs(c.type)&&(re=c.stateNode,un=!1),ji(i,r,c),_o(c.stateNode),re=h,un=p;break;case 5:be||ui(c,r);case 6:if(h=re,p=un,re=null,ji(i,r,c),re=h,un=p,re!==null)if(un)try{(re.nodeType===9?re.body:re.nodeName==="HTML"?re.ownerDocument.body:re).removeChild(c.stateNode)}catch(y){Wt(c,r,y)}else try{re.removeChild(c.stateNode)}catch(y){Wt(c,r,y)}break;case 18:re!==null&&(un?(i=re,av(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),Do(i)):av(re,c.stateNode));break;case 4:h=re,p=un,re=c.stateNode.containerInfo,un=!0,ji(i,r,c),re=h,un=p;break;case 0:case 11:case 14:case 15:be||is(2,c,r),be||is(4,c,r),ji(i,r,c);break;case 1:be||(ui(c,r),h=c.stateNode,typeof h.componentWillUnmount=="function"&&hy(c,r,h)),ji(i,r,c);break;case 21:ji(i,r,c);break;case 22:be=(h=be)||c.memoizedState!==null,ji(i,r,c),be=h;break;default:ji(i,r,c)}}function by(i,r){if(r.memoizedState===null&&(i=r.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Do(i)}catch(c){Wt(r,r.return,c)}}function JS(i){switch(i.tag){case 13:case 19:var r=i.stateNode;return r===null&&(r=i.stateNode=new py),r;case 22:return i=i.stateNode,r=i._retryCache,r===null&&(r=i._retryCache=new py),r;default:throw Error(n(435,i.tag))}}function rd(i,r){var c=JS(i);r.forEach(function(h){var p=lA.bind(null,i,h);c.has(h)||(c.add(h),h.then(p,p))})}function wn(i,r){var c=r.deletions;if(c!==null)for(var h=0;h<c.length;h++){var p=c[h],y=i,T=r,M=T;t:for(;M!==null;){switch(M.tag){case 27:if(hs(M.type)){re=M.stateNode,un=!1;break t}break;case 5:re=M.stateNode,un=!1;break t;case 3:case 4:re=M.stateNode.containerInfo,un=!0;break t}M=M.return}if(re===null)throw Error(n(160));vy(y,T,p),re=null,un=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(r.subtreeFlags&13878)for(r=r.child;r!==null;)wy(r,i),r=r.sibling}var Kn=null;function wy(i,r){var c=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:wn(r,i),_n(i),h&4&&(is(3,i,i.return),uo(3,i),is(5,i,i.return));break;case 1:wn(r,i),_n(i),h&512&&(be||c===null||ui(c,c.return)),h&64&&Bi&&(i=i.updateQueue,i!==null&&(h=i.callbacks,h!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var p=Kn;if(wn(r,i),_n(i),h&512&&(be||c===null||ui(c,c.return)),h&4){var y=c!==null?c.memoizedState:null;if(h=i.memoizedState,c===null)if(h===null)if(i.stateNode===null){t:{h=i.type,c=i.memoizedProps,p=p.ownerDocument||p;e:switch(h){case"title":y=p.getElementsByTagName("title")[0],(!y||y[Ei]||y[ie]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(h),p.head.insertBefore(y,p.querySelector("head > title"))),$e(y,h,c),y[ie]=i,ke(y),h=y;break t;case"link":var T=gv("link","href",p).get(h+(c.href||""));if(T){for(var M=0;M<T.length;M++)if(y=T[M],y.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&y.getAttribute("rel")===(c.rel==null?null:c.rel)&&y.getAttribute("title")===(c.title==null?null:c.title)&&y.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){T.splice(M,1);break e}}y=p.createElement(h),$e(y,h,c),p.head.appendChild(y);break;case"meta":if(T=gv("meta","content",p).get(h+(c.content||""))){for(M=0;M<T.length;M++)if(y=T[M],y.getAttribute("content")===(c.content==null?null:""+c.content)&&y.getAttribute("name")===(c.name==null?null:c.name)&&y.getAttribute("property")===(c.property==null?null:c.property)&&y.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&y.getAttribute("charset")===(c.charSet==null?null:c.charSet)){T.splice(M,1);break e}}y=p.createElement(h),$e(y,h,c),p.head.appendChild(y);break;default:throw Error(n(468,h))}y[ie]=i,ke(y),h=y}i.stateNode=h}else pv(p,i.type,i.stateNode);else i.stateNode=fv(p,h,i.memoizedProps);else y!==h?(y===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):y.count--,h===null?pv(p,i.type,i.stateNode):fv(p,h,i.memoizedProps)):h===null&&i.stateNode!==null&&ed(i,i.memoizedProps,c.memoizedProps)}break;case 27:wn(r,i),_n(i),h&512&&(be||c===null||ui(c,c.return)),c!==null&&h&4&&ed(i,i.memoizedProps,c.memoizedProps);break;case 5:if(wn(r,i),_n(i),h&512&&(be||c===null||ui(c,c.return)),i.flags&32){p=i.stateNode;try{Ar(p,"")}catch(W){Wt(i,i.return,W)}}h&4&&i.stateNode!=null&&(p=i.memoizedProps,ed(i,p,c!==null?c.memoizedProps:p)),h&1024&&(sd=!0);break;case 6:if(wn(r,i),_n(i),h&4){if(i.stateNode===null)throw Error(n(162));h=i.memoizedProps,c=i.stateNode;try{c.nodeValue=h}catch(W){Wt(i,i.return,W)}}break;case 3:if(Rc=null,p=Kn,Kn=xc(r.containerInfo),wn(r,i),Kn=p,_n(i),h&4&&c!==null&&c.memoizedState.isDehydrated)try{Do(r.containerInfo)}catch(W){Wt(i,i.return,W)}sd&&(sd=!1,_y(i));break;case 4:h=Kn,Kn=xc(i.stateNode.containerInfo),wn(r,i),_n(i),Kn=h;break;case 12:wn(r,i),_n(i);break;case 13:wn(r,i),_n(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(hd=Ee()),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,rd(i,h)));break;case 22:p=i.memoizedState!==null;var N=c!==null&&c.memoizedState!==null,G=Bi,K=be;if(Bi=G||p,be=K||N,wn(r,i),be=K,Bi=G,_n(i),h&8192)t:for(r=i.stateNode,r._visibility=p?r._visibility&-2:r._visibility|1,p&&(c===null||N||Bi||be||Xs(i)),c=null,r=i;;){if(r.tag===5||r.tag===26){if(c===null){N=c=r;try{if(y=N.stateNode,p)T=y.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{M=N.stateNode;var J=N.memoizedProps.style,X=J!=null&&J.hasOwnProperty("display")?J.display:null;M.style.display=X==null||typeof X=="boolean"?"":(""+X).trim()}}catch(W){Wt(N,N.return,W)}}}else if(r.tag===6){if(c===null){N=r;try{N.stateNode.nodeValue=p?"":N.memoizedProps}catch(W){Wt(N,N.return,W)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===i)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break t;for(;r.sibling===null;){if(r.return===null||r.return===i)break t;c===r&&(c=null),r=r.return}c===r&&(c=null),r.sibling.return=r.return,r=r.sibling}h&4&&(h=i.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,rd(i,c))));break;case 19:wn(r,i),_n(i),h&4&&(h=i.updateQueue,h!==null&&(i.updateQueue=null,rd(i,h)));break;case 30:break;case 21:break;default:wn(r,i),_n(i)}}function _n(i){var r=i.flags;if(r&2){try{for(var c,h=i.return;h!==null;){if(fy(h)){c=h;break}h=h.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var p=c.stateNode,y=nd(i);fc(i,y,p);break;case 5:var T=c.stateNode;c.flags&32&&(Ar(T,""),c.flags&=-33);var M=nd(i);fc(i,M,T);break;case 3:case 4:var N=c.stateNode.containerInfo,G=nd(i);id(i,G,N);break;default:throw Error(n(161))}}catch(K){Wt(i,i.return,K)}i.flags&=-3}r&4096&&(i.flags&=-4097)}function _y(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var r=i;_y(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),i=i.sibling}}function ss(i,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)my(i,r.alternate,r),r=r.sibling}function Xs(i){for(i=i.child;i!==null;){var r=i;switch(r.tag){case 0:case 11:case 14:case 15:is(4,r,r.return),Xs(r);break;case 1:ui(r,r.return);var c=r.stateNode;typeof c.componentWillUnmount=="function"&&hy(r,r.return,c),Xs(r);break;case 27:_o(r.stateNode);case 26:case 5:ui(r,r.return),Xs(r);break;case 22:r.memoizedState===null&&Xs(r);break;case 30:Xs(r);break;default:Xs(r)}i=i.sibling}}function rs(i,r,c){for(c=c&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var h=r.alternate,p=i,y=r,T=y.flags;switch(y.tag){case 0:case 11:case 15:rs(p,y,c),uo(4,y);break;case 1:if(rs(p,y,c),h=y,p=h.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(G){Wt(h,h.return,G)}if(h=y,p=h.updateQueue,p!==null){var M=h.stateNode;try{var N=p.shared.hiddenCallbacks;if(N!==null)for(p.shared.hiddenCallbacks=null,p=0;p<N.length;p++)Kp(N[p],M)}catch(G){Wt(h,h.return,G)}}c&&T&64&&uy(y),ho(y,y.return);break;case 27:gy(y);case 26:case 5:rs(p,y,c),c&&h===null&&T&4&&dy(y),ho(y,y.return);break;case 12:rs(p,y,c);break;case 13:rs(p,y,c),c&&T&4&&by(p,y);break;case 22:y.memoizedState===null&&rs(p,y,c),ho(y,y.return);break;case 30:break;default:rs(p,y,c)}r=r.sibling}}function ad(i,r){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(i=r.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Ka(c))}function od(i,r){i=null,r.alternate!==null&&(i=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==i&&(r.refCount++,i!=null&&Ka(i))}function hi(i,r,c,h){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Sy(i,r,c,h),r=r.sibling}function Sy(i,r,c,h){var p=r.flags;switch(r.tag){case 0:case 11:case 15:hi(i,r,c,h),p&2048&&uo(9,r);break;case 1:hi(i,r,c,h);break;case 3:hi(i,r,c,h),p&2048&&(i=null,r.alternate!==null&&(i=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==i&&(r.refCount++,i!=null&&Ka(i)));break;case 12:if(p&2048){hi(i,r,c,h),i=r.stateNode;try{var y=r.memoizedProps,T=y.id,M=y.onPostCommit;typeof M=="function"&&M(T,r.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(N){Wt(r,r.return,N)}}else hi(i,r,c,h);break;case 13:hi(i,r,c,h);break;case 23:break;case 22:y=r.stateNode,T=r.alternate,r.memoizedState!==null?y._visibility&2?hi(i,r,c,h):fo(i,r):y._visibility&2?hi(i,r,c,h):(y._visibility|=2,Hr(i,r,c,h,(r.subtreeFlags&10256)!==0)),p&2048&&ad(T,r);break;case 24:hi(i,r,c,h),p&2048&&od(r.alternate,r);break;default:hi(i,r,c,h)}}function Hr(i,r,c,h,p){for(p=p&&(r.subtreeFlags&10256)!==0,r=r.child;r!==null;){var y=i,T=r,M=c,N=h,G=T.flags;switch(T.tag){case 0:case 11:case 15:Hr(y,T,M,N,p),uo(8,T);break;case 23:break;case 22:var K=T.stateNode;T.memoizedState!==null?K._visibility&2?Hr(y,T,M,N,p):fo(y,T):(K._visibility|=2,Hr(y,T,M,N,p)),p&&G&2048&&ad(T.alternate,T);break;case 24:Hr(y,T,M,N,p),p&&G&2048&&od(T.alternate,T);break;default:Hr(y,T,M,N,p)}r=r.sibling}}function fo(i,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var c=i,h=r,p=h.flags;switch(h.tag){case 22:fo(c,h),p&2048&&ad(h.alternate,h);break;case 24:fo(c,h),p&2048&&od(h.alternate,h);break;default:fo(c,h)}r=r.sibling}}var go=8192;function $r(i){if(i.subtreeFlags&go)for(i=i.child;i!==null;)Ay(i),i=i.sibling}function Ay(i){switch(i.tag){case 26:$r(i),i.flags&go&&i.memoizedState!==null&&IA(Kn,i.memoizedState,i.memoizedProps);break;case 5:$r(i);break;case 3:case 4:var r=Kn;Kn=xc(i.stateNode.containerInfo),$r(i),Kn=r;break;case 22:i.memoizedState===null&&(r=i.alternate,r!==null&&r.memoizedState!==null?(r=go,go=16777216,$r(i),go=r):$r(i));break;default:$r(i)}}function Ey(i){var r=i.alternate;if(r!==null&&(i=r.child,i!==null)){r.child=null;do r=i.sibling,i.sibling=null,i=r;while(i!==null)}}function po(i){var r=i.deletions;if((i.flags&16)!==0){if(r!==null)for(var c=0;c<r.length;c++){var h=r[c];Ne=h,xy(h,i)}Ey(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Ty(i),i=i.sibling}function Ty(i){switch(i.tag){case 0:case 11:case 15:po(i),i.flags&2048&&is(9,i,i.return);break;case 3:po(i);break;case 12:po(i);break;case 22:var r=i.stateNode;i.memoizedState!==null&&r._visibility&2&&(i.return===null||i.return.tag!==13)?(r._visibility&=-3,gc(i)):po(i);break;default:po(i)}}function gc(i){var r=i.deletions;if((i.flags&16)!==0){if(r!==null)for(var c=0;c<r.length;c++){var h=r[c];Ne=h,xy(h,i)}Ey(i)}for(i=i.child;i!==null;){switch(r=i,r.tag){case 0:case 11:case 15:is(8,r,r.return),gc(r);break;case 22:c=r.stateNode,c._visibility&2&&(c._visibility&=-3,gc(r));break;default:gc(r)}i=i.sibling}}function xy(i,r){for(;Ne!==null;){var c=Ne;switch(c.tag){case 0:case 11:case 15:is(8,c,r);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Ka(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,Ne=h;else t:for(c=i;Ne!==null;){h=Ne;var p=h.sibling,y=h.return;if(yy(h),h===c){Ne=null;break t}if(p!==null){p.return=y,Ne=p;break t}Ne=y}}}var tA={getCacheForType:function(i){var r=We(De),c=r.data.get(i);return c===void 0&&(c=i(),r.data.set(i,c)),c}},eA=typeof WeakMap=="function"?WeakMap:Map,zt=0,ee=null,Mt=null,Bt=0,Ht=0,Sn=null,as=!1,qr=!1,ld=!1,Ii=0,ye=0,os=0,Ys=0,cd=0,Un=0,Gr=0,mo=null,hn=null,ud=!1,hd=0,pc=1/0,mc=null,ls=null,He=0,cs=null,Vr=null,Xr=0,dd=0,fd=null,Cy=null,yo=0,gd=null;function An(){if((zt&2)!==0&&Bt!==0)return Bt&-Bt;if(B.T!==null){var i=Nr;return i!==0?i:_d()}return yn()}function Ry(){Un===0&&(Un=(Bt&536870912)===0||Ut?xl():536870912);var i=In.current;return i!==null&&(i.flags|=32),Un}function En(i,r,c){(i===ee&&(Ht===2||Ht===9)||i.cancelPendingCommit!==null)&&(Yr(i,0),us(i,Bt,Un,!1)),pe(i,c),((zt&2)===0||i!==ee)&&(i===ee&&((zt&2)===0&&(Ys|=c),ye===4&&us(i,Bt,Un,!1)),di(i))}function Dy(i,r,c){if((zt&6)!==0)throw Error(n(327));var h=!c&&(r&124)===0&&(r&i.expiredLanes)===0||Ms(i,r),p=h?sA(i,r):yd(i,r,!0),y=h;do{if(p===0){qr&&!h&&us(i,r,0,!1);break}else{if(c=i.current.alternate,y&&!nA(c)){p=yd(i,r,!1),y=!1;continue}if(p===2){if(y=r,i.errorRecoveryDisabledLanes&y)var T=0;else T=i.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){r=T;t:{var M=i;p=mo;var N=M.current.memoizedState.isDehydrated;if(N&&(Yr(M,T).flags|=256),T=yd(M,T,!1),T!==2){if(ld&&!N){M.errorRecoveryDisabledLanes|=y,Ys|=y,p=4;break t}y=hn,hn=p,y!==null&&(hn===null?hn=y:hn.push.apply(hn,y))}p=T}if(y=!1,p!==2)continue}}if(p===1){Yr(i,0),us(i,r,0,!0);break}t:{switch(h=i,y=p,y){case 0:case 1:throw Error(n(345));case 4:if((r&4194048)!==r)break;case 6:us(h,r,Un,!as);break t;case 2:hn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((r&62914560)===r&&(p=hd+300-Ee(),10<p)){if(us(h,r,Un,!as),Os(h,0,!0)!==0)break t;h.timeoutHandle=sv(Oy.bind(null,h,c,hn,mc,ud,r,Un,Ys,Gr,as,y,2,-0,0),p);break t}Oy(h,c,hn,mc,ud,r,Un,Ys,Gr,as,y,0,-0,0)}}break}while(!0);di(i)}function Oy(i,r,c,h,p,y,T,M,N,G,K,J,X,W){if(i.timeoutHandle=-1,J=r.subtreeFlags,(J&8192||(J&16785408)===16785408)&&(Eo={stylesheets:null,count:0,unsuspend:jA},Ay(r),J=UA(),J!==null)){i.cancelPendingCommit=J(jy.bind(null,i,r,y,c,h,p,T,M,N,K,1,X,W)),us(i,y,T,!G);return}jy(i,r,y,c,h,p,T,M,N)}function nA(i){for(var r=i;;){var c=r.tag;if((c===0||c===11||c===15)&&r.flags&16384&&(c=r.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var p=c[h],y=p.getSnapshot;p=p.value;try{if(!vn(y(),p))return!1}catch{return!1}}if(c=r.child,r.subtreeFlags&16384&&c!==null)c.return=r,r=c;else{if(r===i)break;for(;r.sibling===null;){if(r.return===null||r.return===i)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function us(i,r,c,h){r&=~cd,r&=~Ys,i.suspendedLanes|=r,i.pingedLanes&=~r,h&&(i.warmLanes|=r),h=i.expirationTimes;for(var p=r;0<p;){var y=31-$t(p),T=1<<y;h[y]=-1,p&=~T}c!==0&&Ve(i,c,r)}function yc(){return(zt&6)===0?(vo(0),!1):!0}function pd(){if(Mt!==null){if(Ht===0)var i=Mt.return;else i=Mt,Oi=Hs=null,kh(i),Fr=null,oo=0,i=Mt;for(;i!==null;)cy(i.alternate,i),i=i.return;Mt=null}}function Yr(i,r){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,wA(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),pd(),ee=i,Mt=c=Ci(i.current,null),Bt=r,Ht=0,Sn=null,as=!1,qr=Ms(i,r),ld=!1,Gr=Un=cd=Ys=os=ye=0,hn=mo=null,ud=!1,(r&8)!==0&&(r|=r&32);var h=i.entangledLanes;if(h!==0)for(i=i.entanglements,h&=r;0<h;){var p=31-$t(h),y=1<<p;r|=i[p],h&=~y}return Ii=r,Ul(),c}function My(i,r){Rt=null,B.H=sc,r===Za||r===Yl?(r=Yp(),Ht=3):r===Gp?(r=Yp(),Ht=4):Ht=r===Wm?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Sn=r,Mt===null&&(ye=1,cc(i,Nn(r,i.current)))}function ky(){var i=B.H;return B.H=sc,i===null?sc:i}function Py(){var i=B.A;return B.A=tA,i}function md(){ye=4,as||(Bt&4194048)!==Bt&&In.current!==null||(qr=!0),(os&134217727)===0&&(Ys&134217727)===0||ee===null||us(ee,Bt,Un,!1)}function yd(i,r,c){var h=zt;zt|=2;var p=ky(),y=Py();(ee!==i||Bt!==r)&&(mc=null,Yr(i,r)),r=!1;var T=ye;t:do try{if(Ht!==0&&Mt!==null){var M=Mt,N=Sn;switch(Ht){case 8:pd(),T=6;break t;case 3:case 2:case 9:case 6:In.current===null&&(r=!0);var G=Ht;if(Ht=0,Sn=null,Wr(i,M,N,G),c&&qr){T=0;break t}break;default:G=Ht,Ht=0,Sn=null,Wr(i,M,N,G)}}iA(),T=ye;break}catch(K){My(i,K)}while(!0);return r&&i.shellSuspendCounter++,Oi=Hs=null,zt=h,B.H=p,B.A=y,Mt===null&&(ee=null,Bt=0,Ul()),T}function iA(){for(;Mt!==null;)Ny(Mt)}function sA(i,r){var c=zt;zt|=2;var h=ky(),p=Py();ee!==i||Bt!==r?(mc=null,pc=Ee()+500,Yr(i,r)):qr=Ms(i,r);t:do try{if(Ht!==0&&Mt!==null){r=Mt;var y=Sn;e:switch(Ht){case 1:Ht=0,Sn=null,Wr(i,r,y,1);break;case 2:case 9:if(Vp(y)){Ht=0,Sn=null,Ly(r);break}r=function(){Ht!==2&&Ht!==9||ee!==i||(Ht=7),di(i)},y.then(r,r);break t;case 3:Ht=7;break t;case 4:Ht=5;break t;case 7:Vp(y)?(Ht=0,Sn=null,Ly(r)):(Ht=0,Sn=null,Wr(i,r,y,7));break;case 5:var T=null;switch(Mt.tag){case 26:T=Mt.memoizedState;case 5:case 27:var M=Mt;if(!T||mv(T)){Ht=0,Sn=null;var N=M.sibling;if(N!==null)Mt=N;else{var G=M.return;G!==null?(Mt=G,vc(G)):Mt=null}break e}}Ht=0,Sn=null,Wr(i,r,y,5);break;case 6:Ht=0,Sn=null,Wr(i,r,y,6);break;case 8:pd(),ye=6;break t;default:throw Error(n(462))}}rA();break}catch(K){My(i,K)}while(!0);return Oi=Hs=null,B.H=h,B.A=p,zt=c,Mt!==null?0:(ee=null,Bt=0,Ul(),ye)}function rA(){for(;Mt!==null&&!Jt();)Ny(Mt)}function Ny(i){var r=oy(i.alternate,i,Ii);i.memoizedProps=i.pendingProps,r===null?vc(i):Mt=r}function Ly(i){var r=i,c=r.alternate;switch(r.tag){case 15:case 0:r=ey(c,r,r.pendingProps,r.type,void 0,Bt);break;case 11:r=ey(c,r,r.pendingProps,r.type.render,r.ref,Bt);break;case 5:kh(r);default:cy(c,r),r=Mt=Bp(r,Ii),r=oy(c,r,Ii)}i.memoizedProps=i.pendingProps,r===null?vc(i):Mt=r}function Wr(i,r,c,h){Oi=Hs=null,kh(r),Fr=null,oo=0;var p=r.return;try{if(YS(i,p,r,c,Bt)){ye=1,cc(i,Nn(c,i.current)),Mt=null;return}}catch(y){if(p!==null)throw Mt=p,y;ye=1,cc(i,Nn(c,i.current)),Mt=null;return}r.flags&32768?(Ut||h===1?i=!0:qr||(Bt&536870912)!==0?i=!1:(as=i=!0,(h===2||h===9||h===3||h===6)&&(h=In.current,h!==null&&h.tag===13&&(h.flags|=16384))),By(r,i)):vc(r)}function vc(i){var r=i;do{if((r.flags&32768)!==0){By(r,as);return}i=r.return;var c=KS(r.alternate,r,Ii);if(c!==null){Mt=c;return}if(r=r.sibling,r!==null){Mt=r;return}Mt=r=i}while(r!==null);ye===0&&(ye=5)}function By(i,r){do{var c=QS(i.alternate,i);if(c!==null){c.flags&=32767,Mt=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!r&&(i=i.sibling,i!==null)){Mt=i;return}Mt=i=c}while(i!==null);ye=6,Mt=null}function jy(i,r,c,h,p,y,T,M,N){i.cancelPendingCommit=null;do bc();while(He!==0);if((zt&6)!==0)throw Error(n(327));if(r!==null){if(r===i.current)throw Error(n(177));if(y=r.lanes|r.childLanes,y|=oh,nn(i,c,y,T,M,N),i===ee&&(Mt=ee=null,Bt=0),Vr=r,cs=i,Xr=c,dd=y,fd=p,Cy=h,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,cA(on,function(){return Hy(),null})):(i.callbackNode=null,i.callbackPriority=0),h=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||h){h=B.T,B.T=null,p=H.p,H.p=2,T=zt,zt|=4;try{ZS(i,r,c)}finally{zt=T,H.p=p,B.T=h}}He=1,Iy(),Uy(),Fy()}}function Iy(){if(He===1){He=0;var i=cs,r=Vr,c=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||c){c=B.T,B.T=null;var h=H.p;H.p=2;var p=zt;zt|=4;try{wy(r,i);var y=Dd,T=xp(i.containerInfo),M=y.focusedElem,N=y.selectionRange;if(T!==M&&M&&M.ownerDocument&&Tp(M.ownerDocument.documentElement,M)){if(N!==null&&nh(M)){var G=N.start,K=N.end;if(K===void 0&&(K=G),"selectionStart"in M)M.selectionStart=G,M.selectionEnd=Math.min(K,M.value.length);else{var J=M.ownerDocument||document,X=J&&J.defaultView||window;if(X.getSelection){var W=X.getSelection(),_t=M.textContent.length,yt=Math.min(N.start,_t),Vt=N.end===void 0?yt:Math.min(N.end,_t);!W.extend&&yt>Vt&&(T=Vt,Vt=yt,yt=T);var F=Ep(M,yt),I=Ep(M,Vt);if(F&&I&&(W.rangeCount!==1||W.anchorNode!==F.node||W.anchorOffset!==F.offset||W.focusNode!==I.node||W.focusOffset!==I.offset)){var $=J.createRange();$.setStart(F.node,F.offset),W.removeAllRanges(),yt>Vt?(W.addRange($),W.extend(I.node,I.offset)):($.setEnd(I.node,I.offset),W.addRange($))}}}}for(J=[],W=M;W=W.parentNode;)W.nodeType===1&&J.push({element:W,left:W.scrollLeft,top:W.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<J.length;M++){var Z=J[M];Z.element.scrollLeft=Z.left,Z.element.scrollTop=Z.top}}Mc=!!Rd,Dd=Rd=null}finally{zt=p,H.p=h,B.T=c}}i.current=r,He=2}}function Uy(){if(He===2){He=0;var i=cs,r=Vr,c=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||c){c=B.T,B.T=null;var h=H.p;H.p=2;var p=zt;zt|=4;try{my(i,r.alternate,r)}finally{zt=p,H.p=h,B.T=c}}He=3}}function Fy(){if(He===4||He===3){He=0,Yt();var i=cs,r=Vr,c=Xr,h=Cy;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?He=5:(He=0,Vr=cs=null,zy(i,i.pendingLanes));var p=i.pendingLanes;if(p===0&&(ls=null),Fe(c),r=r.stateNode,Ft&&typeof Ft.onCommitFiberRoot=="function")try{Ft.onCommitFiberRoot(Si,r,void 0,(r.current.flags&128)===128)}catch{}if(h!==null){r=B.T,p=H.p,H.p=2,B.T=null;try{for(var y=i.onRecoverableError,T=0;T<h.length;T++){var M=h[T];y(M.value,{componentStack:M.stack})}}finally{B.T=r,H.p=p}}(Xr&3)!==0&&bc(),di(i),p=i.pendingLanes,(c&4194090)!==0&&(p&42)!==0?i===gd?yo++:(yo=0,gd=i):yo=0,vo(0)}}function zy(i,r){(i.pooledCacheLanes&=r)===0&&(r=i.pooledCache,r!=null&&(i.pooledCache=null,Ka(r)))}function bc(i){return Iy(),Uy(),Fy(),Hy()}function Hy(){if(He!==5)return!1;var i=cs,r=dd;dd=0;var c=Fe(Xr),h=B.T,p=H.p;try{H.p=32>c?32:c,B.T=null,c=fd,fd=null;var y=cs,T=Xr;if(He=0,Vr=cs=null,Xr=0,(zt&6)!==0)throw Error(n(331));var M=zt;if(zt|=4,Ty(y.current),Sy(y,y.current,T,c),zt=M,vo(0,!1),Ft&&typeof Ft.onPostCommitFiberRoot=="function")try{Ft.onPostCommitFiberRoot(Si,y)}catch{}return!0}finally{H.p=p,B.T=h,zy(i,r)}}function $y(i,r,c){r=Nn(c,r),r=Vh(i.stateNode,r,2),i=Ji(i,r,2),i!==null&&(pe(i,2),di(i))}function Wt(i,r,c){if(i.tag===3)$y(i,i,c);else for(;r!==null;){if(r.tag===3){$y(r,i,c);break}else if(r.tag===1){var h=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ls===null||!ls.has(h))){i=Nn(c,i),c=Xm(2),h=Ji(r,c,2),h!==null&&(Ym(c,h,r,i),pe(h,2),di(h));break}}r=r.return}}function vd(i,r,c){var h=i.pingCache;if(h===null){h=i.pingCache=new eA;var p=new Set;h.set(r,p)}else p=h.get(r),p===void 0&&(p=new Set,h.set(r,p));p.has(c)||(ld=!0,p.add(c),i=aA.bind(null,i,r,c),r.then(i,i))}function aA(i,r,c){var h=i.pingCache;h!==null&&h.delete(r),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,ee===i&&(Bt&c)===c&&(ye===4||ye===3&&(Bt&62914560)===Bt&&300>Ee()-hd?(zt&2)===0&&Yr(i,0):cd|=c,Gr===Bt&&(Gr=0)),di(i)}function qy(i,r){r===0&&(r=Cl()),i=Or(i,r),i!==null&&(pe(i,r),di(i))}function oA(i){var r=i.memoizedState,c=0;r!==null&&(c=r.retryLane),qy(i,c)}function lA(i,r){var c=0;switch(i.tag){case 13:var h=i.stateNode,p=i.memoizedState;p!==null&&(c=p.retryLane);break;case 19:h=i.stateNode;break;case 22:h=i.stateNode._retryCache;break;default:throw Error(n(314))}h!==null&&h.delete(r),qy(i,c)}function cA(i,r){return Dt(i,r)}var wc=null,Kr=null,bd=!1,_c=!1,wd=!1,Ws=0;function di(i){i!==Kr&&i.next===null&&(Kr===null?wc=Kr=i:Kr=Kr.next=i),_c=!0,bd||(bd=!0,hA())}function vo(i,r){if(!wd&&_c){wd=!0;do for(var c=!1,h=wc;h!==null;){if(i!==0){var p=h.pendingLanes;if(p===0)var y=0;else{var T=h.suspendedLanes,M=h.pingedLanes;y=(1<<31-$t(42|i)+1)-1,y&=p&~(T&~M),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(c=!0,Yy(h,y))}else y=Bt,y=Os(h,h===ee?y:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(y&3)===0||Ms(h,y)||(c=!0,Yy(h,y));h=h.next}while(c);wd=!1}}function uA(){Gy()}function Gy(){_c=bd=!1;var i=0;Ws!==0&&(bA()&&(i=Ws),Ws=0);for(var r=Ee(),c=null,h=wc;h!==null;){var p=h.next,y=Vy(h,r);y===0?(h.next=null,c===null?wc=p:c.next=p,p===null&&(Kr=c)):(c=h,(i!==0||(y&3)!==0)&&(_c=!0)),h=p}vo(i)}function Vy(i,r){for(var c=i.suspendedLanes,h=i.pingedLanes,p=i.expirationTimes,y=i.pendingLanes&-62914561;0<y;){var T=31-$t(y),M=1<<T,N=p[T];N===-1?((M&c)===0||(M&h)!==0)&&(p[T]=Tl(M,r)):N<=r&&(i.expiredLanes|=M),y&=~M}if(r=ee,c=Bt,c=Os(i,i===r?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h=i.callbackNode,c===0||i===r&&(Ht===2||Ht===9)||i.cancelPendingCommit!==null)return h!==null&&h!==null&&Pt(h),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||Ms(i,c)){if(r=c&-c,r===i.callbackPriority)return r;switch(h!==null&&Pt(h),Fe(c)){case 2:case 8:c=mn;break;case 32:c=on;break;case 268435456:c=Ds;break;default:c=on}return h=Xy.bind(null,i),c=Dt(c,h),i.callbackPriority=r,i.callbackNode=c,r}return h!==null&&h!==null&&Pt(h),i.callbackPriority=2,i.callbackNode=null,2}function Xy(i,r){if(He!==0&&He!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(bc()&&i.callbackNode!==c)return null;var h=Bt;return h=Os(i,i===ee?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),h===0?null:(Dy(i,h,r),Vy(i,Ee()),i.callbackNode!=null&&i.callbackNode===c?Xy.bind(null,i):null)}function Yy(i,r){if(bc())return null;Dy(i,r,!0)}function hA(){_A(function(){(zt&6)!==0?Dt(ri,uA):Gy()})}function _d(){return Ws===0&&(Ws=xl()),Ws}function Wy(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:kl(""+i)}function Ky(i,r){var c=r.ownerDocument.createElement("input");return c.name=r.name,c.value=r.value,i.id&&c.setAttribute("form",i.id),r.parentNode.insertBefore(c,r),i=new FormData(i),c.parentNode.removeChild(c),i}function dA(i,r,c,h,p){if(r==="submit"&&c&&c.stateNode===p){var y=Wy((p[se]||null).action),T=h.submitter;T&&(r=(r=T[se]||null)?Wy(r.formAction):T.getAttribute("formAction"),r!==null&&(y=r,T=null));var M=new Bl("action","action",null,h,p);i.push({event:M,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Ws!==0){var N=T?Ky(p,T):new FormData(p);zh(c,{pending:!0,data:N,method:p.method,action:y},null,N)}}else typeof y=="function"&&(M.preventDefault(),N=T?Ky(p,T):new FormData(p),zh(c,{pending:!0,data:N,method:p.method,action:y},y,N))},currentTarget:p}]})}}for(var Sd=0;Sd<ah.length;Sd++){var Ad=ah[Sd],fA=Ad.toLowerCase(),gA=Ad[0].toUpperCase()+Ad.slice(1);Wn(fA,"on"+gA)}Wn(Dp,"onAnimationEnd"),Wn(Op,"onAnimationIteration"),Wn(Mp,"onAnimationStart"),Wn("dblclick","onDoubleClick"),Wn("focusin","onFocus"),Wn("focusout","onBlur"),Wn(MS,"onTransitionRun"),Wn(kS,"onTransitionStart"),Wn(PS,"onTransitionCancel"),Wn(kp,"onTransitionEnd"),wr("onMouseEnter",["mouseout","mouseover"]),wr("onMouseLeave",["mouseout","mouseover"]),wr("onPointerEnter",["pointerout","pointerover"]),wr("onPointerLeave",["pointerout","pointerover"]),Ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ps("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(bo));function Qy(i,r){r=(r&4)!==0;for(var c=0;c<i.length;c++){var h=i[c],p=h.event;h=h.listeners;t:{var y=void 0;if(r)for(var T=h.length-1;0<=T;T--){var M=h[T],N=M.instance,G=M.currentTarget;if(M=M.listener,N!==y&&p.isPropagationStopped())break t;y=M,p.currentTarget=G;try{y(p)}catch(K){lc(K)}p.currentTarget=null,y=N}else for(T=0;T<h.length;T++){if(M=h[T],N=M.instance,G=M.currentTarget,M=M.listener,N!==y&&p.isPropagationStopped())break t;y=M,p.currentTarget=G;try{y(p)}catch(K){lc(K)}p.currentTarget=null,y=N}}}}function kt(i,r){var c=r[Ai];c===void 0&&(c=r[Ai]=new Set);var h=i+"__bubble";c.has(h)||(Zy(r,i,2,!1),c.add(h))}function Ed(i,r,c){var h=0;r&&(h|=4),Zy(c,i,h,r)}var Sc="_reactListening"+Math.random().toString(36).slice(2);function Td(i){if(!i[Sc]){i[Sc]=!0,Gg.forEach(function(c){c!=="selectionchange"&&(pA.has(c)||Ed(c,!1,i),Ed(c,!0,i))});var r=i.nodeType===9?i:i.ownerDocument;r===null||r[Sc]||(r[Sc]=!0,Ed("selectionchange",!1,r))}}function Zy(i,r,c,h){switch(Sv(r)){case 2:var p=HA;break;case 8:p=$A;break;default:p=Ud}c=p.bind(null,r,c,i),p=void 0,!Xu||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(p=!0),h?p!==void 0?i.addEventListener(r,c,{capture:!0,passive:p}):i.addEventListener(r,c,!0):p!==void 0?i.addEventListener(r,c,{passive:p}):i.addEventListener(r,c,!1)}function xd(i,r,c,h,p){var y=h;if((r&1)===0&&(r&2)===0&&h!==null)t:for(;;){if(h===null)return;var T=h.tag;if(T===3||T===4){var M=h.stateNode.containerInfo;if(M===p)break;if(T===4)for(T=h.return;T!==null;){var N=T.tag;if((N===3||N===4)&&T.stateNode.containerInfo===p)return;T=T.return}for(;M!==null;){if(T=yr(M),T===null)return;if(N=T.tag,N===5||N===6||N===26||N===27){h=y=T;continue t}M=M.parentNode}}h=h.return}rp(function(){var G=y,K=Gu(c),J=[];t:{var X=Pp.get(i);if(X!==void 0){var W=Bl,_t=i;switch(i){case"keypress":if(Nl(c)===0)break t;case"keydown":case"keyup":W=cS;break;case"focusin":_t="focus",W=Qu;break;case"focusout":_t="blur",W=Qu;break;case"beforeblur":case"afterblur":W=Qu;break;case"click":if(c.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":W=lp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":W=Q_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":W=dS;break;case Dp:case Op:case Mp:W=tS;break;case kp:W=gS;break;case"scroll":case"scrollend":W=W_;break;case"wheel":W=mS;break;case"copy":case"cut":case"paste":W=nS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":W=up;break;case"toggle":case"beforetoggle":W=vS}var yt=(r&4)!==0,Vt=!yt&&(i==="scroll"||i==="scrollend"),F=yt?X!==null?X+"Capture":null:X;yt=[];for(var I=G,$;I!==null;){var Z=I;if($=Z.stateNode,Z=Z.tag,Z!==5&&Z!==26&&Z!==27||$===null||F===null||(Z=ja(I,F),Z!=null&&yt.push(wo(I,Z,$))),Vt)break;I=I.return}0<yt.length&&(X=new W(X,_t,null,c,K),J.push({event:X,listeners:yt}))}}if((r&7)===0){t:{if(X=i==="mouseover"||i==="pointerover",W=i==="mouseout"||i==="pointerout",X&&c!==qu&&(_t=c.relatedTarget||c.fromElement)&&(yr(_t)||_t[Ye]))break t;if((W||X)&&(X=K.window===K?K:(X=K.ownerDocument)?X.defaultView||X.parentWindow:window,W?(_t=c.relatedTarget||c.toElement,W=G,_t=_t?yr(_t):null,_t!==null&&(Vt=a(_t),yt=_t.tag,_t!==Vt||yt!==5&&yt!==27&&yt!==6)&&(_t=null)):(W=null,_t=G),W!==_t)){if(yt=lp,Z="onMouseLeave",F="onMouseEnter",I="mouse",(i==="pointerout"||i==="pointerover")&&(yt=up,Z="onPointerLeave",F="onPointerEnter",I="pointer"),Vt=W==null?X:Ba(W),$=_t==null?X:Ba(_t),X=new yt(Z,I+"leave",W,c,K),X.target=Vt,X.relatedTarget=$,Z=null,yr(K)===G&&(yt=new yt(F,I+"enter",_t,c,K),yt.target=$,yt.relatedTarget=Vt,Z=yt),Vt=Z,W&&_t)e:{for(yt=W,F=_t,I=0,$=yt;$;$=Qr($))I++;for($=0,Z=F;Z;Z=Qr(Z))$++;for(;0<I-$;)yt=Qr(yt),I--;for(;0<$-I;)F=Qr(F),$--;for(;I--;){if(yt===F||F!==null&&yt===F.alternate)break e;yt=Qr(yt),F=Qr(F)}yt=null}else yt=null;W!==null&&Jy(J,X,W,yt,!1),_t!==null&&Vt!==null&&Jy(J,Vt,_t,yt,!0)}}t:{if(X=G?Ba(G):window,W=X.nodeName&&X.nodeName.toLowerCase(),W==="select"||W==="input"&&X.type==="file")var ht=vp;else if(mp(X))if(bp)ht=RS;else{ht=xS;var Ot=TS}else W=X.nodeName,!W||W.toLowerCase()!=="input"||X.type!=="checkbox"&&X.type!=="radio"?G&&$u(G.elementType)&&(ht=vp):ht=CS;if(ht&&(ht=ht(i,G))){yp(J,ht,c,K);break t}Ot&&Ot(i,X,G),i==="focusout"&&G&&X.type==="number"&&G.memoizedProps.value!=null&&Hu(X,"number",X.value)}switch(Ot=G?Ba(G):window,i){case"focusin":(mp(Ot)||Ot.contentEditable==="true")&&(Cr=Ot,ih=G,Ga=null);break;case"focusout":Ga=ih=Cr=null;break;case"mousedown":sh=!0;break;case"contextmenu":case"mouseup":case"dragend":sh=!1,Cp(J,c,K);break;case"selectionchange":if(OS)break;case"keydown":case"keyup":Cp(J,c,K)}var gt;if(Ju)t:{switch(i){case"compositionstart":var bt="onCompositionStart";break t;case"compositionend":bt="onCompositionEnd";break t;case"compositionupdate":bt="onCompositionUpdate";break t}bt=void 0}else xr?gp(i,c)&&(bt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(bt="onCompositionStart");bt&&(hp&&c.locale!=="ko"&&(xr||bt!=="onCompositionStart"?bt==="onCompositionEnd"&&xr&&(gt=ap()):(Wi=K,Yu="value"in Wi?Wi.value:Wi.textContent,xr=!0)),Ot=Ac(G,bt),0<Ot.length&&(bt=new cp(bt,i,null,c,K),J.push({event:bt,listeners:Ot}),gt?bt.data=gt:(gt=pp(c),gt!==null&&(bt.data=gt)))),(gt=wS?_S(i,c):SS(i,c))&&(bt=Ac(G,"onBeforeInput"),0<bt.length&&(Ot=new cp("onBeforeInput","beforeinput",null,c,K),J.push({event:Ot,listeners:bt}),Ot.data=gt)),dA(J,i,G,c,K)}Qy(J,r)})}function wo(i,r,c){return{instance:i,listener:r,currentTarget:c}}function Ac(i,r){for(var c=r+"Capture",h=[];i!==null;){var p=i,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=ja(i,c),p!=null&&h.unshift(wo(i,p,y)),p=ja(i,r),p!=null&&h.push(wo(i,p,y))),i.tag===3)return h;i=i.return}return[]}function Qr(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Jy(i,r,c,h,p){for(var y=r._reactName,T=[];c!==null&&c!==h;){var M=c,N=M.alternate,G=M.stateNode;if(M=M.tag,N!==null&&N===h)break;M!==5&&M!==26&&M!==27||G===null||(N=G,p?(G=ja(c,y),G!=null&&T.unshift(wo(c,G,N))):p||(G=ja(c,y),G!=null&&T.push(wo(c,G,N)))),c=c.return}T.length!==0&&i.push({event:r,listeners:T})}var mA=/\r\n?/g,yA=/\u0000|\uFFFD/g;function tv(i){return(typeof i=="string"?i:""+i).replace(mA,`
`).replace(yA,"")}function ev(i,r){return r=tv(r),tv(i)===r}function Ec(){}function Gt(i,r,c,h,p,y){switch(c){case"children":typeof h=="string"?r==="body"||r==="textarea"&&h===""||Ar(i,h):(typeof h=="number"||typeof h=="bigint")&&r!=="body"&&Ar(i,""+h);break;case"className":Dl(i,"class",h);break;case"tabIndex":Dl(i,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Dl(i,c,h);break;case"style":ip(i,h,y);break;case"data":if(r!=="object"){Dl(i,"data",h);break}case"src":case"href":if(h===""&&(r!=="a"||c!=="href")){i.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(c);break}h=kl(""+h),i.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(c==="formAction"?(r!=="input"&&Gt(i,r,"name",p.name,p,null),Gt(i,r,"formEncType",p.formEncType,p,null),Gt(i,r,"formMethod",p.formMethod,p,null),Gt(i,r,"formTarget",p.formTarget,p,null)):(Gt(i,r,"encType",p.encType,p,null),Gt(i,r,"method",p.method,p,null),Gt(i,r,"target",p.target,p,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){i.removeAttribute(c);break}h=kl(""+h),i.setAttribute(c,h);break;case"onClick":h!=null&&(i.onclick=Ec);break;case"onScroll":h!=null&&kt("scroll",i);break;case"onScrollEnd":h!=null&&kt("scrollend",i);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(p.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"multiple":i.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":i.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){i.removeAttribute("xlink:href");break}c=kl(""+h),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,""+h):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":h===!0?i.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?i.setAttribute(c,h):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?i.setAttribute(c,h):i.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?i.removeAttribute(c):i.setAttribute(c,h);break;case"popover":kt("beforetoggle",i),kt("toggle",i),Rl(i,"popover",h);break;case"xlinkActuate":Ti(i,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Ti(i,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Ti(i,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Ti(i,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Ti(i,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Ti(i,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Ti(i,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Ti(i,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Ti(i,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Rl(i,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=X_.get(c)||c,Rl(i,c,h))}}function Cd(i,r,c,h,p,y){switch(c){case"style":ip(i,h,y);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(p.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"children":typeof h=="string"?Ar(i,h):(typeof h=="number"||typeof h=="bigint")&&Ar(i,""+h);break;case"onScroll":h!=null&&kt("scroll",i);break;case"onScrollEnd":h!=null&&kt("scrollend",i);break;case"onClick":h!=null&&(i.onclick=Ec);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Vg.hasOwnProperty(c))t:{if(c[0]==="o"&&c[1]==="n"&&(p=c.endsWith("Capture"),r=c.slice(2,p?c.length-7:void 0),y=i[se]||null,y=y!=null?y[c]:null,typeof y=="function"&&i.removeEventListener(r,y,p),typeof h=="function")){typeof y!="function"&&y!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(r,h,p);break t}c in i?i[c]=h:h===!0?i.setAttribute(c,""):Rl(i,c,h)}}}function $e(i,r,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":kt("error",i),kt("load",i);var h=!1,p=!1,y;for(y in c)if(c.hasOwnProperty(y)){var T=c[y];if(T!=null)switch(y){case"src":h=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,r));default:Gt(i,r,y,T,c,null)}}p&&Gt(i,r,"srcSet",c.srcSet,c,null),h&&Gt(i,r,"src",c.src,c,null);return;case"input":kt("invalid",i);var M=y=T=p=null,N=null,G=null;for(h in c)if(c.hasOwnProperty(h)){var K=c[h];if(K!=null)switch(h){case"name":p=K;break;case"type":T=K;break;case"checked":N=K;break;case"defaultChecked":G=K;break;case"value":y=K;break;case"defaultValue":M=K;break;case"children":case"dangerouslySetInnerHTML":if(K!=null)throw Error(n(137,r));break;default:Gt(i,r,h,K,c,null)}}Jg(i,y,M,N,G,T,p,!1),Ol(i);return;case"select":kt("invalid",i),h=T=y=null;for(p in c)if(c.hasOwnProperty(p)&&(M=c[p],M!=null))switch(p){case"value":y=M;break;case"defaultValue":T=M;break;case"multiple":h=M;default:Gt(i,r,p,M,c,null)}r=y,c=T,i.multiple=!!h,r!=null?Sr(i,!!h,r,!1):c!=null&&Sr(i,!!h,c,!0);return;case"textarea":kt("invalid",i),y=p=h=null;for(T in c)if(c.hasOwnProperty(T)&&(M=c[T],M!=null))switch(T){case"value":h=M;break;case"defaultValue":p=M;break;case"children":y=M;break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(n(91));break;default:Gt(i,r,T,M,c,null)}ep(i,h,p,y),Ol(i);return;case"option":for(N in c)if(c.hasOwnProperty(N)&&(h=c[N],h!=null))switch(N){case"selected":i.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Gt(i,r,N,h,c,null)}return;case"dialog":kt("beforetoggle",i),kt("toggle",i),kt("cancel",i),kt("close",i);break;case"iframe":case"object":kt("load",i);break;case"video":case"audio":for(h=0;h<bo.length;h++)kt(bo[h],i);break;case"image":kt("error",i),kt("load",i);break;case"details":kt("toggle",i);break;case"embed":case"source":case"link":kt("error",i),kt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(G in c)if(c.hasOwnProperty(G)&&(h=c[G],h!=null))switch(G){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,r));default:Gt(i,r,G,h,c,null)}return;default:if($u(r)){for(K in c)c.hasOwnProperty(K)&&(h=c[K],h!==void 0&&Cd(i,r,K,h,c,void 0));return}}for(M in c)c.hasOwnProperty(M)&&(h=c[M],h!=null&&Gt(i,r,M,h,c,null))}function vA(i,r,c,h){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,T=null,M=null,N=null,G=null,K=null;for(W in c){var J=c[W];if(c.hasOwnProperty(W)&&J!=null)switch(W){case"checked":break;case"value":break;case"defaultValue":N=J;default:h.hasOwnProperty(W)||Gt(i,r,W,null,h,J)}}for(var X in h){var W=h[X];if(J=c[X],h.hasOwnProperty(X)&&(W!=null||J!=null))switch(X){case"type":y=W;break;case"name":p=W;break;case"checked":G=W;break;case"defaultChecked":K=W;break;case"value":T=W;break;case"defaultValue":M=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(n(137,r));break;default:W!==J&&Gt(i,r,X,W,h,J)}}zu(i,T,M,N,G,K,y,p);return;case"select":W=T=M=X=null;for(y in c)if(N=c[y],c.hasOwnProperty(y)&&N!=null)switch(y){case"value":break;case"multiple":W=N;default:h.hasOwnProperty(y)||Gt(i,r,y,null,h,N)}for(p in h)if(y=h[p],N=c[p],h.hasOwnProperty(p)&&(y!=null||N!=null))switch(p){case"value":X=y;break;case"defaultValue":M=y;break;case"multiple":T=y;default:y!==N&&Gt(i,r,p,y,h,N)}r=M,c=T,h=W,X!=null?Sr(i,!!c,X,!1):!!h!=!!c&&(r!=null?Sr(i,!!c,r,!0):Sr(i,!!c,c?[]:"",!1));return;case"textarea":W=X=null;for(M in c)if(p=c[M],c.hasOwnProperty(M)&&p!=null&&!h.hasOwnProperty(M))switch(M){case"value":break;case"children":break;default:Gt(i,r,M,null,h,p)}for(T in h)if(p=h[T],y=c[T],h.hasOwnProperty(T)&&(p!=null||y!=null))switch(T){case"value":X=p;break;case"defaultValue":W=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(n(91));break;default:p!==y&&Gt(i,r,T,p,h,y)}tp(i,X,W);return;case"option":for(var _t in c)if(X=c[_t],c.hasOwnProperty(_t)&&X!=null&&!h.hasOwnProperty(_t))switch(_t){case"selected":i.selected=!1;break;default:Gt(i,r,_t,null,h,X)}for(N in h)if(X=h[N],W=c[N],h.hasOwnProperty(N)&&X!==W&&(X!=null||W!=null))switch(N){case"selected":i.selected=X&&typeof X!="function"&&typeof X!="symbol";break;default:Gt(i,r,N,X,h,W)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var yt in c)X=c[yt],c.hasOwnProperty(yt)&&X!=null&&!h.hasOwnProperty(yt)&&Gt(i,r,yt,null,h,X);for(G in h)if(X=h[G],W=c[G],h.hasOwnProperty(G)&&X!==W&&(X!=null||W!=null))switch(G){case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(n(137,r));break;default:Gt(i,r,G,X,h,W)}return;default:if($u(r)){for(var Vt in c)X=c[Vt],c.hasOwnProperty(Vt)&&X!==void 0&&!h.hasOwnProperty(Vt)&&Cd(i,r,Vt,void 0,h,X);for(K in h)X=h[K],W=c[K],!h.hasOwnProperty(K)||X===W||X===void 0&&W===void 0||Cd(i,r,K,X,h,W);return}}for(var F in c)X=c[F],c.hasOwnProperty(F)&&X!=null&&!h.hasOwnProperty(F)&&Gt(i,r,F,null,h,X);for(J in h)X=h[J],W=c[J],!h.hasOwnProperty(J)||X===W||X==null&&W==null||Gt(i,r,J,X,h,W)}var Rd=null,Dd=null;function Tc(i){return i.nodeType===9?i:i.ownerDocument}function nv(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function iv(i,r){if(i===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&r==="foreignObject"?0:i}function Od(i,r){return i==="textarea"||i==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Md=null;function bA(){var i=window.event;return i&&i.type==="popstate"?i===Md?!1:(Md=i,!0):(Md=null,!1)}var sv=typeof setTimeout=="function"?setTimeout:void 0,wA=typeof clearTimeout=="function"?clearTimeout:void 0,rv=typeof Promise=="function"?Promise:void 0,_A=typeof queueMicrotask=="function"?queueMicrotask:typeof rv<"u"?function(i){return rv.resolve(null).then(i).catch(SA)}:sv;function SA(i){setTimeout(function(){throw i})}function hs(i){return i==="head"}function av(i,r){var c=r,h=0,p=0;do{var y=c.nextSibling;if(i.removeChild(c),y&&y.nodeType===8)if(c=y.data,c==="/$"){if(0<h&&8>h){c=h;var T=i.ownerDocument;if(c&1&&_o(T.documentElement),c&2&&_o(T.body),c&4)for(c=T.head,_o(c),T=c.firstChild;T;){var M=T.nextSibling,N=T.nodeName;T[Ei]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&T.rel.toLowerCase()==="stylesheet"||c.removeChild(T),T=M}}if(p===0){i.removeChild(y),Do(r);return}p--}else c==="$"||c==="$?"||c==="$!"?p++:h=c.charCodeAt(0)-48;else h=0;c=y}while(c);Do(r)}function kd(i){var r=i.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var c=r;switch(r=r.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":kd(c),ju(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function AA(i,r,c,h){for(;i.nodeType===1;){var p=c;if(i.nodeName.toLowerCase()!==r.toLowerCase()){if(!h&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(h){if(!i[Ei])switch(r){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(y=i.getAttribute("rel"),y==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(y!==p.rel||i.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||i.getAttribute("title")!==(p.title==null?null:p.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(y=i.getAttribute("src"),(y!==(p.src==null?null:p.src)||i.getAttribute("type")!==(p.type==null?null:p.type)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(r==="input"&&i.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&i.getAttribute("name")===y)return i}else return i;if(i=Qn(i.nextSibling),i===null)break}return null}function EA(i,r,c){if(r==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=Qn(i.nextSibling),i===null))return null;return i}function Pd(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function TA(i,r){var c=i.ownerDocument;if(i.data!=="$?"||c.readyState==="complete")r();else{var h=function(){r(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),i._reactRetry=h}}function Qn(i){for(;i!=null;i=i.nextSibling){var r=i.nodeType;if(r===1||r===3)break;if(r===8){if(r=i.data,r==="$"||r==="$!"||r==="$?"||r==="F!"||r==="F")break;if(r==="/$")return null}}return i}var Nd=null;function ov(i){i=i.previousSibling;for(var r=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(r===0)return i;r--}else c==="/$"&&r++}i=i.previousSibling}return null}function lv(i,r,c){switch(r=Tc(c),i){case"html":if(i=r.documentElement,!i)throw Error(n(452));return i;case"head":if(i=r.head,!i)throw Error(n(453));return i;case"body":if(i=r.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function _o(i){for(var r=i.attributes;r.length;)i.removeAttributeNode(r[0]);ju(i)}var Fn=new Map,cv=new Set;function xc(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ui=H.d;H.d={f:xA,r:CA,D:RA,C:DA,L:OA,m:MA,X:PA,S:kA,M:NA};function xA(){var i=Ui.f(),r=yc();return i||r}function CA(i){var r=vr(i);r!==null&&r.tag===5&&r.type==="form"?Dm(r):Ui.r(i)}var Zr=typeof document>"u"?null:document;function uv(i,r,c){var h=Zr;if(h&&typeof r=="string"&&r){var p=Pn(r);p='link[rel="'+i+'"][href="'+p+'"]',typeof c=="string"&&(p+='[crossorigin="'+c+'"]'),cv.has(p)||(cv.add(p),i={rel:i,crossOrigin:c,href:r},h.querySelector(p)===null&&(r=h.createElement("link"),$e(r,"link",i),ke(r),h.head.appendChild(r)))}}function RA(i){Ui.D(i),uv("dns-prefetch",i,null)}function DA(i,r){Ui.C(i,r),uv("preconnect",i,r)}function OA(i,r,c){Ui.L(i,r,c);var h=Zr;if(h&&i&&r){var p='link[rel="preload"][as="'+Pn(r)+'"]';r==="image"&&c&&c.imageSrcSet?(p+='[imagesrcset="'+Pn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(p+='[imagesizes="'+Pn(c.imageSizes)+'"]')):p+='[href="'+Pn(i)+'"]';var y=p;switch(r){case"style":y=Jr(i);break;case"script":y=ta(i)}Fn.has(y)||(i=g({rel:"preload",href:r==="image"&&c&&c.imageSrcSet?void 0:i,as:r},c),Fn.set(y,i),h.querySelector(p)!==null||r==="style"&&h.querySelector(So(y))||r==="script"&&h.querySelector(Ao(y))||(r=h.createElement("link"),$e(r,"link",i),ke(r),h.head.appendChild(r)))}}function MA(i,r){Ui.m(i,r);var c=Zr;if(c&&i){var h=r&&typeof r.as=="string"?r.as:"script",p='link[rel="modulepreload"][as="'+Pn(h)+'"][href="'+Pn(i)+'"]',y=p;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=ta(i)}if(!Fn.has(y)&&(i=g({rel:"modulepreload",href:i},r),Fn.set(y,i),c.querySelector(p)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Ao(y)))return}h=c.createElement("link"),$e(h,"link",i),ke(h),c.head.appendChild(h)}}}function kA(i,r,c){Ui.S(i,r,c);var h=Zr;if(h&&i){var p=br(h).hoistableStyles,y=Jr(i);r=r||"default";var T=p.get(y);if(!T){var M={loading:0,preload:null};if(T=h.querySelector(So(y)))M.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":r},c),(c=Fn.get(y))&&Ld(i,c);var N=T=h.createElement("link");ke(N),$e(N,"link",i),N._p=new Promise(function(G,K){N.onload=G,N.onerror=K}),N.addEventListener("load",function(){M.loading|=1}),N.addEventListener("error",function(){M.loading|=2}),M.loading|=4,Cc(T,r,h)}T={type:"stylesheet",instance:T,count:1,state:M},p.set(y,T)}}}function PA(i,r){Ui.X(i,r);var c=Zr;if(c&&i){var h=br(c).hoistableScripts,p=ta(i),y=h.get(p);y||(y=c.querySelector(Ao(p)),y||(i=g({src:i,async:!0},r),(r=Fn.get(p))&&Bd(i,r),y=c.createElement("script"),ke(y),$e(y,"link",i),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},h.set(p,y))}}function NA(i,r){Ui.M(i,r);var c=Zr;if(c&&i){var h=br(c).hoistableScripts,p=ta(i),y=h.get(p);y||(y=c.querySelector(Ao(p)),y||(i=g({src:i,async:!0,type:"module"},r),(r=Fn.get(p))&&Bd(i,r),y=c.createElement("script"),ke(y),$e(y,"link",i),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},h.set(p,y))}}function hv(i,r,c,h){var p=(p=at.current)?xc(p):null;if(!p)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(r=Jr(c.href),c=br(p).hoistableStyles,h=c.get(r),h||(h={type:"style",instance:null,count:0,state:null},c.set(r,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Jr(c.href);var y=br(p).hoistableStyles,T=y.get(i);if(T||(p=p.ownerDocument||p,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(i,T),(y=p.querySelector(So(i)))&&!y._p&&(T.instance=y,T.state.loading=5),Fn.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Fn.set(i,c),y||LA(p,i,c,T.state))),r&&h===null)throw Error(n(528,""));return T}if(r&&h!==null)throw Error(n(529,""));return null;case"script":return r=c.async,c=c.src,typeof c=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=ta(c),c=br(p).hoistableScripts,h=c.get(r),h||(h={type:"script",instance:null,count:0,state:null},c.set(r,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Jr(i){return'href="'+Pn(i)+'"'}function So(i){return'link[rel="stylesheet"]['+i+"]"}function dv(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function LA(i,r,c,h){i.querySelector('link[rel="preload"][as="style"]['+r+"]")?h.loading=1:(r=i.createElement("link"),h.preload=r,r.addEventListener("load",function(){return h.loading|=1}),r.addEventListener("error",function(){return h.loading|=2}),$e(r,"link",c),ke(r),i.head.appendChild(r))}function ta(i){return'[src="'+Pn(i)+'"]'}function Ao(i){return"script[async]"+i}function fv(i,r,c){if(r.count++,r.instance===null)switch(r.type){case"style":var h=i.querySelector('style[data-href~="'+Pn(c.href)+'"]');if(h)return r.instance=h,ke(h),h;var p=g({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(i.ownerDocument||i).createElement("style"),ke(h),$e(h,"style",p),Cc(h,c.precedence,i),r.instance=h;case"stylesheet":p=Jr(c.href);var y=i.querySelector(So(p));if(y)return r.state.loading|=4,r.instance=y,ke(y),y;h=dv(c),(p=Fn.get(p))&&Ld(h,p),y=(i.ownerDocument||i).createElement("link"),ke(y);var T=y;return T._p=new Promise(function(M,N){T.onload=M,T.onerror=N}),$e(y,"link",h),r.state.loading|=4,Cc(y,c.precedence,i),r.instance=y;case"script":return y=ta(c.src),(p=i.querySelector(Ao(y)))?(r.instance=p,ke(p),p):(h=c,(p=Fn.get(y))&&(h=g({},c),Bd(h,p)),i=i.ownerDocument||i,p=i.createElement("script"),ke(p),$e(p,"link",h),i.head.appendChild(p),r.instance=p);case"void":return null;default:throw Error(n(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(h=r.instance,r.state.loading|=4,Cc(h,c.precedence,i));return r.instance}function Cc(i,r,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=h.length?h[h.length-1]:null,y=p,T=0;T<h.length;T++){var M=h[T];if(M.dataset.precedence===r)y=M;else if(y!==p)break}y?y.parentNode.insertBefore(i,y.nextSibling):(r=c.nodeType===9?c.head:c,r.insertBefore(i,r.firstChild))}function Ld(i,r){i.crossOrigin==null&&(i.crossOrigin=r.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=r.referrerPolicy),i.title==null&&(i.title=r.title)}function Bd(i,r){i.crossOrigin==null&&(i.crossOrigin=r.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=r.referrerPolicy),i.integrity==null&&(i.integrity=r.integrity)}var Rc=null;function gv(i,r,c){if(Rc===null){var h=new Map,p=Rc=new Map;p.set(c,h)}else p=Rc,h=p.get(c),h||(h=new Map,p.set(c,h));if(h.has(i))return h;for(h.set(i,null),c=c.getElementsByTagName(i),p=0;p<c.length;p++){var y=c[p];if(!(y[Ei]||y[ie]||i==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var T=y.getAttribute(r)||"";T=i+T;var M=h.get(T);M?M.push(y):h.set(T,[y])}}return h}function pv(i,r,c){i=i.ownerDocument||i,i.head.insertBefore(c,r==="title"?i.querySelector("head > title"):null)}function BA(i,r,c){if(c===1||r.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return i=r.disabled,typeof r.precedence=="string"&&i==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function mv(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var Eo=null;function jA(){}function IA(i,r,c){if(Eo===null)throw Error(n(475));var h=Eo;if(r.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var p=Jr(c.href),y=i.querySelector(So(p));if(y){i=y._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(h.count++,h=Dc.bind(h),i.then(h,h)),r.state.loading|=4,r.instance=y,ke(y);return}y=i.ownerDocument||i,c=dv(c),(p=Fn.get(p))&&Ld(c,p),y=y.createElement("link"),ke(y);var T=y;T._p=new Promise(function(M,N){T.onload=M,T.onerror=N}),$e(y,"link",c),r.instance=y}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(r,i),(i=r.state.preload)&&(r.state.loading&3)===0&&(h.count++,r=Dc.bind(h),i.addEventListener("load",r),i.addEventListener("error",r))}}function UA(){if(Eo===null)throw Error(n(475));var i=Eo;return i.stylesheets&&i.count===0&&jd(i,i.stylesheets),0<i.count?function(r){var c=setTimeout(function(){if(i.stylesheets&&jd(i,i.stylesheets),i.unsuspend){var h=i.unsuspend;i.unsuspend=null,h()}},6e4);return i.unsuspend=r,function(){i.unsuspend=null,clearTimeout(c)}}:null}function Dc(){if(this.count--,this.count===0){if(this.stylesheets)jd(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Oc=null;function jd(i,r){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Oc=new Map,r.forEach(FA,i),Oc=null,Dc.call(i))}function FA(i,r){if(!(r.state.loading&4)){var c=Oc.get(i);if(c)var h=c.get(null);else{c=new Map,Oc.set(i,c);for(var p=i.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var T=p[y];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(c.set(T.dataset.precedence,T),h=T)}h&&c.set(null,h)}p=r.instance,T=p.getAttribute("data-precedence"),y=c.get(T)||h,y===h&&c.set(null,p),c.set(T,p),this.count++,h=Dc.bind(this),p.addEventListener("load",h),p.addEventListener("error",h),y?y.parentNode.insertBefore(p,y.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(p,i.firstChild)),r.state.loading|=4}}var To={$$typeof:x,Provider:null,Consumer:null,_currentValue:tt,_currentValue2:tt,_threadCount:0};function zA(i,r,c,h,p,y,T,M){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=La(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=La(0),this.hiddenUpdates=La(null),this.identifierPrefix=h,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=M,this.incompleteTransitions=new Map}function yv(i,r,c,h,p,y,T,M,N,G,K,J){return i=new zA(i,r,c,T,M,N,G,J),r=1,y===!0&&(r|=24),y=bn(3,null,null,r),i.current=y,y.stateNode=i,r=vh(),r.refCount++,i.pooledCache=r,r.refCount++,y.memoizedState={element:h,isDehydrated:c,cache:r},Sh(y),i}function vv(i){return i?(i=Mr,i):Mr}function bv(i,r,c,h,p,y){p=vv(p),h.context===null?h.context=p:h.pendingContext=p,h=Zi(r),h.payload={element:c},y=y===void 0?null:y,y!==null&&(h.callback=y),c=Ji(i,h,r),c!==null&&(En(c,i,r),to(c,i,r))}function wv(i,r){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<r?c:r}}function Id(i,r){wv(i,r),(i=i.alternate)&&wv(i,r)}function _v(i){if(i.tag===13){var r=Or(i,67108864);r!==null&&En(r,i,67108864),Id(i,67108864)}}var Mc=!0;function HA(i,r,c,h){var p=B.T;B.T=null;var y=H.p;try{H.p=2,Ud(i,r,c,h)}finally{H.p=y,B.T=p}}function $A(i,r,c,h){var p=B.T;B.T=null;var y=H.p;try{H.p=8,Ud(i,r,c,h)}finally{H.p=y,B.T=p}}function Ud(i,r,c,h){if(Mc){var p=Fd(h);if(p===null)xd(i,r,h,kc,c),Av(i,h);else if(GA(p,i,r,c,h))h.stopPropagation();else if(Av(i,h),r&4&&-1<qA.indexOf(i)){for(;p!==null;){var y=vr(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var T=Xn(y.pendingLanes);if(T!==0){var M=y;for(M.pendingLanes|=2,M.entangledLanes|=2;T;){var N=1<<31-$t(T);M.entanglements[1]|=N,T&=~N}di(y),(zt&6)===0&&(pc=Ee()+500,vo(0))}}break;case 13:M=Or(y,2),M!==null&&En(M,y,2),yc(),Id(y,2)}if(y=Fd(h),y===null&&xd(i,r,h,kc,c),y===p)break;p=y}p!==null&&h.stopPropagation()}else xd(i,r,h,null,c)}}function Fd(i){return i=Gu(i),zd(i)}var kc=null;function zd(i){if(kc=null,i=yr(i),i!==null){var r=a(i);if(r===null)i=null;else{var c=r.tag;if(c===13){if(i=l(r),i!==null)return i;i=null}else if(c===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;i=null}else r!==i&&(i=null)}}return kc=i,null}function Sv(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(si()){case ri:return 2;case mn:return 8;case on:case Gi:return 32;case Ds:return 268435456;default:return 32}default:return 32}}var Hd=!1,ds=null,fs=null,gs=null,xo=new Map,Co=new Map,ps=[],qA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Av(i,r){switch(i){case"focusin":case"focusout":ds=null;break;case"dragenter":case"dragleave":fs=null;break;case"mouseover":case"mouseout":gs=null;break;case"pointerover":case"pointerout":xo.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Co.delete(r.pointerId)}}function Ro(i,r,c,h,p,y){return i===null||i.nativeEvent!==y?(i={blockedOn:r,domEventName:c,eventSystemFlags:h,nativeEvent:y,targetContainers:[p]},r!==null&&(r=vr(r),r!==null&&_v(r)),i):(i.eventSystemFlags|=h,r=i.targetContainers,p!==null&&r.indexOf(p)===-1&&r.push(p),i)}function GA(i,r,c,h,p){switch(r){case"focusin":return ds=Ro(ds,i,r,c,h,p),!0;case"dragenter":return fs=Ro(fs,i,r,c,h,p),!0;case"mouseover":return gs=Ro(gs,i,r,c,h,p),!0;case"pointerover":var y=p.pointerId;return xo.set(y,Ro(xo.get(y)||null,i,r,c,h,p)),!0;case"gotpointercapture":return y=p.pointerId,Co.set(y,Ro(Co.get(y)||null,i,r,c,h,p)),!0}return!1}function Ev(i){var r=yr(i.target);if(r!==null){var c=a(r);if(c!==null){if(r=c.tag,r===13){if(r=l(c),r!==null){i.blockedOn=r,Xi(i.priority,function(){if(c.tag===13){var h=An();h=Xe(h);var p=Or(c,h);p!==null&&En(p,c,h),Id(c,h)}});return}}else if(r===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Pc(i){if(i.blockedOn!==null)return!1;for(var r=i.targetContainers;0<r.length;){var c=Fd(i.nativeEvent);if(c===null){c=i.nativeEvent;var h=new c.constructor(c.type,c);qu=h,c.target.dispatchEvent(h),qu=null}else return r=vr(c),r!==null&&_v(r),i.blockedOn=c,!1;r.shift()}return!0}function Tv(i,r,c){Pc(i)&&c.delete(r)}function VA(){Hd=!1,ds!==null&&Pc(ds)&&(ds=null),fs!==null&&Pc(fs)&&(fs=null),gs!==null&&Pc(gs)&&(gs=null),xo.forEach(Tv),Co.forEach(Tv)}function Nc(i,r){i.blockedOn===r&&(i.blockedOn=null,Hd||(Hd=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,VA)))}var Lc=null;function xv(i){Lc!==i&&(Lc=i,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){Lc===i&&(Lc=null);for(var r=0;r<i.length;r+=3){var c=i[r],h=i[r+1],p=i[r+2];if(typeof h!="function"){if(zd(h||c)===null)continue;break}var y=vr(c);y!==null&&(i.splice(r,3),r-=3,zh(y,{pending:!0,data:p,method:c.method,action:h},h,p))}}))}function Do(i){function r(N){return Nc(N,i)}ds!==null&&Nc(ds,i),fs!==null&&Nc(fs,i),gs!==null&&Nc(gs,i),xo.forEach(r),Co.forEach(r);for(var c=0;c<ps.length;c++){var h=ps[c];h.blockedOn===i&&(h.blockedOn=null)}for(;0<ps.length&&(c=ps[0],c.blockedOn===null);)Ev(c),c.blockedOn===null&&ps.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var p=c[h],y=c[h+1],T=p[se]||null;if(typeof y=="function")T||xv(c);else if(T){var M=null;if(y&&y.hasAttribute("formAction")){if(p=y,T=y[se]||null)M=T.formAction;else if(zd(p)!==null)continue}else M=T.action;typeof M=="function"?c[h+1]=M:(c.splice(h,3),h-=3),xv(c)}}}function $d(i){this._internalRoot=i}Bc.prototype.render=$d.prototype.render=function(i){var r=this._internalRoot;if(r===null)throw Error(n(409));var c=r.current,h=An();bv(c,h,i,r,null,null)},Bc.prototype.unmount=$d.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var r=i.containerInfo;bv(i.current,2,null,i,null,null),yc(),r[Ye]=null}};function Bc(i){this._internalRoot=i}Bc.prototype.unstable_scheduleHydration=function(i){if(i){var r=yn();i={blockedOn:null,target:i,priority:r};for(var c=0;c<ps.length&&r!==0&&r<ps[c].priority;c++);ps.splice(c,0,i),c===0&&Ev(i)}};var Cv=t.version;if(Cv!=="19.1.0")throw Error(n(527,Cv,"19.1.0"));H.findDOMNode=function(i){var r=i._reactInternals;if(r===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=d(r),i=i!==null?f(i):null,i=i===null?null:i.stateNode,i};var XA={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jc.isDisabled&&jc.supportsFiber)try{Si=jc.inject(XA),Ft=jc}catch{}}return Mo.createRoot=function(i,r){if(!s(i))throw Error(n(299));var c=!1,h="",p=$m,y=qm,T=Gm,M=null;return r!=null&&(r.unstable_strictMode===!0&&(c=!0),r.identifierPrefix!==void 0&&(h=r.identifierPrefix),r.onUncaughtError!==void 0&&(p=r.onUncaughtError),r.onCaughtError!==void 0&&(y=r.onCaughtError),r.onRecoverableError!==void 0&&(T=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(M=r.unstable_transitionCallbacks)),r=yv(i,1,!1,null,null,c,h,p,y,T,M,null),i[Ye]=r.current,Td(i),new $d(r)},Mo.hydrateRoot=function(i,r,c){if(!s(i))throw Error(n(299));var h=!1,p="",y=$m,T=qm,M=Gm,N=null,G=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(y=c.onUncaughtError),c.onCaughtError!==void 0&&(T=c.onCaughtError),c.onRecoverableError!==void 0&&(M=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(N=c.unstable_transitionCallbacks),c.formState!==void 0&&(G=c.formState)),r=yv(i,1,!0,r,c??null,h,p,y,T,M,N,G),r.context=vv(null),c=r.current,h=An(),h=Xe(h),p=Zi(h),p.callback=null,Ji(c,p,h),c=h,r.current.lanes=c,pe(r,c),di(r),i[Ye]=r.current,Td(i),new Bc(r)},Mo.version="19.1.0",Mo}var Uv;function nE(){if(Uv)return Xd.exports;Uv=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(t){console.error(t)}}return o(),Xd.exports=eE(),Xd.exports}var iE=nE();function sE({className:o,dataNoPan:t}){return Q.jsx("header",{className:`w-full bg-gray-200 p-4 shadow-md rounded-b-lg flex items-center justify-center ${o||""}`,"data-no-pan":t?"true":void 0,children:Q.jsx("p",{className:"text-xl font-semibold text-gray-700",children:" ()"})})}var Ho=Su();const Au=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ca(o){const t=Object.prototype.toString.call(o);return t==="[object Window]"||t==="[object global]"}function ig(o){return"nodeType"in o}function pn(o){var t,e;return o?Ca(o)?o:ig(o)&&(t=(e=o.ownerDocument)==null?void 0:e.defaultView)!=null?t:window:window}function sg(o){const{Document:t}=pn(o);return o instanceof t}function hl(o){return Ca(o)?!1:o instanceof pn(o).HTMLElement}function C0(o){return o instanceof pn(o).SVGElement}function Ra(o){return o?Ca(o)?o.document:ig(o)?sg(o)?o:hl(o)||C0(o)?o.ownerDocument:document:document:document}const Ts=Au?j.useLayoutEffect:j.useEffect;function rg(o){const t=j.useRef(o);return Ts(()=>{t.current=o}),j.useCallback(function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return t.current==null?void 0:t.current(...n)},[])}function rE(){const o=j.useRef(null),t=j.useCallback((n,s)=>{o.current=setInterval(n,s)},[]),e=j.useCallback(()=>{o.current!==null&&(clearInterval(o.current),o.current=null)},[]);return[t,e]}function ag(o,t){t===void 0&&(t=[o]);const e=j.useRef(o);return Ts(()=>{e.current!==o&&(e.current=o)},t),e}function dl(o,t){const e=j.useRef();return j.useMemo(()=>{const n=o(e.current);return e.current=n,n},[...t])}function Ef(o){const t=rg(o),e=j.useRef(null),n=j.useCallback(s=>{s!==e.current&&t?.(s,e.current),e.current=s},[]);return[e,n]}function Tf(o){const t=j.useRef();return j.useEffect(()=>{t.current=o},[o]),t.current}let Qd={};function og(o,t){return j.useMemo(()=>{if(t)return t;const e=Qd[o]==null?0:Qd[o]+1;return Qd[o]=e,o+"-"+e},[o,t])}function R0(o){return function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),s=1;s<e;s++)n[s-1]=arguments[s];return n.reduce((a,l)=>{const u=Object.entries(l);for(const[d,f]of u){const g=a[d];g!=null&&(a[d]=g+o*f)}return a},{...t})}}const ga=R0(1),cu=R0(-1);function aE(o){return"clientX"in o&&"clientY"in o}function D0(o){if(!o)return!1;const{KeyboardEvent:t}=pn(o.target);return t&&o instanceof t}function oE(o){if(!o)return!1;const{TouchEvent:t}=pn(o.target);return t&&o instanceof t}function xf(o){if(oE(o)){if(o.touches&&o.touches.length){const{clientX:t,clientY:e}=o.touches[0];return{x:t,y:e}}else if(o.changedTouches&&o.changedTouches.length){const{clientX:t,clientY:e}=o.changedTouches[0];return{x:t,y:e}}}return aE(o)?{x:o.clientX,y:o.clientY}:null}const Fv="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function lE(o){return o.matches(Fv)?o:o.querySelector(Fv)}const cE={display:"none"};function uE(o){let{id:t,value:e}=o;return Gn.createElement("div",{id:t,style:cE},e)}function hE(o){let{id:t,announcement:e,ariaLiveType:n="assertive"}=o;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Gn.createElement("div",{id:t,style:s,role:"status","aria-live":n,"aria-atomic":!0},e)}function dE(){const[o,t]=j.useState("");return{announce:j.useCallback(n=>{n!=null&&t(n)},[]),announcement:o}}const O0=j.createContext(null);function fE(o){const t=j.useContext(O0);j.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(o)},[o,t])}function gE(){const[o]=j.useState(()=>new Set),t=j.useCallback(n=>(o.add(n),()=>o.delete(n)),[o]);return[j.useCallback(n=>{let{type:s,event:a}=n;o.forEach(l=>{var u;return(u=l[s])==null?void 0:u.call(l,a)})},[o]),t]}const pE={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},mE={onDragStart(o){let{active:t}=o;return"Picked up draggable item "+t.id+"."},onDragOver(o){let{active:t,over:e}=o;return e?"Draggable item "+t.id+" was moved over droppable area "+e.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(o){let{active:t,over:e}=o;return e?"Draggable item "+t.id+" was dropped over droppable area "+e.id:"Draggable item "+t.id+" was dropped."},onDragCancel(o){let{active:t}=o;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function yE(o){let{announcements:t=mE,container:e,hiddenTextDescribedById:n,screenReaderInstructions:s=pE}=o;const{announce:a,announcement:l}=dE(),u=og("DndLiveRegion"),[d,f]=j.useState(!1);if(j.useEffect(()=>{f(!0)},[]),fE(j.useMemo(()=>({onDragStart(m){let{active:v}=m;a(t.onDragStart({active:v}))},onDragMove(m){let{active:v,over:b}=m;t.onDragMove&&a(t.onDragMove({active:v,over:b}))},onDragOver(m){let{active:v,over:b}=m;a(t.onDragOver({active:v,over:b}))},onDragEnd(m){let{active:v,over:b}=m;a(t.onDragEnd({active:v,over:b}))},onDragCancel(m){let{active:v,over:b}=m;a(t.onDragCancel({active:v,over:b}))}}),[a,t])),!d)return null;const g=Gn.createElement(Gn.Fragment,null,Gn.createElement(uE,{id:n,value:s.draggable}),Gn.createElement(hE,{id:u,announcement:l}));return e?Ho.createPortal(g,e):g}var tn;(function(o){o.DragStart="dragStart",o.DragMove="dragMove",o.DragEnd="dragEnd",o.DragCancel="dragCancel",o.DragOver="dragOver",o.RegisterDroppable="registerDroppable",o.SetDroppableDisabled="setDroppableDisabled",o.UnregisterDroppable="unregisterDroppable"})(tn||(tn={}));function uu(){}function vE(o,t){return j.useMemo(()=>({sensor:o,options:t??{}}),[o,t])}function bE(){for(var o=arguments.length,t=new Array(o),e=0;e<o;e++)t[e]=arguments[e];return j.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const ni=Object.freeze({x:0,y:0});function wE(o,t){let{data:{value:e}}=o,{data:{value:n}}=t;return n-e}function _E(o,t){if(!o||o.length===0)return null;const[e]=o;return e[t]}function SE(o,t){const e=Math.max(t.top,o.top),n=Math.max(t.left,o.left),s=Math.min(t.left+t.width,o.left+o.width),a=Math.min(t.top+t.height,o.top+o.height),l=s-n,u=a-e;if(n<s&&e<a){const d=t.width*t.height,f=o.width*o.height,g=l*u,m=g/(d+f-g);return Number(m.toFixed(4))}return 0}const AE=o=>{let{collisionRect:t,droppableRects:e,droppableContainers:n}=o;const s=[];for(const a of n){const{id:l}=a,u=e.get(l);if(u){const d=SE(u,t);d>0&&s.push({id:l,data:{droppableContainer:a,value:d}})}}return s.sort(wE)};function EE(o,t,e){return{...o,scaleX:t&&e?t.width/e.width:1,scaleY:t&&e?t.height/e.height:1}}function M0(o,t){return o&&t?{x:o.left-t.left,y:o.top-t.top}:ni}function TE(o){return function(e){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return s.reduce((l,u)=>({...l,top:l.top+o*u.y,bottom:l.bottom+o*u.y,left:l.left+o*u.x,right:l.right+o*u.x}),{...e})}}const xE=TE(1);function CE(o){if(o.startsWith("matrix3d(")){const t=o.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(o.startsWith("matrix(")){const t=o.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function RE(o,t,e){const n=CE(t);if(!n)return o;const{scaleX:s,scaleY:a,x:l,y:u}=n,d=o.left-l-(1-s)*parseFloat(e),f=o.top-u-(1-a)*parseFloat(e.slice(e.indexOf(" ")+1)),g=s?o.width/s:o.width,m=a?o.height/a:o.height;return{width:g,height:m,top:f,right:d+g,bottom:f+m,left:d}}const DE={ignoreTransform:!1};function fl(o,t){t===void 0&&(t=DE);let e=o.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:g}=pn(o).getComputedStyle(o);f&&(e=RE(e,f,g))}const{top:n,left:s,width:a,height:l,bottom:u,right:d}=e;return{top:n,left:s,width:a,height:l,bottom:u,right:d}}function zv(o){return fl(o,{ignoreTransform:!0})}function OE(o){const t=o.innerWidth,e=o.innerHeight;return{top:0,left:0,right:t,bottom:e,width:t,height:e}}function ME(o,t){return t===void 0&&(t=pn(o).getComputedStyle(o)),t.position==="fixed"}function kE(o,t){t===void 0&&(t=pn(o).getComputedStyle(o));const e=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const a=t[s];return typeof a=="string"?e.test(a):!1})}function lg(o,t){const e=[];function n(s){if(t!=null&&e.length>=t||!s)return e;if(sg(s)&&s.scrollingElement!=null&&!e.includes(s.scrollingElement))return e.push(s.scrollingElement),e;if(!hl(s)||C0(s)||e.includes(s))return e;const a=pn(o).getComputedStyle(s);return s!==o&&kE(s,a)&&e.push(s),ME(s,a)?e:n(s.parentNode)}return o?n(o):e}function k0(o){const[t]=lg(o,1);return t??null}function Zd(o){return!Au||!o?null:Ca(o)?o:ig(o)?sg(o)||o===Ra(o).scrollingElement?window:hl(o)?o:null:null}function P0(o){return Ca(o)?o.scrollX:o.scrollLeft}function N0(o){return Ca(o)?o.scrollY:o.scrollTop}function Cf(o){return{x:P0(o),y:N0(o)}}var Ie;(function(o){o[o.Forward=1]="Forward",o[o.Backward=-1]="Backward"})(Ie||(Ie={}));function L0(o){return!Au||!o?!1:o===document.scrollingElement}function B0(o){const t={x:0,y:0},e=L0(o)?{height:window.innerHeight,width:window.innerWidth}:{height:o.clientHeight,width:o.clientWidth},n={x:o.scrollWidth-e.width,y:o.scrollHeight-e.height},s=o.scrollTop<=t.y,a=o.scrollLeft<=t.x,l=o.scrollTop>=n.y,u=o.scrollLeft>=n.x;return{isTop:s,isLeft:a,isBottom:l,isRight:u,maxScroll:n,minScroll:t}}const PE={x:.2,y:.2};function NE(o,t,e,n,s){let{top:a,left:l,right:u,bottom:d}=e;n===void 0&&(n=10),s===void 0&&(s=PE);const{isTop:f,isBottom:g,isLeft:m,isRight:v}=B0(o),b={x:0,y:0},S={x:0,y:0},w={height:t.height*s.y,width:t.width*s.x};return!f&&a<=t.top+w.height?(b.y=Ie.Backward,S.y=n*Math.abs((t.top+w.height-a)/w.height)):!g&&d>=t.bottom-w.height&&(b.y=Ie.Forward,S.y=n*Math.abs((t.bottom-w.height-d)/w.height)),!v&&u>=t.right-w.width?(b.x=Ie.Forward,S.x=n*Math.abs((t.right-w.width-u)/w.width)):!m&&l<=t.left+w.width&&(b.x=Ie.Backward,S.x=n*Math.abs((t.left+w.width-l)/w.width)),{direction:b,speed:S}}function LE(o){if(o===document.scrollingElement){const{innerWidth:a,innerHeight:l}=window;return{top:0,left:0,right:a,bottom:l,width:a,height:l}}const{top:t,left:e,right:n,bottom:s}=o.getBoundingClientRect();return{top:t,left:e,right:n,bottom:s,width:o.clientWidth,height:o.clientHeight}}function j0(o){return o.reduce((t,e)=>ga(t,Cf(e)),ni)}function BE(o){return o.reduce((t,e)=>t+P0(e),0)}function jE(o){return o.reduce((t,e)=>t+N0(e),0)}function IE(o,t){if(t===void 0&&(t=fl),!o)return;const{top:e,left:n,bottom:s,right:a}=t(o);k0(o)&&(s<=0||a<=0||e>=window.innerHeight||n>=window.innerWidth)&&o.scrollIntoView({block:"center",inline:"center"})}const UE=[["x",["left","right"],BE],["y",["top","bottom"],jE]];class cg{constructor(t,e){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=lg(e),s=j0(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[a,l,u]of UE)for(const d of l)Object.defineProperty(this,d,{get:()=>{const f=u(n),g=s[a]-f;return this.rect[d]+g},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Xo{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(e=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...e)})},this.target=t}add(t,e,n){var s;(s=this.target)==null||s.addEventListener(t,e,n),this.listeners.push([t,e,n])}}function FE(o){const{EventTarget:t}=pn(o);return o instanceof t?o:Ra(o)}function Jd(o,t){const e=Math.abs(o.x),n=Math.abs(o.y);return typeof t=="number"?Math.sqrt(e**2+n**2)>t:"x"in t&&"y"in t?e>t.x&&n>t.y:"x"in t?e>t.x:"y"in t?n>t.y:!1}var qn;(function(o){o.Click="click",o.DragStart="dragstart",o.Keydown="keydown",o.ContextMenu="contextmenu",o.Resize="resize",o.SelectionChange="selectionchange",o.VisibilityChange="visibilitychange"})(qn||(qn={}));function Hv(o){o.preventDefault()}function zE(o){o.stopPropagation()}var Kt;(function(o){o.Space="Space",o.Down="ArrowDown",o.Right="ArrowRight",o.Left="ArrowLeft",o.Up="ArrowUp",o.Esc="Escape",o.Enter="Enter",o.Tab="Tab"})(Kt||(Kt={}));const I0={start:[Kt.Space,Kt.Enter],cancel:[Kt.Esc],end:[Kt.Space,Kt.Enter,Kt.Tab]},HE=(o,t)=>{let{currentCoordinates:e}=t;switch(o.code){case Kt.Right:return{...e,x:e.x+25};case Kt.Left:return{...e,x:e.x-25};case Kt.Down:return{...e,y:e.y+25};case Kt.Up:return{...e,y:e.y-25}}};class U0{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:e}}=t;this.props=t,this.listeners=new Xo(Ra(e)),this.windowListeners=new Xo(pn(e)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(qn.Resize,this.handleCancel),this.windowListeners.add(qn.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(qn.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:e}=this.props,n=t.node.current;n&&IE(n),e(ni)}handleKeyDown(t){if(D0(t)){const{active:e,context:n,options:s}=this.props,{keyboardCodes:a=I0,coordinateGetter:l=HE,scrollBehavior:u="smooth"}=s,{code:d}=t;if(a.end.includes(d)){this.handleEnd(t);return}if(a.cancel.includes(d)){this.handleCancel(t);return}const{collisionRect:f}=n.current,g=f?{x:f.left,y:f.top}:ni;this.referenceCoordinates||(this.referenceCoordinates=g);const m=l(t,{active:e,context:n.current,currentCoordinates:g});if(m){const v=cu(m,g),b={x:0,y:0},{scrollableAncestors:S}=n.current;for(const w of S){const A=t.code,{isTop:_,isRight:E,isLeft:x,isBottom:O,maxScroll:C,minScroll:D}=B0(w),R=LE(w),k={x:Math.min(A===Kt.Right?R.right-R.width/2:R.right,Math.max(A===Kt.Right?R.left:R.left+R.width/2,m.x)),y:Math.min(A===Kt.Down?R.bottom-R.height/2:R.bottom,Math.max(A===Kt.Down?R.top:R.top+R.height/2,m.y))},L=A===Kt.Right&&!E||A===Kt.Left&&!x,V=A===Kt.Down&&!O||A===Kt.Up&&!_;if(L&&k.x!==m.x){const q=w.scrollLeft+v.x,it=A===Kt.Right&&q<=C.x||A===Kt.Left&&q>=D.x;if(it&&!v.y){w.scrollTo({left:q,behavior:u});return}it?b.x=w.scrollLeft-q:b.x=A===Kt.Right?w.scrollLeft-C.x:w.scrollLeft-D.x,b.x&&w.scrollBy({left:-b.x,behavior:u});break}else if(V&&k.y!==m.y){const q=w.scrollTop+v.y,it=A===Kt.Down&&q<=C.y||A===Kt.Up&&q>=D.y;if(it&&!v.x){w.scrollTo({top:q,behavior:u});return}it?b.y=w.scrollTop-q:b.y=A===Kt.Down?w.scrollTop-C.y:w.scrollTop-D.y,b.y&&w.scrollBy({top:-b.y,behavior:u});break}}this.handleMove(t,ga(cu(m,this.referenceCoordinates),b))}}}handleMove(t,e){const{onMove:n}=this.props;t.preventDefault(),n(e)}handleEnd(t){const{onEnd:e}=this.props;t.preventDefault(),this.detach(),e()}handleCancel(t){const{onCancel:e}=this.props;t.preventDefault(),this.detach(),e()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}U0.activators=[{eventName:"onKeyDown",handler:(o,t,e)=>{let{keyboardCodes:n=I0,onActivation:s}=t,{active:a}=e;const{code:l}=o.nativeEvent;if(n.start.includes(l)){const u=a.activatorNode.current;return u&&o.target!==u?!1:(o.preventDefault(),s?.({event:o.nativeEvent}),!0)}return!1}}];function $v(o){return!!(o&&"distance"in o)}function qv(o){return!!(o&&"delay"in o)}class ug{constructor(t,e,n){var s;n===void 0&&(n=FE(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=e;const{event:a}=t,{target:l}=a;this.props=t,this.events=e,this.document=Ra(l),this.documentListeners=new Xo(this.document),this.listeners=new Xo(n),this.windowListeners=new Xo(pn(l)),this.initialCoordinates=(s=xf(a))!=null?s:ni,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:e,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(qn.Resize,this.handleCancel),this.windowListeners.add(qn.DragStart,Hv),this.windowListeners.add(qn.VisibilityChange,this.handleCancel),this.windowListeners.add(qn.ContextMenu,Hv),this.documentListeners.add(qn.Keydown,this.handleKeydown),e){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(qv(e)){this.timeoutId=setTimeout(this.handleStart,e.delay),this.handlePending(e);return}if($v(e)){this.handlePending(e);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,e){const{active:n,onPending:s}=this.props;s(n,t,this.initialCoordinates,e)}handleStart(){const{initialCoordinates:t}=this,{onStart:e}=this.props;t&&(this.activated=!0,this.documentListeners.add(qn.Click,zE,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(qn.SelectionChange,this.removeTextSelection),e(t))}handleMove(t){var e;const{activated:n,initialCoordinates:s,props:a}=this,{onMove:l,options:{activationConstraint:u}}=a;if(!s)return;const d=(e=xf(t))!=null?e:ni,f=cu(s,d);if(!n&&u){if($v(u)){if(u.tolerance!=null&&Jd(f,u.tolerance))return this.handleCancel();if(Jd(f,u.distance))return this.handleStart()}if(qv(u)&&Jd(f,u.tolerance))return this.handleCancel();this.handlePending(u,f);return}t.cancelable&&t.preventDefault(),l(d)}handleEnd(){const{onAbort:t,onEnd:e}=this.props;this.detach(),this.activated||t(this.props.active),e()}handleCancel(){const{onAbort:t,onCancel:e}=this.props;this.detach(),this.activated||t(this.props.active),e()}handleKeydown(t){t.code===Kt.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const $E={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class F0 extends ug{constructor(t){const{event:e}=t,n=Ra(e.target);super(t,$E,n)}}F0.activators=[{eventName:"onPointerDown",handler:(o,t)=>{let{nativeEvent:e}=o,{onActivation:n}=t;return!e.isPrimary||e.button!==0?!1:(n?.({event:e}),!0)}}];const qE={move:{name:"mousemove"},end:{name:"mouseup"}};var Rf;(function(o){o[o.RightClick=2]="RightClick"})(Rf||(Rf={}));class z0 extends ug{constructor(t){super(t,qE,Ra(t.event.target))}}z0.activators=[{eventName:"onMouseDown",handler:(o,t)=>{let{nativeEvent:e}=o,{onActivation:n}=t;return e.button===Rf.RightClick?!1:(n?.({event:e}),!0)}}];const tf={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class GE extends ug{constructor(t){super(t,tf)}static setup(){return window.addEventListener(tf.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(tf.move.name,t)};function t(){}}}GE.activators=[{eventName:"onTouchStart",handler:(o,t)=>{let{nativeEvent:e}=o,{onActivation:n}=t;const{touches:s}=e;return s.length>1?!1:(n?.({event:e}),!0)}}];var Yo;(function(o){o[o.Pointer=0]="Pointer",o[o.DraggableRect=1]="DraggableRect"})(Yo||(Yo={}));var hu;(function(o){o[o.TreeOrder=0]="TreeOrder",o[o.ReversedTreeOrder=1]="ReversedTreeOrder"})(hu||(hu={}));function VE(o){let{acceleration:t,activator:e=Yo.Pointer,canScroll:n,draggingRect:s,enabled:a,interval:l=5,order:u=hu.TreeOrder,pointerCoordinates:d,scrollableAncestors:f,scrollableAncestorRects:g,delta:m,threshold:v}=o;const b=YE({delta:m,disabled:!a}),[S,w]=rE(),A=j.useRef({x:0,y:0}),_=j.useRef({x:0,y:0}),E=j.useMemo(()=>{switch(e){case Yo.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case Yo.DraggableRect:return s}},[e,s,d]),x=j.useRef(null),O=j.useCallback(()=>{const D=x.current;if(!D)return;const R=A.current.x*_.current.x,k=A.current.y*_.current.y;D.scrollBy(R,k)},[]),C=j.useMemo(()=>u===hu.TreeOrder?[...f].reverse():f,[u,f]);j.useEffect(()=>{if(!a||!f.length||!E){w();return}for(const D of C){if(n?.(D)===!1)continue;const R=f.indexOf(D),k=g[R];if(!k)continue;const{direction:L,speed:V}=NE(D,k,E,t,v);for(const q of["x","y"])b[q][L[q]]||(V[q]=0,L[q]=0);if(V.x>0||V.y>0){w(),x.current=D,S(O,l),A.current=V,_.current=L;return}}A.current={x:0,y:0},_.current={x:0,y:0},w()},[t,O,n,w,a,l,JSON.stringify(E),JSON.stringify(b),S,f,C,g,JSON.stringify(v)])}const XE={x:{[Ie.Backward]:!1,[Ie.Forward]:!1},y:{[Ie.Backward]:!1,[Ie.Forward]:!1}};function YE(o){let{delta:t,disabled:e}=o;const n=Tf(t);return dl(s=>{if(e||!n||!s)return XE;const a={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[Ie.Backward]:s.x[Ie.Backward]||a.x===-1,[Ie.Forward]:s.x[Ie.Forward]||a.x===1},y:{[Ie.Backward]:s.y[Ie.Backward]||a.y===-1,[Ie.Forward]:s.y[Ie.Forward]||a.y===1}}},[e,t,n])}function WE(o,t){const e=t!=null?o.get(t):void 0,n=e?e.node.current:null;return dl(s=>{var a;return t==null?null:(a=n??s)!=null?a:null},[n,t])}function KE(o,t){return j.useMemo(()=>o.reduce((e,n)=>{const{sensor:s}=n,a=s.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,n)}));return[...e,...a]},[]),[o,t])}var el;(function(o){o[o.Always=0]="Always",o[o.BeforeDragging=1]="BeforeDragging",o[o.WhileDragging=2]="WhileDragging"})(el||(el={}));var Df;(function(o){o.Optimized="optimized"})(Df||(Df={}));const Gv=new Map;function QE(o,t){let{dragging:e,dependencies:n,config:s}=t;const[a,l]=j.useState(null),{frequency:u,measure:d,strategy:f}=s,g=j.useRef(o),m=A(),v=ag(m),b=j.useCallback(function(_){_===void 0&&(_=[]),!v.current&&l(E=>E===null?_:E.concat(_.filter(x=>!E.includes(x))))},[v]),S=j.useRef(null),w=dl(_=>{if(m&&!e)return Gv;if(!_||_===Gv||g.current!==o||a!=null){const E=new Map;for(let x of o){if(!x)continue;if(a&&a.length>0&&!a.includes(x.id)&&x.rect.current){E.set(x.id,x.rect.current);continue}const O=x.node.current,C=O?new cg(d(O),O):null;x.rect.current=C,C&&E.set(x.id,C)}return E}return _},[o,a,e,m,d]);return j.useEffect(()=>{g.current=o},[o]),j.useEffect(()=>{m||b()},[e,m]),j.useEffect(()=>{a&&a.length>0&&l(null)},[JSON.stringify(a)]),j.useEffect(()=>{m||typeof u!="number"||S.current!==null||(S.current=setTimeout(()=>{b(),S.current=null},u))},[u,m,b,...n]),{droppableRects:w,measureDroppableContainers:b,measuringScheduled:a!=null};function A(){switch(f){case el.Always:return!1;case el.BeforeDragging:return e;default:return!e}}}function H0(o,t){return dl(e=>o?e||(typeof t=="function"?t(o):o):null,[t,o])}function ZE(o,t){return H0(o,t)}function JE(o){let{callback:t,disabled:e}=o;const n=rg(t),s=j.useMemo(()=>{if(e||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(n)},[n,e]);return j.useEffect(()=>()=>s?.disconnect(),[s]),s}function hg(o){let{callback:t,disabled:e}=o;const n=rg(t),s=j.useMemo(()=>{if(e||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(n)},[e]);return j.useEffect(()=>()=>s?.disconnect(),[s]),s}function tT(o){return new cg(fl(o),o)}function Vv(o,t,e){t===void 0&&(t=tT);const[n,s]=j.useState(null);function a(){s(d=>{if(!o)return null;if(o.isConnected===!1){var f;return(f=d??e)!=null?f:null}const g=t(o);return JSON.stringify(d)===JSON.stringify(g)?d:g})}const l=JE({callback(d){if(o)for(const f of d){const{type:g,target:m}=f;if(g==="childList"&&m instanceof HTMLElement&&m.contains(o)){a();break}}}}),u=hg({callback:a});return Ts(()=>{a(),o?(u?.observe(o),l?.observe(document.body,{childList:!0,subtree:!0})):(u?.disconnect(),l?.disconnect())},[o]),n}function eT(o){const t=H0(o);return M0(o,t)}const Xv=[];function nT(o){const t=j.useRef(o),e=dl(n=>o?n&&n!==Xv&&o&&t.current&&o.parentNode===t.current.parentNode?n:lg(o):Xv,[o]);return j.useEffect(()=>{t.current=o},[o]),e}function iT(o){const[t,e]=j.useState(null),n=j.useRef(o),s=j.useCallback(a=>{const l=Zd(a.target);l&&e(u=>u?(u.set(l,Cf(l)),new Map(u)):null)},[]);return j.useEffect(()=>{const a=n.current;if(o!==a){l(a);const u=o.map(d=>{const f=Zd(d);return f?(f.addEventListener("scroll",s,{passive:!0}),[f,Cf(f)]):null}).filter(d=>d!=null);e(u.length?new Map(u):null),n.current=o}return()=>{l(o),l(a)};function l(u){u.forEach(d=>{const f=Zd(d);f?.removeEventListener("scroll",s)})}},[s,o]),j.useMemo(()=>o.length?t?Array.from(t.values()).reduce((a,l)=>ga(a,l),ni):j0(o):ni,[o,t])}function Yv(o,t){t===void 0&&(t=[]);const e=j.useRef(null);return j.useEffect(()=>{e.current=null},t),j.useEffect(()=>{const n=o!==ni;n&&!e.current&&(e.current=o),!n&&e.current&&(e.current=null)},[o]),e.current?cu(o,e.current):ni}function sT(o){j.useEffect(()=>{if(!Au)return;const t=o.map(e=>{let{sensor:n}=e;return n.setup==null?void 0:n.setup()});return()=>{for(const e of t)e?.()}},o.map(t=>{let{sensor:e}=t;return e}))}function rT(o,t){return j.useMemo(()=>o.reduce((e,n)=>{let{eventName:s,handler:a}=n;return e[s]=l=>{a(l,t)},e},{}),[o,t])}function $0(o){return j.useMemo(()=>o?OE(o):null,[o])}const Wv=[];function aT(o,t){t===void 0&&(t=fl);const[e]=o,n=$0(e?pn(e):null),[s,a]=j.useState(Wv);function l(){a(()=>o.length?o.map(d=>L0(d)?n:new cg(t(d),d)):Wv)}const u=hg({callback:l});return Ts(()=>{u?.disconnect(),l(),o.forEach(d=>u?.observe(d))},[o]),s}function oT(o){if(!o)return null;if(o.children.length>1)return o;const t=o.children[0];return hl(t)?t:o}function lT(o){let{measure:t}=o;const[e,n]=j.useState(null),s=j.useCallback(f=>{for(const{target:g}of f)if(hl(g)){n(m=>{const v=t(g);return m?{...m,width:v.width,height:v.height}:v});break}},[t]),a=hg({callback:s}),l=j.useCallback(f=>{const g=oT(f);a?.disconnect(),g&&a?.observe(g),n(g?t(g):null)},[t,a]),[u,d]=Ef(l);return j.useMemo(()=>({nodeRef:u,rect:e,setRef:d}),[e,u,d])}const cT=[{sensor:F0,options:{}},{sensor:U0,options:{}}],uT={current:{}},au={draggable:{measure:zv},droppable:{measure:zv,strategy:el.WhileDragging,frequency:Df.Optimized},dragOverlay:{measure:fl}};class Wo extends Map{get(t){var e;return t!=null&&(e=super.get(t))!=null?e:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:e}=t;return!e})}getNodeFor(t){var e,n;return(e=(n=this.get(t))==null?void 0:n.node.current)!=null?e:void 0}}const hT={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Wo,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:uu},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:au,measureDroppableContainers:uu,windowRect:null,measuringScheduled:!1},dT={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:uu,draggableNodes:new Map,over:null,measureDroppableContainers:uu},dg=j.createContext(dT),fT=j.createContext(hT);function gT(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Wo}}}function pT(o,t){switch(t.type){case tn.DragStart:return{...o,draggable:{...o.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case tn.DragMove:return o.draggable.active==null?o:{...o,draggable:{...o.draggable,translate:{x:t.coordinates.x-o.draggable.initialCoordinates.x,y:t.coordinates.y-o.draggable.initialCoordinates.y}}};case tn.DragEnd:case tn.DragCancel:return{...o,draggable:{...o.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case tn.RegisterDroppable:{const{element:e}=t,{id:n}=e,s=new Wo(o.droppable.containers);return s.set(n,e),{...o,droppable:{...o.droppable,containers:s}}}case tn.SetDroppableDisabled:{const{id:e,key:n,disabled:s}=t,a=o.droppable.containers.get(e);if(!a||n!==a.key)return o;const l=new Wo(o.droppable.containers);return l.set(e,{...a,disabled:s}),{...o,droppable:{...o.droppable,containers:l}}}case tn.UnregisterDroppable:{const{id:e,key:n}=t,s=o.droppable.containers.get(e);if(!s||n!==s.key)return o;const a=new Wo(o.droppable.containers);return a.delete(e),{...o,droppable:{...o.droppable,containers:a}}}default:return o}}function mT(o){let{disabled:t}=o;const{active:e,activatorEvent:n,draggableNodes:s}=j.useContext(dg),a=Tf(n),l=Tf(e?.id);return j.useEffect(()=>{if(!t&&!n&&a&&l!=null){if(!D0(a)||document.activeElement===a.target)return;const u=s.get(l);if(!u)return;const{activatorNode:d,node:f}=u;if(!d.current&&!f.current)return;requestAnimationFrame(()=>{for(const g of[d.current,f.current]){if(!g)continue;const m=lE(g);if(m){m.focus();break}}})}},[n,t,s,l,a]),null}function yT(o,t){let{transform:e,...n}=t;return o!=null&&o.length?o.reduce((s,a)=>a({transform:s,...n}),e):e}function vT(o){return j.useMemo(()=>({draggable:{...au.draggable,...o?.draggable},droppable:{...au.droppable,...o?.droppable},dragOverlay:{...au.dragOverlay,...o?.dragOverlay}}),[o?.draggable,o?.droppable,o?.dragOverlay])}function bT(o){let{activeNode:t,measure:e,initialRect:n,config:s=!0}=o;const a=j.useRef(!1),{x:l,y:u}=typeof s=="boolean"?{x:s,y:s}:s;Ts(()=>{if(!l&&!u||!t){a.current=!1;return}if(a.current||!n)return;const f=t?.node.current;if(!f||f.isConnected===!1)return;const g=e(f),m=M0(g,n);if(l||(m.x=0),u||(m.y=0),a.current=!0,Math.abs(m.x)>0||Math.abs(m.y)>0){const v=k0(f);v&&v.scrollBy({top:m.y,left:m.x})}},[t,l,u,n,e])}const q0=j.createContext({...ni,scaleX:1,scaleY:1});var _s;(function(o){o[o.Uninitialized=0]="Uninitialized",o[o.Initializing=1]="Initializing",o[o.Initialized=2]="Initialized"})(_s||(_s={}));const wT=j.memo(function(t){var e,n,s,a;let{id:l,accessibility:u,autoScroll:d=!0,children:f,sensors:g=cT,collisionDetection:m=AE,measuring:v,modifiers:b,...S}=t;const w=j.useReducer(pT,void 0,gT),[A,_]=w,[E,x]=gE(),[O,C]=j.useState(_s.Uninitialized),D=O===_s.Initialized,{draggable:{active:R,nodes:k,translate:L},droppable:{containers:V}}=A,q=R!=null?k.get(R):null,it=j.useRef({initial:null,translated:null}),rt=j.useMemo(()=>{var pe;return R!=null?{id:R,data:(pe=q?.data)!=null?pe:uT,rect:it}:null},[R,q]),st=j.useRef(null),[ot,B]=j.useState(null),[H,tt]=j.useState(null),lt=ag(S,Object.values(S)),P=og("DndDescribedBy",l),z=j.useMemo(()=>V.getEnabled(),[V]),Y=vT(v),{droppableRects:U,measureDroppableContainers:et,measuringScheduled:nt}=QE(z,{dragging:D,dependencies:[L.x,L.y],config:Y.droppable}),at=WE(k,R),ft=j.useMemo(()=>H?xf(H):null,[H]),vt=La(),It=ZE(at,Y.draggable.measure);bT({activeNode:R!=null?k.get(R):null,config:vt.layoutShiftCompensation,initialRect:It,measure:Y.draggable.measure});const St=Vv(at,Y.draggable.measure,It),Ae=Vv(at?at.parentElement:null),le=j.useRef({activatorEvent:null,active:null,activeNode:at,collisionRect:null,collisions:null,droppableRects:U,draggableNodes:k,draggingNode:null,draggingNodeRect:null,droppableContainers:V,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Dt=V.getNodeFor((e=le.current.over)==null?void 0:e.id),Pt=lT({measure:Y.dragOverlay.measure}),Jt=(n=Pt.nodeRef.current)!=null?n:at,Yt=D?(s=Pt.rect)!=null?s:St:null,Ee=!!(Pt.nodeRef.current&&Pt.rect),si=eT(Ee?null:St),ri=$0(Jt?pn(Jt):null),mn=nT(D?Dt??at:null),on=aT(mn),Gi=yT(b,{transform:{x:L.x-si.x,y:L.y-si.y,scaleX:1,scaleY:1},activatorEvent:H,active:rt,activeNodeRect:St,containerNodeRect:Ae,draggingNodeRect:Yt,over:le.current.over,overlayNodeRect:Pt.rect,scrollableAncestors:mn,scrollableAncestorRects:on,windowRect:ri}),Ds=ft?ga(ft,L):null,gr=iT(mn),Na=Yv(gr),Si=Yv(gr,[St]),Ft=ga(Gi,Na),ge=Yt?xE(Yt,Gi):null,$t=rt&&ge?m({active:rt,collisionRect:ge,droppableRects:U,droppableContainers:z,pointerCoordinates:Ds}):null,Vi=_E($t,"id"),[ai,El]=j.useState(null),pr=Ee?Gi:ga(Gi,Si),mr=EE(pr,(a=ai?.rect)!=null?a:null,St),Xn=j.useRef(null),Os=j.useCallback((pe,nn)=>{let{sensor:Ve,options:Yn}=nn;if(st.current==null)return;const Xe=k.get(st.current);if(!Xe)return;const Fe=pe.nativeEvent,yn=new Ve({active:st.current,activeNode:Xe,event:Fe,options:Yn,context:le,onAbort(te){if(!k.get(te))return;const{onDragAbort:se}=lt.current,Ye={id:te};se?.(Ye),E({type:"onDragAbort",event:Ye})},onPending(te,ie,se,Ye){if(!k.get(te))return;const{onDragPending:ks}=lt.current,oi={id:te,constraint:ie,initialCoordinates:se,offset:Ye};ks?.(oi),E({type:"onDragPending",event:oi})},onStart(te){const ie=st.current;if(ie==null)return;const se=k.get(ie);if(!se)return;const{onDragStart:Ye}=lt.current,Ai={activatorEvent:Fe,active:{id:ie,data:se.data,rect:it}};Ho.unstable_batchedUpdates(()=>{Ye?.(Ai),C(_s.Initializing),_({type:tn.DragStart,initialCoordinates:te,active:ie}),E({type:"onDragStart",event:Ai}),B(Xn.current),tt(Fe)})},onMove(te){_({type:tn.DragMove,coordinates:te})},onEnd:Xi(tn.DragEnd),onCancel:Xi(tn.DragCancel)});Xn.current=yn;function Xi(te){return async function(){const{active:se,collisions:Ye,over:Ai,scrollAdjustedTranslate:ks}=le.current;let oi=null;if(se&&ks){const{cancelDrop:Yi}=lt.current;oi={activatorEvent:Fe,active:se,collisions:Ye,delta:ks,over:Ai},te===tn.DragEnd&&typeof Yi=="function"&&await Promise.resolve(Yi(oi))&&(te=tn.DragCancel)}st.current=null,Ho.unstable_batchedUpdates(()=>{_({type:te}),C(_s.Uninitialized),El(null),B(null),tt(null),Xn.current=null;const Yi=te===tn.DragEnd?"onDragEnd":"onDragCancel";if(oi){const Ei=lt.current[Yi];Ei?.(oi),E({type:Yi,event:oi})}})}}},[k]),Ms=j.useCallback((pe,nn)=>(Ve,Yn)=>{const Xe=Ve.nativeEvent,Fe=k.get(Yn);if(st.current!==null||!Fe||Xe.dndKit||Xe.defaultPrevented)return;const yn={active:Fe};pe(Ve,nn.options,yn)===!0&&(Xe.dndKit={capturedBy:nn.sensor},st.current=Yn,Os(Ve,nn))},[k,Os]),Tl=KE(g,Ms);sT(g),Ts(()=>{St&&O===_s.Initializing&&C(_s.Initialized)},[St,O]),j.useEffect(()=>{const{onDragMove:pe}=lt.current,{active:nn,activatorEvent:Ve,collisions:Yn,over:Xe}=le.current;if(!nn||!Ve)return;const Fe={active:nn,activatorEvent:Ve,collisions:Yn,delta:{x:Ft.x,y:Ft.y},over:Xe};Ho.unstable_batchedUpdates(()=>{pe?.(Fe),E({type:"onDragMove",event:Fe})})},[Ft.x,Ft.y]),j.useEffect(()=>{const{active:pe,activatorEvent:nn,collisions:Ve,droppableContainers:Yn,scrollAdjustedTranslate:Xe}=le.current;if(!pe||st.current==null||!nn||!Xe)return;const{onDragOver:Fe}=lt.current,yn=Yn.get(Vi),Xi=yn&&yn.rect.current?{id:yn.id,rect:yn.rect.current,data:yn.data,disabled:yn.disabled}:null,te={active:pe,activatorEvent:nn,collisions:Ve,delta:{x:Xe.x,y:Xe.y},over:Xi};Ho.unstable_batchedUpdates(()=>{El(Xi),Fe?.(te),E({type:"onDragOver",event:te})})},[Vi]),Ts(()=>{le.current={activatorEvent:H,active:rt,activeNode:at,collisionRect:ge,collisions:$t,droppableRects:U,draggableNodes:k,draggingNode:Jt,draggingNodeRect:Yt,droppableContainers:V,over:ai,scrollableAncestors:mn,scrollAdjustedTranslate:Ft},it.current={initial:Yt,translated:ge}},[rt,at,$t,ge,k,Jt,Yt,U,V,ai,mn,Ft]),VE({...vt,delta:L,draggingRect:ge,pointerCoordinates:Ds,scrollableAncestors:mn,scrollableAncestorRects:on});const xl=j.useMemo(()=>({active:rt,activeNode:at,activeNodeRect:St,activatorEvent:H,collisions:$t,containerNodeRect:Ae,dragOverlay:Pt,draggableNodes:k,droppableContainers:V,droppableRects:U,over:ai,measureDroppableContainers:et,scrollableAncestors:mn,scrollableAncestorRects:on,measuringConfiguration:Y,measuringScheduled:nt,windowRect:ri}),[rt,at,St,H,$t,Ae,Pt,k,V,U,ai,et,mn,on,Y,nt,ri]),Cl=j.useMemo(()=>({activatorEvent:H,activators:Tl,active:rt,activeNodeRect:St,ariaDescribedById:{draggable:P},dispatch:_,draggableNodes:k,over:ai,measureDroppableContainers:et}),[H,Tl,rt,St,_,P,k,ai,et]);return Gn.createElement(O0.Provider,{value:x},Gn.createElement(dg.Provider,{value:Cl},Gn.createElement(fT.Provider,{value:xl},Gn.createElement(q0.Provider,{value:mr},f)),Gn.createElement(mT,{disabled:u?.restoreFocus===!1})),Gn.createElement(yE,{...u,hiddenTextDescribedById:P}));function La(){const pe=ot?.autoScrollEnabled===!1,nn=typeof d=="object"?d.enabled===!1:d===!1,Ve=D&&!pe&&!nn;return typeof d=="object"?{...d,enabled:Ve}:{enabled:Ve}}}),_T=j.createContext(null),Kv="button",ST="Draggable";function Of(o){let{id:t,data:e,disabled:n=!1,attributes:s}=o;const a=og(ST),{activators:l,activatorEvent:u,active:d,activeNodeRect:f,ariaDescribedById:g,draggableNodes:m,over:v}=j.useContext(dg),{role:b=Kv,roleDescription:S="draggable",tabIndex:w=0}=s??{},A=d?.id===t,_=j.useContext(A?q0:_T),[E,x]=Ef(),[O,C]=Ef(),D=rT(l,t),R=ag(e);Ts(()=>(m.set(t,{id:t,key:a,node:E,activatorNode:O,data:R}),()=>{const L=m.get(t);L&&L.key===a&&m.delete(t)}),[m,t]);const k=j.useMemo(()=>({role:b,tabIndex:w,"aria-disabled":n,"aria-pressed":A&&b===Kv?!0:void 0,"aria-roledescription":S,"aria-describedby":g.draggable}),[n,b,w,A,S,g.draggable]);return{active:d,activatorEvent:u,activeNodeRect:f,attributes:k,isDragging:A,listeners:n?void 0:D,node:E,over:v,setNodeRef:x,setActivatorNodeRef:C,transform:_}}function G0(o){var t,e,n="";if(typeof o=="string"||typeof o=="number")n+=o;else if(typeof o=="object")if(Array.isArray(o)){var s=o.length;for(t=0;t<s;t++)o[t]&&(e=G0(o[t]))&&(n&&(n+=" "),n+=e)}else for(e in o)o[e]&&(n&&(n+=" "),n+=e);return n}function Vn(){for(var o,t,e=0,n="",s=arguments.length;e<s;e++)(o=arguments[e])&&(t=G0(o))&&(n&&(n+=" "),n+=t);return n}var Mf=function(o,t){return Mf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])},Mf(o,t)};function V0(o,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Mf(o,t);function e(){this.constructor=o}o.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var du=function(){return du=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++){e=arguments[n];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},du.apply(this,arguments)};function Da(o,t){var e={};for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&t.indexOf(n)<0&&(e[n]=o[n]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(o);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(o,n[s])&&(e[n[s]]=o[n[s]]);return e}function X0(o,t,e,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(o,t,e,n);else for(var u=o.length-1;u>=0;u--)(l=o[u])&&(a=(s<3?l(a):s>3?l(t,e,a):l(t,e))||a);return s>3&&a&&Object.defineProperty(t,e,a),a}function Y0(o,t){return function(e,n){t(e,n,o)}}function W0(o,t,e,n,s,a){function l(_){if(_!==void 0&&typeof _!="function")throw new TypeError("Function expected");return _}for(var u=n.kind,d=u==="getter"?"get":u==="setter"?"set":"value",f=!t&&o?n.static?o:o.prototype:null,g=t||(f?Object.getOwnPropertyDescriptor(f,n.name):{}),m,v=!1,b=e.length-1;b>=0;b--){var S={};for(var w in n)S[w]=w==="access"?{}:n[w];for(var w in n.access)S.access[w]=n.access[w];S.addInitializer=function(_){if(v)throw new TypeError("Cannot add initializers after decoration has completed");a.push(l(_||null))};var A=(0,e[b])(u==="accessor"?{get:g.get,set:g.set}:g[d],S);if(u==="accessor"){if(A===void 0)continue;if(A===null||typeof A!="object")throw new TypeError("Object expected");(m=l(A.get))&&(g.get=m),(m=l(A.set))&&(g.set=m),(m=l(A.init))&&s.unshift(m)}else(m=l(A))&&(u==="field"?s.unshift(m):g[d]=m)}f&&Object.defineProperty(f,n.name,g),v=!0}function K0(o,t,e){for(var n=arguments.length>2,s=0;s<t.length;s++)e=n?t[s].call(o,e):t[s].call(o);return n?e:void 0}function Q0(o){return typeof o=="symbol"?o:"".concat(o)}function Z0(o,t,e){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:e?"".concat(e," ",t):t})}function J0(o,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,t)}function dt(o,t,e,n){function s(a){return a instanceof e?a:new e(function(l){l(a)})}return new(e||(e=Promise))(function(a,l){function u(g){try{f(n.next(g))}catch(m){l(m)}}function d(g){try{f(n.throw(g))}catch(m){l(m)}}function f(g){g.done?a(g.value):s(g.value).then(u,d)}f((n=n.apply(o,t||[])).next())})}function tw(o,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,s,a,l=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return l.next=u(0),l.throw=u(1),l.return=u(2),typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function u(f){return function(g){return d([f,g])}}function d(f){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,f[0]&&(e=0)),e;)try{if(n=1,s&&(a=f[0]&2?s.return:f[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,f[1])).done)return a;switch(s=0,a&&(f=[f[0]&2,a.value]),f[0]){case 0:case 1:a=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,s=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!a||f[1]>a[0]&&f[1]<a[3])){e.label=f[1];break}if(f[0]===6&&e.label<a[1]){e.label=a[1],a=f;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(f);break}a[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(o,e)}catch(g){f=[6,g],s=0}finally{n=a=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}var Eu=Object.create?function(o,t,e,n){n===void 0&&(n=e);var s=Object.getOwnPropertyDescriptor(t,e);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(o,n,s)}:function(o,t,e,n){n===void 0&&(n=e),o[n]=t[e]};function ew(o,t){for(var e in o)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&Eu(t,o,e)}function fu(o){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&o[t],n=0;if(e)return e.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&n>=o.length&&(o=void 0),{value:o&&o[n++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function fg(o,t){var e=typeof Symbol=="function"&&o[Symbol.iterator];if(!e)return o;var n=e.call(o),s,a=[],l;try{for(;(t===void 0||t-- >0)&&!(s=n.next()).done;)a.push(s.value)}catch(u){l={error:u}}finally{try{s&&!s.done&&(e=n.return)&&e.call(n)}finally{if(l)throw l.error}}return a}function nw(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(fg(arguments[t]));return o}function iw(){for(var o=0,t=0,e=arguments.length;t<e;t++)o+=arguments[t].length;for(var n=Array(o),s=0,t=0;t<e;t++)for(var a=arguments[t],l=0,u=a.length;l<u;l++,s++)n[s]=a[l];return n}function sw(o,t,e){if(e||arguments.length===2)for(var n=0,s=t.length,a;n<s;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return o.concat(a||Array.prototype.slice.call(t))}function Sa(o){return this instanceof Sa?(this.v=o,this):new Sa(o)}function rw(o,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(o,t||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",l),s[Symbol.asyncIterator]=function(){return this},s;function l(b){return function(S){return Promise.resolve(S).then(b,m)}}function u(b,S){n[b]&&(s[b]=function(w){return new Promise(function(A,_){a.push([b,w,A,_])>1||d(b,w)})},S&&(s[b]=S(s[b])))}function d(b,S){try{f(n[b](S))}catch(w){v(a[0][3],w)}}function f(b){b.value instanceof Sa?Promise.resolve(b.value.v).then(g,m):v(a[0][2],b)}function g(b){d("next",b)}function m(b){d("throw",b)}function v(b,S){b(S),a.shift(),a.length&&d(a[0][0],a[0][1])}}function aw(o){var t,e;return t={},n("next"),n("throw",function(s){throw s}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(s,a){t[s]=o[s]?function(l){return(e=!e)?{value:Sa(o[s](l)),done:!1}:a?a(l):l}:a}}function ow(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],e;return t?t.call(o):(o=typeof fu=="function"?fu(o):o[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(a){e[a]=o[a]&&function(l){return new Promise(function(u,d){l=o[a](l),s(u,d,l.done,l.value)})}}function s(a,l,u,d){Promise.resolve(d).then(function(f){a({value:f,done:u})},l)}}function lw(o,t){return Object.defineProperty?Object.defineProperty(o,"raw",{value:t}):o.raw=t,o}var AT=Object.create?function(o,t){Object.defineProperty(o,"default",{enumerable:!0,value:t})}:function(o,t){o.default=t},kf=function(o){return kf=Object.getOwnPropertyNames||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[e.length]=n);return e},kf(o)};function cw(o){if(o&&o.__esModule)return o;var t={};if(o!=null)for(var e=kf(o),n=0;n<e.length;n++)e[n]!=="default"&&Eu(t,o,e[n]);return AT(t,o),t}function uw(o){return o&&o.__esModule?o:{default:o}}function hw(o,t,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?o!==t||!n:!t.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(o):n?n.value:t.get(o)}function dw(o,t,e,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?o!==t||!s:!t.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(o,e):s?s.value=e:t.set(o,e),e}function fw(o,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?t===o:o.has(t)}function gw(o,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,s;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],e&&(s=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");s&&(n=function(){try{s.call(this)}catch(a){return Promise.reject(a)}}),o.stack.push({value:t,dispose:n,async:e})}else e&&o.stack.push({async:!0});return t}var ET=typeof SuppressedError=="function"?SuppressedError:function(o,t,e){var n=new Error(e);return n.name="SuppressedError",n.error=o,n.suppressed=t,n};function pw(o){function t(a){o.error=o.hasError?new ET(a,o.error,"An error was suppressed during disposal."):a,o.hasError=!0}var e,n=0;function s(){for(;e=o.stack.pop();)try{if(!e.async&&n===1)return n=0,o.stack.push(e),Promise.resolve().then(s);if(e.dispose){var a=e.dispose.call(e.value);if(e.async)return n|=2,Promise.resolve(a).then(s,function(l){return t(l),s()})}else n|=1}catch(l){t(l)}if(n===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return s()}function mw(o,t){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,n,s,a,l){return n?t?".jsx":".js":s&&(!a||!l)?e:s+a+"."+l.toLowerCase()+"js"}):o}const TT={__extends:V0,__assign:du,__rest:Da,__decorate:X0,__param:Y0,__esDecorate:W0,__runInitializers:K0,__propKey:Q0,__setFunctionName:Z0,__metadata:J0,__awaiter:dt,__generator:tw,__createBinding:Eu,__exportStar:ew,__values:fu,__read:fg,__spread:nw,__spreadArrays:iw,__spreadArray:sw,__await:Sa,__asyncGenerator:rw,__asyncDelegator:aw,__asyncValues:ow,__makeTemplateObject:lw,__importStar:cw,__importDefault:uw,__classPrivateFieldGet:hw,__classPrivateFieldSet:dw,__classPrivateFieldIn:fw,__addDisposableResource:gw,__disposeResources:pw,__rewriteRelativeImportExtension:mw},xT=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:gw,get __assign(){return du},__asyncDelegator:aw,__asyncGenerator:rw,__asyncValues:ow,__await:Sa,__awaiter:dt,__classPrivateFieldGet:hw,__classPrivateFieldIn:fw,__classPrivateFieldSet:dw,__createBinding:Eu,__decorate:X0,__disposeResources:pw,__esDecorate:W0,__exportStar:ew,__extends:V0,__generator:tw,__importDefault:uw,__importStar:cw,__makeTemplateObject:lw,__metadata:J0,__param:Y0,__propKey:Q0,__read:fg,__rest:Da,__rewriteRelativeImportExtension:mw,__runInitializers:K0,__setFunctionName:Z0,__spread:nw,__spreadArray:sw,__spreadArrays:iw,__values:fu,default:TT},Symbol.toStringTag,{value:"Module"})),CT="modulepreload",RT=function(o){return"/"+o},Qv={},Oa=function(t,e,n){let s=Promise.resolve();if(e&&e.length>0){let d=function(f){return Promise.all(f.map(g=>Promise.resolve(g).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=l?.nonce||l?.getAttribute("nonce");s=d(e.map(f=>{if(f=RT(f),f in Qv)return;Qv[f]=!0;const g=f.endsWith(".css"),m=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${m}`))return;const v=document.createElement("link");if(v.rel=g?"stylesheet":CT,g||(v.as="script"),v.crossOrigin="",v.href=f,u&&v.setAttribute("nonce",u),document.head.appendChild(v),g)return new Promise((b,S)=>{v.addEventListener("load",b),v.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return s.then(l=>{for(const u of l||[])u.status==="rejected"&&a(u.reason);return t().catch(a)})},DT=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...e)=>Oa(async()=>{const{default:n}=await Promise.resolve().then(()=>hr);return{default:n}},[]).then(({default:n})=>n(...e)):t=fetch,(...e)=>t(...e)};class gg extends Error{constructor(t,e="FunctionsError",n){super(t),this.name=e,this.context=n}}class Zv extends gg{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Jv extends gg{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class tb extends gg{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Pf;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(Pf||(Pf={}));class OT{constructor(t,{headers:e={},customFetch:n,region:s=Pf.Any}={}){this.url=t,this.headers=e,this.region=s,this.fetch=DT(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return dt(this,arguments,void 0,function*(e,n={}){var s;try{const{headers:a,method:l,body:u,signal:d}=n;let f={},{region:g}=n;g||(g=this.region);const m=new URL(`${this.url}/${e}`);g&&g!=="any"&&(f["x-region"]=g,m.searchParams.set("forceFunctionRegion",g));let v;u&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",v=u):typeof u=="string"?(f["Content-Type"]="text/plain",v=u):typeof FormData<"u"&&u instanceof FormData?v=u:(f["Content-Type"]="application/json",v=JSON.stringify(u)):v=u;const b=yield this.fetch(m.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),a),body:v,signal:d}).catch(_=>{throw _.name==="AbortError"?_:new Zv(_)}),S=b.headers.get("x-relay-error");if(S&&S==="true")throw new Jv(b);if(!b.ok)throw new tb(b);let w=((s=b.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),A;return w==="application/json"?A=yield b.json():w==="application/octet-stream"||w==="application/pdf"?A=yield b.blob():w==="text/event-stream"?A=b:w==="multipart/form-data"?A=yield b.formData():A=yield b.text(),{data:A,error:null,response:b}}catch(a){return a instanceof Error&&a.name==="AbortError"?{data:null,error:new Zv(a)}:{data:null,error:a,response:a instanceof tb||a instanceof Jv?a.context:void 0}}})}}var Qe={};const Ma=x0(xT);var Ic={},Uc={},Fc={},zc={},Hc={},MT=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Aa=MT();const kT=Aa.fetch,yw=Aa.fetch.bind(Aa),vw=Aa.Headers,PT=Aa.Request,NT=Aa.Response,hr=Object.freeze(Object.defineProperty({__proto__:null,Headers:vw,Request:PT,Response:NT,default:yw,fetch:kT},Symbol.toStringTag,{value:"Module"})),LT=x0(hr);var $c={},eb;function bw(){if(eb)return $c;eb=1,Object.defineProperty($c,"__esModule",{value:!0});class o extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}return $c.default=o,$c}var nb;function ww(){if(nb)return Hc;nb=1,Object.defineProperty(Hc,"__esModule",{value:!0});const o=Ma,t=o.__importDefault(LT),e=o.__importDefault(bw());class n{constructor(a){var l,u;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(l=a.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=a.signal,this.isMaybeSingle=(u=a.isMaybeSingle)!==null&&u!==void 0?u:!1,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,l){return this.headers=new Headers(this.headers),this.headers.set(a,l),this}then(a,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const u=this.fetch;let d=u(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var g,m,v,b;let S=null,w=null,A=null,_=f.status,E=f.statusText;if(f.ok){if(this.method!=="HEAD"){const D=await f.text();D===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((g=this.headers.get("Accept"))===null||g===void 0)&&g.includes("application/vnd.pgrst.plan+text"))?w=D:w=JSON.parse(D))}const O=(m=this.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),C=(v=f.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");O&&C&&C.length>1&&(A=parseInt(C[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(S={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,A=null,_=406,E="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const O=await f.text();try{S=JSON.parse(O),Array.isArray(S)&&f.status===404&&(w=[],S=null,_=200,E="OK")}catch{f.status===404&&O===""?(_=204,E="No Content"):S={message:O}}if(S&&this.isMaybeSingle&&(!((b=S?.details)===null||b===void 0)&&b.includes("0 rows"))&&(S=null,_=200,E="OK"),S&&this.shouldThrowOnError)throw new e.default(S)}return{error:S,data:w,count:A,status:_,statusText:E}});return this.shouldThrowOnError||(d=d.catch(f=>{var g,m,v;return{error:{message:`${(g=f?.name)!==null&&g!==void 0?g:"FetchError"}: ${f?.message}`,details:`${(m=f?.stack)!==null&&m!==void 0?m:""}`,hint:"",code:`${(v=f?.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),d.then(a,l)}returns(){return this}overrideTypes(){return this}}return Hc.default=n,Hc}var ib;function _w(){if(ib)return zc;ib=1,Object.defineProperty(zc,"__esModule",{value:!0});const t=Ma.__importDefault(ww());class e extends t.default{select(s){let a=!1;const l=(s??"*").split("").map(u=>/\s/.test(u)&&!a?"":(u==='"'&&(a=!a),u)).join("");return this.url.searchParams.set("select",l),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:a=!0,nullsFirst:l,foreignTable:u,referencedTable:d=u}={}){const f=d?`${d}.order`:"order",g=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${g?`${g},`:""}${s}.${a?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:a,referencedTable:l=a}={}){const u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(u,`${s}`),this}range(s,a,{foreignTable:l,referencedTable:u=l}={}){const d=typeof u>"u"?"offset":`${u}.offset`,f=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(d,`${s}`),this.url.searchParams.set(f,`${a-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:a=!1,settings:l=!1,buffers:u=!1,wal:d=!1,format:f="text"}={}){var g;const m=[s?"analyze":null,a?"verbose":null,l?"settings":null,u?"buffers":null,d?"wal":null].filter(Boolean).join("|"),v=(g=this.headers.get("Accept"))!==null&&g!==void 0?g:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${v}"; options=${m};`),f==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return zc.default=e,zc}var sb;function pg(){if(sb)return Fc;sb=1,Object.defineProperty(Fc,"__esModule",{value:!0});const t=Ma.__importDefault(_w());class e extends t.default{eq(s,a){return this.url.searchParams.append(s,`eq.${a}`),this}neq(s,a){return this.url.searchParams.append(s,`neq.${a}`),this}gt(s,a){return this.url.searchParams.append(s,`gt.${a}`),this}gte(s,a){return this.url.searchParams.append(s,`gte.${a}`),this}lt(s,a){return this.url.searchParams.append(s,`lt.${a}`),this}lte(s,a){return this.url.searchParams.append(s,`lte.${a}`),this}like(s,a){return this.url.searchParams.append(s,`like.${a}`),this}likeAllOf(s,a){return this.url.searchParams.append(s,`like(all).{${a.join(",")}}`),this}likeAnyOf(s,a){return this.url.searchParams.append(s,`like(any).{${a.join(",")}}`),this}ilike(s,a){return this.url.searchParams.append(s,`ilike.${a}`),this}ilikeAllOf(s,a){return this.url.searchParams.append(s,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(s,a){return this.url.searchParams.append(s,`ilike(any).{${a.join(",")}}`),this}is(s,a){return this.url.searchParams.append(s,`is.${a}`),this}in(s,a){const l=Array.from(new Set(a)).map(u=>typeof u=="string"&&new RegExp("[,()]").test(u)?`"${u}"`:`${u}`).join(",");return this.url.searchParams.append(s,`in.(${l})`),this}contains(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cs.{${a.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(a)}`),this}containedBy(s,a){return typeof a=="string"?this.url.searchParams.append(s,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(s,`cd.{${a.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(a)}`),this}rangeGt(s,a){return this.url.searchParams.append(s,`sr.${a}`),this}rangeGte(s,a){return this.url.searchParams.append(s,`nxl.${a}`),this}rangeLt(s,a){return this.url.searchParams.append(s,`sl.${a}`),this}rangeLte(s,a){return this.url.searchParams.append(s,`nxr.${a}`),this}rangeAdjacent(s,a){return this.url.searchParams.append(s,`adj.${a}`),this}overlaps(s,a){return typeof a=="string"?this.url.searchParams.append(s,`ov.${a}`):this.url.searchParams.append(s,`ov.{${a.join(",")}}`),this}textSearch(s,a,{config:l,type:u}={}){let d="";u==="plain"?d="pl":u==="phrase"?d="ph":u==="websearch"&&(d="w");const f=l===void 0?"":`(${l})`;return this.url.searchParams.append(s,`${d}fts${f}.${a}`),this}match(s){return Object.entries(s).forEach(([a,l])=>{this.url.searchParams.append(a,`eq.${l}`)}),this}not(s,a,l){return this.url.searchParams.append(s,`not.${a}.${l}`),this}or(s,{foreignTable:a,referencedTable:l=a}={}){const u=l?`${l}.or`:"or";return this.url.searchParams.append(u,`(${s})`),this}filter(s,a,l){return this.url.searchParams.append(s,`${a}.${l}`),this}}return Fc.default=e,Fc}var rb;function Sw(){if(rb)return Uc;rb=1,Object.defineProperty(Uc,"__esModule",{value:!0});const t=Ma.__importDefault(pg());class e{constructor(s,{headers:a={},schema:l,fetch:u}){this.url=s,this.headers=new Headers(a),this.schema=l,this.fetch=u}select(s,a){const{head:l=!1,count:u}=a??{},d=l?"HEAD":"GET";let f=!1;const g=(s??"*").split("").map(m=>/\s/.test(m)&&!f?"":(m==='"'&&(f=!f),m)).join("");return this.url.searchParams.set("select",g),u&&this.headers.append("Prefer",`count=${u}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:a,defaultToNull:l=!0}={}){var u;const d="POST";if(a&&this.headers.append("Prefer",`count=${a}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const f=s.reduce((g,m)=>g.concat(Object.keys(m)),[]);if(f.length>0){const g=[...new Set(f)].map(m=>`"${m}"`);this.url.searchParams.set("columns",g.join(","))}}return new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}upsert(s,{onConflict:a,ignoreDuplicates:l=!1,count:u,defaultToNull:d=!0}={}){var f;const g="POST";if(this.headers.append("Prefer",`resolution=${l?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),u&&this.headers.append("Prefer",`count=${u}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const m=s.reduce((v,b)=>v.concat(Object.keys(b)),[]);if(m.length>0){const v=[...new Set(m)].map(b=>`"${b}"`);this.url.searchParams.set("columns",v.join(","))}}return new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}update(s,{count:a}={}){var l;const u="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}delete({count:s}={}){var a;const l="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return Uc.default=e,Uc}var ab;function BT(){if(ab)return Ic;ab=1,Object.defineProperty(Ic,"__esModule",{value:!0});const o=Ma,t=o.__importDefault(Sw()),e=o.__importDefault(pg());class n{constructor(a,{headers:l={},schema:u,fetch:d}={}){this.url=a,this.headers=new Headers(l),this.schemaName=u,this.fetch=d}from(a){const l=new URL(`${this.url}/${a}`);return new t.default(l,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new n(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,l={},{head:u=!1,get:d=!1,count:f}={}){var g;let m;const v=new URL(`${this.url}/rpc/${a}`);let b;u||d?(m=u?"HEAD":"GET",Object.entries(l).filter(([w,A])=>A!==void 0).map(([w,A])=>[w,Array.isArray(A)?`{${A.join(",")}}`:`${A}`]).forEach(([w,A])=>{v.searchParams.append(w,A)})):(m="POST",b=l);const S=new Headers(this.headers);return f&&S.set("Prefer",`count=${f}`),new e.default({method:m,url:v,headers:S,schema:this.schemaName,body:b,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}}return Ic.default=n,Ic}var ob;function jT(){if(ob)return Qe;ob=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.PostgrestError=Qe.PostgrestBuilder=Qe.PostgrestTransformBuilder=Qe.PostgrestFilterBuilder=Qe.PostgrestQueryBuilder=Qe.PostgrestClient=void 0;const o=Ma,t=o.__importDefault(BT());Qe.PostgrestClient=t.default;const e=o.__importDefault(Sw());Qe.PostgrestQueryBuilder=e.default;const n=o.__importDefault(pg());Qe.PostgrestFilterBuilder=n.default;const s=o.__importDefault(_w());Qe.PostgrestTransformBuilder=s.default;const a=o.__importDefault(ww());Qe.PostgrestBuilder=a.default;const l=o.__importDefault(bw());return Qe.PostgrestError=l.default,Qe.default={PostgrestClient:t.default,PostgrestQueryBuilder:e.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:a.default,PostgrestError:l.default},Qe}var IT=jT();const UT=ng(IT),{PostgrestClient:FT,PostgrestQueryBuilder:WD,PostgrestFilterBuilder:KD,PostgrestTransformBuilder:QD,PostgrestBuilder:ZD,PostgrestError:JD}=UT;class zT{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const e=process.versions;if(e&&e.node){const n=e.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let e=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(e+=`

Suggested solution: ${t.workaround}`),new Error(e)}static createWebSocket(t,e){const n=this.getWebSocketConstructor();return new n(t,e)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const HT="2.76.1",$T=`realtime-js/${HT}`,qT="1.0.0",Nf=1e4,GT=1e3,VT=100;var Ko;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(Ko||(Ko={}));var Me;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(Me||(Me={}));var ei;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(ei||(ei={}));var Lf;(function(o){o.websocket="websocket"})(Lf||(Lf={}));var tr;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(tr||(tr={}));class XT{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const e=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,e,n)}_decodeBroadcast(t,e,n){const s=e.getUint8(1),a=e.getUint8(2);let l=this.HEADER_LENGTH+2;const u=n.decode(t.slice(l,l+s));l=l+s;const d=n.decode(t.slice(l,l+a));l=l+a;const f=JSON.parse(n.decode(t.slice(l,t.byteLength)));return{ref:null,topic:u,event:d,payload:f}}}class Aw{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ne;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(ne||(ne={}));const lb=(o,t,e={})=>{var n;const s=(n=e.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((a,l)=>(a[l]=YT(l,o,t,s),a),{}):{}},YT=(o,t,e,n)=>{const s=t.find(u=>u.name===o),a=s?.type,l=e[o];return a&&!n.includes(a)?Ew(a,l):Bf(l)},Ew=(o,t)=>{if(o.charAt(0)==="_"){const e=o.slice(1,o.length);return ZT(t,e)}switch(o){case ne.bool:return WT(t);case ne.float4:case ne.float8:case ne.int2:case ne.int4:case ne.int8:case ne.numeric:case ne.oid:return KT(t);case ne.json:case ne.jsonb:return QT(t);case ne.timestamp:return JT(t);case ne.abstime:case ne.date:case ne.daterange:case ne.int4range:case ne.int8range:case ne.money:case ne.reltime:case ne.text:case ne.time:case ne.timestamptz:case ne.timetz:case ne.tsrange:case ne.tstzrange:return Bf(t);default:return Bf(t)}},Bf=o=>o,WT=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},KT=o=>{if(typeof o=="string"){const t=parseFloat(o);if(!Number.isNaN(t))return t}return o},QT=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(t){return console.log(`JSON parse error: ${t}`),o}return o},ZT=(o,t)=>{if(typeof o!="string")return o;const e=o.length-1,n=o[e];if(o[0]==="{"&&n==="}"){let a;const l=o.slice(1,e);try{a=JSON.parse("["+l+"]")}catch{a=l?l.split(","):[]}return a.map(u=>Ew(t,u))}return o},JT=o=>typeof o=="string"?o.replace(" ","T"):o,Tw=o=>{const t=new URL(o);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class ef{constructor(t,e,n={},s=Nf){this.channel=t,this.event=e,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var n;return this._hasReceived(t)&&e((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var cb;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(cb||(cb={}));class Qo{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:l,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Qo.syncState(this.state,s,a,l),this.pendingDiffs.forEach(d=>{this.state=Qo.syncDiff(this.state,d,a,l)}),this.pendingDiffs=[],u()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:l,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Qo.syncDiff(this.state,s,a,l),u())}),this.onJoin((s,a,l)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:l})}),this.onLeave((s,a,l)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,n,s){const a=this.cloneDeep(t),l=this.transformState(e),u={},d={};return this.map(a,(f,g)=>{l[f]||(d[f]=g)}),this.map(l,(f,g)=>{const m=a[f];if(m){const v=g.map(A=>A.presence_ref),b=m.map(A=>A.presence_ref),S=g.filter(A=>b.indexOf(A.presence_ref)<0),w=m.filter(A=>v.indexOf(A.presence_ref)<0);S.length>0&&(u[f]=S),w.length>0&&(d[f]=w)}else u[f]=g}),this.syncDiff(a,{joins:u,leaves:d},n,s)}static syncDiff(t,e,n,s){const{joins:a,leaves:l}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(u,d)=>{var f;const g=(f=t[u])!==null&&f!==void 0?f:[];if(t[u]=this.cloneDeep(d),g.length>0){const m=t[u].map(b=>b.presence_ref),v=g.filter(b=>m.indexOf(b.presence_ref)<0);t[u].unshift(...v)}n(u,g,d)}),this.map(l,(u,d)=>{let f=t[u];if(!f)return;const g=d.map(m=>m.presence_ref);f=f.filter(m=>g.indexOf(m.presence_ref)<0),t[u]=f,s(u,f,d),f.length===0&&delete t[u]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(n=>e(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,n)=>{const s=t[n];return"metas"in s?e[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):e[n]=s,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ub;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(ub||(ub={}));var Zo;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(Zo||(Zo={}));var zi;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(zi||(zi={}));class mg{constructor(t,e={config:{}},n){var s,a;if(this.topic=t,this.params=e,this.socket=n,this.bindings={},this.state=Me.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new ef(this,ei.join,this.params,this.timeout),this.rejoinTimer=new Aw(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Me.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Me.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Me.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Me.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Me.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ei.reply,{},(l,u)=>{this._trigger(this._replyEventName(u),l)}),this.presence=new Qo(this),this.broadcastEndpointURL=Tw(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,e=this.timeout){var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Me.closed){const{config:{broadcast:l,presence:u,private:d}}=this.params,f=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(b=>b.filter))!==null&&s!==void 0?s:[],g=!!this.bindings[Zo.PRESENCE]&&this.bindings[Zo.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,m={},v={broadcast:l,presence:Object.assign(Object.assign({},u),{enabled:g}),postgres_changes:f,private:d};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(b=>t?.(zi.CHANNEL_ERROR,b)),this._onClose(()=>t?.(zi.CLOSED)),this.updateJoinPayload(Object.assign({config:v},m)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:b})=>{var S;if(this.socket.setAuth(),b===void 0){t?.(zi.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,A=(S=w?.length)!==null&&S!==void 0?S:0,_=[];for(let E=0;E<A;E++){const x=w[E],{filter:{event:O,schema:C,table:D,filter:R}}=x,k=b&&b[E];if(k&&k.event===O&&k.schema===C&&k.table===D&&k.filter===R)_.push(Object.assign(Object.assign({},x),{id:k.id}));else{this.unsubscribe(),this.state=Me.errored,t?.(zi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,t&&t(zi.SUBSCRIBED);return}}).receive("error",b=>{this.state=Me.errored,t?.(zi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{t?.(zi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,e={}){return await this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,e,n){return this.state===Me.joined&&t===Zo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,e,n)}async httpSend(t,e,n={}){var s;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(e==null)return Promise.reject("Payload is required for httpSend()");const l={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:e,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(u.status===202)return{success:!0};let d=u.statusText;try{const f=await u.json();d=f.error||f.message||d}catch{}return Promise.reject(new Error(d))}async send(t,e={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:l}=t,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:l,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(n=e.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=f.body)===null||s===void 0?void 0:s.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var l,u,d;const f=this._push(t.type,t,e.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(u=(l=this.params)===null||l===void 0?void 0:l.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.ack)&&a("ok"),f.receive("ok",()=>a("ok")),f.receive("error",()=>a("error")),f.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Me.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ei.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new ef(this,ei.leave,{},t),n.receive("ok",()=>{e(),s("ok")}).receive("timeout",()=>{e(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Me.closed,this.bindings={}}async _fetchWithTimeout(t,e,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:s.signal}));return clearTimeout(a),l}_push(t,e,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new ef(this,t,e,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>VT){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(t,e,n){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,n){var s,a;const l=t.toLocaleLowerCase(),{close:u,error:d,leave:f,join:g}=ei;if(n&&[u,d,f,g].indexOf(l)>=0&&n!==this._joinRef())return;let v=this._onMessage(l,e,n);if(e&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(b=>{var S,w,A;return((S=b.filter)===null||S===void 0?void 0:S.event)==="*"||((A=(w=b.filter)===null||w===void 0?void 0:w.event)===null||A===void 0?void 0:A.toLocaleLowerCase())===l}).map(b=>b.callback(v,n)):(a=this.bindings[l])===null||a===void 0||a.filter(b=>{var S,w,A,_,E,x;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in b){const O=b.id,C=(S=b.filter)===null||S===void 0?void 0:S.event;return O&&((w=e.ids)===null||w===void 0?void 0:w.includes(O))&&(C==="*"||C?.toLocaleLowerCase()===((A=e.data)===null||A===void 0?void 0:A.type.toLocaleLowerCase()))}else{const O=(E=(_=b?.filter)===null||_===void 0?void 0:_.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return O==="*"||O===((x=e?.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===l}).map(b=>{if(typeof v=="object"&&"ids"in v){const S=v.data,{schema:w,table:A,commit_timestamp:_,type:E,errors:x}=S;v=Object.assign(Object.assign({},{schema:w,table:A,commit_timestamp:_,eventType:E,new:{},old:{},errors:x}),this._getPayloadRecords(S))}b.callback(v,n)})}_isClosed(){return this.state===Me.closed}_isJoined(){return this.state===Me.joined}_isJoining(){return this.state===Me.joining}_isLeaving(){return this.state===Me.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,n){const s=t.toLocaleLowerCase(),a={type:s,filter:e,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(t,e){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&mg.isEqual(s.filter,e))})),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ei.close,{},t)}_onError(t){this._on(ei.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Me.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=lb(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=lb(t.columns,t.old_record)),e}}const nf=()=>{},qc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},tx=[1e3,2e3,5e3,1e4],ex=1e4,nx=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ix{constructor(t,e){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Nf,this.transport=null,this.heartbeatIntervalMs=qc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=nf,this.ref=0,this.reconnectTimer=null,this.logger=nf,this.conn=null,this.sendBuffer=[],this.serializer=new XT,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...l)=>Oa(async()=>{const{default:u}=await Promise.resolve().then(()=>hr);return{default:u}},void 0).then(({default:u})=>u(...l)).catch(u=>{throw new Error(`Failed to load @supabase/node-fetch: ${u.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...l)=>a(...l)},!(!((n=e?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=e.params.apikey,this.endPoint=`${t}/${Lf.websocket}`,this.httpEndpoint=Tw(t),this._initializeOptions(e),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(e?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=zT.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const e=t.message;throw e.includes("Node.js")?new Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:qT}))}disconnect(t,e){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,e??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const e=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),e}async removeAllChannels(){const t=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,e,n){this.logger(t,e,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Ko.connecting:return tr.Connecting;case Ko.open:return tr.Open;case Ko.closing:return tr.Closing;default:return tr.Closed}}isConnected(){return this.connectionState()===tr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,e={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new mg(`realtime:${t}`,e,this);return this.channels.push(a),a}}push(t){const{topic:e,event:n,payload:s,ref:a}=t,l=()=>{this.encode(t,u=>{var d;(d=this.conn)===null||d===void 0||d.send(u)})};this.log("push",`${e} ${n} (${a})`,s),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(GT,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout()},qc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,e=>{if(e.topic==="phoenix"&&e.event==="phx_reply")try{this.heartbeatCallback(e.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:a,ref:l}=e,u=l?`(${l})`:"",d=a.status||"";this.log("receive",`${d} ${n} ${s} ${u}`.trim(),a),this.channels.filter(f=>f._isMember(n)).forEach(f=>f._trigger(s,a,l)),this._triggerStateCallbacks("message",e)})}_clearTimer(t){var e;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((e=this.reconnectTimer)===null||e===void 0||e.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var e;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(ei.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(e);return`${t}${n}${s}`}_workerObjectUrl(t){let e;if(t)e=t;else{const n=new Blob([nx],{type:"application/javascript"});e=URL.createObjectURL(n)}return e}_setConnectionState(t,e=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=e)}async _performAuth(t=null){let e;t?e=t:this.accessToken?e=await this.accessToken():e=this.accessTokenValue,this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(n=>{const s={access_token:e,version:$T};e&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(ei.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(e=>{this.log("error",`error setting auth in ${t}`,e)})}_triggerStateCallbacks(t,e){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(e)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Aw(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},qc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var e,n,s,a,l,u,d,f,g;if(this.transport=(e=t?.transport)!==null&&e!==void 0?e:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:Nf,this.heartbeatIntervalMs=(s=t?.heartbeatIntervalMs)!==null&&s!==void 0?s:qc.HEARTBEAT_INTERVAL,this.worker=(a=t?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(l=t?.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(u=t?.heartbeatCallback)!==null&&u!==void 0?u:nf,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t?.reconnectAfterMs)!==null&&d!==void 0?d:m=>tx[m-1]||ex,this.encode=(f=t?.encode)!==null&&f!==void 0?f:(m,v)=>v(JSON.stringify(m)),this.decode=(g=t?.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class yg extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function he(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class sx extends yg{constructor(t,e,n){super(t),this.name="StorageApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class jf extends yg{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}}const vg=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...e)=>Oa(async()=>{const{default:n}=await Promise.resolve().then(()=>hr);return{default:n}},void 0).then(({default:n})=>n(...e)):t=fetch,(...e)=>t(...e)},rx=()=>dt(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Oa(()=>Promise.resolve().then(()=>hr),void 0)).Response:Response}),If=o=>{if(Array.isArray(o))return o.map(e=>If(e));if(typeof o=="function"||o!==Object(o))return o;const t={};return Object.entries(o).forEach(([e,n])=>{const s=e.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[s]=If(n)}),t},ax=o=>{if(typeof o!="object"||o===null)return!1;const t=Object.getPrototypeOf(o);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},sf=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),ox=(o,t,e)=>dt(void 0,void 0,void 0,function*(){const n=yield rx();o instanceof n&&!e?.noResolveJson?o.json().then(s=>{const a=o.status||500,l=s?.statusCode||a+"";t(new sx(sf(s),a,l))}).catch(s=>{t(new jf(sf(s),s))}):t(new jf(sf(o),o))}),lx=(o,t,e,n)=>{const s={method:o,headers:t?.headers||{}};return o==="GET"||!n?s:(ax(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(n)):s.body=n,t?.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),e))};function gl(o,t,e,n,s,a){return dt(this,void 0,void 0,function*(){return new Promise((l,u)=>{o(e,lx(t,n,s,a)).then(d=>{if(!d.ok)throw d;return n?.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>ox(d,u,n))})})}function nl(o,t,e,n){return dt(this,void 0,void 0,function*(){return gl(o,"GET",t,e,n)})}function Jn(o,t,e,n,s){return dt(this,void 0,void 0,function*(){return gl(o,"POST",t,n,s,e)})}function Uf(o,t,e,n,s){return dt(this,void 0,void 0,function*(){return gl(o,"PUT",t,n,s,e)})}function cx(o,t,e,n){return dt(this,void 0,void 0,function*(){return gl(o,"HEAD",t,Object.assign(Object.assign({},e),{noResolveJson:!0}),n)})}function bg(o,t,e,n,s){return dt(this,void 0,void 0,function*(){return gl(o,"DELETE",t,n,s,e)})}class ux{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}execute(){return dt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(he(t))return{data:null,error:t};throw t}})}}var xw;class hx{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[xw]="BlobDownloadBuilder",this.promise=null}asStream(){return new ux(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return dt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(he(t))return{data:null,error:t};throw t}})}}xw=Symbol.toStringTag;const dx={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},hb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class fx{constructor(t,e={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=n,this.fetch=vg(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,e,n,s){return dt(this,void 0,void 0,function*(){try{let a;const l=Object.assign(Object.assign({},hb),s);let u=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",l.cacheControl),d&&a.append("metadata",this.encodeMetadata(d)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",l.cacheControl),d&&a.append("metadata",this.encodeMetadata(d))):(a=n,u["cache-control"]=`max-age=${l.cacheControl}`,u["content-type"]=l.contentType,d&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),s?.headers&&(u=Object.assign(Object.assign({},u),s.headers));const f=this._removeEmptyFolders(e),g=this._getFinalPath(f),m=yield(t=="PUT"?Uf:Jn)(this.fetch,`${this.url}/object/${g}`,a,Object.assign({headers:u},l?.duplex?{duplex:l.duplex}:{}));return{data:{path:f,id:m.Id,fullPath:m.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(he(a))return{data:null,error:a};throw a}})}upload(t,e,n){return dt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,n)})}uploadToSignedUrl(t,e,n,s){return dt(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),l=this._getFinalPath(a),u=new URL(this.url+`/object/upload/sign/${l}`);u.searchParams.set("token",e);try{let d;const f=Object.assign({upsert:hb.upsert},s),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&n instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",n)):typeof FormData<"u"&&n instanceof FormData?(d=n,d.append("cacheControl",f.cacheControl)):(d=n,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType);const m=yield Uf(this.fetch,u.toString(),d,{headers:g});return{data:{path:a,fullPath:m.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(he(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(t,e){return dt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);e?.upsert&&(s["x-upsert"]="true");const a=yield Jn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),l=new URL(this.url+a.url),u=l.searchParams.get("token");if(!u)throw new yg("No token returned by API");return{data:{signedUrl:l.toString(),path:t,token:u},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(he(n))return{data:null,error:n};throw n}})}update(t,e,n){return dt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,n)})}move(t,e,n){return dt(this,void 0,void 0,function*(){try{return{data:yield Jn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(he(s))return{data:null,error:s};throw s}})}copy(t,e,n){return dt(this,void 0,void 0,function*(){try{return{data:{path:(yield Jn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(he(s))return{data:null,error:s};throw s}})}createSignedUrl(t,e,n){return dt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),a=yield Jn(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:e},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const l=n?.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${l}`)},{data:a,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(he(s))return{data:null,error:s};throw s}})}createSignedUrls(t,e,n){return dt(this,void 0,void 0,function*(){try{const s=yield Jn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),a=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${a}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(he(s))return{data:null,error:s};throw s}})}download(t,e){const s=typeof e?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(e?.transform||{}),l=a?`?${a}`:"",u=this._getFinalPath(t),d=()=>nl(this.fetch,`${this.url}/${s}/${u}${l}`,{headers:this.headers,noResolveJson:!0});return new hx(d,this.shouldThrowOnError)}info(t){return dt(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{const n=yield nl(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:If(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(he(n))return{data:null,error:n};throw n}})}exists(t){return dt(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{return yield cx(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(he(n)&&n instanceof jf){const s=n.originalError;if([400,404].includes(s?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,e){const n=this._getFinalPath(t),s=[],a=e?.download?`download=${e.download===!0?"":e.download}`:"";a!==""&&s.push(a);const u=typeof e?.transform<"u"?"render/image":"object",d=this.transformOptsToQueryString(e?.transform||{});d!==""&&s.push(d);let f=s.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${n}${f}`)}}}remove(t){return dt(this,void 0,void 0,function*(){try{return{data:yield bg(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(he(e))return{data:null,error:e};throw e}})}list(t,e,n){return dt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},dx),e),{prefix:t||""});return{data:yield Jn(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(he(s))return{data:null,error:s};throw s}})}listV2(t,e){return dt(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Jn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},e),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(he(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}}const Cw="2.76.1",Rw={"X-Client-Info":`storage-js/${Cw}`};class gx{constructor(t,e={},n,s){this.shouldThrowOnError=!1;const a=new URL(t);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Rw),e),this.fetch=vg(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return dt(this,void 0,void 0,function*(){try{return{data:yield nl(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(he(t))return{data:null,error:t};throw t}})}getBucket(t){return dt(this,void 0,void 0,function*(){try{return{data:yield nl(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(he(e))return{data:null,error:e};throw e}})}createBucket(t){return dt(this,arguments,void 0,function*(e,n={public:!1}){try{return{data:yield Jn(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(he(s))return{data:null,error:s};throw s}})}updateBucket(t,e){return dt(this,void 0,void 0,function*(){try{return{data:yield Uf(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(he(n))return{data:null,error:n};throw n}})}emptyBucket(t){return dt(this,void 0,void 0,function*(){try{return{data:yield Jn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(he(e))return{data:null,error:e};throw e}})}deleteBucket(t){return dt(this,void 0,void 0,function*(){try{return{data:yield bg(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(he(e))return{data:null,error:e};throw e}})}}class px{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Rw),e),this.fetch=vg(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return dt(this,void 0,void 0,function*(){try{return{data:yield Jn(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(he(e))return{data:null,error:e};throw e}})}listBuckets(t){return dt(this,void 0,void 0,function*(){try{const e=new URLSearchParams;t?.limit!==void 0&&e.set("limit",t.limit.toString()),t?.offset!==void 0&&e.set("offset",t.offset.toString()),t?.sortColumn&&e.set("sortColumn",t.sortColumn),t?.sortOrder&&e.set("sortOrder",t.sortOrder),t?.search&&e.set("search",t.search);const n=e.toString(),s=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`,a=yield nl(this.fetch,s,{headers:this.headers});return{data:Array.isArray(a)?a.filter(u=>u.type==="ANALYTICS"):[],error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(he(e))return{data:null,error:e};throw e}})}deleteBucket(t){return dt(this,void 0,void 0,function*(){try{return{data:yield bg(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(he(e))return{data:null,error:e};throw e}})}}const wg={"X-Client-Info":`storage-js/${Cw}`,"Content-Type":"application/json"};class Dw extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Dn(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class rf extends Dw{constructor(t,e,n){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class mx extends Dw{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}}var db;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(db||(db={}));const _g=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...e)=>Oa(async()=>{const{default:n}=await Promise.resolve().then(()=>hr);return{default:n}},void 0).then(({default:n})=>n(...e)):t=fetch,(...e)=>t(...e)},yx=o=>{if(typeof o!="object"||o===null)return!1;const t=Object.getPrototypeOf(o);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},fb=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),vx=(o,t,e)=>dt(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!e?.noResolveJson){const s=o.status||500,a=o;if(typeof a.json=="function")a.json().then(l=>{const u=l?.statusCode||l?.code||s+"";t(new rf(fb(l),s,u))}).catch(()=>{const l=s+"",u=a.statusText||`HTTP ${s} error`;t(new rf(u,s,l))});else{const l=s+"",u=a.statusText||`HTTP ${s} error`;t(new rf(u,s,l))}}else t(new mx(fb(o),o))}),bx=(o,t,e,n)=>{const s={method:o,headers:t?.headers||{}};return n?(yx(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(n)):s.body=n,Object.assign(Object.assign({},s),e)):s};function wx(o,t,e,n,s,a){return dt(this,void 0,void 0,function*(){return new Promise((l,u)=>{o(e,bx(t,n,s,a)).then(d=>{if(!d.ok)throw d;if(n?.noResolveJson)return d;const f=d.headers.get("content-type");return!f||!f.includes("application/json")?{}:d.json()}).then(d=>l(d)).catch(d=>vx(d,u,n))})})}function On(o,t,e,n,s){return dt(this,void 0,void 0,function*(){return wx(o,"POST",t,n,s,e)})}class _x{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},wg),e),this.fetch=_g(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return dt(this,void 0,void 0,function*(){try{return{data:(yield On(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Dn(e))return{data:null,error:e};throw e}})}getIndex(t,e){return dt(this,void 0,void 0,function*(){try{return{data:yield On(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Dn(n))return{data:null,error:n};throw n}})}listIndexes(t){return dt(this,void 0,void 0,function*(){try{return{data:yield On(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Dn(e))return{data:null,error:e};throw e}})}deleteIndex(t,e){return dt(this,void 0,void 0,function*(){try{return{data:(yield On(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Dn(n))return{data:null,error:n};throw n}})}}class Sx{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},wg),e),this.fetch=_g(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return dt(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield On(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Dn(e))return{data:null,error:e};throw e}})}getVectors(t){return dt(this,void 0,void 0,function*(){try{return{data:yield On(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Dn(e))return{data:null,error:e};throw e}})}listVectors(t){return dt(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield On(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Dn(e))return{data:null,error:e};throw e}})}queryVectors(t){return dt(this,void 0,void 0,function*(){try{return{data:yield On(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Dn(e))return{data:null,error:e};throw e}})}deleteVectors(t){return dt(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield On(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Dn(e))return{data:null,error:e};throw e}})}}class Ax{constructor(t,e={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},wg),e),this.fetch=_g(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return dt(this,void 0,void 0,function*(){try{return{data:(yield On(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Dn(e))return{data:null,error:e};throw e}})}getBucket(t){return dt(this,void 0,void 0,function*(){try{return{data:yield On(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Dn(e))return{data:null,error:e};throw e}})}listBuckets(){return dt(this,arguments,void 0,function*(t={}){try{return{data:yield On(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Dn(e))return{data:null,error:e};throw e}})}deleteBucket(t){return dt(this,void 0,void 0,function*(){try{return{data:(yield On(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Dn(e))return{data:null,error:e};throw e}})}}class Ex extends Ax{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new Tx(this.url,this.headers,t,this.fetch)}}class Tx extends _x{constructor(t,e,n,s){super(t,e,s),this.vectorBucketName=n}createIndex(t){const e=Object.create(null,{createIndex:{get:()=>super.createIndex}});return dt(this,void 0,void 0,function*(){return e.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return dt(this,arguments,void 0,function*(e={}){return t.listIndexes.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const e=Object.create(null,{getIndex:{get:()=>super.getIndex}});return dt(this,void 0,void 0,function*(){return e.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const e=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return dt(this,void 0,void 0,function*(){return e.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new xx(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class xx extends Sx{constructor(t,e,n,s,a){super(t,e,a),this.vectorBucketName=n,this.indexName=s}putVectors(t){const e=Object.create(null,{putVectors:{get:()=>super.putVectors}});return dt(this,void 0,void 0,function*(){return e.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const e=Object.create(null,{getVectors:{get:()=>super.getVectors}});return dt(this,void 0,void 0,function*(){return e.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return dt(this,arguments,void 0,function*(e={}){return t.listVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const e=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return dt(this,void 0,void 0,function*(){return e.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const e=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return dt(this,void 0,void 0,function*(){return e.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class Cx extends gx{constructor(t,e={},n,s){super(t,e,n,s)}from(t){return new fx(this.url,this.headers,t,this.fetch)}get vectors(){return new Ex(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new px(this.url+"/iceberg",this.headers,this.fetch)}}const Rx="2.76.1";let $o="";typeof Deno<"u"?$o="deno":typeof document<"u"?$o="web":typeof navigator<"u"&&navigator.product==="ReactNative"?$o="react-native":$o="node";const Dx={"X-Client-Info":`supabase-js-${$o}/${Rx}`},Ox={headers:Dx},Mx={schema:"public"},kx={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Px={},Nx=o=>{let t;return o?t=o:typeof fetch>"u"?t=yw:t=fetch,(...e)=>t(...e)},Lx=()=>typeof Headers>"u"?vw:Headers,Bx=(o,t,e)=>{const n=Nx(e),s=Lx();return async(a,l)=>{var u;const d=(u=await t())!==null&&u!==void 0?u:o;let f=new s(l?.headers);return f.has("apikey")||f.set("apikey",o),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),n(a,Object.assign(Object.assign({},l),{headers:f}))}};function jx(o){return o.endsWith("/")?o:o+"/"}function Ix(o,t){var e,n;const{db:s,auth:a,realtime:l,global:u}=o,{db:d,auth:f,realtime:g,global:m}=t,v={db:Object.assign(Object.assign({},d),s),auth:Object.assign(Object.assign({},f),a),realtime:Object.assign(Object.assign({},g),l),storage:{},global:Object.assign(Object.assign(Object.assign({},m),u),{headers:Object.assign(Object.assign({},(e=m?.headers)!==null&&e!==void 0?e:{}),(n=u?.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return o.accessToken?v.accessToken=o.accessToken:delete v.accessToken,v}function Ux(o){const t=o?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(jx(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Ow="2.76.1",la=30*1e3,Ff=3,af=Ff*la,Fx="http://localhost:9999",zx="supabase.auth.token",Hx={"X-Client-Info":`gotrue-js/${Ow}`},zf="X-Supabase-Api-Version",Mw={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},$x=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,qx=10*60*1e3;class il extends Error{constructor(t,e,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=n}}function mt(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class Gx extends il{constructor(t,e,n){super(t,e,n),this.name="AuthApiError",this.status=e,this.code=n}}function Vx(o){return mt(o)&&o.name==="AuthApiError"}class er extends il{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class Rs extends il{constructor(t,e,n,s){super(t,n,s),this.name=e,this.status=n}}class ws extends Rs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Xx(o){return mt(o)&&o.name==="AuthSessionMissingError"}class ea extends Rs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Gc extends Rs{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Vc extends Rs{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Yx(o){return mt(o)&&o.name==="AuthImplicitGrantRedirectError"}class gb extends Rs{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Hf extends Rs{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}}function of(o){return mt(o)&&o.name==="AuthRetryableFetchError"}class pb extends Rs{constructor(t,e,n){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=n}}class $f extends Rs{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const gu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),mb=` 	
\r=`.split(""),Wx=(()=>{const o=new Array(128);for(let t=0;t<o.length;t+=1)o[t]=-1;for(let t=0;t<mb.length;t+=1)o[mb[t].charCodeAt(0)]=-2;for(let t=0;t<gu.length;t+=1)o[gu[t].charCodeAt(0)]=t;return o})();function yb(o,t,e){if(o!==null)for(t.queue=t.queue<<8|o,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;e(gu[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;e(gu[n]),t.queuedBits-=6}}function kw(o,t,e){const n=Wx[o];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)e(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function vb(o){const t=[],e=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=l=>{Zx(l,n,e)};for(let l=0;l<o.length;l+=1)kw(o.charCodeAt(l),s,a);return t.join("")}function Kx(o,t){if(o<=127){t(o);return}else if(o<=2047){t(192|o>>6),t(128|o&63);return}else if(o<=65535){t(224|o>>12),t(128|o>>6&63),t(128|o&63);return}else if(o<=1114111){t(240|o>>18),t(128|o>>12&63),t(128|o>>6&63),t(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function Qx(o,t){for(let e=0;e<o.length;e+=1){let n=o.charCodeAt(e);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(o.charCodeAt(e+1)-56320&65535|s)+65536,e+=1}Kx(n,t)}}function Zx(o,t,e){if(t.utf8seq===0){if(o<=127){e(o);return}for(let n=1;n<6;n+=1)if((o>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=o&31;else if(t.utf8seq===3)t.codepoint=o&15;else if(t.utf8seq===4)t.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|o&63,t.utf8seq-=1,t.utf8seq===0&&e(t.codepoint)}}function pa(o){const t=[],e={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<o.length;s+=1)kw(o.charCodeAt(s),e,n);return new Uint8Array(t)}function Jx(o){const t=[];return Qx(o,e=>t.push(e)),new Uint8Array(t)}function ir(o){const t=[],e={queue:0,queuedBits:0},n=s=>{t.push(s)};return o.forEach(s=>yb(s,e,n)),yb(null,e,n),t.join("")}function t1(o){return Math.round(Date.now()/1e3)+o}function e1(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const t=Math.random()*16|0;return(o=="x"?t:t&3|8).toString(16)})}const Tn=()=>typeof window<"u"&&typeof document<"u",Ks={tested:!1,writable:!1},Pw=()=>{if(!Tn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ks.tested)return Ks.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),Ks.tested=!0,Ks.writable=!0}catch{Ks.tested=!0,Ks.writable=!1}return Ks.writable};function n1(o){const t={},e=new URL(o);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((s,a)=>{t[a]=s})}catch{}return e.searchParams.forEach((n,s)=>{t[s]=n}),t}const Nw=o=>{let t;return o?t=o:typeof fetch>"u"?t=(...e)=>Oa(async()=>{const{default:n}=await Promise.resolve().then(()=>hr);return{default:n}},void 0).then(({default:n})=>n(...e)):t=fetch,(...e)=>t(...e)},i1=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",ca=async(o,t,e)=>{await o.setItem(t,JSON.stringify(e))},Qs=async(o,t)=>{const e=await o.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}},ys=async(o,t)=>{await o.removeItem(t)};class Tu{constructor(){this.promise=new Tu.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}Tu.promiseConstructor=Promise;function lf(o){const t=o.split(".");if(t.length!==3)throw new $f("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!$x.test(t[n]))throw new $f("JWT not in base64url format");return{header:JSON.parse(vb(t[0])),payload:JSON.parse(vb(t[1])),signature:pa(t[2]),raw:{header:t[0],payload:t[1]}}}async function s1(o){return await new Promise(t=>{setTimeout(()=>t(null),o)})}function r1(o,t){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const l=await o(a);if(!t(a,null,l)){n(l);return}}catch(l){if(!t(a,l)){s(l);return}}})()})}function a1(o){return("0"+o.toString(16)).substr(-2)}function o1(){const t=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=e.length;let s="";for(let a=0;a<56;a++)s+=e.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,a1).join("")}async function l1(o){const e=new TextEncoder().encode(o),n=await crypto.subtle.digest("SHA-256",e),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function c1(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const e=await l1(o);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function na(o,t,e=!1){const n=o1();let s=n;e&&(s+="/PASSWORD_RECOVERY"),await ca(o,`${t}-code-verifier`,s);const a=await c1(n);return[a,n===a?"plain":"s256"]}const u1=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function h1(o){const t=o.headers.get(zf);if(!t||!t.match(u1))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function d1(o){if(!o)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(o<=t)throw new Error("JWT has expired")}function f1(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const g1=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ia(o){if(!g1.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function cf(){const o={};return new Proxy(o,{get:(t,e)=>{if(e==="__isUserNotAvailableProxy")return!0;if(typeof e=="symbol"){const n=e.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${e}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function bb(o){return JSON.parse(JSON.stringify(o))}const Js=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),p1=[502,503,504];async function wb(o){var t;if(!i1(o))throw new Hf(Js(o),0);if(p1.includes(o.status))throw new Hf(Js(o),o.status);let e;try{e=await o.json()}catch(a){throw new er(Js(a),a)}let n;const s=h1(o);if(s&&s.getTime()>=Mw["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?n=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(n=e.error_code),n){if(n==="weak_password")throw new pb(Js(e),o.status,((t=e.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new ws}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((a,l)=>a&&typeof l=="string",!0))throw new pb(Js(e),o.status,e.weak_password.reasons);throw new Gx(Js(e),o.status||500,n)}const m1=(o,t,e,n)=>{const s={method:o,headers:t?.headers||{}};return o==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),e))};async function At(o,t,e,n){var s;const a=Object.assign({},n?.headers);a[zf]||(a[zf]=Mw["2024-01-01"].name),n?.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const l=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(l.redirect_to=n.redirectTo);const u=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await y1(o,t,e+u,{headers:a,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(d):{data:Object.assign({},d),error:null}}async function y1(o,t,e,n,s,a){const l=m1(t,n,s,a);let u;try{u=await o(e,Object.assign({},l))}catch(d){throw console.error(d),new Hf(Js(d),0)}if(u.ok||await wb(u),n?.noResolveJson)return u;try{return await u.json()}catch(d){await wb(d)}}function Zn(o){var t;let e=null;w1(o)&&(e=Object.assign({},o),o.expires_at||(e.expires_at=t1(o.expires_in)));const n=(t=o.user)!==null&&t!==void 0?t:o;return{data:{session:e,user:n},error:null}}function _b(o){const t=Zn(o);return!t.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((e,n)=>e&&typeof n=="string",!0)&&(t.data.weak_password=o.weak_password),t}function Ss(o){var t;return{data:{user:(t=o.user)!==null&&t!==void 0?t:o},error:null}}function v1(o){return{data:o,error:null}}function b1(o){const{action_link:t,email_otp:e,hashed_token:n,redirect_to:s,verification_type:a}=o,l=Da(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:e,hashed_token:n,redirect_to:s,verification_type:a},d=Object.assign({},l);return{data:{properties:u,user:d},error:null}}function Sb(o){return o}function w1(o){return o.access_token&&o.refresh_token&&o.expires_in}const uf=["global","local","others"];class _1{constructor({url:t="",headers:e={},fetch:n}){this.url=t,this.headers=e,this.fetch=Nw(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,e=uf[0]){if(uf.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${uf.join(", ")}`);try{return await At(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(mt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,e={}){try{return await At(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:Ss})}catch(n){if(mt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:e}=t,n=Da(t,["options"]),s=Object.assign(Object.assign({},n),e);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await At(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:b1,redirectTo:e?.redirectTo})}catch(e){if(mt(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(t){try{return await At(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ss})}catch(e){if(mt(e))return{data:{user:null},error:e};throw e}}async listUsers(t){var e,n,s,a,l,u,d;try{const f={nextPage:null,lastPage:0,total:0},g=await At(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:Sb});if(g.error)throw g.error;const m=await g.json(),v=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,b=(d=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return b.length>0&&(b.forEach(S=>{const w=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(S.split(";")[1].split("=")[1]);f[`${A}Page`]=w}),f.total=parseInt(v)),{data:Object.assign(Object.assign({},m),f),error:null}}catch(f){if(mt(f))return{data:{users:[]},error:f};throw f}}async getUserById(t){ia(t);try{return await At(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ss})}catch(e){if(mt(e))return{data:{user:null},error:e};throw e}}async updateUserById(t,e){ia(t);try{return await At(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:Ss})}catch(n){if(mt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,e=!1){ia(t);try{return await At(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:Ss})}catch(n){if(mt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){ia(t.userId);try{const{data:e,error:n}=await At(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:e,error:n}}catch(e){if(mt(e))return{data:null,error:e};throw e}}async _deleteFactor(t){ia(t.userId),ia(t.id);try{return{data:await At(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(mt(e))return{data:null,error:e};throw e}}async _listOAuthClients(t){var e,n,s,a,l,u,d;try{const f={nextPage:null,lastPage:0,total:0},g=await At(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:Sb});if(g.error)throw g.error;const m=await g.json(),v=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,b=(d=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return b.length>0&&(b.forEach(S=>{const w=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(S.split(";")[1].split("=")[1]);f[`${A}Page`]=w}),f.total=parseInt(v)),{data:Object.assign(Object.assign({},m),f),error:null}}catch(f){if(mt(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(t){try{return await At(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(mt(e))return{data:null,error:e};throw e}}async _getOAuthClient(t){try{return await At(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(mt(e))return{data:null,error:e};throw e}}async _deleteOAuthClient(t){try{return await At(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(mt(e))return{data:null,error:e};throw e}}async _regenerateOAuthClientSecret(t){try{return await At(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(mt(e))return{data:null,error:e};throw e}}}function Ab(o={}){return{getItem:t=>o[t]||null,setItem:(t,e)=>{o[t]=e},removeItem:t=>{delete o[t]}}}const sa={debug:!!(globalThis&&Pw()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Lw extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class S1 extends Lw{}async function A1(o,t,e){sa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),sa.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){sa.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,s.name);try{return await e()}finally{sa.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,s.name)}}else{if(t===0)throw sa.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new S1(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(sa.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await e()}}))}function E1(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Bw(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function T1(o){return parseInt(o,16)}function x1(o){const t=new TextEncoder().encode(o);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function C1(o){var t;const{chainId:e,domain:n,expirationTime:s,issuedAt:a=new Date,nonce:l,notBefore:u,requestId:d,resources:f,scheme:g,uri:m,version:v}=o;{if(!Number.isInteger(e))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${e}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((t=o.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const b=Bw(o.address),S=g?`${g}://${n}`:n,w=o.statement?`${o.statement}
`:"",A=`${S} wants you to sign in with your Ethereum account:
${b}

${w}`;let _=`URI: ${m}
Version: ${v}
Chain ID: ${e}${l?`
Nonce: ${l}`:""}
Issued At: ${a.toISOString()}`;if(s&&(_+=`
Expiration Time: ${s.toISOString()}`),u&&(_+=`
Not Before: ${u.toISOString()}`),d&&(_+=`
Request ID: ${d}`),f){let E=`
Resources:`;for(const x of f){if(!x||typeof x!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${x}`);E+=`
- ${x}`}_+=E}return`${A}
${_}`}class Re extends Error{constructor({message:t,code:e,cause:n,name:s}){var a;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=s??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=e}}class pu extends Re{constructor(t,e){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e,message:t}),this.name="WebAuthnUnknownError",this.originalError=e}}function R1({error:o,options:t}){var e,n,s;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Re({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((e=a.authenticatorSelection)===null||e===void 0?void 0:e.requireResidentKey)===!0)return new Re({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(t.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Re({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Re({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new Re({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new Re({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return a.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new Re({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new Re({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const l=window.location.hostname;if(jw(l)){if(a.rp.id!==l)return new Re({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Re({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Re({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new Re({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Re({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function D1({error:o,options:t}){const{publicKey:e}=t;if(!e)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Re({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new Re({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const n=window.location.hostname;if(jw(n)){if(e.rpId!==n)return new Re({message:`The RP ID "${e.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Re({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new Re({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Re({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class O1{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const M1=new O1;function k1(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:t,user:e,excludeCredentials:n}=o,s=Da(o,["challenge","user","excludeCredentials"]),a=pa(t).buffer,l=Object.assign(Object.assign({},e),{id:pa(e.id).buffer}),u=Object.assign(Object.assign({},s),{challenge:a,user:l});if(n&&n.length>0){u.excludeCredentials=new Array(n.length);for(let d=0;d<n.length;d++){const f=n[d];u.excludeCredentials[d]=Object.assign(Object.assign({},f),{id:pa(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return u}function P1(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:t,allowCredentials:e}=o,n=Da(o,["challenge","allowCredentials"]),s=pa(t).buffer,a=Object.assign(Object.assign({},n),{challenge:s});if(e&&e.length>0){a.allowCredentials=new Array(e.length);for(let l=0;l<e.length;l++){const u=e[l];a.allowCredentials[l]=Object.assign(Object.assign({},u),{id:pa(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return a}function N1(o){var t;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const e=o;return{id:o.id,rawId:o.id,response:{attestationObject:ir(new Uint8Array(o.response.attestationObject)),clientDataJSON:ir(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(t=e.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function L1(o){var t;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const e=o,n=o.getClientExtensionResults(),s=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:ir(new Uint8Array(s.authenticatorData)),clientDataJSON:ir(new Uint8Array(s.clientDataJSON)),signature:ir(new Uint8Array(s.signature)),userHandle:s.userHandle?ir(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=e.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function jw(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function Eb(){var o,t;return!!(Tn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator?.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function B1(o){try{const t=await navigator.credentials.create(o);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new pu("Browser returned unexpected credential type",t)}:{data:null,error:new pu("Empty credential response",t)}}catch(t){return{data:null,error:R1({error:t,options:o})}}}async function j1(o){try{const t=await navigator.credentials.get(o);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new pu("Browser returned unexpected credential type",t)}:{data:null,error:new pu("Empty credential response",t)}}catch(t){return{data:null,error:D1({error:t,options:o})}}}const I1={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},U1={userVerification:"preferred",hints:["security-key"]};function mu(...o){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),e=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of o)if(s)for(const a in s){const l=s[a];if(l!==void 0)if(Array.isArray(l))n[a]=l;else if(e(l))n[a]=l;else if(t(l)){const u=n[a];t(u)?n[a]=mu(u,l):n[a]=mu(l)}else n[a]=l}return n}function F1(o,t){return mu(I1,o,t||{})}function z1(o,t){return mu(U1,o,t||{})}class H1{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:e,friendlyName:n,signal:s},a){try{const{data:l,error:u}=await this.client.mfa.challenge({factorId:t,webauthn:e});if(!l)return{data:null,error:u};const d=s??M1.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:f}=l.webauthn.credential_options.publicKey;f.name||(f.name=`${f.id}:${n}`),f.displayName||(f.displayName=f.name)}switch(l.webauthn.type){case"create":{const f=F1(l.webauthn.credential_options.publicKey,a?.create),{data:g,error:m}=await B1({publicKey:f,signal:d});return g?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:g}},error:null}:{data:null,error:m}}case"request":{const f=z1(l.webauthn.credential_options.publicKey,a?.request),{data:g,error:m}=await j1(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:f,signal:d}));return g?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:g}},error:null}:{data:null,error:m}}}}catch(l){return mt(l)?{data:null,error:l}:{data:null,error:new er("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:e,webauthn:n}){return this.client.mfa.verify({factorId:e,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}},a){if(!e)return{data:null,error:new il("rpId is required for WebAuthn authentication")};try{if(!Eb())return{data:null,error:new er("Browser does not support WebAuthn",null)};const{data:l,error:u}=await this.challenge({factorId:t,webauthn:{rpId:e,rpOrigins:n},signal:s},{request:a});if(!l)return{data:null,error:u};const{webauthn:d}=l;return this._verify({factorId:t,challengeId:l.challengeId,webauthn:{type:d.type,rpId:e,rpOrigins:n,credential_response:d.credential_response}})}catch(l){return mt(l)?{data:null,error:l}:{data:null,error:new er("Unexpected error in authenticate",l)}}}async _register({friendlyName:t,rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s},a){if(!e)return{data:null,error:new il("rpId is required for WebAuthn registration")};try{if(!Eb())return{data:null,error:new er("Browser does not support WebAuthn",null)};const{data:l,error:u}=await this._enroll({friendlyName:t});if(!l)return await this.client.mfa.listFactors().then(g=>{var m;return(m=g.data)===null||m===void 0?void 0:m.all.find(v=>v.factor_type==="webauthn"&&v.friendly_name===t&&v.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g?.id}):void 0),{data:null,error:u};const{data:d,error:f}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:e,rpOrigins:n},signal:s},{create:a});return d?this._verify({factorId:l.id,challengeId:d.challengeId,webauthn:{rpId:e,rpOrigins:n,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:f}}catch(l){return mt(l)?{data:null,error:l}:{data:null,error:new er("Unexpected error in register",l)}}}}E1();const $1={url:Fx,storageKey:zx,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Hx,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Tb(o,t,e){return await e()}const ra={};class sl{get jwks(){var t,e;return(e=(t=ra[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&e!==void 0?e:{keys:[]}}set jwks(t){ra[this.storageKey]=Object.assign(Object.assign({},ra[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,e;return(e=(t=ra[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&e!==void 0?e:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){ra[this.storageKey]=Object.assign(Object.assign({},ra[this.storageKey]),{cachedAt:t})}constructor(t){var e,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=sl.nextInstanceID,sl.nextInstanceID+=1,this.instanceID>0&&Tn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},$1),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new _1({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Nw(s.fetch),this.lock=s.lock||Tb,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Tn()&&(!((e=globalThis?.navigator)===null||e===void 0)&&e.locks)?this.lock=A1:this.lock=Tb,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new H1(this)},this.persistSession?(s.storage?this.storage=s.storage:Pw()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ab(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Ab(this.memoryStorage)),Tn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Ow}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const e=n1(window.location.href);let n="none";if(this._isImplicitGrantCallback(e)?n="implicit":await this._isPKCECallback(e)&&(n="pkce"),Tn()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(e,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Yx(a)){const d=(t=a.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:l,redirectType:u}=s;return this._debug("#_initialize()","detected session in URL",l,"redirect type",u),await this._saveSession(l),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return mt(e)?{error:e}:{error:new er("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var e,n,s;try{const a=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(e=t?.options)===null||e===void 0?void 0:e.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t?.options)===null||s===void 0?void 0:s.captchaToken}},xform:Zn}),{data:l,error:u}=a;if(u||!l)return{data:{user:null,session:null},error:u};const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(a){if(mt(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(t){var e,n,s;try{let a;if("email"in t){const{email:g,password:m,options:v}=t;let b=null,S=null;this.flowType==="pkce"&&([b,S]=await na(this.storage,this.storageKey)),a=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v?.emailRedirectTo,body:{email:g,password:m,data:(e=v?.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:b,code_challenge_method:S},xform:Zn})}else if("phone"in t){const{phone:g,password:m,options:v}=t;a=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:m,data:(n=v?.data)!==null&&n!==void 0?n:{},channel:(s=v?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:Zn})}else throw new Gc("You must provide either an email or phone number and a password");const{data:l,error:u}=a;if(u||!l)return{data:{user:null,session:null},error:u};const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(a){if(mt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(t){try{let e;if("email"in t){const{email:a,password:l,options:u}=t;e=await At(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:_b})}else if("phone"in t){const{phone:a,password:l,options:u}=t;e=await At(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:_b})}else throw new Gc("You must provide either an email or phone number and a password");const{data:n,error:s}=e;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new ea}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(e){if(mt(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(t){var e,n,s,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(e=t.options)===null||e===void 0?void 0:e.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:e}=t;switch(e){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${e}"`)}}async signInWithEthereum(t){var e,n,s,a,l,u,d,f,g,m,v;let b,S;if("message"in t)b=t.message,S=t.signature;else{const{chain:w,wallet:A,statement:_,options:E}=t;let x;if(Tn())if(typeof A=="object")x=A;else{const L=window;if("ethereum"in L&&typeof L.ethereum=="object"&&"request"in L.ethereum&&typeof L.ethereum.request=="function")x=L.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!E?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=A}const O=new URL((e=E?.url)!==null&&e!==void 0?e:window.location.href),C=await x.request({method:"eth_requestAccounts"}).then(L=>L).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!C||C.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const D=Bw(C[0]);let R=(n=E?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!R){const L=await x.request({method:"eth_chainId"});R=T1(L)}const k={domain:O.host,address:D,statement:_,uri:O.href,version:"1",chainId:R,nonce:(s=E?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(l=(a=E?.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(u=E?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(d=E?.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(f=E?.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(g=E?.signInWithEthereum)===null||g===void 0?void 0:g.resources};b=C1(k),S=await x.request({method:"personal_sign",params:[x1(b),D]})}try{const{data:w,error:A}=await At(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:S},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:Zn});if(A)throw A;return!w||!w.session||!w.user?{data:{user:null,session:null},error:new ea}:(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),{data:Object.assign({},w),error:A})}catch(w){if(mt(w))return{data:{user:null,session:null},error:w};throw w}}async signInWithSolana(t){var e,n,s,a,l,u,d,f,g,m,v,b;let S,w;if("message"in t)S=t.message,w=t.signature;else{const{chain:A,wallet:_,statement:E,options:x}=t;let O;if(Tn())if(typeof _=="object")O=_;else{const D=window;if("solana"in D&&typeof D.solana=="object"&&("signIn"in D.solana&&typeof D.solana.signIn=="function"||"signMessage"in D.solana&&typeof D.solana.signMessage=="function"))O=D.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!x?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=_}const C=new URL((e=x?.url)!==null&&e!==void 0?e:window.location.href);if("signIn"in O&&O.signIn){const D=await O.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x?.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),E?{statement:E}:null));let R;if(Array.isArray(D)&&D[0]&&typeof D[0]=="object")R=D[0];else if(D&&typeof D=="object"&&"signedMessage"in D&&"signature"in D)R=D;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)S=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),w=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in O)||typeof O.signMessage!="function"||!("publicKey"in O)||typeof O!="object"||!O.publicKey||!("toBase58"in O.publicKey)||typeof O.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${C.host} wants you to sign in with your Solana account:`,O.publicKey.toBase58(),...E?["",E,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(s=(n=x?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=x?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((l=x?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((u=x?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((d=x?.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((f=x?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((m=(g=x?.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||m===void 0)&&m.length?["Resources",...x.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const D=await O.signMessage(new TextEncoder().encode(S),"utf8");if(!D||!(D instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=D}}try{const{data:A,error:_}=await At(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:ir(w)},!((v=t.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(b=t.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Zn});if(_)throw _;return!A||!A.session||!A.user?{data:{user:null,session:null},error:new ea}:(A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),{data:Object.assign({},A),error:_})}catch(A){if(mt(A))return{data:{user:null,session:null},error:A};throw A}}async _exchangeCodeForSession(t){const e=await Qs(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(e??"").split("/");try{const{data:a,error:l}=await At(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Zn});if(await ys(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new ea}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:l})}catch(a){if(mt(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(t){try{const{options:e,provider:n,token:s,access_token:a,nonce:l}=t,u=await At(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:l,gotrue_meta_security:{captcha_token:e?.captchaToken}},xform:Zn}),{data:d,error:f}=u;return f?{data:{user:null,session:null},error:f}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new ea}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:f})}catch(e){if(mt(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(t){var e,n,s,a,l;try{if("email"in t){const{email:u,options:d}=t;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await na(this.storage,this.storageKey));const{error:m}=await At(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(e=d?.data)!==null&&e!==void 0?e:{},create_user:(n=d?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:d?.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in t){const{phone:u,options:d}=t,{data:f,error:g}=await At(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(s=d?.data)!==null&&s!==void 0?s:{},create_user:(a=d?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:d?.captchaToken},channel:(l=d?.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:f?.message_id},error:g}}throw new Gc("You must provide either an email or phone number.")}catch(u){if(mt(u))return{data:{user:null,session:null},error:u};throw u}}async verifyOtp(t){var e,n;try{let s,a;"options"in t&&(s=(e=t.options)===null||e===void 0?void 0:e.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:u}=await At(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:Zn});if(u)throw u;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,f=l.user;return d?.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(s){if(mt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var e,n,s;try{let a=null,l=null;return this.flowType==="pkce"&&([a,l]=await na(this.storage,this.storageKey)),await At(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(e=t.options)===null||e===void 0?void 0:e.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:l}),headers:this.headers,xform:v1})}catch(a){if(mt(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:e},error:n}=t;if(n)throw n;if(!e)throw new ws;const{error:s}=await At(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(mt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const e=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:a}=t,{error:l}=await At(this.fetch,"POST",e,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in t){const{phone:n,type:s,options:a}=t,{data:l,error:u}=await At(this.fetch,"POST",e,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return{data:{user:null,session:null,messageId:l?.message_id},error:u}}throw new Gc("You must provide either an email or phone number and a type")}catch(e){if(mt(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(t,e){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await e()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=e();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await t(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const e=await Qs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?t=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<af:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const l=await Qs(this.userStorage,this.storageKey+"-user");l?.user?t.user=l.user:t.user=cf()}if(this.storage.isServer&&t.user){let l=this.suppressGetSessionWarning;t=new Proxy(t,{get:(d,f,g)=>(!l&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,f,g))})}return{data:{session:t},error:null}}const{data:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await At(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ss}):await this._useSession(async e=>{var n,s,a;const{data:l,error:u}=e;if(u)throw u;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ws}:await At(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:Ss})})}catch(e){if(mt(e))return Xx(e)&&(await this._removeSession(),await ys(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(t,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,e))}async _updateUser(t,e={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new ws;const l=s.session;let u=null,d=null;this.flowType==="pkce"&&t.email!=null&&([u,d]=await na(this.storage,this.storageKey));const{data:f,error:g}=await At(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:d}),jwt:l.access_token,xform:Ss});if(g)throw g;return l.user=f.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(n){if(mt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ws;const e=Date.now()/1e3;let n=e,s=!0,a=null;const{payload:l}=lf(t.access_token);if(l.exp&&(n=l.exp,s=n<=e),s){const{data:u,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!u)return{data:{user:null,session:null},error:null};a=u}else{const{data:u,error:d}=await this._getUser(t.access_token);if(d)throw d;a={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:n-e,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(e){if(mt(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async e=>{var n;if(!t){const{data:l,error:u}=e;if(u)throw u;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new ws;const{data:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{user:null,session:null},error:a}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(mt(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(t,e){try{if(!Tn())throw new Vc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Vc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(e){case"implicit":if(this.flowType==="pkce")throw new gb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Vc("Not a valid implicit grant flow url.");break;default:}if(e==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new gb("No code detected.");const{data:E,error:x}=await this._exchangeCodeForSession(t.code);if(x)throw x;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:E.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:l,expires_in:u,expires_at:d,token_type:f}=t;if(!a||!u||!l||!f)throw new Vc("No session defined in URL");const g=Math.round(Date.now()/1e3),m=parseInt(u);let v=g+m;d&&(v=parseInt(d));const b=v-g;b*1e3<=la&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${m}s`);const S=v-m;g-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,v,g):g-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,v,g);const{data:w,error:A}=await this._getUser(a);if(A)throw A;const _={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:m,expires_at:v,refresh_token:l,token_type:f,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:_,redirectType:t.type},error:null}}catch(n){if(mt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const e=await Qs(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&e)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async e=>{var n;const{data:s,error:a}=e;if(a)return{error:a};const l=(n=s.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:u}=await this.admin.signOut(l,t);if(u&&!(Vx(u)&&(u.status===404||u.status===401||u.status===403)))return{error:u}}return t!=="others"&&(await this._removeSession(),await ys(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const e=e1(),n={id:e,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async e=>{var n,s;try{const{data:{session:a},error:l}=e;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,e={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await na(this.storage,this.storageKey,!0));try{return await At(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(a){if(mt(a))return{data:null,error:a};throw a}}async getUserIdentities(){var t;try{const{data:e,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=e.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(e){if(mt(e))return{data:null,error:e};throw e}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var e;try{const{data:n,error:s}=await this._useSession(async a=>{var l,u,d,f,g;const{data:m,error:v}=a;if(v)throw v;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await At(this.fetch,"GET",b,{headers:this.headers,jwt:(g=(f=m.session)===null||f===void 0?void 0:f.access_token)!==null&&g!==void 0?g:void 0})});if(s)throw s;return Tn()&&!(!((e=t.options)===null||e===void 0)&&e.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:t.provider,url:n?.url},error:null}}catch(n){if(mt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async linkIdentityIdToken(t){return await this._useSession(async e=>{var n;try{const{error:s,data:{session:a}}=e;if(s)throw s;const{options:l,provider:u,token:d,access_token:f,nonce:g}=t,m=await At(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:u,id_token:d,access_token:f,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Zn}),{data:v,error:b}=m;return b?{data:{user:null,session:null},error:b}:!v||!v.session||!v.user?{data:{user:null,session:null},error:new ea}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("USER_UPDATED",v.session)),{data:v,error:b})}catch(s){if(mt(s))return{data:{user:null,session:null},error:s};throw s}})}async unlinkIdentity(t){try{return await this._useSession(async e=>{var n,s;const{data:a,error:l}=e;if(l)throw l;return await At(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(e){if(mt(e))return{data:null,error:e};throw e}}async _refreshAccessToken(t){const e=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(e,"begin");try{const n=Date.now();return await r1(async s=>(s>0&&await s1(200*Math.pow(2,s-1)),this._debug(e,"refreshing attempt",s),await At(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Zn})),(s,a)=>{const l=200*Math.pow(2,s);return a&&of(a)&&Date.now()+l-n<la})}catch(n){if(this._debug(e,"error",n),mt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(e,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,e){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",e,"url",n),Tn()&&!e.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Qs(this.storage,this.storageKey);if(s&&this.userStorage){let l=await Qs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:s.user},await ca(this.userStorage,this.storageKey+"-user",l)),s.user=(t=l?.user)!==null&&t!==void 0?t:cf()}else if(s&&!s.user&&!s.user){const l=await Qs(this.storage,this.storageKey+"-user");l&&l?.user?(s.user=l.user,await ys(this.storage,this.storageKey+"-user"),await ca(this.storage,this.storageKey,s)):s.user=cf()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((e=s.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<af;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${af}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:l}=await this._callRefreshToken(s.refresh_token);l&&(console.error(l),of(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:u}=await this._getUser(s.access_token);!u&&l?.user?(s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var e,n;if(!t)throw new ws;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Tu;const{data:a,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!a.session)throw new ws;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const u={data:a.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(a){if(this._debug(s,"error",a),mt(a)){const l={data:null,error:a};return of(a)||await this._removeSession(),(e=this.refreshingDeferred)===null||e===void 0||e.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,e,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",e,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:e});const a=[],l=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,e)}catch(d){a.push(d)}});if(await Promise.all(l),a.length>0){for(let u=0;u<a.length;u+=1)console.error(a[u]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const e=Object.assign({},t),n=e.user&&e.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&e.user&&await ca(this.userStorage,this.storageKey+"-user",{user:e.user});const s=Object.assign({},e);delete s.user;const a=bb(s);await ca(this.storage,this.storageKey,a)}else{const s=bb(e);await ca(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await ys(this.storage,this.storageKey),await ys(this.storage,this.storageKey+"-code-verifier"),await ys(this.storage,this.storageKey+"-user"),this.userStorage&&await ys(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Tn()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),la);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:n}}=e;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/la);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${la}ms, refresh threshold is ${Ff} ticks`),s<=Ff&&await this._callRefreshToken(n.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Lw)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Tn()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const e=`#_onVisibilityChanged(${t})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,e,n){const s=[`provider=${encodeURIComponent(e)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,l]=await na(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(l)}`});s.push(u.toString())}if(n?.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async e=>{var n;const{data:s,error:a}=e;return a?{data:null,error:a}:await At(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(e){if(mt(e))return{data:null,error:e};throw e}}async _enroll(t){try{return await this._useSession(async e=>{var n,s;const{data:a,error:l}=e;if(l)return{data:null,error:l};const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:d,error:f}=await At(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return f?{data:null,error:f}:(t.factorType==="totp"&&d.type==="totp"&&(!((s=d?.totp)===null||s===void 0)&&s.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(e){if(mt(e))return{data:null,error:e};throw e}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var n;const{data:s,error:a}=e;if(a)return{data:null,error:a};const l=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?N1(t.webauthn.credential_response):L1(t.webauthn.credential_response)})}:{code:t.code}),{data:u,error:d}=await At(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:l,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),{data:u,error:d})})}catch(e){if(mt(e))return{data:null,error:e};throw e}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var n;const{data:s,error:a}=e;if(a)return{data:null,error:a};const l=await At(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});if(l.error)return l;const{data:u}=l;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:k1(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:P1(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if(mt(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(t){const{data:e,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:e.id,code:t.code})}async _listFactors(){var t;const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=e?.factors)!==null&&t!==void 0?t:[])s.all.push(a),a.status==="verified"&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var e,n;const{data:{session:s},error:a}=t;if(a)return{data:null,error:a};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=lf(s.access_token);let u=null;l.aal&&(u=l.aal);let d=u;((n=(e=s.user.factors)===null||e===void 0?void 0:e.filter(m=>m.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(d="aal2");const g=l.amr||[];return{data:{currentLevel:u,nextLevel:d,currentAuthenticationMethods:g},error:null}}))}async fetchJwk(t,e={keys:[]}){let n=e.keys.find(u=>u.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(u=>u.kid===t),n&&this.jwks_cached_at+qx>s)return n;const{data:a,error:l}=await At(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(u=>u.kid===t),!n)?null:n}async getClaims(t,e={}){try{let n=t;if(!n){const{data:b,error:S}=await this.getSession();if(S||!b.session)return{data:null,error:S};n=b.session.access_token}const{header:s,payload:a,signature:l,raw:{header:u,payload:d}}=lf(n);e?.allowExpired||d1(a.exp);const f=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,e?.keys?{keys:e.keys}:e?.jwks);if(!f){const{error:b}=await this.getUser(n);if(b)throw b;return{data:{claims:a,header:s,signature:l},error:null}}const g=f1(s.alg),m=await crypto.subtle.importKey("jwk",f,g,!0,["verify"]);if(!await crypto.subtle.verify(g,m,l,Jx(`${u}.${d}`)))throw new $f("Invalid JWT signature");return{data:{claims:a,header:s,signature:l},error:null}}catch(n){if(mt(n))return{data:null,error:n};throw n}}}sl.nextInstanceID=0;const q1=sl;class G1 extends q1{constructor(t){super(t)}}class V1{constructor(t,e,n){var s,a,l;this.supabaseUrl=t,this.supabaseKey=e;const u=Ux(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",u),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",u),this.storageUrl=new URL("storage/v1",u),this.functionsUrl=new URL("functions/v1",u);const d=`sb-${u.hostname.split(".")[0]}-auth-token`,f={db:Mx,realtime:Px,auth:Object.assign(Object.assign({},kx),{storageKey:d}),global:Ox},g=Ix(n??{},f);this.storageKey=(s=g.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=g.global.headers)!==null&&a!==void 0?a:{},g.accessToken?(this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(m,v)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(v)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=g.auth)!==null&&l!==void 0?l:{},this.headers,g.global.fetch),this.fetch=Bx(e,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.rest=new FT(new URL("rest/v1",u).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch}),this.storage=new Cx(this.storageUrl.href,this.headers,this.fetch,n?.storage),g.accessToken||this._listenForAuthEvents()}get functions(){return new OT(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,e;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(e=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:a,storageKey:l,flowType:u,lock:d,debug:f},g,m){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new G1({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),g),storageKey:l,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:s,userStorage:a,flowType:u,lock:d,debug:f,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new ix(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,n)=>{this._handleTokenChanged(e,"CLIENT",n?.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const X1=(o,t,e)=>new V1(o,t,e);function Y1(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const t=o.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Y1()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const W1="https://ujqbkeqcompkvseaouac.supabase.co",K1="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVqcWJrZXFjb21wa3ZzZWFvdWFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE0NDAxODAsImV4cCI6MjA3NzAxNjE4MH0.q2yT2mUY1V4THvuU3KksuINNTBuWbphZhkSuLyeoUhE",Ze=X1(W1,K1);let Sg=(o=21)=>crypto.getRandomValues(new Uint8Array(o)).reduce((t,e)=>(e&=63,e<36?t+=e.toString(36):e<62?t+=(e-26).toString(36).toUpperCase():e>62?t+="-":t+="_",t),"");function Q1({onUpload:o}){const t=j.useRef(null),[e,n]=j.useState(null),[s,a]=j.useState(!1),l=async d=>{const f=d.target.files?.[0];if(f){a(!0),n(f.name);try{const g=f.name.split(".").pop(),m=`${Sg()}.${g}`,{data:v,error:b}=await Ze.storage.from("uploads").upload(m,f);if(b)throw b;const{data:S}=Ze.storage.from("uploads").getPublicUrl(v.path);if(!S.publicUrl)throw new Error("URLPublic");console.log("URL:",S.publicUrl),o(S.publicUrl)}catch(g){console.error(":",g),alert(`: ${g.message}`),n("...")}finally{a(!1)}}},u=()=>{t.current?.click()};return Q.jsxs("div",{className:"flex flex-col items-center p-4 border-2 border-dashed border-gray-400 rounded-md bg-gray-50 mb-4",children:[Q.jsx("input",{type:"file",ref:t,onChange:l,className:"hidden",accept:"image/png, image/jpeg",disabled:s}),Q.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s?`...: ${e}`:e?`: ${e}`:""}),Q.jsx("button",{onClick:u,className:"py-2 px-4 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors disabled:opacity-50",disabled:s,children:s?"":e?"":""})]})}function Z1({className:o,onIconUpload:t,onTogglePdfViewer:e,dataNoPan:n}){const{attributes:s,listeners:a,setNodeRef:l,transform:u,isDragging:d}=Of({id:"red-note-template",data:{color:"r",text:"",type:"note-template"}}),f={transform:u?`translate3d(${u.x}px, ${u.y}px, 0)`:void 0,cursor:d?"grabbing":"grab",opacity:d?.8:1,position:"relative",zIndex:d?9999:void 0},{attributes:g,listeners:m,setNodeRef:v,transform:b,isDragging:S}=Of({id:"blue-note-template",data:{color:"b",text:"",type:"note-template"}}),w={transform:b?`translate3d(${b.x}px, ${b.y}px, 0)`:void 0,cursor:S?"grabbing":"grab",opacity:S?.8:1,position:"relative",zIndex:S?9999:void 0};return Q.jsxs("aside",{className:`w-64 bg-gray-100 p-4 shadow-lg rounded-r-lg flex flex-col items-center ${o||""}`,"data-no-pan":n?"true":void 0,children:[Q.jsx("div",{className:"w-full h-12 bg-gray-300 rounded-md mb-4 flex items-center justify-center text-gray-600 font-medium",children:""}),Q.jsx(Q1,{onUpload:t}),Q.jsx("div",{ref:l,style:f,...s,...a,className:Vn("note","note-red","template-note"),children:Q.jsx("div",{className:"note-text-readonly",children:""})}),Q.jsx("div",{ref:v,style:w,...g,...m,className:Vn("note","note-blue","template-note"),children:Q.jsx("div",{className:"note-text-readonly",children:""})}),Q.jsx("div",{className:"w-full h-32 bg-gray-300 rounded-md mb-4 flex items-center justify-center text-gray-600 font-medium",children:""}),Q.jsx("div",{className:"w-full h-48 bg-gray-300 rounded-md flex items-center justify-center text-gray-600 font-medium",children:""}),Q.jsx("div",{className:"mt-8",children:Q.jsx("button",{onClick:e,className:"w-full bg-gray-700 text-white font-bold py-2 px-4 rounded hover:bg-gray-600",children:"PDF"})})]})}const J1=({onAddReply:o,onCancel:t})=>{const[e,n]=j.useState(""),s=()=>{e.trim()&&(o(e),n(""))};return Q.jsxs("div",{className:"reply-form",children:[Q.jsx("textarea",{className:"reply-textarea",rows:2,value:e,onChange:a=>n(a.target.value),placeholder:"..."}),Q.jsxs("div",{className:"reply-form-actions",children:[Q.jsx("button",{onClick:t,className:"cancel-button",children:""}),Q.jsx("button",{onClick:s,className:"submit-button",children:""})]})]})};function tC({className:o,notes:t,onAddReply:e,onToggleReadStatus:n}){const[s,a]=j.useState("question"),[l,u]=j.useState(null),d=t.filter(f=>s==="question"?f.color==="b":f.color==="r");return Q.jsxs("aside",{className:`w-64 bg-gray-100 p-2 shadow-lg rounded-l-lg flex flex-col ${o||""}`,children:[Q.jsxs("div",{className:"flex border-b-2",children:[Q.jsx("button",{onClick:()=>a("question"),className:Vn("flex-1 py-2 text-sm font-bold",s==="question"?"bg-blue-100 text-blue-700":"text-gray-500"),children:""}),Q.jsx("button",{onClick:()=>a("comment"),className:Vn("flex-1 py-2 text-sm font-bold",s==="comment"?"bg-red-100 text-red-700":"text-gray-500"),children:""})]}),Q.jsx("div",{className:"sidebar-list-container",children:d.length>0?Q.jsx("ul",{className:"sidebar-list",children:d.map(f=>Q.jsxs("li",{className:Vn("note-item",{"is-read":f.isRead}),children:[Q.jsxs("div",{className:"note-item-header",children:[Q.jsx("div",{className:"checkbox",onClick:()=>n(f.id),children:f.isRead?"":""}),Q.jsx("p",{className:"note-text",children:f.text})]}),Q.jsxs("div",{className:"replies-section",children:[f.replies?.map(g=>Q.jsx("div",{className:"reply-item",children:g.text},g.id)),l===f.id?Q.jsx(J1,{onAddReply:g=>{e(f.id,g),u(null)},onCancel:()=>u(null)}):Q.jsx("button",{className:"reply-button",onClick:()=>u(f.id),children:""})]})]},f.id))}):Q.jsx("div",{className:"text-center text-gray-500 mt-8",children:Q.jsx("p",{children:""})})})]})}const eC=j.forwardRef(({className:o,children:t,scale:e,viewpoint:n,onPanStart:s},a)=>{const l={transform:`translate(${n?.x??0}px, ${n?.y??0}px) scale(${e})`,transformOrigin:"top left"};return Q.jsx("main",{ref:a,className:`flex-1 overflow-hidden p-4 relative ${o||""}`,onMouseDown:s,children:Q.jsx("div",{style:l,children:t})})});var ko={exports:{}},Po={},No={exports:{}},hf={},df={exports:{}},ff,xb;function nC(){if(xb)return ff;xb=1;var o="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ff=o,ff}var gf,Cb;function iC(){if(Cb)return gf;Cb=1;var o=nC();function t(){}function e(){}return e.resetWarningCache=t,gf=function(){function n(l,u,d,f,g,m){if(m!==o){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}n.isRequired=n;function s(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:s,element:n,elementType:n,instanceOf:s,node:n,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:e,resetWarningCache:t};return a.PropTypes=a,a},gf}var Rb;function xu(){return Rb||(Rb=1,df.exports=iC()()),df.exports}var Xc={exports:{}},Db;function sC(){if(Db)return Xc.exports;Db=1;function o(e){var n,s,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var l=e.length;for(n=0;n<l;n++)e[n]&&(s=o(e[n]))&&(a&&(a+=" "),a+=s)}else for(s in e)e[s]&&(a&&(a+=" "),a+=s);return a}function t(){for(var e,n,s=0,a="",l=arguments.length;s<l;s++)(e=arguments[s])&&(n=o(e))&&(a&&(a+=" "),a+=n);return a}return Xc.exports=t,Xc.exports.clsx=t,Xc.exports}var we={},vs={},Ob;function Cu(){if(Ob)return vs;Ob=1,Object.defineProperty(vs,"__esModule",{value:!0}),vs.dontSetMe=s,vs.findInArray=o,vs.int=n,vs.isFunction=t,vs.isNum=e;function o(a,l){for(let u=0,d=a.length;u<d;u++)if(l.apply(l,[a[u],u,a]))return a[u]}function t(a){return typeof a=="function"||Object.prototype.toString.call(a)==="[object Function]"}function e(a){return typeof a=="number"&&!isNaN(a)}function n(a){return parseInt(a,10)}function s(a,l,u){if(a[l])return new Error(`Invalid prop ${l} passed to ${u} - do not set this, set it on the child.`)}return vs}var bs={},Mb;function rC(){if(Mb)return bs;Mb=1,Object.defineProperty(bs,"__esModule",{value:!0}),bs.browserPrefixToKey=e,bs.browserPrefixToStyle=n,bs.default=void 0,bs.getPrefix=t;const o=["Moz","Webkit","O","ms"];function t(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const l=window.document?.documentElement?.style;if(!l||a in l)return"";for(let u=0;u<o.length;u++)if(e(a,o[u])in l)return o[u];return""}function e(a,l){return l?`${l}${s(a)}`:a}function n(a,l){return l?`-${l.toLowerCase()}-${a}`:a}function s(a){let l="",u=!0;for(let d=0;d<a.length;d++)u?(l+=a[d].toUpperCase(),u=!1):a[d]==="-"?u=!0:l+=a[d];return l}return bs.default=t(),bs}var kb;function Ag(){if(kb)return we;kb=1,Object.defineProperty(we,"__esModule",{value:!0}),we.addClassName=C,we.addEvent=l,we.addUserSelectStyles=E,we.createCSSTransform=b,we.createSVGTransform=S,we.getTouch=A,we.getTouchIdentifier=_,we.getTranslation=w,we.innerHeight=g,we.innerWidth=m,we.matchesSelector=s,we.matchesSelectorAndParentsTo=a,we.offsetXYFromParent=v,we.outerHeight=d,we.outerWidth=f,we.removeClassName=D,we.removeEvent=u,we.scheduleRemoveUserSelectStyles=x;var o=Cu(),t=e(rC());function e(R,k){if(typeof WeakMap=="function")var L=new WeakMap,V=new WeakMap;return(e=function(q,it){if(!it&&q&&q.__esModule)return q;var rt,st,ot={__proto__:null,default:q};if(q===null||typeof q!="object"&&typeof q!="function")return ot;if(rt=it?V:L){if(rt.has(q))return rt.get(q);rt.set(q,ot)}for(const B in q)B!=="default"&&{}.hasOwnProperty.call(q,B)&&((st=(rt=Object.defineProperty)&&Object.getOwnPropertyDescriptor(q,B))&&(st.get||st.set)?rt(ot,B,st):ot[B]=q[B]);return ot})(R,k)}let n="";function s(R,k){return n||(n=(0,o.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(L){return(0,o.isFunction)(R[L])})),(0,o.isFunction)(R[n])?R[n](k):!1}function a(R,k,L){let V=R;do{if(s(V,k))return!0;if(V===L)return!1;V=V.parentNode}while(V);return!1}function l(R,k,L,V){if(!R)return;const q={capture:!0,...V};R.addEventListener?R.addEventListener(k,L,q):R.attachEvent?R.attachEvent("on"+k,L):R["on"+k]=L}function u(R,k,L,V){if(!R)return;const q={capture:!0,...V};R.removeEventListener?R.removeEventListener(k,L,q):R.detachEvent?R.detachEvent("on"+k,L):R["on"+k]=null}function d(R){let k=R.clientHeight;const L=R.ownerDocument.defaultView.getComputedStyle(R);return k+=(0,o.int)(L.borderTopWidth),k+=(0,o.int)(L.borderBottomWidth),k}function f(R){let k=R.clientWidth;const L=R.ownerDocument.defaultView.getComputedStyle(R);return k+=(0,o.int)(L.borderLeftWidth),k+=(0,o.int)(L.borderRightWidth),k}function g(R){let k=R.clientHeight;const L=R.ownerDocument.defaultView.getComputedStyle(R);return k-=(0,o.int)(L.paddingTop),k-=(0,o.int)(L.paddingBottom),k}function m(R){let k=R.clientWidth;const L=R.ownerDocument.defaultView.getComputedStyle(R);return k-=(0,o.int)(L.paddingLeft),k-=(0,o.int)(L.paddingRight),k}function v(R,k,L){const q=k===k.ownerDocument.body?{left:0,top:0}:k.getBoundingClientRect(),it=(R.clientX+k.scrollLeft-q.left)/L,rt=(R.clientY+k.scrollTop-q.top)/L;return{x:it,y:rt}}function b(R,k){const L=w(R,k,"px");return{[(0,t.browserPrefixToKey)("transform",t.default)]:L}}function S(R,k){return w(R,k,"")}function w(R,k,L){let{x:V,y:q}=R,it=`translate(${V}${L},${q}${L})`;if(k){const rt=`${typeof k.x=="string"?k.x:k.x+L}`,st=`${typeof k.y=="string"?k.y:k.y+L}`;it=`translate(${rt}, ${st})`+it}return it}function A(R,k){return R.targetTouches&&(0,o.findInArray)(R.targetTouches,L=>k===L.identifier)||R.changedTouches&&(0,o.findInArray)(R.changedTouches,L=>k===L.identifier)}function _(R){if(R.targetTouches&&R.targetTouches[0])return R.targetTouches[0].identifier;if(R.changedTouches&&R.changedTouches[0])return R.changedTouches[0].identifier}function E(R){if(!R)return;let k=R.getElementById("react-draggable-style-el");k||(k=R.createElement("style"),k.type="text/css",k.id="react-draggable-style-el",k.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,k.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,R.getElementsByTagName("head")[0].appendChild(k)),R.body&&C(R.body,"react-draggable-transparent-selection")}function x(R){window.requestAnimationFrame?window.requestAnimationFrame(()=>{O(R)}):O(R)}function O(R){if(R)try{if(R.body&&D(R.body,"react-draggable-transparent-selection"),R.selection)R.selection.empty();else{const k=(R.defaultView||window).getSelection();k&&k.type!=="Caret"&&k.removeAllRanges()}}catch{}}function C(R,k){R.classList?R.classList.add(k):R.className.match(new RegExp(`(?:^|\\s)${k}(?!\\S)`))||(R.className+=` ${k}`)}function D(R,k){R.classList?R.classList.remove(k):R.className=R.className.replace(new RegExp(`(?:^|\\s)${k}(?!\\S)`,"g"),"")}return we}var pi={},Pb;function Iw(){if(Pb)return pi;Pb=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.canDragX=s,pi.canDragY=a,pi.createCoreData=u,pi.createDraggableData=d,pi.getBoundPosition=e,pi.getControlPosition=l,pi.snapToGrid=n;var o=Cu(),t=Ag();function e(m,v,b){if(!m.props.bounds)return[v,b];let{bounds:S}=m.props;S=typeof S=="string"?S:f(S);const w=g(m);if(typeof S=="string"){const{ownerDocument:A}=w,_=A.defaultView;let E;if(S==="parent"?E=w.parentNode:E=w.getRootNode().querySelector(S),!(E instanceof _.HTMLElement))throw new Error('Bounds selector "'+S+'" could not find an element.');const x=E,O=_.getComputedStyle(w),C=_.getComputedStyle(x);S={left:-w.offsetLeft+(0,o.int)(C.paddingLeft)+(0,o.int)(O.marginLeft),top:-w.offsetTop+(0,o.int)(C.paddingTop)+(0,o.int)(O.marginTop),right:(0,t.innerWidth)(x)-(0,t.outerWidth)(w)-w.offsetLeft+(0,o.int)(C.paddingRight)-(0,o.int)(O.marginRight),bottom:(0,t.innerHeight)(x)-(0,t.outerHeight)(w)-w.offsetTop+(0,o.int)(C.paddingBottom)-(0,o.int)(O.marginBottom)}}return(0,o.isNum)(S.right)&&(v=Math.min(v,S.right)),(0,o.isNum)(S.bottom)&&(b=Math.min(b,S.bottom)),(0,o.isNum)(S.left)&&(v=Math.max(v,S.left)),(0,o.isNum)(S.top)&&(b=Math.max(b,S.top)),[v,b]}function n(m,v,b){const S=Math.round(v/m[0])*m[0],w=Math.round(b/m[1])*m[1];return[S,w]}function s(m){return m.props.axis==="both"||m.props.axis==="x"}function a(m){return m.props.axis==="both"||m.props.axis==="y"}function l(m,v,b){const S=typeof v=="number"?(0,t.getTouch)(m,v):null;if(typeof v=="number"&&!S)return null;const w=g(b),A=b.props.offsetParent||w.offsetParent||w.ownerDocument.body;return(0,t.offsetXYFromParent)(S||m,A,b.props.scale)}function u(m,v,b){const S=!(0,o.isNum)(m.lastX),w=g(m);return S?{node:w,deltaX:0,deltaY:0,lastX:v,lastY:b,x:v,y:b}:{node:w,deltaX:v-m.lastX,deltaY:b-m.lastY,lastX:m.lastX,lastY:m.lastY,x:v,y:b}}function d(m,v){const b=m.props.scale;return{node:v.node,x:m.state.x+v.deltaX/b,y:m.state.y+v.deltaY/b,deltaX:v.deltaX/b,deltaY:v.deltaY/b,lastX:m.state.x,lastY:m.state.y}}function f(m){return{left:m.left,top:m.top,right:m.right,bottom:m.bottom}}function g(m){const v=m.findDOMNode();if(!v)throw new Error("<DraggableCore>: Unmounted during event!");return v}return pi}var Lo={},Yc={},Nb;function Uw(){if(Nb)return Yc;Nb=1,Object.defineProperty(Yc,"__esModule",{value:!0}),Yc.default=o;function o(){}return Yc}var Lb;function aC(){if(Lb)return Lo;Lb=1,Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.default=void 0;var o=d(Cs()),t=u(xu()),e=u(Su()),n=Ag(),s=Iw(),a=Cu(),l=u(Uw());function u(w){return w&&w.__esModule?w:{default:w}}function d(w,A){if(typeof WeakMap=="function")var _=new WeakMap,E=new WeakMap;return(d=function(x,O){if(!O&&x&&x.__esModule)return x;var C,D,R={__proto__:null,default:x};if(x===null||typeof x!="object"&&typeof x!="function")return R;if(C=O?E:_){if(C.has(x))return C.get(x);C.set(x,R)}for(const k in x)k!=="default"&&{}.hasOwnProperty.call(x,k)&&((D=(C=Object.defineProperty)&&Object.getOwnPropertyDescriptor(x,k))&&(D.get||D.set)?C(R,k,D):R[k]=x[k]);return R})(w,A)}function f(w,A,_){return(A=g(A))in w?Object.defineProperty(w,A,{value:_,enumerable:!0,configurable:!0,writable:!0}):w[A]=_,w}function g(w){var A=m(w,"string");return typeof A=="symbol"?A:A+""}function m(w,A){if(typeof w!="object"||!w)return w;var _=w[Symbol.toPrimitive];if(_!==void 0){var E=_.call(w,A);if(typeof E!="object")return E;throw new TypeError("@@toPrimitive must return a primitive value.")}return(A==="string"?String:Number)(w)}const v={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let b=v.mouse,S=class extends o.Component{constructor(){super(...arguments),f(this,"dragging",!1),f(this,"lastX",NaN),f(this,"lastY",NaN),f(this,"touchIdentifier",null),f(this,"mounted",!1),f(this,"handleDragStart",A=>{if(this.props.onMouseDown(A),!this.props.allowAnyClick&&typeof A.button=="number"&&A.button!==0)return!1;const _=this.findDOMNode();if(!_||!_.ownerDocument||!_.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:E}=_;if(this.props.disabled||!(A.target instanceof E.defaultView.Node)||this.props.handle&&!(0,n.matchesSelectorAndParentsTo)(A.target,this.props.handle,_)||this.props.cancel&&(0,n.matchesSelectorAndParentsTo)(A.target,this.props.cancel,_))return;A.type==="touchstart"&&!this.props.allowMobileScroll&&A.preventDefault();const x=(0,n.getTouchIdentifier)(A);this.touchIdentifier=x;const O=(0,s.getControlPosition)(A,x,this);if(O==null)return;const{x:C,y:D}=O,R=(0,s.createCoreData)(this,C,D);(0,l.default)("DraggableCore: handleDragStart: %j",R),(0,l.default)("calling",this.props.onStart),!(this.props.onStart(A,R)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,n.addUserSelectStyles)(E),this.dragging=!0,this.lastX=C,this.lastY=D,(0,n.addEvent)(E,b.move,this.handleDrag),(0,n.addEvent)(E,b.stop,this.handleDragStop))}),f(this,"handleDrag",A=>{const _=(0,s.getControlPosition)(A,this.touchIdentifier,this);if(_==null)return;let{x:E,y:x}=_;if(Array.isArray(this.props.grid)){let D=E-this.lastX,R=x-this.lastY;if([D,R]=(0,s.snapToGrid)(this.props.grid,D,R),!D&&!R)return;E=this.lastX+D,x=this.lastY+R}const O=(0,s.createCoreData)(this,E,x);if((0,l.default)("DraggableCore: handleDrag: %j",O),this.props.onDrag(A,O)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const R=document.createEvent("MouseEvents");R.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(R)}return}this.lastX=E,this.lastY=x}),f(this,"handleDragStop",A=>{if(!this.dragging)return;const _=(0,s.getControlPosition)(A,this.touchIdentifier,this);if(_==null)return;let{x:E,y:x}=_;if(Array.isArray(this.props.grid)){let R=E-this.lastX||0,k=x-this.lastY||0;[R,k]=(0,s.snapToGrid)(this.props.grid,R,k),E=this.lastX+R,x=this.lastY+k}const O=(0,s.createCoreData)(this,E,x);if(this.props.onStop(A,O)===!1||this.mounted===!1)return!1;const D=this.findDOMNode();D&&this.props.enableUserSelectHack&&(0,n.scheduleRemoveUserSelectStyles)(D.ownerDocument),(0,l.default)("DraggableCore: handleDragStop: %j",O),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,D&&((0,l.default)("DraggableCore: Removing handlers"),(0,n.removeEvent)(D.ownerDocument,b.move,this.handleDrag),(0,n.removeEvent)(D.ownerDocument,b.stop,this.handleDragStop))}),f(this,"onMouseDown",A=>(b=v.mouse,this.handleDragStart(A))),f(this,"onMouseUp",A=>(b=v.mouse,this.handleDragStop(A))),f(this,"onTouchStart",A=>(b=v.touch,this.handleDragStart(A))),f(this,"onTouchEnd",A=>(b=v.touch,this.handleDragStop(A)))}componentDidMount(){this.mounted=!0;const A=this.findDOMNode();A&&(0,n.addEvent)(A,v.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const A=this.findDOMNode();if(A){const{ownerDocument:_}=A;(0,n.removeEvent)(_,v.mouse.move,this.handleDrag),(0,n.removeEvent)(_,v.touch.move,this.handleDrag),(0,n.removeEvent)(_,v.mouse.stop,this.handleDragStop),(0,n.removeEvent)(_,v.touch.stop,this.handleDragStop),(0,n.removeEvent)(A,v.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,n.scheduleRemoveUserSelectStyles)(_)}}findDOMNode(){return this.props?.nodeRef?this.props?.nodeRef?.current:e.default.findDOMNode(this)}render(){return o.cloneElement(o.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};return Lo.default=S,f(S,"displayName","DraggableCore"),f(S,"propTypes",{allowAnyClick:t.default.bool,allowMobileScroll:t.default.bool,children:t.default.node.isRequired,disabled:t.default.bool,enableUserSelectHack:t.default.bool,offsetParent:function(w,A){if(w[A]&&w[A].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:t.default.arrayOf(t.default.number),handle:t.default.string,cancel:t.default.string,nodeRef:t.default.object,onStart:t.default.func,onDrag:t.default.func,onStop:t.default.func,onMouseDown:t.default.func,scale:t.default.number,className:a.dontSetMe,style:a.dontSetMe,transform:a.dontSetMe}),f(S,"defaultProps",{allowAnyClick:!1,allowMobileScroll:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1}),Lo}var Bb;function oC(){return Bb||(Bb=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),Object.defineProperty(o,"DraggableCore",{enumerable:!0,get:function(){return d.default}}),o.default=void 0;var t=m(Cs()),e=g(xu()),n=g(Su()),s=sC(),a=Ag(),l=Iw(),u=Cu(),d=g(aC()),f=g(Uw());function g(_){return _&&_.__esModule?_:{default:_}}function m(_,E){if(typeof WeakMap=="function")var x=new WeakMap,O=new WeakMap;return(m=function(C,D){if(!D&&C&&C.__esModule)return C;var R,k,L={__proto__:null,default:C};if(C===null||typeof C!="object"&&typeof C!="function")return L;if(R=D?O:x){if(R.has(C))return R.get(C);R.set(C,L)}for(const V in C)V!=="default"&&{}.hasOwnProperty.call(C,V)&&((k=(R=Object.defineProperty)&&Object.getOwnPropertyDescriptor(C,V))&&(k.get||k.set)?R(L,V,k):L[V]=C[V]);return L})(_,E)}function v(){return v=Object.assign?Object.assign.bind():function(_){for(var E=1;E<arguments.length;E++){var x=arguments[E];for(var O in x)({}).hasOwnProperty.call(x,O)&&(_[O]=x[O])}return _},v.apply(null,arguments)}function b(_,E,x){return(E=S(E))in _?Object.defineProperty(_,E,{value:x,enumerable:!0,configurable:!0,writable:!0}):_[E]=x,_}function S(_){var E=w(_,"string");return typeof E=="symbol"?E:E+""}function w(_,E){if(typeof _!="object"||!_)return _;var x=_[Symbol.toPrimitive];if(x!==void 0){var O=x.call(_,E);if(typeof O!="object")return O;throw new TypeError("@@toPrimitive must return a primitive value.")}return(E==="string"?String:Number)(_)}class A extends t.Component{static getDerivedStateFromProps(E,x){let{position:O}=E,{prevPropsPosition:C}=x;return O&&(!C||O.x!==C.x||O.y!==C.y)?((0,f.default)("Draggable: getDerivedStateFromProps %j",{position:O,prevPropsPosition:C}),{x:O.x,y:O.y,prevPropsPosition:{...O}}):null}constructor(E){super(E),b(this,"onDragStart",(x,O)=>{if((0,f.default)("Draggable: onDragStart: %j",O),this.props.onStart(x,(0,l.createDraggableData)(this,O))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),b(this,"onDrag",(x,O)=>{if(!this.state.dragging)return!1;(0,f.default)("Draggable: onDrag: %j",O);const C=(0,l.createDraggableData)(this,O),D={x:C.x,y:C.y,slackX:0,slackY:0};if(this.props.bounds){const{x:k,y:L}=D;D.x+=this.state.slackX,D.y+=this.state.slackY;const[V,q]=(0,l.getBoundPosition)(this,D.x,D.y);D.x=V,D.y=q,D.slackX=this.state.slackX+(k-D.x),D.slackY=this.state.slackY+(L-D.y),C.x=D.x,C.y=D.y,C.deltaX=D.x-this.state.x,C.deltaY=D.y-this.state.y}if(this.props.onDrag(x,C)===!1)return!1;this.setState(D)}),b(this,"onDragStop",(x,O)=>{if(!this.state.dragging||this.props.onStop(x,(0,l.createDraggableData)(this,O))===!1)return!1;(0,f.default)("Draggable: onDragStop: %j",O);const D={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:k,y:L}=this.props.position;D.x=k,D.y=L}this.setState(D)}),this.state={dragging:!1,dragged:!1,x:E.position?E.position.x:E.defaultPosition.x,y:E.position?E.position.y:E.defaultPosition.y,prevPropsPosition:{...E.position},slackX:0,slackY:0,isElementSVG:!1},E.position&&!(E.onDrag||E.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.state.dragging&&this.setState({dragging:!1})}findDOMNode(){return this.props?.nodeRef?.current??n.default.findDOMNode(this)}render(){const{axis:E,bounds:x,children:O,defaultPosition:C,defaultClassName:D,defaultClassNameDragging:R,defaultClassNameDragged:k,position:L,positionOffset:V,scale:q,...it}=this.props;let rt={},st=null;const B=!!!L||this.state.dragging,H=L||C,tt={x:(0,l.canDragX)(this)&&B?this.state.x:H.x,y:(0,l.canDragY)(this)&&B?this.state.y:H.y};this.state.isElementSVG?st=(0,a.createSVGTransform)(tt,V):rt=(0,a.createCSSTransform)(tt,V);const lt=(0,s.clsx)(O.props.className||"",D,{[R]:this.state.dragging,[k]:this.state.dragged});return t.createElement(d.default,v({},it,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),t.cloneElement(t.Children.only(O),{className:lt,style:{...O.props.style,...rt},transform:st}))}}o.default=A,b(A,"displayName","Draggable"),b(A,"propTypes",{...d.default.propTypes,axis:e.default.oneOf(["both","x","y","none"]),bounds:e.default.oneOfType([e.default.shape({left:e.default.number,right:e.default.number,top:e.default.number,bottom:e.default.number}),e.default.string,e.default.oneOf([!1])]),defaultClassName:e.default.string,defaultClassNameDragging:e.default.string,defaultClassNameDragged:e.default.string,defaultPosition:e.default.shape({x:e.default.number,y:e.default.number}),positionOffset:e.default.shape({x:e.default.oneOfType([e.default.number,e.default.string]),y:e.default.oneOfType([e.default.number,e.default.string])}),position:e.default.shape({x:e.default.number,y:e.default.number}),className:u.dontSetMe,style:u.dontSetMe,transform:u.dontSetMe}),b(A,"defaultProps",{...d.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})}(hf)),hf}var jb;function Fw(){if(jb)return No.exports;jb=1;const{default:o,DraggableCore:t}=oC();return No.exports=o,No.exports.default=o,No.exports.DraggableCore=t,No.exports}var Wc={},Ib;function lC(){if(Ib)return Wc;Ib=1,Wc.__esModule=!0,Wc.cloneElement=u;var o=t(Cs());function t(d){return d&&d.__esModule?d:{default:d}}function e(d,f){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(d);f&&(m=m.filter(function(v){return Object.getOwnPropertyDescriptor(d,v).enumerable})),g.push.apply(g,m)}return g}function n(d){for(var f=1;f<arguments.length;f++){var g=arguments[f]!=null?arguments[f]:{};f%2?e(Object(g),!0).forEach(function(m){s(d,m,g[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):e(Object(g)).forEach(function(m){Object.defineProperty(d,m,Object.getOwnPropertyDescriptor(g,m))})}return d}function s(d,f,g){return f=a(f),f in d?Object.defineProperty(d,f,{value:g,enumerable:!0,configurable:!0,writable:!0}):d[f]=g,d}function a(d){var f=l(d,"string");return typeof f=="symbol"?f:String(f)}function l(d,f){if(typeof d!="object"||d===null)return d;var g=d[Symbol.toPrimitive];if(g!==void 0){var m=g.call(d,f);if(typeof m!="object")return m;throw new TypeError("@@toPrimitive must return a primitive value.")}return(f==="string"?String:Number)(d)}function u(d,f){return f.style&&d.props.style&&(f.style=n(n({},d.props.style),f.style)),f.className&&d.props.className&&(f.className=d.props.className+" "+f.className),o.default.cloneElement(d,f)}return Wc}var Bo={},Ub;function zw(){if(Ub)return Bo;Ub=1,Bo.__esModule=!0,Bo.resizableProps=void 0;var o=t(xu());Fw();function t(n){return n&&n.__esModule?n:{default:n}}var e={axis:o.default.oneOf(["both","x","y","none"]),className:o.default.string,children:o.default.element.isRequired,draggableOpts:o.default.shape({allowAnyClick:o.default.bool,cancel:o.default.string,children:o.default.node,disabled:o.default.bool,enableUserSelectHack:o.default.bool,offsetParent:o.default.node,grid:o.default.arrayOf(o.default.number),handle:o.default.string,nodeRef:o.default.object,onStart:o.default.func,onDrag:o.default.func,onStop:o.default.func,onMouseDown:o.default.func,scale:o.default.number}),height:function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];var u=a[0];if(u.axis==="both"||u.axis==="y"){var d;return(d=o.default.number).isRequired.apply(d,a)}return o.default.number.apply(o.default,a)},handle:o.default.oneOfType([o.default.node,o.default.func]),handleSize:o.default.arrayOf(o.default.number),lockAspectRatio:o.default.bool,maxConstraints:o.default.arrayOf(o.default.number),minConstraints:o.default.arrayOf(o.default.number),onResizeStop:o.default.func,onResizeStart:o.default.func,onResize:o.default.func,resizeHandles:o.default.arrayOf(o.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),transformScale:o.default.number,width:function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];var u=a[0];if(u.axis==="both"||u.axis==="x"){var d;return(d=o.default.number).isRequired.apply(d,a)}return o.default.number.apply(o.default,a)}};return Bo.resizableProps=e,Bo}var Fb;function Hw(){if(Fb)return Po;Fb=1,Po.__esModule=!0,Po.default=void 0;var o=l(Cs()),t=Fw(),e=lC(),n=zw(),s=["children","className","draggableOpts","width","height","handle","handleSize","lockAspectRatio","axis","minConstraints","maxConstraints","onResize","onResizeStop","onResizeStart","resizeHandles","transformScale"];function a(_){if(typeof WeakMap!="function")return null;var E=new WeakMap,x=new WeakMap;return(a=function(C){return C?x:E})(_)}function l(_,E){if(_&&_.__esModule)return _;if(_===null||typeof _!="object"&&typeof _!="function")return{default:_};var x=a(E);if(x&&x.has(_))return x.get(_);var O={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var D in _)if(D!=="default"&&Object.prototype.hasOwnProperty.call(_,D)){var R=C?Object.getOwnPropertyDescriptor(_,D):null;R&&(R.get||R.set)?Object.defineProperty(O,D,R):O[D]=_[D]}return O.default=_,x&&x.set(_,O),O}function u(){return u=Object.assign?Object.assign.bind():function(_){for(var E=1;E<arguments.length;E++){var x=arguments[E];for(var O in x)Object.prototype.hasOwnProperty.call(x,O)&&(_[O]=x[O])}return _},u.apply(this,arguments)}function d(_,E){if(_==null)return{};var x={},O=Object.keys(_),C,D;for(D=0;D<O.length;D++)C=O[D],!(E.indexOf(C)>=0)&&(x[C]=_[C]);return x}function f(_,E){var x=Object.keys(_);if(Object.getOwnPropertySymbols){var O=Object.getOwnPropertySymbols(_);E&&(O=O.filter(function(C){return Object.getOwnPropertyDescriptor(_,C).enumerable})),x.push.apply(x,O)}return x}function g(_){for(var E=1;E<arguments.length;E++){var x=arguments[E]!=null?arguments[E]:{};E%2?f(Object(x),!0).forEach(function(O){m(_,O,x[O])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(x)):f(Object(x)).forEach(function(O){Object.defineProperty(_,O,Object.getOwnPropertyDescriptor(x,O))})}return _}function m(_,E,x){return E=v(E),E in _?Object.defineProperty(_,E,{value:x,enumerable:!0,configurable:!0,writable:!0}):_[E]=x,_}function v(_){var E=b(_,"string");return typeof E=="symbol"?E:String(E)}function b(_,E){if(typeof _!="object"||_===null)return _;var x=_[Symbol.toPrimitive];if(x!==void 0){var O=x.call(_,E);if(typeof O!="object")return O;throw new TypeError("@@toPrimitive must return a primitive value.")}return(E==="string"?String:Number)(_)}function S(_,E){_.prototype=Object.create(E.prototype),_.prototype.constructor=_,w(_,E)}function w(_,E){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(O,C){return O.__proto__=C,O},w(_,E)}var A=function(_){S(E,_);function E(){for(var O,C=arguments.length,D=new Array(C),R=0;R<C;R++)D[R]=arguments[R];return O=_.call.apply(_,[this].concat(D))||this,O.handleRefs={},O.lastHandleRect=null,O.slack=null,O}var x=E.prototype;return x.componentWillUnmount=function(){this.resetData()},x.resetData=function(){this.lastHandleRect=this.slack=null},x.runConstraints=function(C,D){var R=this.props,k=R.minConstraints,L=R.maxConstraints,V=R.lockAspectRatio;if(!k&&!L&&!V)return[C,D];if(V){var q=this.props.width/this.props.height,it=C-this.props.width,rt=D-this.props.height;Math.abs(it)>Math.abs(rt*q)?D=C/q:C=D*q}var st=C,ot=D,B=this.slack||[0,0],H=B[0],tt=B[1];return C+=H,D+=tt,k&&(C=Math.max(k[0],C),D=Math.max(k[1],D)),L&&(C=Math.min(L[0],C),D=Math.min(L[1],D)),this.slack=[H+(st-C),tt+(ot-D)],[C,D]},x.resizeHandler=function(C,D){var R=this;return function(k,L){var V=L.node,q=L.deltaX,it=L.deltaY;C==="onResizeStart"&&R.resetData();var rt=(R.props.axis==="both"||R.props.axis==="x")&&D!=="n"&&D!=="s",st=(R.props.axis==="both"||R.props.axis==="y")&&D!=="e"&&D!=="w";if(!(!rt&&!st)){var ot=D[0],B=D[D.length-1],H=V.getBoundingClientRect();if(R.lastHandleRect!=null){if(B==="w"){var tt=H.left-R.lastHandleRect.left;q+=tt}if(ot==="n"){var lt=H.top-R.lastHandleRect.top;it+=lt}}R.lastHandleRect=H,B==="w"&&(q=-q),ot==="n"&&(it=-it);var P=R.props.width+(rt?q/R.props.transformScale:0),z=R.props.height+(st?it/R.props.transformScale:0),Y=R.runConstraints(P,z);P=Y[0],z=Y[1];var U=P!==R.props.width||z!==R.props.height,et=typeof R.props[C]=="function"?R.props[C]:null,nt=C==="onResize"&&!U;et&&!nt&&(k.persist==null||k.persist(),et(k,{node:V,size:{width:P,height:z},handle:D})),C==="onResizeStop"&&R.resetData()}}},x.renderResizeHandle=function(C,D){var R=this.props.handle;if(!R)return o.createElement("span",{className:"react-resizable-handle react-resizable-handle-"+C,ref:D});if(typeof R=="function")return R(C,D);var k=typeof R.type=="string",L=g({ref:D},k?{}:{handleAxis:C});return o.cloneElement(R,L)},x.render=function(){var C=this,D=this.props,R=D.children,k=D.className,L=D.draggableOpts;D.width,D.height,D.handle,D.handleSize,D.lockAspectRatio,D.axis,D.minConstraints,D.maxConstraints,D.onResize,D.onResizeStop,D.onResizeStart;var V=D.resizeHandles;D.transformScale;var q=d(D,s);return(0,e.cloneElement)(R,g(g({},q),{},{className:(k?k+" ":"")+"react-resizable",children:[].concat(R.props.children,V.map(function(it){var rt,st=(rt=C.handleRefs[it])!=null?rt:C.handleRefs[it]=o.createRef();return o.createElement(t.DraggableCore,u({},L,{nodeRef:st,key:"resizableHandle-"+it,onStop:C.resizeHandler("onResizeStop",it),onStart:C.resizeHandler("onResizeStart",it),onDrag:C.resizeHandler("onResize",it)}),C.renderResizeHandle(it,st))}))}))},E}(o.Component);return Po.default=A,A.propTypes=n.resizableProps,A.defaultProps={axis:"both",handleSize:[20,20],lockAspectRatio:!1,minConstraints:[20,20],maxConstraints:[1/0,1/0],resizeHandles:["se"],transformScale:1},Po}var jo={},zb;function cC(){if(zb)return jo;zb=1,jo.__esModule=!0,jo.default=void 0;var o=u(Cs()),t=a(xu()),e=a(Hw()),n=zw(),s=["handle","handleSize","onResize","onResizeStart","onResizeStop","draggableOpts","minConstraints","maxConstraints","lockAspectRatio","axis","width","height","resizeHandles","style","transformScale"];function a(E){return E&&E.__esModule?E:{default:E}}function l(E){if(typeof WeakMap!="function")return null;var x=new WeakMap,O=new WeakMap;return(l=function(D){return D?O:x})(E)}function u(E,x){if(E&&E.__esModule)return E;if(E===null||typeof E!="object"&&typeof E!="function")return{default:E};var O=l(x);if(O&&O.has(E))return O.get(E);var C={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in E)if(R!=="default"&&Object.prototype.hasOwnProperty.call(E,R)){var k=D?Object.getOwnPropertyDescriptor(E,R):null;k&&(k.get||k.set)?Object.defineProperty(C,R,k):C[R]=E[R]}return C.default=E,O&&O.set(E,C),C}function d(){return d=Object.assign?Object.assign.bind():function(E){for(var x=1;x<arguments.length;x++){var O=arguments[x];for(var C in O)Object.prototype.hasOwnProperty.call(O,C)&&(E[C]=O[C])}return E},d.apply(this,arguments)}function f(E,x){var O=Object.keys(E);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(E);x&&(C=C.filter(function(D){return Object.getOwnPropertyDescriptor(E,D).enumerable})),O.push.apply(O,C)}return O}function g(E){for(var x=1;x<arguments.length;x++){var O=arguments[x]!=null?arguments[x]:{};x%2?f(Object(O),!0).forEach(function(C){m(E,C,O[C])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(O)):f(Object(O)).forEach(function(C){Object.defineProperty(E,C,Object.getOwnPropertyDescriptor(O,C))})}return E}function m(E,x,O){return x=v(x),x in E?Object.defineProperty(E,x,{value:O,enumerable:!0,configurable:!0,writable:!0}):E[x]=O,E}function v(E){var x=b(E,"string");return typeof x=="symbol"?x:String(x)}function b(E,x){if(typeof E!="object"||E===null)return E;var O=E[Symbol.toPrimitive];if(O!==void 0){var C=O.call(E,x);if(typeof C!="object")return C;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(E)}function S(E,x){if(E==null)return{};var O={},C=Object.keys(E),D,R;for(R=0;R<C.length;R++)D=C[R],!(x.indexOf(D)>=0)&&(O[D]=E[D]);return O}function w(E,x){E.prototype=Object.create(x.prototype),E.prototype.constructor=E,A(E,x)}function A(E,x){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(C,D){return C.__proto__=D,C},A(E,x)}var _=function(E){w(x,E);function x(){for(var C,D=arguments.length,R=new Array(D),k=0;k<D;k++)R[k]=arguments[k];return C=E.call.apply(E,[this].concat(R))||this,C.state={width:C.props.width,height:C.props.height,propsWidth:C.props.width,propsHeight:C.props.height},C.onResize=function(L,V){var q=V.size;C.props.onResize?(L.persist==null||L.persist(),C.setState(q,function(){return C.props.onResize&&C.props.onResize(L,V)})):C.setState(q)},C}x.getDerivedStateFromProps=function(D,R){return R.propsWidth!==D.width||R.propsHeight!==D.height?{width:D.width,height:D.height,propsWidth:D.width,propsHeight:D.height}:null};var O=x.prototype;return O.render=function(){var D=this.props,R=D.handle,k=D.handleSize;D.onResize;var L=D.onResizeStart,V=D.onResizeStop,q=D.draggableOpts,it=D.minConstraints,rt=D.maxConstraints,st=D.lockAspectRatio,ot=D.axis;D.width,D.height;var B=D.resizeHandles,H=D.style,tt=D.transformScale,lt=S(D,s);return o.createElement(e.default,{axis:ot,draggableOpts:q,handle:R,handleSize:k,height:this.state.height,lockAspectRatio:st,maxConstraints:rt,minConstraints:it,onResizeStart:L,onResize:this.onResize,onResizeStop:V,resizeHandles:B,transformScale:tt,width:this.state.width},o.createElement("div",d({},lt,{style:g(g({},H),{},{width:this.state.width+"px",height:this.state.height+"px"})})))},x}(o.Component);return jo.default=_,_.propTypes=g(g({},n.resizableProps),{},{children:t.default.element}),jo}var Hb;function uC(){return Hb||(Hb=1,ko.exports=function(){throw new Error("Don't instantiate Resizable directly! Use require('react-resizable').Resizable")},ko.exports.Resizable=Hw().default,ko.exports.ResizableBox=cC().default),ko.exports}var hC=uC();const rn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),qf=[.001,0,0,.001,0,0],pf=1.35,xn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},_i={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},rl="pdfjs_internal_editor_",Et={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Nt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},$w={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},qe={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Jo={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},_e={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ua={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},pl={ERRORS:0,WARNINGS:1,INFOS:5},Ea={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Kc={moveTo:0,lineTo:1,curveTo:2,closePath:3},qw={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Ru=pl.WARNINGS;function dC(o){Number.isInteger(o)&&(Ru=o)}function fC(){return Ru}function Du(o){Ru>=pl.INFOS&&console.info(`Info: ${o}`)}function Tt(o){Ru>=pl.WARNINGS&&console.warn(`Warning: ${o}`)}function Zt(o){throw new Error(o)}function Lt(o,t){o||Zt(t)}function gC(o){switch(o?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Eg(o,t=null,e=null){if(!o)return null;if(e&&typeof o=="string"&&(e.addDefaultProtocol&&o.startsWith("www.")&&o.match(/\./g)?.length>=2&&(o=`http://${o}`),e.tryConvertEncoding))try{o=bC(o)}catch{}const n=t?URL.parse(o,t):URL.parse(o);return gC(n)?n:null}function Tg(o,t,e=!1){const n=URL.parse(o);return n?(n.hash=t,n.href):e&&Eg(o,"http://example.com")?o.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Ct(o,t,e,n=!1){return Object.defineProperty(o,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const dr=function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t}();class $b extends dr{constructor(t,e){super(t,"PasswordException"),this.code=e}}class mf extends dr{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class yu extends dr{constructor(t){super(t,"InvalidPDFException")}}class al extends dr{constructor(t,e,n){super(t,"ResponseException"),this.status=e,this.missing=n}}class pC extends dr{constructor(t){super(t,"FormatError")}}class $i extends dr{constructor(t){super(t,"AbortException")}}function Gw(o){(typeof o!="object"||o?.length===void 0)&&Zt("Invalid argument for bytesToString");const t=o.length,e=8192;if(t<e)return String.fromCharCode.apply(null,o);const n=[];for(let s=0;s<t;s+=e){const a=Math.min(s+e,t),l=o.subarray(s,a);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function ml(o){typeof o!="string"&&Zt("Invalid argument for stringToBytes");const t=o.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=o.charCodeAt(n)&255;return e}function mC(o){return String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,o&255)}function yC(){const o=new Uint8Array(4);return o[0]=1,new Uint32Array(o.buffer,0,1)[0]===1}function vC(){try{return new Function(""),!0}catch{return!1}}class Ue{static get isLittleEndian(){return Ct(this,"isLittleEndian",yC())}static get isEvalSupported(){return Ct(this,"isEvalSupported",vC())}static get isOffscreenCanvasSupported(){return Ct(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ct(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Ct(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Ct(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const yf=Array.from(Array(256).keys(),o=>o.toString(16).padStart(2,"0"));class ut{static makeHexColor(t,e,n){return`#${yf[t]}${yf[e]}${yf[n]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,n=0){const s=t[n],a=t[n+1];t[n]=s*e[0]+a*e[2]+e[4],t[n+1]=s*e[1]+a*e[3]+e[5]}static applyTransformToBezier(t,e,n=0){const s=e[0],a=e[1],l=e[2],u=e[3],d=e[4],f=e[5];for(let g=0;g<6;g+=2){const m=t[n+g],v=t[n+g+1];t[n+g]=m*s+v*l+d,t[n+g+1]=m*a+v*u+f}}static applyInverseTransform(t,e){const n=t[0],s=t[1],a=e[0]*e[3]-e[1]*e[2];t[0]=(n*e[3]-s*e[2]+e[2]*e[5]-e[4]*e[3])/a,t[1]=(-n*e[1]+s*e[0]+e[4]*e[1]-e[5]*e[0])/a}static axialAlignedBoundingBox(t,e,n){const s=e[0],a=e[1],l=e[2],u=e[3],d=e[4],f=e[5],g=t[0],m=t[1],v=t[2],b=t[3];let S=s*g+d,w=S,A=s*v+d,_=A,E=u*m+f,x=E,O=u*b+f,C=O;if(a!==0||l!==0){const D=a*g,R=a*v,k=l*m,L=l*b;S+=k,_+=k,A+=L,w+=L,E+=D,C+=D,O+=R,x+=R}n[0]=Math.min(n[0],S,A,w,_),n[1]=Math.min(n[1],E,O,x,C),n[2]=Math.max(n[2],S,A,w,_),n[3]=Math.max(n[3],E,O,x,C)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const n=t[0],s=t[1],a=t[2],l=t[3],u=n**2+s**2,d=n*a+s*l,f=a**2+l**2,g=(u+f)/2,m=Math.sqrt(g**2-(u*f-d**2));e[0]=Math.sqrt(g+m||1),e[1]=Math.sqrt(g-m||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>s)return null;const a=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return a>l?null:[n,a,s,l]}static pointBoundingBox(t,e,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}static rectBoundingBox(t,e,n,s,a){a[0]=Math.min(a[0],t,n),a[1]=Math.min(a[1],e,s),a[2]=Math.max(a[2],t,n),a[3]=Math.max(a[3],e,s)}static#t(t,e,n,s,a,l,u,d,f,g){if(f<=0||f>=1)return;const m=1-f,v=f*f,b=v*f,S=m*(m*(m*t+3*f*e)+3*v*n)+b*s,w=m*(m*(m*a+3*f*l)+3*v*u)+b*d;g[0]=Math.min(g[0],S),g[1]=Math.min(g[1],w),g[2]=Math.max(g[2],S),g[3]=Math.max(g[3],w)}static#e(t,e,n,s,a,l,u,d,f,g,m,v){if(Math.abs(f)<1e-12){Math.abs(g)>=1e-12&&this.#t(t,e,n,s,a,l,u,d,-m/g,v);return}const b=g**2-4*m*f;if(b<0)return;const S=Math.sqrt(b),w=2*f;this.#t(t,e,n,s,a,l,u,d,(-g+S)/w,v),this.#t(t,e,n,s,a,l,u,d,(-g-S)/w,v)}static bezierBoundingBox(t,e,n,s,a,l,u,d,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],e,d),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],e,d),this.#e(t,n,a,u,e,s,l,d,3*(-t+3*(n-a)+u),6*(t-2*n+a),3*(n-t),f),this.#e(t,n,a,u,e,s,l,d,3*(-e+3*(s-l)+d),6*(e-2*s+l),3*(s-e),f)}}function bC(o){return decodeURIComponent(escape(o))}let vf=null,qb=null;function Vw(o){return vf||(vf=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,qb=new Map([["","t"]])),o.replaceAll(vf,(t,e,n)=>e?e.normalize("NFKC"):qb.get(n))}function xg(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const o=new Uint8Array(32);return crypto.getRandomValues(o),Gw(o)}const Cg="pdfjs_internal_id_";function wC(o,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[n,s,...a]=e;if(!o(n)&&!Number.isInteger(n)||!t(s))return!1;const l=a.length;let u=!0;switch(s.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;u=!1;break;default:return!1}for(const d of a)if(!(typeof d=="number"||u&&d===null))return!1;return!0}function Je(o,t,e){return Math.min(Math.max(o,t),e)}function Xw(o){return Uint8Array.prototype.toBase64?o.toBase64():btoa(Gw(o))}function _C(o){return Uint8Array.fromBase64?Uint8Array.fromBase64(o):ml(atob(o))}typeof Promise.try!="function"&&(Promise.try=function(o,...t){return new Promise(e=>{e(o(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(o){return o.reduce((t,e)=>t+e,0)});class ol{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function s(a){if(!a)return;let l=null;const u=a.name;if(u==="#text")l=a.value;else if(ol.shouldBuildText(u))a?.attributes?.textContent?l=a.attributes.textContent:a.value&&(l=a.value);else return;if(l!==null&&e.push({str:l}),!!a.children)for(const d of a.children)s(d)}return s(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Rg{static setupStorage(t,e,n,s,a){const l=s.getValue(e,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),a==="print")break;t.addEventListener("input",u=>{s.setValue(e,{value:u.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?t.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&t.removeAttribute("checked"),a==="print")break;t.addEventListener("change",u=>{s.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),a==="print")break;t.addEventListener("input",u=>{s.setValue(e,{value:u.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const u of n.children)u.attributes.value===l.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const d=u.target.options,f=d.selectedIndex===-1?"":d[d.selectedIndex].value;s.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:s,linkService:a}){const{attributes:l}=e,u=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${s}`);for(const[d,f]of Object.entries(l))if(f!=null)switch(d){case"class":f.length&&t.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||d!=="href"&&d!=="newWindow")&&t.setAttribute(d,f)}u&&a.addLinkAttributes(t,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(t,l.dataId,e,n)}static render(t){const e=t.annotationStorage,n=t.linkService,s=t.xfaHtml,a=t.intent||"display",l=document.createElement(s.name);s.attributes&&this.setAttributes({html:l,element:s,intent:a,linkService:n});const u=a!=="richText",d=t.div;if(d.append(l),t.viewport){const m=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=m}u&&d.setAttribute("class","xfaLayer xfaFont");const f=[];if(s.children.length===0){if(s.value){const m=document.createTextNode(s.value);l.append(m),u&&ol.shouldBuildText(s.name)&&f.push(m)}return{textDivs:f}}const g=[[s,-1,l]];for(;g.length>0;){const[m,v,b]=g.at(-1);if(v+1===m.children.length){g.pop();continue}const S=m.children[++g.at(-1)[1]];if(S===null)continue;const{name:w}=S;if(w==="#text"){const _=document.createTextNode(S.value);f.push(_),b.append(_);continue}const A=S?.attributes?.xmlns?document.createElementNS(S.attributes.xmlns,w):document.createElement(w);if(b.append(A),S.attributes&&this.setAttributes({html:A,element:S,storage:e,intent:a,linkService:n}),S.children?.length>0)g.push([S,-1,A]);else if(S.value){const _=document.createTextNode(S.value);u&&ol.shouldBuildText(w)&&f.push(_),A.append(_)}}for(const m of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Fi="http://www.w3.org/2000/svg";class lr{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function ka(o,t="text"){if(qo(o,document.baseURI)){const e=await fetch(o);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const s=new XMLHttpRequest;s.open("GET",o,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(s.response);return}e(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class yl{constructor({viewBox:t,userUnit:e,scale:n,rotation:s,offsetX:a=0,offsetY:l=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=n,this.rotation=s,this.offsetX=a,this.offsetY=l,n*=e;const d=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let g,m,v,b;switch(s%=360,s<0&&(s+=360),s){case 180:g=-1,m=0,v=0,b=1;break;case 90:g=0,m=1,v=1,b=0;break;case 270:g=0,m=-1,v=-1,b=0;break;case 0:g=1,m=0,v=0,b=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(v=-v,b=-b);let S,w,A,_;g===0?(S=Math.abs(f-t[1])*n+a,w=Math.abs(d-t[0])*n+l,A=(t[3]-t[1])*n,_=(t[2]-t[0])*n):(S=Math.abs(d-t[0])*n+a,w=Math.abs(f-t[1])*n+l,A=(t[2]-t[0])*n,_=(t[3]-t[1])*n),this.transform=[g*n,m*n,v*n,b*n,S-g*n*d-v*n*f,w-m*n*d-b*n*f],this.width=A,this.height=_}get rawDims(){const t=this.viewBox;return Ct(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:a=!1}={}){return new yl({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:s,dontFlip:a})}convertToViewportPoint(t,e){const n=[t,e];return ut.applyTransform(n,this.transform),n}convertToViewportRectangle(t){const e=[t[0],t[1]];ut.applyTransform(e,this.transform);const n=[t[2],t[3]];return ut.applyTransform(n,this.transform),[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){const n=[t,e];return ut.applyInverseTransform(n,this.transform),n}}class Ou extends dr{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function vl(o){const t=o.length;let e=0;for(;e<t&&o[e].trim()==="";)e++;return o.substring(e,e+5).toLowerCase()==="data:"}function Mu(o){return typeof o=="string"&&/\.pdf$/i.test(o)}function Yw(o){return[o]=o.split(/[#?]/,1),o.substring(o.lastIndexOf("/")+1)}function Ww(o,t="document.pdf"){if(typeof o!="string")return t;if(vl(o))return Tt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(o);if(!n)return t;const s=u=>{try{let d=decodeURIComponent(u);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:u):d}catch{return u}},a=/\.pdf$/i,l=n.pathname.split("/").at(-1);if(a.test(l))return s(l);if(n.searchParams.size>0){const u=Array.from(n.searchParams.values()).reverse();for(const f of u)if(a.test(f))return s(f);const d=Array.from(n.searchParams.keys()).reverse();for(const f of d)if(a.test(f))return s(f)}if(n.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(d)return s(d[0])}return t}class Gb{started=Object.create(null);times=[];time(t){t in this.started&&Tt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Tt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:s,end:a}of this.times)t.push(`${n.padEnd(e)} ${a-s}ms
`);return t.join("")}}function qo(o,t){const e=t?URL.parse(o,t):URL.parse(o);return e?.protocol==="http:"||e?.protocol==="https:"}function Mn(o){o.preventDefault()}function de(o){o.preventDefault(),o.stopPropagation()}function SC(o){console.log("Deprecated API usage: "+o)}class vu{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const n=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let a=parseInt(e[3],10);a=a>=1&&a<=31?a:1;let l=parseInt(e[4],10);l=l>=0&&l<=23?l:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(e[6],10);d=d>=0&&d<=59?d:0;const f=e[7]||"Z";let g=parseInt(e[8],10);g=g>=0&&g<=23?g:0;let m=parseInt(e[9],10)||0;return m=m>=0&&m<=59?m:0,f==="-"?(l+=g,u+=m):f==="+"&&(l-=g,u-=m),new Date(Date.UTC(n,s,a,l,u,d))}}function Kw(o,{scale:t=1,rotation:e=0}){const{width:n,height:s}=o.attributes.style,a=[0,0,parseInt(n),parseInt(s)];return new yl({viewBox:a,userUnit:1,scale:t,rotation:e})}function Pa(o){if(o.startsWith("#")){const t=parseInt(o.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return o.startsWith("rgb(")?o.slice(4,-1).split(",").map(t=>parseInt(t)):o.startsWith("rgba(")?o.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Tt(`Not a valid color format: "${o}"`),[0,0,0])}function AC(o){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of o.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;o.set(e,Pa(n))}t.remove()}function ue(o){const{a:t,b:e,c:n,d:s,e:a,f:l}=o.getTransform();return[t,e,n,s,a,l]}function mi(o){const{a:t,b:e,c:n,d:s,e:a,f:l}=o.getTransform().invertSelf();return[t,e,n,s,a,l]}function xs(o,t,e=!1,n=!0){if(t instanceof yl){const{pageWidth:s,pageHeight:a}=t.rawDims,{style:l}=o,u=Ue.isCSSRoundSupported,d=`var(--total-scale-factor) * ${s}px`,f=`var(--total-scale-factor) * ${a}px`,g=u?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,m=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(l.width=g,l.height=m):(l.width=m,l.height=g)}n&&o.setAttribute("data-main-rotation",t.rotation)}class ii{constructor(){const{pixelRatio:t}=ii;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,n,s,a=-1){let l=1/0,u=1/0,d=1/0;n=ii.capPixels(n,a),n>0&&(l=Math.sqrt(n/(t*e))),s!==-1&&(u=s/t,d=s/e);const f=Math.min(l,u,d);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,n):n}return t}}const bu=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class EC{static get isDarkMode(){return Ct(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class Qw{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:n}=window.getComputedStyle(t);return t.remove(),Ct(this,"commentForegroundColor",Pa(n))}}function Zw(o,t,e,n){n=Math.min(Math.max(n??1,0),1);const s=255*(1-n);return o=Math.round(o*n+s),t=Math.round(t*n+s),e=Math.round(e*n+s),[o,t,e]}function Vb(o,t){const e=o[0]/255,n=o[1]/255,s=o[2]/255,a=Math.max(e,n,s),l=Math.min(e,n,s),u=(a+l)/2;if(a===l)t[0]=t[1]=0;else{const d=a-l;switch(t[1]=u<.5?d/(a+l):d/(2-a-l),a){case e:t[0]=((n-s)/d+(n<s?6:0))*60;break;case n:t[0]=((s-e)/d+2)*60;break;case s:t[0]=((e-n)/d+4)*60;break}}t[2]=u}function Gf(o,t){const e=o[0],n=o[1],s=o[2],a=(1-Math.abs(2*s-1))*n,l=a*(1-Math.abs(e/60%2-1)),u=s-a/2;switch(Math.floor(e/60)){case 0:t[0]=a+u,t[1]=l+u,t[2]=u;break;case 1:t[0]=l+u,t[1]=a+u,t[2]=u;break;case 2:t[0]=u,t[1]=a+u,t[2]=l+u;break;case 3:t[0]=u,t[1]=l+u,t[2]=a+u;break;case 4:t[0]=l+u,t[1]=u,t[2]=a+u;break;case 5:case 6:t[0]=a+u,t[1]=u,t[2]=l+u;break}}function Xb(o){return o<=.03928?o/12.92:((o+.055)/1.055)**2.4}function Yb(o,t,e){Gf(o,e),e.map(Xb);const n=.2126*e[0]+.7152*e[1]+.0722*e[2];Gf(t,e),e.map(Xb);const s=.2126*e[0]+.7152*e[1]+.0722*e[2];return n>s?(n+.05)/(s+.05):(s+.05)/(n+.05)}const Wb=new Map;function Jw(o,t){const e=o[0]+o[1]*256+o[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let n=Wb.get(e);if(n)return n;const s=new Float32Array(9),a=s.subarray(0,3),l=s.subarray(3,6);Vb(o,l);const u=s.subarray(6,9);Vb(t,u);const d=u[2]<.5,f=d?12:4.5;if(l[2]=d?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),Yb(l,u,a)<f){let g,m;d?(g=l[2],m=1):(g=0,m=l[2]);const v=.005;for(;m-g>v;){const b=l[2]=(g+m)/2;d===Yb(l,u,a)<f?g=b:m=b}l[2]=d?m:g}return Gf(l,a),n=ut.makeHexColor(Math.round(a[0]*255),Math.round(a[1]*255),Math.round(a[2]*255)),Wb.set(e,n),n}function Dg({html:o,dir:t,className:e},n){const s=document.createDocumentFragment();if(typeof o=="string"){const a=document.createElement("p");a.dir=t||"auto";const l=o.split(/(?:\r\n?|\n)/);for(let u=0,d=l.length;u<d;++u){const f=l[u];a.append(document.createTextNode(f)),u<d-1&&a.append(document.createElement("br"))}s.append(a)}else Rg.render({xfaHtml:o,div:s,intent:"richText"});s.firstChild.classList.add("richText",e),n.append(s)}class tl{#t=null;#e=null;#i;#n=null;#a=null;#s=null;#r=null;#o=null;static#c=null;constructor(t){this.#i=t,tl.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#i._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",Mn,{signal:e}),t.addEventListener("pointerdown",tl.#l,{signal:e}));const n=this.#n=document.createElement("div");n.className="buttons",t.append(n);const s=this.#i.toolbarPosition;if(s){const{style:a}=t,l=this.#i._uiManager.direction==="ltr"?1-s[0]:s[0];a.insetInlineEnd=`${100*l}%`,a.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#i._focusEventsAllowed=!1,de(t)}#h(t){this.#i._focusEventsAllowed=!0,de(t)}#f(t){const e=this.#i._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Mn,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#a?.shown(),this.#s?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#i,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",tl.#c[t]),this.#f(n)&&n.addEventListener("click",s=>{e.delete()},{signal:e._signal}),this.#n.append(n)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#n.append(e,this.#m),this.#a=t}addComment(t,e=null){if(this.#s)return;const n=t.renderForToolbar();if(!n)return;this.#f(n);const s=this.#r=this.#m;e?(this.#n.insertBefore(n,e),this.#n.insertBefore(s,e)):this.#n.append(n,s),this.#s=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#n.append(e,this.#m)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#i);this.#f(e),this.#n.append(e,this.#m)}removeButton(t){switch(t){case"comment":this.#s?.removeToolbarCommentButton(),this.#s=null,this.#r?.remove(),this.#r=null;break}}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(e);break}}async addButtonBefore(t,e,n){const s=this.#n.querySelector(n);s&&t==="comment"&&this.addComment(e,s)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class TC{#t=null;#e=null;#i;constructor(t){this.#i=t}#n(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#i._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",Mn,{signal:e});const n=this.#t=document.createElement("div");return n.className="buttons",t.append(n),this.#i.hasCommentManager()&&this.#s("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#s("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),t}#a(t,e){let n=0,s=0;for(const a of t){const l=a.y+a.height;if(l<n)continue;const u=a.x+(e?a.width:0);if(l>n){s=u,n=l;continue}e?u>s&&(s=u):u<s&&(s=u)}return[e?1-s:s,n]}show(t,e,n){const[s,a]=this.#a(e,n),{style:l}=this.#e||=this.#n();t.append(this.#e),l.insetInlineEnd=`${100*s}%`,l.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#s(t,e,n,s){const a=document.createElement("button");a.classList.add("basic",t),a.tabIndex=0,a.setAttribute("data-l10n-id",e);const l=document.createElement("span");a.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",n);const u=this.#i._signal;u instanceof AbortSignal&&!u.aborted&&(a.addEventListener("contextmenu",Mn,{signal:u}),a.addEventListener("click",s,{signal:u})),this.#t.append(a)}}function t_(o,t,e){for(const n of e)t.addEventListener(n,o[n].bind(o))}class xC{#t=0;get id(){return`${rl}${this.#t++}`}}class Og{#t=xg();#e=0;#i=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=t;const a=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Ct(this,"_isSVGFittingCanvas",a)}async#n(t,e){this.#i||=new Map;let n=this.#i.get(t);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let s;if(typeof e=="string"?(n.url=e,s=await ka(e,"blob")):e instanceof File?s=n.file=e:e instanceof Blob&&(s=e),s.type==="image/svg+xml"){const a=Og._isSVGFittingCanvas,l=new FileReader,u=new Image,d=new Promise((f,g)=>{u.onload=()=>{n.bitmap=u,n.isSvg=!0,f()},l.onload=async()=>{const m=n.svgUrl=l.result;u.src=await a?`${m}#svgView(preserveAspectRatio(none))`:m},u.onerror=l.onerror=g});l.readAsDataURL(s),await d}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){Tt(s),n=null}return this.#i.set(t,n),n&&this.#i.set(n.id,n),n}async getFromFile(t){const{lastModified:e,name:n,size:s,type:a}=t;return this.#n(`${e}_${n}_${s}_${a}`,t)}async getFromUrl(t){return this.#n(t,t)}async getFromBlob(t,e){const n=await e;return this.#n(t,n)}async getFromId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#i||=new Map;let n=this.#i.get(t);if(n?.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(e.width,e.height);return s.getContext("2d").drawImage(e,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#i.set(t,n),this.#i.set(n.id,n),n}getSvgUrl(t){const e=this.#i.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=s.convertToBlob()}n.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class CC{#t=[];#e=!1;#i;#n=-1;constructor(t=128){this.#i=t}add({cmd:t,undo:e,post:n,mustExec:s,type:a=NaN,overwriteIfSameType:l=!1,keepUndo:u=!1}){if(s&&t(),this.#e)return;const d={cmd:t,undo:e,post:n,type:a};if(this.#n===-1){this.#t.length>0&&(this.#t.length=0),this.#n=0,this.#t.push(d);return}if(l&&this.#t[this.#n].type===a){u&&(d.undo=this.#t[this.#n].undo),this.#t[this.#n]=d;return}const f=this.#n+1;f===this.#i?this.#t.splice(0,1):(this.#n=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(d)}undo(){if(this.#n===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1,this.#n-=1}redo(){if(this.#n<this.#t.length-1){this.#n+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#t.length-1}cleanType(t){if(this.#n!==-1){for(let e=this.#n;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#n-e),this.#n=e;return}this.#t.length=0,this.#n=-1}}destroy(){this.#t=null}}class bl{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Ue.platform;for(const[n,s,a={}]of t)for(const l of n){const u=l.startsWith("mac+");e&&u?(this.callbacks.set(l.slice(4),{callback:s,options:a}),this.allKeys.add(l.split("+").at(-1))):!e&&!u&&(this.callbacks.set(l,{callback:s,options:a}),this.allKeys.add(l.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(this.#t(e));if(!n)return;const{callback:s,options:{bubbles:a=!1,args:l=[],checker:u=null}}=n;u&&!u(t,e)||(s.bind(t,...l,e)(),a||de(e))}}class Mg{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return AC(t),Ct(this,"_colors",t)}convert(t){const e=Pa(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,s]of this._colors)if(s.every((a,l)=>a===e[l]))return Mg._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?ut.makeHexColor(...e):t}}class qi{#t=new AbortController;#e=null;#i=null;#n=new Map;#a=new Map;#s=null;#r=null;#o=null;#c=new CC;#l=null;#d=null;#h=null;#f=0;#m=new Set;#g=null;#u=null;#p=new Set;_editorUndoBar=null;#y=!1;#b=!1;#v=!1;#T=null;#A=null;#w=null;#C=null;#S=!1;#E=null;#O=new xC;#R=!1;#D=!1;#j=!1;#k=null;#N=null;#I=null;#L=null;#q=null;#x=Et.NONE;#_=new Set;#P=null;#U=null;#z=null;#X=null;#V=null;#Y={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#B=null;#G=null;#Z=null;#J=null;#F=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=qi.prototype,e=l=>l.#G.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},s=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Ct(this,"_keyboardManager",new bl([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#G.contains(u)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#G.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}]]))}constructor(t,e,n,s,a,l,u,d,f,g,m,v,b,S,w,A){const _=this._signal=this.#t.signal;this.#G=t,this.#Z=e,this.#J=n,this.#s=s,this.#l=a,this.#U=l,this.#V=d,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:_}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:_}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:_}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:_}),u._on("setpreference",this.onSetPreference.bind(this),{signal:_}),u._on("switchannotationeditorparams",E=>this.updateParams(E.type,E.value),{signal:_}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:_}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:_}),this.#lt(),this.#dt(),this.#et(),this.#r=d.annotationStorage,this.#T=d.filterFactory,this.#z=f,this.#C=g||null,this.#y=m,this.#b=v,this.#v=b,this.#q=S||null,this.viewParameters={realScale:lr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=w||null,this._supportsPinchToZoom=A!==!1,a?.setSidebarUiManager(this)}destroy(){this.#F?.resolve(),this.#F=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#a.values())t.destroy();this.#a.clear(),this.#n.clear(),this.#p.clear(),this.#L?.clear(),this.#e=null,this.#_.clear(),this.#c.destroy(),this.#s?.destroy(),this.#l?.destroy(),this.#U?.destroy(),this.#E?.hide(),this.#E=null,this.#I?.destroy(),this.#I=null,this.#i=null,this.#A&&(clearTimeout(this.#A),this.#A=null),this.#B&&(clearTimeout(this.#B),this.#B=null),this._editorUndoBar?.destroy(),this.#V=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#q}get useNewAltTextFlow(){return this.#b}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Ct(this,"hcmFilter",this.#z?this.#T.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return Ct(this,"direction",getComputedStyle(this.#G).direction)}get _highlightColors(){return Ct(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Ct(this,"highlightColors",null);const e=new Map,n=!!this.#z;for(const[s,a]of t){const l=s.endsWith("_HCM");if(n&&l){e.set(s.replace("_HCM",""),a);continue}!n&&!l&&e.set(s,a)}return Ct(this,"highlightColors",e)}get highlightColorNames(){return Ct(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#I=t}editAltText(t,e=!1){this.#s?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,n,s){this.#l?.showDialog(this,t,e,n,s)}selectComment(t,e){this.#a.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,e,n=void 0){this.#l?.toggleCommentPopup(t,e,n)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#a.has(t-1))return;const{resolve:e,promise:n}=Promise.withResolvers(),s=a=>{a.pageNumber===t&&(this._eventBus._off("editorsrendered",s),e())};this._eventBus.on("editorsrendered",s),await n}getSignature(t){this.#U?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#U}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#v=e;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#G.focus()}findParent(t,e){for(const n of this.#a.values()){const{x:s,y:a,width:l,height:u}=n.div.getBoundingClientRect();if(t>=s&&t<=s+l&&e>=a&&e<=a+u)return n}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*lr.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of this.#a.values())if(n.hasTextLayer(t))return n;return null}highlightSelection(t="",e=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:s,anchorOffset:a,focusNode:l,focusOffset:u}=n,d=n.toString(),g=this.#Q(n).closest(".textLayer"),m=this.getSelectionBoxes(g);if(!m)return;n.empty();const v=this.#tt(g),b=this.#x===Et.NONE,S=()=>{const w=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:m,anchorNode:s,anchorOffset:a,focusNode:l,focusOffset:u,text:d});b&&this.showAllEditors("highlight",!0,!0),e&&w?.editComment()};if(b){this.switchToMode(Et.HIGHLIGHT,S);return}S()}commentSelection(t=""){this.highlightSelection(t,!0)}#at(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=this.#Q(t).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(this.#E||=new TC(this),this.#E.show(n,s,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#r)return null;const e=`${rl}${t}`,n=this.#r.getRawValue(e);return n&&this.#r.remove(e),n}addToAnnotationStorage(t){!t.isEmpty()&&this.#r&&!this.#r.has(t.id)&&this.#r.setValue(t.id,t)}a11yAlert(t,e=null){const n=this.#J;n&&(n.setAttribute("data-l10n-id",t),e?n.setAttribute("data-l10n-args",JSON.stringify(e)):n.removeAttribute("data-l10n-args"))}#ot(){const t=document.getSelection();if(!t||t.isCollapsed){this.#P&&(this.#E?.hide(),this.#P=null,this.#M({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#P)return;const s=this.#Q(t).closest(".textLayer");if(!s){this.#P&&(this.#E?.hide(),this.#P=null,this.#M({hasSelectedText:!1}));return}if(this.#E?.hide(),this.#P=e,this.#M({hasSelectedText:!0}),!(this.#x!==Et.HIGHLIGHT&&this.#x!==Et.NONE)&&(this.#x===Et.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#S=this.isShiftKeyDown,!this.isShiftKeyDown)){const a=this.#x===Et.HIGHLIGHT?this.#tt(s):null;if(a?.toggleDrawing(),this.#D){const l=new AbortController,u=this.combinedSignal(l),d=f=>{f.type==="pointerup"&&f.button!==0||(l.abort(),a?.toggleDrawing(!0),f.type==="pointerup"&&this.#W("main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}else a?.toggleDrawing(!0),this.#W("main_toolbar")}}#W(t=""){this.#x===Et.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#at()}#lt(){document.addEventListener("selectionchange",this.#ot.bind(this),{signal:this._signal})}#ct(){if(this.#w)return;this.#w=new AbortController;const t=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ut(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#W("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#_)if(e.div.contains(t)){this.#N=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#N)return;const[t,e]=this.#N;this.#N=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#k)return;this.#k=new AbortController;const t=this.combinedSignal(this.#k);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ht(){this.#k?.abort(),this.#k=null}#nt(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#it(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.#nt()}removeEditListeners(){this.#ht(),this.#it()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const n of this.#_){const s=n.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const a of e.items)for(const l of this.#u)if(l.isHandlingMimeForPasting(a.type)){l.paste(a,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(a){Tt(`paste: "${a.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const a=[];for(const d of n){const f=await s.deserialize(d);if(!f)return;a.push(f)}const l=()=>{for(const d of a)this.#st(d);this.#rt(a)},u=()=>{for(const d of a)d.remove()};this.addCommands({cmd:l,undo:u,mustExec:!0})}catch(a){Tt(`paste: "${a.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#x!==Et.NONE&&!this.isEditorHandlingKeyboard&&qi._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#W("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#M(t){Object.entries(t).some(([n,s])=>this.#Y[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#Y,t)}),this.#x===Et.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#$([[Nt.HIGHLIGHT_FREE,!0]]))}#$(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ct(),this.#nt(),this.#M({isEditing:this.#x!==Et.NONE,isEmpty:this.#K(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ut(),this.#it(),this.#M({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const e of this.#u)this.#$(e.defaultPropertiesToUpdate)}}getId(){return this.#O.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(t){return this.#a.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#a.set(t.pageIndex,t),this.#R?t.enable():t.disable()}removeLayer(t){this.#a.delete(t.pageIndex)}async updateMode(t,e=null,n=!1,s=!1,a=!1){if(this.#x!==t&&!(this.#F&&(await this.#F.promise,!this.#F))){if(this.#F=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#x===Et.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#x=t,t===Et.NONE){this.setEditingState(!1),this.#gt();for(const l of this.#n.values())l.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#F.resolve();return}for(const l of this.#n.values())l.addStandaloneCommentButton();t===Et.SIGNATURE&&await this.#U?.loadSignatures(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const l of this.#a.values())l.updateMode(t);if(t===Et.POPUP){this.#i||=await this.#V.getAnnotationsByType(new Set(this.#u.map(d=>d._editorType)));const l=new Set,u=[];for(const d of this.#n.values()){const{annotationElementId:f,hasComment:g,deleted:m}=d;f&&l.add(f),g&&!m&&u.push(d.getData())}for(const d of this.#i){const{id:f,popupRef:g,contentsObj:m}=d;g&&m?.str&&!l.has(f)&&!this.#m.has(f)&&u.push(d)}this.#l?.showSidebar(u)}if(!e){n&&this.addNewEditorFromKeyboard(),this.#F.resolve();return}for(const l of this.#n.values())l.uid===e?(this.setSelected(l),a?l.editComment():s?l.enterInEditMode():l.focus()):l.unselect();this.#F.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#x&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#u){switch(t){case Nt.CREATE:this.currentLayer.addNewEditor(e);return;case Nt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#X||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const n of this.#_)n.updateParams(t,e);else for(const n of this.#u)n.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){for(const a of this.#n.values())a.editorType===t&&a.show(e);(this.#X?.get(Nt.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#$([[Nt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#j!==t){this.#j=t;for(const e of this.#a.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#R){this.#R=!0;const t=[];for(const e of this.#a.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#gt(){if(this.unselectAll(),this.#R){this.#R=!1;for(const t of this.#a.values())t.disable();for(const t of this.#n.values())t.disable()}}*getEditors(t){for(const e of this.#n.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#A&&clearTimeout(this.#A),this.#A=setTimeout(()=>{this.focusMainContainer(),this.#A=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#L?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#r?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#st(t){const e=this.#a.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#$(t.propertiesToUpdate))}get#pt(){let t=null;for(t of this.#_);return t}updateUI(t){this.#pt===t&&this.#$(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#$(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#_.has(t)){this.#_.delete(t),t.unselect(),this.#M({hasSelectedEditor:this.hasSelection});return}this.#_.add(t),t.select(),this.#$(t.propertiesToUpdate),this.#M({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),this.#h?.commitOrRemove();for(const e of this.#_)e!==t&&e.unselect();this.#_.clear(),this.#_.add(t),t.select(),this.#$(t.propertiesToUpdate),this.#M({hasSelectedEditor:!0})}isSelected(t){return this.#_.has(t)}get firstSelectedEditor(){return this.#_.values().next().value}unselect(t){t.unselect(),this.#_.delete(t),this.#M({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#_.size!==0}get isEnterHandled(){return this.#_.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#M({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#K()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#M({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#K()})}addCommands(t){this.#c.add(t),this.#M({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#K()})}cleanUndoStack(t){this.#c.cleanType(t)}#K(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#_],n=()=>{this._editorUndoBar?.show(s,e.length===1?e[0].editorType:e.length);for(const a of e)a.remove()},s=()=>{for(const a of e)this.#st(a)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#rt(t){for(const e of this.#_)e.unselect();this.#_.clear();for(const e of t)e.isEmpty()||(this.#_.add(e),e.select());this.#M({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#_)t.commit();this.#rt(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#x!==Et.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#_)t.unselect();this.#_.clear(),this.#M({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=e;const[s,a]=this.#H,l=[...this.#_],u=1e3;this.#B&&clearTimeout(this.#B),this.#B=setTimeout(()=>{this.#B=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const d of l)this.#n.has(d.id)&&(d.translateInPage(s,a),d.translationDone())},undo:()=>{for(const d of l)this.#n.has(d.id)&&(d.translateInPage(-s,-a),d.translationDone())},mustExec:!1})},u);for(const d of l)d.translateInPage(t,e),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const t of this.#_)this.#g.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const t=this.#g;this.#g=null;let e=!1;for(const[{x:s,y:a,pageIndex:l},u]of t)u.newX=s,u.newY=a,u.newPageIndex=l,e||=s!==u.savedX||a!==u.savedY||l!==u.savedPageIndex;if(!e)return!1;const n=(s,a,l,u)=>{if(this.#n.has(s.id)){const d=this.#a.get(u);d?s._setParentAndPosition(d,a,l):(s.pageIndex=u,s.x=a,s.y=l)}};return this.addCommands({cmd:()=>{for(const[s,{newX:a,newY:l,newPageIndex:u}]of t)n(s,a,l,u)},undo:()=>{for(const[s,{savedX:a,savedY:l,savedPageIndex:u}]of t)n(s,a,l,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#g)for(const n of this.#g.keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#_.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#x}isEditingMode(){return this.#x!==Et.NONE}get imageManager(){return Ct(this,"imageManager",new Og)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,g=e.rangeCount;f<g;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:n,y:s,width:a,height:l}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,g,m,v)=>({x:(g-s)/l,y:1-(f+m-n)/a,width:v/l,height:m/a});break;case"180":u=(f,g,m,v)=>({x:1-(f+m-n)/a,y:1-(g+v-s)/l,width:m/a,height:v/l});break;case"270":u=(f,g,m,v)=>({x:1-(g+v-s)/l,y:(f-n)/a,width:v/l,height:m/a});break;default:u=(f,g,m,v)=>({x:(f-n)/a,y:(g-s)/l,width:m/a,height:v/l});break}const d=[];for(let f=0,g=e.rangeCount;f<g;f++){const m=e.getRangeAt(f);if(!m.collapsed)for(const{x:v,y:b,width:S,height:w}of m.getClientRects())S===0||w===0||d.push(u(v,b,S,w))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const n=this.#r.getRawValue(e);n&&(this.#x===Et.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}setMissingCanvas(t,e,n){const s=this.#L?.get(t);s&&(s.setCanvas(e,n),this.#L.delete(t))}addMissingCanvas(t,e){(this.#L||=new Map).set(t,e)}}class bi{#t=null;#e=!1;#i=null;#n=null;#a=null;#s=null;#r=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,bi.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){bi._l10n??=t}async render(){const t=this.#i=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#n=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",bi.#f.missing),e.setAttribute("data-l10n-id",bi.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#c._uiManager._signal;t.addEventListener("contextmenu",Mn,{signal:n}),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const s=a=>{a.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",s,{capture:!0,signal:n}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#r=!0,s(a))},{signal:n}),await this.#g(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#r}),this.#r=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await bi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#g())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:s,cancel:a=!1}){n&&(this.#l=n,this.#d=s),!(this.#t===t&&this.#e===e)&&(a||(this.#t=t,this.#e=e),this.#g())}toggle(t=!1){this.#i&&(!t&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#i.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#a=null,this.#o?.remove(),this.#o=null}async#g(){const t=this.#i;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",bi.#f[this.#m]),this.#n?.setAttribute("data-l10n-id",bi.#f[`${this.#m}-label`]),!this.#t){this.#a?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#a?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#a;if(!e){this.#a=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const s=100,a=this.#c._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#a.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:a}),t.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#a?.classList.remove("show")},{signal:a})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class Qc{#t=null;#e=null;#i=!1;#n=null;#a=null;#s=null;#r=null;#o=null;#c=!1;#l=null;constructor(t){this.#n=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#n.commentButtonPosition;if(e){const{style:n}=t;n.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const s=this.#n.commentButtonColor;s&&(n.backgroundColor=s)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#n.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:n}=this.#t.getBoundingClientRect(),{x:s,y:a,width:l,height:u}=this.#n.parent.boundingClientRect;return[(t-s)/l,(e+n-a)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#n._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const n=this.#n._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return t;t.addEventListener("contextmenu",Mn,{signal:n}),e&&(t.addEventListener("focusin",a=>{this.#n._focusEventsAllowed=!1,de(a)},{capture:!0,signal:n}),t.addEventListener("focusout",a=>{this.#n._focusEventsAllowed=!0,de(a)},{capture:!0,signal:n})),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const s=a=>{a.preventDefault(),t===this.#e?this.edit():this.#n.toggleComment(!0)};return t.addEventListener("click",s,{capture:!0,signal:n}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#i=!0,s(a))},{signal:n}),t.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:n}),t.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:n}),t}edit(t){const e=this.commentPopupPositionInLayer;let n,s;if(e)[n,s]=e;else{[n,s]=this.#n.commentButtonPosition;const{width:g,height:m,x:v,y:b}=this.#n;n=v+n*g,s=b+s*m}const a=this.#n.parent.boundingClientRect,{x:l,y:u,width:d,height:f}=a;this.#n._uiManager.editComment(this.#n,l+n*d,u+s*f,{...t,parentDimensions:a})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#r===""}isEmpty(){return this.#r===null}hasBeenEdited(){return this.isDeleted()||this.#r!==this.#a}serialize(){return this.data}get data(){return{text:this.#r,richText:this.#s,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#r&&(this.#s=null),t===null){this.#r="",this.#c=!0;return}this.#r=t,this.#o=new Date,this.#c=!1}setInitialText(t,e=null){this.#a=t,this.data=t,this.#o=null,this.#s=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#r="",this.#s=null,this.#o=null,this.#n=null,this.#i=!1,this.#c=!1}}class wl{#t;#e=!1;#i=null;#n;#a;#s;#r;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:a=null,onPinchEnd:l=null,signal:u}){this.#t=t,this.#i=n,this.#n=e,this.#a=s,this.#s=a,this.#r=l,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/ii.pixelRatio}#f(t){if(this.#n?.())return;if(t.touches.length===1){if(this.#o)return;const s=this.#o=new AbortController,a=AbortSignal.any([this.#c,s.signal]),l=this.#t,u={capture:!0,signal:a,passive:!1},d=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};l.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(de(f),d(f))},u),l.addEventListener("pointerup",d,u),l.addEventListener("pointercancel",d,u);return}if(!this.#h){this.#h=new AbortController;const s=AbortSignal.any([this.#c,this.#h.signal]),a=this.#t,l={signal:s,capture:!1,passive:!1};a.addEventListener("touchmove",this.#m.bind(this),l);const u=this.#g.bind(this);a.addEventListener("touchend",u,l),a.addEventListener("touchcancel",u,l),l.capture=!0,a.addEventListener("pointerdown",de,l),a.addEventListener("pointermove",de,l),a.addEventListener("pointercancel",de,l),a.addEventListener("pointerup",de,l),this.#a?.()}if(de(t),t.touches.length!==2||this.#i?.()){this.#l=null;return}let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#m(t){if(!this.#l||t.touches.length!==2)return;de(t);let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]);const{screenX:s,screenY:a}=e,{screenX:l,screenY:u}=n,d=this.#l,{touch0X:f,touch0Y:g,touch1X:m,touch1Y:v}=d,b=m-f,S=v-g,w=l-s,A=u-a,_=Math.hypot(w,A)||1,E=Math.hypot(b,S)||1;if(!this.#e&&Math.abs(E-_)<=wl.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=s,d.touch0Y=a,d.touch1X=l,d.touch1Y=u,!this.#e){this.#e=!0;return}const x=[(s+l)/2,(a+u)/2];this.#s?.(x,E,_)}#g(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#r?.()),this.#l&&(de(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class pt{#t=null;#e=null;#i=null;#n=null;#a=null;#s=!1;#r=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#m="";#g=!1;#u=null;#p=!1;#y=!1;#b=!1;#v=null;#T=0;#A=0;#w=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#E=pt._zIndex++;static _borderLineWidth=-1;static _colorManager=new Mg;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=pt.prototype._resizeWithKeyboard,e=qi.TRANSLATE_SMALL,n=qi.TRANSLATE_BIG;return Ct(this,"_resizerKeyboardManager",new bl([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],pt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:s,pageX:a,pageY:l}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[a,l];const[u,d]=this.parentDimensions;this.x=t.x/u,this.y=t.y/d,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ct(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new RC({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(pt._l10n??=t,pt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),pt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);pt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Zt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(t){this.#S=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#E}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#B(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,s){const[a,l]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(t+n)/a,this.y=(e+s)/l,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[n,s]=this.parentDimensions;this.setAt(t*n,e*s,this.width*n,this.height*s),this._onTranslated()}#O([t,e],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/t,this.y+=s/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#O(this.parentDimensions,t,e)}translateInPage(t,e){this.#u||=[this.x,this.y,this.width,this.height],this.#O(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#u||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[s,a]}=this;if(this.x+=t/s,this.y+=e/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:u}=this;const[d,f]=this.getBaseTranslation();l+=d,u+=f;const{style:g}=n;g.left=`${(100*l).toFixed(2)}%`,g.top=`${(100*u).toFixed(2)}%`,this._onTranslating(l,u),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=pt,s=n/t,a=n/e;switch(this.rotation){case 90:return[-s,a];case 180:return[s,a];case 270:return[s,-a];default:return[-s,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[n,s]}=this;let{x:a,y:l,width:u,height:d}=this;if(u*=n,d*=s,a*=n,l*=s,this._mustFixPosition)switch(t){case 0:a=Je(a,0,n-u),l=Je(l,0,s-d);break;case 90:a=Je(a,0,n-d),l=Je(l,u,s);break;case 180:a=Je(a,u,n),l=Je(l,d,s);break;case 270:a=Je(a,d,n),l=Je(l,0,s-u);break}this.x=a/=n,this.y=l/=s;const[f,g]=this.getBaseTranslation();a+=f,l+=g,e.left=`${(100*a).toFixed(2)}%`,e.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#R(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return pt.#R(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return pt.#R(t,e,360-this.parentRotation)}#D(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(){const{div:{style:t},width:e,height:n}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#j(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const s=document.createElement("div");this.#c.append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",this.#k.bind(this,n),{signal:e}),s.addEventListener("contextmenu",Mn,{signal:e}),s.tabIndex=-1}this.div.prepend(this.#c)}#k(t,e){e.preventDefault();const{isMac:n}=Ue.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#i?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const a=new AbortController,l=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#L.bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",de,{passive:!1,signal:l}),window.addEventListener("contextmenu",Mn,{signal:l}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{a.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=u,this.div.style.cursor=d,this.#I()};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})}#N(t,e,n,s){this.width=n,this.height=s,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#I(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:s}=this.#d;this.#d=null;const a=this.x,l=this.y,u=this.width,d=this.height;a===t&&l===e&&u===n&&d===s||this.addCommands({cmd:this.#N.bind(this,a,l,u,d),undo:this.#N.bind(this,t,e,n,s),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#L(t,e){const[n,s]=this.parentDimensions,a=this.x,l=this.y,u=this.width,d=this.height,f=pt.MIN_SIZE/n,g=pt.MIN_SIZE/s,m=this.#D(this.rotation),v=(B,H)=>[m[0]*B+m[2]*H,m[1]*B+m[3]*H],b=this.#D(360-this.rotation),S=(B,H)=>[b[0]*B+b[2]*H,b[1]*B+b[3]*H];let w,A,_=!1,E=!1;switch(t){case"topLeft":_=!0,w=(B,H)=>[0,0],A=(B,H)=>[B,H];break;case"topMiddle":w=(B,H)=>[B/2,0],A=(B,H)=>[B/2,H];break;case"topRight":_=!0,w=(B,H)=>[B,0],A=(B,H)=>[0,H];break;case"middleRight":E=!0,w=(B,H)=>[B,H/2],A=(B,H)=>[0,H/2];break;case"bottomRight":_=!0,w=(B,H)=>[B,H],A=(B,H)=>[0,0];break;case"bottomMiddle":w=(B,H)=>[B/2,H],A=(B,H)=>[B/2,0];break;case"bottomLeft":_=!0,w=(B,H)=>[0,H],A=(B,H)=>[B,0];break;case"middleLeft":E=!0,w=(B,H)=>[0,H/2],A=(B,H)=>[B,H/2];break}const x=w(u,d),O=A(u,d);let C=v(...O);const D=pt._round(a+C[0]),R=pt._round(l+C[1]);let k=1,L=1,V,q;if(e.fromKeyboard)({deltaX:V,deltaY:q}=e);else{const{screenX:B,screenY:H}=e,[tt,lt]=this.#l;[V,q]=this.screenToPageTranslation(B-tt,H-lt),this.#l[0]=B,this.#l[1]=H}if([V,q]=S(V/n,q/s),_){const B=Math.hypot(u,d);k=L=Math.max(Math.min(Math.hypot(O[0]-x[0]-V,O[1]-x[1]-q)/B,1/u,1/d),f/u,g/d)}else E?k=Je(Math.abs(O[0]-x[0]-V),f,1)/u:L=Je(Math.abs(O[1]-x[1]-q),g,1)/d;const it=pt._round(u*k),rt=pt._round(d*L);C=v(...A(it,rt));const st=D-C[0],ot=R-C[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=it,this.height=rt,this.x=st,this.y=ot,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new tl(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,n]of t)await this._editToolbar.addButton(e,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(bi.initialize(pt._l10n),this.#i=new bi(this),this.#t&&(this.#i.data=this.#t,this.#t=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(t){this.#i&&(this.#i.data=t)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(t){await this.#i?.setGuessedText(t)}serializeAltText(t){return this.#i?.serialize(t)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.#n||=new Qc(this)}addStandaloneCommentButton(){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#n.renderForStandalone(),this.div.append(this.#a))}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:n,deleted:s}}=this.#n;return{text:e,richText:t,date:n,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#n||=new Qc(this),this.#n.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:n}){if(!e||(this.#n||=new Qc(this),this.#n.setInitialText(t,n),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(t){this.#n||=new Qc(this),this.#n.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#n.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,s]=t.rect,[a]=this.pageDimensions,[l]=this.pageTranslation,u=l+a+1,d=s-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,d,f,s]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#n.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#s?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#z();const[e,n]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*n/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/n).toFixed(2)}%`);const[s,a]=this.getInitialTranslation();return this.translate(s,a),t_(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new wl({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#q.bind(this),onPinching:this.#x.bind(this),onPinchEnd:this.#_.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#q(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#x(t,e,n){let a=.7*(n/e)+1-.7;if(a===1)return;const l=this.#D(this.rotation),u=(D,R)=>[l[0]*D+l[2]*R,l[1]*D+l[3]*R],[d,f]=this.parentDimensions,g=this.x,m=this.y,v=this.width,b=this.height,S=pt.MIN_SIZE/d,w=pt.MIN_SIZE/f;a=Math.max(Math.min(a,1/v,1/b),S/v,w/b);const A=pt._round(v*a),_=pt._round(b*a);if(A===v&&_===b)return;this.#u||=[g,m,v,b];const E=u(v/2,b/2),x=pt._round(g+E[0]),O=pt._round(m+E[1]),C=u(A/2,_/2);this.x=x-C[0],this.y=O-C[1],this.width=A,this.height=_,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#_(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#I()}pointerdown(t){const{isMac:e}=Ue.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#U(t);return}this.#P(t)}#P(t){const{isMac:e}=Ue.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,a=this._uiManager.combinedSignal(s),l={capture:!0,passive:!1,signal:a},u=f=>{s.abort(),this.#r=null,this.#g=!1,this._uiManager.endDragSession()||this.#P(f),n&&this._onStopDragging()};e&&(this.#T=t.clientX,this.#A=t.clientY,this.#r=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:g,clientY:m,pointerId:v}=f;if(v!==this.#r){de(f);return}const[b,S]=this.screenToPageTranslation(g-this.#T,m-this.#A);this.#T=g,this.#A=m,this._uiManager.dragSelectedEditors(b,S)},l),window.addEventListener("touchmove",de,l),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#C||f.isPrimary)&&u(f),de(f)},l));const d=f=>{if(!this.#r||this.#r===f.pointerId){u(f);return}de(f)};window.addEventListener("pointerup",d,{signal:a}),window.addEventListener("blur",d,{signal:a})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,n=this.rotation){const s=this.parentScale,[a,l]=this.pageDimensions,[u,d]=this.pageTranslation,f=t/s,g=e/s,m=this.x*a,v=this.y*l,b=this.width*a,S=this.height*l;switch(n){case 0:return[m+f+u,l-v-g-S+d,m+f+b+u,l-v-g+d];case 90:return[m+g+u,l-v+f+d,m+g+S+u,l-v+f+b+d];case 180:return[m-f-b+u,l-v+g+d,m-f+u,l-v+g+S+d];case 270:return[m-g-S+u,l-v-f-b+d,m-g+u,l-v-f+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,s,a,l]=t,u=a-n,d=l-s;switch(this.rotation){case 0:return[n,e-l,u,d];case 90:return[n,e-s,d,u];case 180:return[a,e-s,u,d];case 270:return[a,e-l,d,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&pt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:n,opacity:s,deleted:a,richText:l},uid:u,pageIndex:d,creationDate:f,modificationDate:g}=this;return{id:u,pageIndex:d,rect:this.getPDFRect(),richText:l,contentsObj:{str:t},creationDate:f,modificationDate:n||g,popupRef:!a,color:e,opacity:s}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#b}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:a,innerWidth:l}=window;return e<l&&s>0&&t<a&&n>0}#z(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#z()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,n){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});s.rotation=t.rotation,s.#t=t.accessibilityData,s._isCopy=t.isCopy||!1;const[a,l]=s.pageDimensions,[u,d,f,g]=s.getRectInCurrentCoords(t.rect,l);return s.x=u/a,s.y=d/l,s.width=f/a,s.height=g/l,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#B(),this.removeEditToolbar(),this.#w){for(const t of this.#w.values())clearTimeout(t);this.#w=null}this.parent=null,this.#C?.destroy(),this.#C=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#j(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[n,s,a,l]=this.getPDFRect();return[pt._round(n+(a-n)*t),pt._round(s+(l-s)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(t){this.#n.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#n.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const l=this.#X.bind(this),u=this.#V.bind(this),d=this._uiManager._signal;for(const f of this.#e){const g=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:d}),f.addEventListener("blur",u,{signal:d}),f.addEventListener("focus",this.#Y.bind(this,g),{signal:d}),f.setAttribute("data-l10n-id",pt._l10nResizer[g])}}const n=this.#e[0];let s=0;for(const l of e){if(l===n)break;s++}const a=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(a!==s){if(a<s)for(let u=0;u<s-a;u++)this.#c.append(this.#c.firstChild);else if(a>s)for(let u=0;u<a-s;u++)this.#c.firstChild.before(this.#c.lastChild);let l=0;for(const u of e){const f=this.#e[l++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",pt._l10nResizer[f])}}this.#H(0),this.#b=!0,this.#c.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#X(t){pt._resizerKeyboardManager.exec(this,t)}#V(t){this.#b&&t.relatedTarget?.parentNode!==this.#c&&this.#B()}#Y(t){this.#m=this.#b?t:""}#H(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#b&&this.#L(this.#m,{deltaX:t,deltaY:e,fromKeyboard:!0})}#B(){this.#b=!1,this.#H(-1),this.#I()}_stopResizingWithKeyboard(){this.#B(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#w||=new Map;const{action:n}=t;let s=this.#w.get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),this.#w.delete(n),this.#w.size===0&&(this.#w=null)},pt._telemetryTimeout),this.#w.set(n,s);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#s=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#s=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class RC extends pt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Kb=3285377520,zn=4294901760,yi=65535;class e_{constructor(t){this.h1=t?t&4294967295:Kb,this.h2=t?t&4294967295:Kb}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let w=0,A=t.length;w<A;w++){const _=t.charCodeAt(w);_<=255?e[n++]=_:(e[n++]=_>>>8,e[n++]=_&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,a=n-s*4,l=new Uint32Array(e.buffer,0,s);let u=0,d=0,f=this.h1,g=this.h2;const m=3432918353,v=461845907,b=m&yi,S=v&yi;for(let w=0;w<s;w++)w&1?(u=l[w],u=u*m&zn|u*b&yi,u=u<<15|u>>>17,u=u*v&zn|u*S&yi,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(d=l[w],d=d*m&zn|d*b&yi,d=d<<15|d>>>17,d=d*v&zn|d*S&yi,g^=d,g=g<<13|g>>>19,g=g*5+3864292196);switch(u=0,a){case 3:u^=e[s*4+2]<<16;case 2:u^=e[s*4+1]<<8;case 1:u^=e[s*4],u=u*m&zn|u*b&yi,u=u<<15|u>>>17,u=u*v&zn|u*S&yi,s&1?f^=u:g^=u}this.h1=f,this.h2=g}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&zn|t*36045&yi,e=e*4283543511&zn|((e<<16|t>>>16)*2950163797&zn)>>>16,t^=e>>>1,t=t*444984403&zn|t*60499&yi,e=e*3301882366&zn|((e<<16|t>>>16)*3120437893&zn)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Vf=Object.freeze({map:null,hash:"",transfer:void 0});class kg{#t=!1;#e=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=this.#n.get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return this.#n.get(t)}remove(t){const e=this.#n.get(t);if(e!==void 0&&(e instanceof pt&&this.#i.delete(e.annotationElementId),this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of this.#n.values())if(n instanceof pt)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=this.#n.get(t);let s=!1;if(n!==void 0)for(const[a,l]of Object.entries(e))n[a]!==l&&(s=!0,n[a]=l);else s=!0,this.#n.set(t,e);s&&this.#a(),e instanceof pt&&((this.#i||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#n.has(t)}get size(){return this.#n.size}#a(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new n_(this)}get serializable(){if(this.#n.size===0)return Vf;const t=new Map,e=new e_,n=[],s=Object.create(null);let a=!1;for(const[l,u]of this.#n){const d=u instanceof pt?u.serialize(!1,s):u;d&&(t.set(l,d),e.update(`${l}:${JSON.stringify(d)}`),a||=!!d.bitmap)}if(a)for(const l of t.values())l.bitmap&&n.push(l.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:Vf}get editorStats(){let t=null;const e=new Map;let n=0,s=0;for(const a of this.#n.values()){if(!(a instanceof pt)){a.popup&&(a.popup.deleted?s+=1:n+=1);continue}a.isCommentDeleted?s+=1:a.hasEditedComment&&(n+=1);const l=a.telemetryFinalData;if(!l)continue;const{type:u}=l;e.has(u)||e.set(u,Object.getPrototypeOf(a).constructor),t||=Object.create(null);const d=t[u]||=new Map;for(const[f,g]of Object.entries(l)){if(f==="type")continue;let m=d.get(f);m||(m=new Map,d.set(f,m));const v=m.get(g)??0;m.set(g,v+1)}}if((s>0||n>0)&&(t||=Object.create(null),t.comments={deleted:s,edited:n}),!t)return null;for(const[a,l]of e)t[a]=l.computeTelemetryFinalData(t[a]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const n=this.#i?.get(t);return n?(n.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#i?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#i)for(const e of this.#i.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class n_ extends kg{#t;constructor(t){super();const{map:e,hash:n,transfer:s}=t.serializable,a=structuredClone(e,s?{transfer:s}:null);this.#t={map:a,hash:n,transfer:s}}get print(){Zt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Ct(this,"modifiedIds",{ids:new Set,hash:""})}}class DC{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:n}){if(!(!t||this.#t.has(t.loadedName))){if(Lt(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:a,style:l}=t,u=new FontFace(s,a,l);this.addNativeFontFace(u);try{await u.load(),this.#t.add(s),n?.(t)}catch{Tt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Zt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw Tt(`Failed to load font '${n.family}': '${s}'.`),t.disableFontFace=!0,s}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,s)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Ct(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Ct(this,"isSyncFontLoadingSupported",rn||Ue.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Lt(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const a=n.shift();setTimeout(a.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:e,callback:t};return n.push(s),s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ct(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(O,C){return O.charCodeAt(C)<<24|O.charCodeAt(C+1)<<16|O.charCodeAt(C+2)<<8|O.charCodeAt(C+3)&255}function s(O,C,D,R){const k=O.substring(0,C),L=O.substring(C+D);return k+R+L}let a,l;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let f=0;function g(O,C){if(++f>30){Tt("Load test font never loaded."),C();return}if(d.font="30px "+O,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){C();return}setTimeout(g.bind(null,O,C))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=s(v,976,m.length,m);const S=16,w=1482184792;let A=n(v,S);for(a=0,l=m.length-3;a<l;a+=4)A=A-w+n(m,a)|0;a<m.length&&(A=A-w+n(m+"XXX",a)|0),v=s(v,S,4,mC(A));const _=`url(data:font/opentype;base64,${btoa(v)});`,E=`@font-face {font-family:"${m}";src:${_}}`;this.insertRule(E);const x=this._document.createElement("div");x.style.visibility="hidden",x.style.width=x.style.height="10px",x.style.position="absolute",x.style.top=x.style.left="0px";for(const O of[t.loadedName,m]){const C=this._document.createElement("span");C.textContent="Hi",C.style.fontFamily=O,x.append(C)}this._document.body.append(x),g(m,()=>{x.remove(),e.complete()})}}class OC{#t;constructor(t,e=null,n,s){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,n&&Object.assign(this,n),s&&(this.charProcOperatorList=s)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Xw(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let s;try{s=t.get(n)}catch(l){Tt(`getPathGenerator - ignoring character: "${l}".`)}const a=new Path2D(s||"");return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=a}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}function MC(o){if(o instanceof URL)return o.href;if(typeof o=="string"){if(rn)return o;const t=URL.parse(o,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function kC(o){if(rn&&typeof Buffer<"u"&&o instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength)return o;if(typeof o=="string")return ml(o);if(o instanceof ArrayBuffer||ArrayBuffer.isView(o)||typeof o=="object"&&!isNaN(o?.length))return new Uint8Array(o);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Zc(o){if(typeof o!="string")return null;if(o.endsWith("/"))return o;throw new Error(`Invalid factory url: "${o}" must include trailing slash.`)}const Xf=o=>typeof o=="object"&&Number.isInteger(o?.num)&&o.num>=0&&Number.isInteger(o?.gen)&&o.gen>=0,PC=o=>typeof o=="object"&&typeof o?.name=="string",i_=wC.bind(null,Xf,PC);class NC{#t=new Map;#e=Promise.resolve();postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[s]of this.#t)s.call(this,n)})}addEventListener(t,e,n=null){let s=null;if(n?.signal instanceof AbortSignal){const{signal:a}=n;if(a.aborted){Tt("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,e);s=()=>a.removeEventListener("abort",l),a.addEventListener("abort",l)}this.#t.set(e,s)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const Jc={DATA:1,ERROR:2},Ce={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Qb(){}function fn(o){if(o instanceof $i||o instanceof yu||o instanceof $b||o instanceof al||o instanceof mf)return o;switch(o instanceof Error||typeof o=="object"&&o!==null||Zt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),o.name){case"AbortException":return new $i(o.message);case"InvalidPDFException":return new yu(o.message);case"PasswordException":return new $b(o.message,o.code);case"ResponseException":return new al(o.message,o.status,o.missing);case"UnknownErrorException":return new mf(o.message,o.details)}return new mf(o.message,o.toString())}class Go{#t=new AbortController;constructor(t,e,n){this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#n(t);return}if(t.callback){const n=t.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===Jc.DATA)s.resolve(t.data);else if(t.callback===Jc.ERROR)s.reject(fn(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,s=t.sourceName,a=this.comObj;Promise.try(e,t.data).then(function(l){a.postMessage({sourceName:n,targetName:s,callback:Jc.DATA,callbackId:t.callbackId,data:l})},function(l){a.postMessage({sourceName:n,targetName:s,callback:Jc.ERROR,callbackId:t.callbackId,reason:fn(l)})});return}if(t.streamId){this.#i(t);return}e(t.data)}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const s=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[s]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},n)}catch(l){a.reject(l)}return a.promise}sendWithStream(t,e,n,s){const a=this.streamId++,l=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:f=>{const g=Promise.withResolvers();return this.streamControllers[a]={controller:f,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:l,targetName:u,action:t,streamId:a,data:e,desiredSize:f.desiredSize},s),g.promise},pull:f=>{const g=Promise.withResolvers();return this.streamControllers[a].pullCall=g,d.postMessage({sourceName:l,targetName:u,stream:Ce.PULL,streamId:a,desiredSize:f.desiredSize}),g.promise},cancel:f=>{Lt(f instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[a].cancelCall=g,this.streamControllers[a].isClosed=!0,d.postMessage({sourceName:l,targetName:u,stream:Ce.CANCEL,streamId:a,reason:fn(f)}),g.promise}},n)}#i(t){const e=t.streamId,n=this.sourceName,s=t.sourceName,a=this.comObj,l=this,u=this.actionHandler[t.action],d={enqueue(f,g=1,m){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=g,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:n,targetName:s,stream:Ce.ENQUEUE,streamId:e,chunk:f},m)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:s,stream:Ce.CLOSE,streamId:e}),delete l.streamSinks[e])},error(f){Lt(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:s,stream:Ce.ERROR,streamId:e,reason:fn(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[e]=d,Promise.try(u,t.data,d).then(function(){a.postMessage({sourceName:n,targetName:s,stream:Ce.START_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:n,targetName:s,stream:Ce.START_COMPLETE,streamId:e,reason:fn(f)})})}#n(t){const e=t.streamId,n=this.sourceName,s=t.sourceName,a=this.comObj,l=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case Ce.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(fn(t.reason));break;case Ce.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(fn(t.reason));break;case Ce.PULL:if(!u){a.postMessage({sourceName:n,targetName:s,stream:Ce.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||Qb).then(function(){a.postMessage({sourceName:n,targetName:s,stream:Ce.PULL_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:n,targetName:s,stream:Ce.PULL_COMPLETE,streamId:e,reason:fn(f)})});break;case Ce.ENQUEUE:if(Lt(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case Ce.CLOSE:if(Lt(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#a(l,e);break;case Ce.ERROR:Lt(l,"error should have stream controller"),l.controller.error(fn(t.reason)),this.#a(l,e);break;case Ce.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(fn(t.reason)),this.#a(l,e);break;case Ce.CANCEL:if(!u)break;const d=fn(t.reason);Promise.try(u.onCancel||Qb,d).then(function(){a.postMessage({sourceName:n,targetName:s,stream:Ce.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:n,targetName:s,stream:Ce.CANCEL_COMPLETE,streamId:e,reason:fn(f)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#a(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class s_{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Zt("Abstract method `_createCanvas` called.")}}class LC extends s_{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}class r_{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Zt("Abstract method `_fetch` called.")}}class Zb extends r_{async _fetch(t){const e=await ka(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):ml(e)}}class a_{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,s,a){return"none"}destroy(t=!1){}}class BC extends a_{#t;#e;#i;#n;#a;#s;#r=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#n=t,this.#a=e}get#o(){return this.#e||=new Map}get#c(){return this.#s||=new Map}get#l(){if(!this.#i){const t=this.#a.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const n=this.#a.createElementNS(Fi,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#i=this.#a.createElementNS(Fi,"defs"),t.append(n),n.append(this.#i),this.#a.body.append(t)}return this.#i}#d(t){if(t.length===1){const d=t[0],f=new Array(256);for(let m=0;m<256;m++)f[m]=d[m]/255;const g=f.join(",");return[g,g,g]}const[e,n,s]=t,a=new Array(256),l=new Array(256),u=new Array(256);for(let d=0;d<256;d++)a[d]=e[d]/255,l[d]=n[d]/255,u[d]=s[d]/255;return[a.join(","),l.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#a.URL;e!==this.#a.baseURI&&(vl(e)?Tt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=Tg(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[n,s,a]=this.#d(t),l=t.length===1?n:`${n}${s}${a}`;if(e=this.#o.get(l),e)return this.#o.set(t,e),e;const u=`g_${this.#n}_transfer_map_${this.#r++}`,d=this.#h(u);this.#o.set(t,d),this.#o.set(l,d);const f=this.#g(u);return this.#p(n,s,a,f),d}addHCMFilter(t,e){const n=`${t}-${e}`,s="base";let a=this.#c.get(s);if(a?.key===n||(a?(a.filter?.remove(),a.key=n,a.url="none",a.filter=null):(a={key:n,url:"none",filter:null},this.#c.set(s,a)),!t||!e))return a.url;const l=this.#b(t);t=ut.makeHexColor(...l);const u=this.#b(e);if(e=ut.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return a.url;const d=new Array(256);for(let b=0;b<=255;b++){const S=b/255;d[b]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}const f=d.join(","),g=`g_${this.#n}_hcm_filter`,m=a.filter=this.#g(g);this.#p(f,f,f,m),this.#m(m);const v=(b,S)=>{const w=l[b]/255,A=u[b]/255,_=new Array(S+1);for(let E=0;E<=S;E++)_[E]=w+E/S*(A-w);return _.join(",")};return this.#p(v(0,5),v(1,5),v(2,5),m),a.url=this.#h(g),a.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[n]=this.#d([t]),s=`alpha_${n}`;if(e=this.#o.get(s),e)return this.#o.set(t,e),e;const a=`g_${this.#n}_alpha_map_${this.#r++}`,l=this.#h(a);this.#o.set(t,l),this.#o.set(s,l);const u=this.#g(a);return this.#y(n,u),l}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let n,s;if(t?([n]=this.#d([t]),s=`luminosity_${n}`):s="luminosity",e=this.#o.get(s),e)return this.#o.set(t,e),e;const a=`g_${this.#n}_luminosity_map_${this.#r++}`,l=this.#h(a);this.#o.set(t,l),this.#o.set(s,l);const u=this.#g(a);return this.#f(u),t&&this.#y(n,u),l}addHighlightHCMFilter(t,e,n,s,a){const l=`${e}-${n}-${s}-${a}`;let u=this.#c.get(t);if(u?.key===l||(u?(u.filter?.remove(),u.key=l,u.url="none",u.filter=null):(u={key:l,url:"none",filter:null},this.#c.set(t,u)),!e||!n))return u.url;const[d,f]=[e,n].map(this.#b.bind(this));let g=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),m=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[v,b]=[s,a].map(this.#b.bind(this));m<g&&([g,m,v,b]=[m,g,b,v]),this.#l.style.color="";const S=(_,E,x)=>{const O=new Array(256),C=(m-g)/x,D=_/255,R=(E-_)/(255*x);let k=0;for(let L=0;L<=x;L++){const V=Math.round(g+L*C),q=D+L*R;for(let it=k;it<=V;it++)O[it]=q;k=V+1}for(let L=k;L<256;L++)O[L]=O[k-1];return O.join(",")},w=`g_${this.#n}_hcm_${t}_filter`,A=u.filter=this.#g(w);return this.#m(A),this.#p(S(v[0],b[0],5),S(v[1],b[1],5),S(v[2],b[2],5),A),u.url=this.#h(w),u.url}destroy(t=!1){t&&this.#s?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#e?.clear(),this.#e=null,this.#s?.clear(),this.#s=null,this.#r=0)}#f(t){const e=this.#a.createElementNS(Fi,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#m(t){const e=this.#a.createElementNS(Fi,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#g(t){const e=this.#a.createElementNS(Fi,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#u(t,e,n){const s=this.#a.createElementNS(Fi,e);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),t.append(s)}#p(t,e,n,s){const a=this.#a.createElementNS(Fi,"feComponentTransfer");s.append(a),this.#u(a,"feFuncR",t),this.#u(a,"feFuncG",e),this.#u(a,"feFuncB",n)}#y(t,e){const n=this.#a.createElementNS(Fi,"feComponentTransfer");e.append(n),this.#u(n,"feFuncA",t)}#b(t){return this.#l.style.color=t,Pa(getComputedStyle(this.#l).getPropertyValue("color"))}}class o_{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Zt("Abstract method `_fetch` called.")}}class Jb extends o_{async _fetch(t){const e=await ka(t,"arraybuffer");return new Uint8Array(e)}}class l_{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Zt("Abstract method `_fetch` called.")}}class t0 extends l_{async _fetch(t){const e=await ka(t,"arraybuffer");return new Uint8Array(e)}}rn&&Tt("Please use the `legacy` build in Node.js environments.");async function Pg(o){const e=await process.getBuiltinModule("fs").promises.readFile(o);return new Uint8Array(e)}class jC extends a_{}class IC extends s_{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class UC extends r_{async _fetch(t){return Pg(t)}}class FC extends o_{async _fetch(t){return Pg(t)}}class zC extends l_{async _fetch(t){return Pg(t)}}const aa="__forcedDependency",{floor:e0,ceil:n0}=Math;function tu(o,t,e,n,s,a){o[t*4+0]=Math.min(o[t*4+0],e),o[t*4+1]=Math.min(o[t*4+1],n),o[t*4+2]=Math.max(o[t*4+2],s),o[t*4+3]=Math.max(o[t*4+3],a)}const Yf=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class HC{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===Yf}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const eu=(o,t)=>{if(!o)return;let e=o.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},o.set(t,e)),e};class $C{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[aa]:[]};#i=new Map;#n=[];#a=[];#s=[[1,0,0,1,0,0]];#r=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#m;#g;#u;#p;constructor(t,e,n=!1){this.#f=t.width,this.#m=t.height,this.#y(e),n&&(this.#p=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,e){const n=new ArrayBuffer(t*4);this.#g=new Uint8ClampedArray(n),this.#u=new Uint32Array(n),e&&e.length>0?(this.#u.set(e),this.#u.fill(Yf,e.length)):this.#u.fill(Yf)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[aa]:{__proto__:this.#e[aa]}},this.#r={__proto__:this.#r},this.#n.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#r=Object.getPrototypeOf(this.#r);const n=this.#n.pop();return n!==void 0&&(eu(this.#p,t)?.dependencies.add(n),this.#u[t]=this.#u[n]),this}recordOpenMarker(t){return this.#n.push(t),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(t){const e=this.#n.pop();return e!==void 0&&(eu(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}beginMarkedContent(t){return this.#a.push(t),this}endMarkedContent(t){const e=this.#a.pop();return e!==void 0&&(eu(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}pushBaseTransform(t){return this.#s.push(ut.multiplyByDOMMatrix(this.#s.at(-1),t.getTransform())),this}popBaseTransform(){return this.#s.length>1&&this.#s.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#i.set(t,e),this}recordSimpleDataFromNamed(t,e,n){this.#t[t]=this.#i.get(e)??n}recordFutureForcedDependency(t,e){return this.recordIncrementalData(aa,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(aa,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,n,s,a,l){const u=ut.multiplyByDOMMatrix(this.#s.at(-1),e.getTransform()),d=[1/0,1/0,-1/0,-1/0];ut.axialAlignedBoundingBox([n,a,s,l],u,d);const f=ut.intersect(this.#r,d);return f?(this.#r[0]=f[0],this.#r[1]=f[1],this.#r[2]=f[2],this.#r[3]=f[3]):(this.#r[0]=this.#r[1]=1/0,this.#r[2]=this.#r[3]=-1/0),this}recordBBox(t,e,n,s,a,l){const u=this.#r;if(u[0]===1/0)return this;const d=ut.multiplyByDOMMatrix(this.#s.at(-1),e.getTransform());if(u[0]===-1/0)return ut.axialAlignedBoundingBox([n,a,s,l],d,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return ut.axialAlignedBoundingBox([n,a,s,l],d,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,e,n,s=1,a=0,l=0,u){const d=n.bbox;let f,g;if(d&&(f=d[2]!==d[0]&&d[3]!==d[1]&&this.#h.get(n),f!==!1&&(g=[0,0,0,0],ut.axialAlignedBoundingBox(d,n.fontMatrix,g),(s!==1||a!==0||l!==0)&&ut.scaleMinMax([s,0,0,-s,a,l],g),f)))return this.recordBBox(t,e,g[0],g[2],g[1],g[3]);if(!u)return this.recordFullPageBBox(t);const m=u();return d&&g&&f===void 0&&(f=g[0]<=a-m.actualBoundingBoxLeft&&g[2]>=a+m.actualBoundingBoxRight&&g[1]<=l-m.actualBoundingBoxAscent&&g[3]>=l+m.actualBoundingBoxDescent,this.#h.set(n,f),f)?this.recordBBox(t,e,g[0],g[2],g[1],g[3]):this.recordBBox(t,e,a-m.actualBoundingBoxLeft,a+m.actualBoundingBoxRight,l-m.actualBoundingBoxAscent,l+m.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#r[0]),this.#o[1]=Math.max(0,this.#r[1]),this.#o[2]=Math.min(this.#f,this.#r[2]),this.#o[3]=Math.min(this.#m,this.#r[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const n=this.#l,s=this.#t,a=this.#e;for(const l of e)l in this.#t?n.add(s[l]):l in a&&a[l].forEach(n.add,n);return this}recordNamedDependency(t,e){return this.#i.has(e)&&this.#l.add(this.#i.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[aa]),this.#p){const n=eu(this.#p,t),{dependencies:s}=n;this.#l.forEach(s.add,s),this.#n.forEach(s.add,s),this.#a.forEach(s.add,s),s.delete(t),n.isRenderingOperation=!0}if(this.#c===t){const n=e0(this.#o[0]*256/this.#f),s=e0(this.#o[1]*256/this.#m),a=n0(this.#o[2]*256/this.#f),l=n0(this.#o[3]*256/this.#m);tu(this.#g,t,n,s,a,l);for(const u of this.#l)u!==t&&tu(this.#g,u,n,s,a,l);for(const u of this.#n)u!==t&&tu(this.#g,u,n,s,a,l);for(const u of this.#a)u!==t&&tu(this.#g,u,n,s,a,l);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const n=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const s of n)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#r[0]=Math.max(this.#r[0],this.#o[0]),this.#r[1]=Math.max(this.#r[1],this.#o[1]),this.#r[2]=Math.min(this.#r[2],this.#o[2]),this.#r[3]=Math.min(this.#r[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#h.clear(),new HC(this.#u,this.#g)}takeDebugMetadata(){return this.#p}}class wu{#t;#e;#i;#n=0;#a=0;constructor(t,e,n){if(t instanceof wu&&t.#i===!!n)return t;this.#t=t,this.#e=e,this.#i=!!n}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#a++,this.#t.save(this.#e),this}restore(t){return this.#a>0&&(this.#t.restore(this.#e),this.#a--),this}recordOpenMarker(t){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#n--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,n){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#i||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,n,s,a,l){return this.#i||this.#t.recordClipBox(this.#e,e,n,s,a,l),this}recordBBox(t,e,n,s,a,l){return this.#i||this.#t.recordBBox(this.#e,e,n,s,a,l),this}recordCharacterBBox(t,e,n,s,a,l,u){return this.#i||this.#t.recordCharacterBBox(this.#e,e,n,s,a,l,u),this}recordFullPageBBox(t){return this.#i||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#i||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Hn={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Ge={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Wf(o,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,n),o.clip(s)}class Ng{isModifyingCurrentTransform(){return!1}getPattern(){Zt("Abstract method `getPattern` called.")}}class qC extends Ng{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)e.addColorStop(n[0],n[1]);return e}getPattern(t,e,n,s){let a;if(s===Ge.STROKE||s===Ge.FILL){const l=e.current.getClippedPathBoundingBox(s,ue(t))||[0,0,0,0],u=Math.ceil(l[2]-l[0])||1,d=Math.ceil(l[3]-l[1])||1,f=e.cachedCanvases.getCanvas("pattern",u,d),g=f.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-l[0],-l[1]),n=ut.transform(n,[1,0,0,1,l[0],l[1]]),g.transform(...e.baseTransform),this.matrix&&g.transform(...this.matrix),Wf(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),a=t.createPattern(f.canvas,"no-repeat");const m=new DOMMatrix(n);a.setTransform(m)}else Wf(t,this._bbox),a=this._createGradient(t);return a}}function bf(o,t,e,n,s,a,l,u){const d=t.coords,f=t.colors,g=o.data,m=o.width*4;let v;d[e+1]>d[n+1]&&(v=e,e=n,n=v,v=a,a=l,l=v),d[n+1]>d[s+1]&&(v=n,n=s,s=v,v=l,l=u,u=v),d[e+1]>d[n+1]&&(v=e,e=n,n=v,v=a,a=l,l=v);const b=(d[e]+t.offsetX)*t.scaleX,S=(d[e+1]+t.offsetY)*t.scaleY,w=(d[n]+t.offsetX)*t.scaleX,A=(d[n+1]+t.offsetY)*t.scaleY,_=(d[s]+t.offsetX)*t.scaleX,E=(d[s+1]+t.offsetY)*t.scaleY;if(S>=E)return;const x=f[a],O=f[a+1],C=f[a+2],D=f[l],R=f[l+1],k=f[l+2],L=f[u],V=f[u+1],q=f[u+2],it=Math.round(S),rt=Math.round(E);let st,ot,B,H,tt,lt,P,z;for(let Y=it;Y<=rt;Y++){if(Y<A){const ft=Y<S?0:(S-Y)/(S-A);st=b-(b-w)*ft,ot=x-(x-D)*ft,B=O-(O-R)*ft,H=C-(C-k)*ft}else{let ft;Y>E?ft=1:A===E?ft=0:ft=(A-Y)/(A-E),st=w-(w-_)*ft,ot=D-(D-L)*ft,B=R-(R-V)*ft,H=k-(k-q)*ft}let U;Y<S?U=0:Y>E?U=1:U=(S-Y)/(S-E),tt=b-(b-_)*U,lt=x-(x-L)*U,P=O-(O-V)*U,z=C-(C-q)*U;const et=Math.round(Math.min(st,tt)),nt=Math.round(Math.max(st,tt));let at=m*Y+et*4;for(let ft=et;ft<=nt;ft++)U=(st-ft)/(st-tt),U<0?U=0:U>1&&(U=1),g[at++]=ot-(ot-lt)*U|0,g[at++]=B-(B-P)*U|0,g[at++]=H-(H-z)*U|0,g[at++]=255}}function GC(o,t,e){const n=t.coords,s=t.colors;let a,l;switch(t.type){case"lattice":const u=t.verticesPerRow,d=Math.floor(n.length/u)-1,f=u-1;for(a=0;a<d;a++){let g=a*u;for(let m=0;m<f;m++,g++)bf(o,e,n[g],n[g+1],n[g+u],s[g],s[g+1],s[g+u]),bf(o,e,n[g+u+1],n[g+1],n[g+u],s[g+u+1],s[g+1],s[g+u])}break;case"triangles":for(a=0,l=n.length;a<l;a+=3)bf(o,e,n[a],n[a+1],n[a+2],s[a],s[a+1],s[a+2]);break;default:throw new Error("illegal figure")}}class VC extends Ng{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,n){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,g=Math.ceil(this._bounds[3])-d,m=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(g*t[1]*1.1)),3e3),b=f/m,S=g/v,w={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/b,scaleY:1/S},A=m+2*2,_=v+2*2,E=n.getCanvas("mesh",A,_),x=E.context,O=x.createImageData(m,v);if(e){const D=O.data;for(let R=0,k=D.length;R<k;R+=4)D[R]=e[0],D[R+1]=e[1],D[R+2]=e[2],D[R+3]=255}for(const D of this._figures)GC(O,D,w);return x.putImageData(O,2,2),{canvas:E.canvas,offsetX:u-2*b,offsetY:d-2*S,scaleX:b,scaleY:S}}isModifyingCurrentTransform(){return!0}getPattern(t,e,n,s){Wf(t,this._bbox);const a=new Float32Array(2);if(s===Ge.SHADING)ut.singularValueDecompose2dScale(ue(t),a);else if(this.matrix){ut.singularValueDecompose2dScale(this.matrix,a);const[u,d]=a;ut.singularValueDecompose2dScale(e.baseTransform,a),a[0]*=u,a[1]*=d}else ut.singularValueDecompose2dScale(e.baseTransform,a);const l=this._createMeshCanvas(a,s===Ge.SHADING?null:this._background,e.cachedCanvases);return s!==Ge.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class XC extends Ng{getPattern(){return"hotpink"}}function YC(o){switch(o[0]){case"RadialAxial":return new qC(o);case"Mesh":return new VC(o);case"Dummy":return new XC}throw new Error(`Unknown IR type: ${o[0]}`)}const i0={COLORED:1,UNCOLORED:2};class Lg{static MAX_PATTERN_SIZE=3e3;constructor(t,e,n,s){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(t,e){const{bbox:n,operatorList:s,paintType:a,tilingType:l,color:u,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:g}=this;f=Math.abs(f),g=Math.abs(g),Du("TilingType: "+l);const m=n[0],v=n[1],b=n[2],S=n[3],w=b-m,A=S-v,_=new Float32Array(2);ut.singularValueDecompose2dScale(this.matrix,_);const[E,x]=_;ut.singularValueDecompose2dScale(this.baseTransform,_);const O=E*_[0],C=x*_[1];let D=w,R=A,k=!1,L=!1;const V=Math.ceil(f*O),q=Math.ceil(g*C),it=Math.ceil(w*O),rt=Math.ceil(A*C);V>=it?D=f:k=!0,q>=rt?R=g:L=!0;const st=this.getSizeAndScale(D,this.ctx.canvas.width,O),ot=this.getSizeAndScale(R,this.ctx.canvas.height,C),B=t.cachedCanvases.getCanvas("pattern",st.size,ot.size),H=B.context,tt=d.createCanvasGraphics(H,e);if(tt.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(tt,a,u),H.translate(-st.scale*m,-ot.scale*v),tt.transform(0,st.scale,0,0,ot.scale,0,0),H.save(),tt.dependencyTracker?.save(),this.clipBbox(tt,m,v,b,S),tt.baseTransform=ue(tt.ctx),tt.executeOperatorList(s),tt.endDrawing(),tt.dependencyTracker?.restore(),H.restore(),k||L){const lt=B.canvas;k&&(D=f),L&&(R=g);const P=this.getSizeAndScale(D,this.ctx.canvas.width,O),z=this.getSizeAndScale(R,this.ctx.canvas.height,C),Y=P.size,U=z.size,et=t.cachedCanvases.getCanvas("pattern-workaround",Y,U),nt=et.context,at=k?Math.floor(w/f):0,ft=L?Math.floor(A/g):0;for(let vt=0;vt<=at;vt++)for(let It=0;It<=ft;It++)nt.drawImage(lt,Y*vt,U*It,Y,U,0,0,Y,U);return{canvas:et.canvas,scaleX:P.scale,scaleY:z.scale,offsetX:m,offsetY:v}}return{canvas:B.canvas,scaleX:st.scale,scaleY:ot.scale,offsetX:m,offsetY:v}}getSizeAndScale(t,e,n){const s=Math.max(Lg.MAX_PATTERN_SIZE,e);let a=Math.ceil(t*n);return a>=s?a=s:n=a/t,{scale:n,size:a}}clipBbox(t,e,n,s,a){const l=s-e,u=a-n;t.ctx.rect(e,n,l,u),ut.axialAlignedBoundingBox([e,n,s,a],ue(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const s=t.ctx,a=t.current;switch(e){case i0.COLORED:const{fillStyle:l,strokeStyle:u}=this.ctx;s.fillStyle=a.fillColor=l,s.strokeStyle=a.strokeColor=u;break;case i0.UNCOLORED:s.fillStyle=s.strokeStyle=n,a.fillColor=a.strokeColor=n;break;default:throw new pC(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,n,s,a){let l=n;s!==Ge.SHADING&&(l=ut.transform(l,e.baseTransform),this.matrix&&(l=ut.transform(l,this.matrix)));const u=this.createPatternCanvas(e,a);let d=new DOMMatrix(l);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(d),f}}function WC({src:o,srcPos:t=0,dest:e,width:n,height:s,nonBlackColor:a=4294967295,inverseDecode:l=!1}){const u=Ue.isLittleEndian?4278190080:255,[d,f]=l?[a,u]:[u,a],g=n>>3,m=n&7,v=o.length;e=new Uint32Array(e.buffer);let b=0;for(let S=0;S<s;S++){for(const A=t+g;t<A;t++){const _=t<v?o[t]:255;e[b++]=_&128?f:d,e[b++]=_&64?f:d,e[b++]=_&32?f:d,e[b++]=_&16?f:d,e[b++]=_&8?f:d,e[b++]=_&4?f:d,e[b++]=_&2?f:d,e[b++]=_&1?f:d}if(m===0)continue;const w=t<v?o[t++]:255;for(let A=0;A<m;A++)e[b++]=w&1<<7-A?f:d}return{srcPos:t,destPos:b}}const s0=16,r0=100,KC=15,a0=10,gn=16,wf=new DOMMatrix,Rn=new Float32Array(2),da=new Float32Array([1/0,1/0,-1/0,-1/0]);function QC(o,t){if(o._removeMirroring)throw new Error("Context is already forwarding operations.");o.__originalSave=o.save,o.__originalRestore=o.restore,o.__originalRotate=o.rotate,o.__originalScale=o.scale,o.__originalTranslate=o.translate,o.__originalTransform=o.transform,o.__originalSetTransform=o.setTransform,o.__originalResetTransform=o.resetTransform,o.__originalClip=o.clip,o.__originalMoveTo=o.moveTo,o.__originalLineTo=o.lineTo,o.__originalBezierCurveTo=o.bezierCurveTo,o.__originalRect=o.rect,o.__originalClosePath=o.closePath,o.__originalBeginPath=o.beginPath,o._removeMirroring=()=>{o.save=o.__originalSave,o.restore=o.__originalRestore,o.rotate=o.__originalRotate,o.scale=o.__originalScale,o.translate=o.__originalTranslate,o.transform=o.__originalTransform,o.setTransform=o.__originalSetTransform,o.resetTransform=o.__originalResetTransform,o.clip=o.__originalClip,o.moveTo=o.__originalMoveTo,o.lineTo=o.__originalLineTo,o.bezierCurveTo=o.__originalBezierCurveTo,o.rect=o.__originalRect,o.closePath=o.__originalClosePath,o.beginPath=o.__originalBeginPath,delete o._removeMirroring},o.save=function(){t.save(),this.__originalSave()},o.restore=function(){t.restore(),this.__originalRestore()},o.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},o.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},o.transform=function(e,n,s,a,l,u){t.transform(e,n,s,a,l,u),this.__originalTransform(e,n,s,a,l,u)},o.setTransform=function(e,n,s,a,l,u){t.setTransform(e,n,s,a,l,u),this.__originalSetTransform(e,n,s,a,l,u)},o.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},o.rotate=function(e){t.rotate(e),this.__originalRotate(e)},o.clip=function(e){t.clip(e),this.__originalClip(e)},o.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},o.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},o.bezierCurveTo=function(e,n,s,a,l,u){t.bezierCurveTo(e,n,s,a,l,u),this.__originalBezierCurveTo(e,n,s,a,l,u)},o.rect=function(e,n,s,a){t.rect(e,n,s,a),this.__originalRect(e,n,s,a)},o.closePath=function(){t.closePath(),this.__originalClosePath()},o.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class ZC{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let s;return this.cache[t]!==void 0?(s=this.cache[t],this.canvasFactory.reset(s,e,n)):(s=this.canvasFactory.create(e,n),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function nu(o,t,e,n,s,a,l,u,d,f){const[g,m,v,b,S,w]=ue(o);if(m===0&&v===0){const E=l*g+S,x=Math.round(E),O=u*b+w,C=Math.round(O),D=(l+d)*g+S,R=Math.abs(Math.round(D)-x)||1,k=(u+f)*b+w,L=Math.abs(Math.round(k)-C)||1;return o.setTransform(Math.sign(g),0,0,Math.sign(b),x,C),o.drawImage(t,e,n,s,a,0,0,R,L),o.setTransform(g,m,v,b,S,w),[R,L]}if(g===0&&b===0){const E=u*v+S,x=Math.round(E),O=l*m+w,C=Math.round(O),D=(u+f)*v+S,R=Math.abs(Math.round(D)-x)||1,k=(l+d)*m+w,L=Math.abs(Math.round(k)-C)||1;return o.setTransform(0,Math.sign(m),Math.sign(v),0,x,C),o.drawImage(t,e,n,s,a,0,0,L,R),o.setTransform(g,m,v,b,S,w),[L,R]}o.drawImage(t,e,n,s,a,l,u,d,f);const A=Math.hypot(g,m),_=Math.hypot(v,b);return[A*d,_*f]}class o0{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=qf;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=qe.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,n){n?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=da.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Ge.FILL,e=null){const n=this.minMax.slice();if(t===Ge.STROKE){e||Zt("Stroke bounding box must include transform."),ut.singularValueDecompose2dScale(e,Rn);const s=Rn[0]*this.lineWidth/2,a=Rn[1]*this.lineWidth/2;n[0]-=s,n[1]-=a,n[2]+=s,n[3]+=a}return n}updateClipFromPath(){const t=ut.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(da,0)}getClippedPathBoundingBox(t=Ge.FILL,e=null){return ut.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function l0(o,t){if(t instanceof ImageData){o.putImageData(t,0,0);return}const e=t.height,n=t.width,s=e%gn,a=(e-s)/gn,l=s===0?a:a+1,u=o.createImageData(n,gn);let d=0,f;const g=t.data,m=u.data;let v,b,S,w;if(t.kind===Jo.GRAYSCALE_1BPP){const A=g.byteLength,_=new Uint32Array(m.buffer,0,m.byteLength>>2),E=_.length,x=n+7>>3,O=4294967295,C=Ue.isLittleEndian?4278190080:255;for(v=0;v<l;v++){for(S=v<a?gn:s,f=0,b=0;b<S;b++){const D=A-d;let R=0;const k=D>x?n:D*8-7,L=k&-8;let V=0,q=0;for(;R<L;R+=8)q=g[d++],_[f++]=q&128?O:C,_[f++]=q&64?O:C,_[f++]=q&32?O:C,_[f++]=q&16?O:C,_[f++]=q&8?O:C,_[f++]=q&4?O:C,_[f++]=q&2?O:C,_[f++]=q&1?O:C;for(;R<k;R++)V===0&&(q=g[d++],V=128),_[f++]=q&V?O:C,V>>=1}for(;f<E;)_[f++]=0;o.putImageData(u,0,v*gn)}}else if(t.kind===Jo.RGBA_32BPP){for(b=0,w=n*gn*4,v=0;v<a;v++)m.set(g.subarray(d,d+w)),d+=w,o.putImageData(u,0,b),b+=gn;v<l&&(w=n*s*4,m.set(g.subarray(d,d+w)),o.putImageData(u,0,b))}else if(t.kind===Jo.RGB_24BPP)for(S=gn,w=n*S,v=0;v<l;v++){for(v>=a&&(S=s,w=n*S),f=0,b=w;b--;)m[f++]=g[d++],m[f++]=g[d++],m[f++]=g[d++],m[f++]=255;o.putImageData(u,0,v*gn)}else throw new Error(`bad image kind: ${t.kind}`)}function c0(o,t){if(t.bitmap){o.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,s=e%gn,a=(e-s)/gn,l=s===0?a:a+1,u=o.createImageData(n,gn);let d=0;const f=t.data,g=u.data;for(let m=0;m<l;m++){const v=m<a?gn:s;({srcPos:d}=WC({src:f,srcPos:d,dest:g,width:n,height:v,nonBlackColor:0})),o.putImageData(u,0,m*gn)}}function Io(o,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)o[n]!==void 0&&(t[n]=o[n]);o.setLineDash!==void 0&&(t.setLineDash(o.getLineDash()),t.lineDashOffset=o.lineDashOffset)}function iu(o){o.strokeStyle=o.fillStyle="#000000",o.fillRule="nonzero",o.globalAlpha=1,o.lineWidth=1,o.lineCap="butt",o.lineJoin="miter",o.miterLimit=10,o.globalCompositeOperation="source-over",o.font="10px sans-serif",o.setLineDash!==void 0&&(o.setLineDash([]),o.lineDashOffset=0);const{filter:t}=o;t!=="none"&&t!==""&&(o.filter="none")}function u0(o,t){if(t)return!0;ut.singularValueDecompose2dScale(o,Rn);const e=Math.fround(ii.pixelRatio*lr.PDF_TO_CSS_UNITS);return Rn[0]<=e&&Rn[1]<=e}const JC=["butt","round","square"],tR=["miter","round","bevel"],eR={},h0={};class ma{constructor(t,e,n,s,a,{optionalContentConfig:l,markedContentStack:u=null},d,f,g){this.ctx=t,this.current=new o0(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=s,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=l,this.cachedCanvases=new ZC(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=g??null}getObject(t,e,n=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):n}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:s=null}){const a=this.ctx.canvas.width,l=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,a,l),this.ctx.fillStyle=u,n){const d=this.cachedCanvases.getCanvas("transparent",a,l);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...ue(this.compositeCtx))}this.ctx.save(),iu(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ue(this.ctx)}executeOperatorList(t,e,n,s,a){const l=t.argsArray,u=t.fnArray;let d=e||0;const f=l.length;if(f===d)return d;const g=f-d>a0&&typeof n=="function",m=g?Date.now()+KC:0;let v=0;const b=this.commonObjs,S=this.objs;let w,A;for(;;){if(s!==void 0&&d===s.nextBreakPoint)return s.breakIt(d,n),d;if(!a||a(d))if(w=u[d],A=l[d]??null,w!==Ea.dependency)A===null?this[w](d):this[w](d,...A);else for(const _ of A){this.dependencyTracker?.recordNamedData(_,d);const E=_.startsWith("g_")?b:S;if(!E.has(_))return E.get(_,n),d}if(d++,d===f)return d;if(g&&++v>a0){if(Date.now()>m)return n(),d;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const n=t.width??t.displayWidth,s=t.height??t.displayHeight;let a=Math.max(Math.hypot(e[0],e[1]),1),l=Math.max(Math.hypot(e[2],e[3]),1),u=n,d=s,f="prescale1",g,m;for(;a>2&&u>1||l>2&&d>1;){let v=u,b=d;a>2&&u>1&&(v=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),a/=u/v),l>2&&d>1&&(b=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,l/=d/b),g=this.cachedCanvases.getCanvas(f,v,b),m=g.context,m.clearRect(0,0,v,b),m.drawImage(t,0,0,u,d,0,0,v,b),t=g.canvas,u=v,d=b,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:d}}_createMaskCanvas(t,e){const n=this.ctx,{width:s,height:a}=e,l=this.current.fillColor,u=this.current.patternFill,d=ue(n);let f,g,m,v;if((e.bitmap||e.data)&&e.count>1){const V=e.bitmap||e.data.buffer;g=JSON.stringify(u?d:[d.slice(0,4),l]),f=this._cachedBitmapsMap.get(V),f||(f=new Map,this._cachedBitmapsMap.set(V,f));const q=f.get(g);if(q&&!u){const it=Math.round(Math.min(d[0],d[2])+d[4]),rt=Math.round(Math.min(d[1],d[3])+d[5]);return this.dependencyTracker?.recordDependencies(t,Hn.transformAndFill),{canvas:q,offsetX:it,offsetY:rt}}m=q}m||(v=this.cachedCanvases.getCanvas("maskCanvas",s,a),c0(v.context,e));let b=ut.transform(d,[1/s,0,0,-1/a,0,0]);b=ut.transform(b,[1,0,0,1,0,-a]);const S=da.slice();ut.axialAlignedBoundingBox([0,0,s,a],b,S);const[w,A,_,E]=S,x=Math.round(_-w)||1,O=Math.round(E-A)||1,C=this.cachedCanvases.getCanvas("fillCanvas",x,O),D=C.context,R=w,k=A;D.translate(-R,-k),D.transform(...b),m||(m=this._scaleImage(v.canvas,mi(D)),m=m.img,f&&u&&f.set(g,m)),D.imageSmoothingEnabled=u0(ue(D),e.interpolate),nu(D,m,0,0,m.width,m.height,0,0,s,a),D.globalCompositeOperation="source-in";const L=ut.transform(mi(D),[1,0,0,1,-R,-k]);return D.fillStyle=u?l.getPattern(n,this,L,Ge.FILL,t):l,D.fillRect(0,0,s,a),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(g,C.canvas)),this.dependencyTracker?.recordDependencies(t,Hn.transformAndFill),{canvas:C.canvas,offsetX:Math.round(R),offsetY:Math.round(k)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=JC[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=tR[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,n){this.dependencyTracker?.recordSimpleData("dash",t);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=n)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[n,s]of e)switch(n){case"LW":this.setLineWidth(t,s);break;case"LC":this.setLineCap(t,s);break;case"LJ":this.setLineJoin(t,s);break;case"ML":this.setMiterLimit(t,s);break;case"D":this.setDash(t,s[0],s[1]);break;case"RI":this.setRenderingIntent(t,s);break;case"FL":this.setFlatness(t,s);break;case"Font":this.setFont(t,s[0],s[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=s;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=s;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,n=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(s,e,n);this.suspendedCtx=this.ctx;const l=this.ctx=a.context;l.setTransform(this.suspendedCtx.getTransform()),Io(this.suspendedCtx,l),QC(l,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Io(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,s){const a=s[0],l=s[1],u=s[2]-a,d=s[3]-l;u===0||d===0||(this.genericComposeSMask(e.context,n,u,d,e.subtype,e.backdrop,e.transferMap,a,l,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,s,a,l,u,d,f,g,m){let v=t.canvas,b=d-g,S=f-m;if(l)if(b<0||S<0||b+n>v.width||S+s>v.height){const A=this.cachedCanvases.getCanvas("maskExtension",n,s),_=A.context;_.drawImage(v,-b,-S),_.globalCompositeOperation="destination-atop",_.fillStyle=l,_.fillRect(0,0,n,s),_.globalCompositeOperation="source-over",v=A.canvas,b=S=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const A=new Path2D;A.rect(b,S,n,s),t.clip(A),t.globalCompositeOperation="destination-atop",t.fillStyle=l,t.fillRect(b,S,n,s),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),a==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):a==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const w=new Path2D;w.rect(d,f,n,s),e.clip(w),e.globalCompositeOperation="destination-in",e.drawImage(v,b,S,n,s,d,f,n,s),e.restore()}save(t){this.inSMaskMode&&Io(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Io(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,n,s,a,l,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,n,s,a,l,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n,s){let[a]=n;if(!s){a||=n[0]=new Path2D,this[e](t,a);return}if(this.dependencyTracker!==null){const l=e===Ea.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,s[0]-l,s[2]+l,s[1]-l,s[3]+l).recordDependencies(t,["transform"])}if(!(a instanceof Path2D)){const l=n[0]=new Path2D;for(let u=0,d=a.length;u<d;)switch(a[u++]){case Kc.moveTo:l.moveTo(a[u++],a[u++]);break;case Kc.lineTo:l.lineTo(a[u++],a[u++]);break;case Kc.curveTo:l.bezierCurveTo(a[u++],a[u++],a[u++],a[u++],a[u++],a[u++]);break;case Kc.closePath:l.closePath();break;default:Tt(`Unrecognized drawing path operator: ${a[u-1]}`);break}a=l}ut.axialAlignedBoundingBox(s,ue(this.ctx),this.current.minMax),this[e](t,a),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,n=!0){const s=this.ctx,a=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&a?.getPattern){const l=a.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=a.getPattern(s,this,mi(s),Ge.STROKE,t),l){const u=new Path2D;u.addPath(e,s.getTransform().invertSelf().multiplySelf(l)),e=u}this.rescaleAndStroke(e,!1),s.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,Hn.stroke),n&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(Ge.STROKE,ue(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,n=!0){const s=this.ctx,a=this.current.fillColor,l=this.current.patternFill;let u=!1;if(l){const f=a.isModifyingCurrentTransform()?s.getTransform():null;if(this.dependencyTracker?.save(t),s.save(),s.fillStyle=a.getPattern(s,this,mi(s),Ge.FILL,t),f){const g=new Path2D;g.addPath(e,s.getTransform().invertSelf().multiplySelf(f)),e=g}u=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(s.fill(e,"evenodd"),this.pendingEOFill=!1):s.fill(e)),this.dependencyTracker?.recordDependencies(t,Hn.fill),u&&(s.restore(),this.dependencyTracker?.restore(t)),n&&this.consumePath(t,e,d)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,Hn.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=eR}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=h0}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;e!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",t),s.recordCloseMarker(t)}if(e!==void 0){const s=new Path2D,a=n.getTransform().invertSelf();for(const{transform:l,x:u,y:d,fontSize:f,path:g}of e)g&&s.addPath(g,new DOMMatrix(l).preMultiplySelf(a).translate(u,d).scale(f,-f));n.clip(s)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,n){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const s=this.commonObjs.get(e),a=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(a.fontMatrix=s.fontMatrix||qf,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&Tt("Invalid font matrix for font "+e),n<0?(n=-n,a.fontDirection=-1):a.fontDirection=1,this.current.font=s,this.current.fontSize=n,s.isType3Font)return;const l=s.loadedName||"sans-serif",u=s.systemFontInfo?.css||`"${l}", ${s.fallbackName}`;let d="normal";s.black?d="900":s.bold&&(d="bold");const f=s.italic?"italic":"normal";let g=n;n<s0?g=s0:n>r0&&(g=r0),this.current.fontSizeScale=n/g,this.ctx.font=`${f} ${d} ${g}px ${u}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=n}setLeadingMoveText(t,e,n){this.setLeading(t,-n),this.moveText(t,e,n)}setTextMatrix(t,e){this.dependencyTracker?.recordSimpleData("textMatrix",t);const{current:n}=this;n.textMatrix=e,n.textMatrixScale=Math.hypot(e[0],e[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#i(t,e,n){const s=new Path2D;return s.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),s}paintChar(t,e,n,s,a,l){const u=this.ctx,d=this.current,f=d.font,g=d.textRenderingMode,m=d.fontSize/d.fontSizeScale,v=g&qe.FILL_STROKE_MASK,b=!!(g&qe.ADD_TO_PATH_FLAG),S=d.patternFill&&!f.missingFile,w=d.patternStroke&&!f.missingFile;let A;if((f.disableFontFace||b||S||w)&&!f.missingFile&&(A=f.getPathGenerator(this.commonObjs,e)),A&&(f.disableFontFace||S||w)){u.save(),u.translate(n,s),u.scale(m,-m),this.dependencyTracker?.recordCharacterBBox(t,u,f);let _;if(v===qe.FILL||v===qe.FILL_STROKE)if(a){_=u.getTransform(),u.setTransform(...a);const E=this.#i(A,_,a);u.fill(E)}else u.fill(A);if(v===qe.STROKE||v===qe.FILL_STROKE)if(l){_||=u.getTransform(),u.setTransform(...l);const{a:E,b:x,c:O,d:C}=_,D=ut.inverseTransform(l),R=ut.transform([E,x,O,C,0,0],D);ut.singularValueDecompose2dScale(R,Rn),u.lineWidth*=Math.max(Rn[0],Rn[1])/m,u.stroke(this.#i(A,_,l))}else u.lineWidth/=m,u.stroke(A);u.restore()}else(v===qe.FILL||v===qe.FILL_STROKE)&&(u.fillText(e,n,s),this.dependencyTracker?.recordCharacterBBox(t,u,f,m,n,s,()=>u.measureText(e))),(v===qe.STROKE||v===qe.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,m,n,s,()=>u.measureText(e)).recordDependencies(t,Hn.stroke),u.strokeText(e,n,s));b&&((this.pendingTextPaths||=[]).push({transform:ue(u),x:n,y:s,fontSize:m,path:A}),this.dependencyTracker?.recordCharacterBBox(t,u,f,m,n,s))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){n=!0;break}return Ct(this,"isFontSubpixelAAEnabled",n)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Hn.showText).resetBBox(t),this.current.textRenderingMode&qe.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,s=n.font;if(s.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const a=n.fontSize;if(a===0){this.dependencyTracker?.recordOperation(t);return}const l=this.ctx,u=n.fontSizeScale,d=n.charSpacing,f=n.wordSpacing,g=n.fontDirection,m=n.textHScale*g,v=e.length,b=s.vertical,S=b?1:-1,w=s.defaultVMetrics,A=a*n.fontMatrix[0],_=n.textRenderingMode===qe.FILL&&!s.disableFontFace&&!n.patternFill;l.save(),n.textMatrix&&l.transform(...n.textMatrix),l.translate(n.x,n.y+n.textRise),g>0?l.scale(m,-1):l.scale(m,1);let E,x;if(n.patternFill){l.save();const k=n.fillColor.getPattern(l,this,mi(l),Ge.FILL,t);E=ue(l),l.restore(),l.fillStyle=k}if(n.patternStroke){l.save();const k=n.strokeColor.getPattern(l,this,mi(l),Ge.STROKE,t);x=ue(l),l.restore(),l.strokeStyle=k}let O=n.lineWidth;const C=n.textMatrixScale;if(C===0||O===0){const k=n.textRenderingMode&qe.FILL_STROKE_MASK;(k===qe.STROKE||k===qe.FILL_STROKE)&&(O=this.getSinglePixelWidth())}else O/=C;if(u!==1&&(l.scale(u,u),O/=u),l.lineWidth=O,s.isInvalidPDFjsFont){const k=[];let L=0;for(const q of e)k.push(q.unicode),L+=q.width;const V=k.join("");if(l.fillText(V,0,0),this.dependencyTracker!==null){const q=l.measureText(V);this.dependencyTracker.recordBBox(t,this.ctx,-q.actualBoundingBoxLeft,q.actualBoundingBoxRight,-q.actualBoundingBoxAscent,q.actualBoundingBoxDescent).recordShowTextOperation(t)}n.x+=L*A*m,l.restore(),this.compose();return}let D=0,R;for(R=0;R<v;++R){const k=e[R];if(typeof k=="number"){D+=S*k*a/1e3;continue}let L=!1;const V=(k.isSpace?f:0)+d,q=k.fontChar,it=k.accent;let rt,st,ot=k.width;if(b){const tt=k.vmetric||w,lt=-(k.vmetric?tt[1]:ot*.5)*A,P=tt[2]*A;ot=tt?-tt[0]:ot,rt=lt/u,st=(D+P)/u}else rt=D/u,st=0;let B;if(s.remeasure&&ot>0){B=l.measureText(q);const tt=B.width*1e3/a*u;if(ot<tt&&this.isFontSubpixelAAEnabled){const lt=ot/tt;L=!0,l.save(),l.scale(lt,1),rt/=lt}else ot!==tt&&(rt+=(ot-tt)/2e3*a/u)}if(this.contentVisible&&(k.isInFont||s.missingFile)){if(_&&!it)l.fillText(q,rt,st),this.dependencyTracker?.recordCharacterBBox(t,l,B?{bbox:null}:s,a/u,rt,st,()=>B??l.measureText(q));else if(this.paintChar(t,q,rt,st,E,x),it){const tt=rt+a*it.offset.x/u,lt=st-a*it.offset.y/u;this.paintChar(t,it.fontChar,tt,lt,E,x)}}const H=b?ot*A-V*g:ot*A+V*g;D+=H,L&&l.restore()}b?n.y-=D:n.x+=D*m,l.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const n=this.ctx,s=this.current,a=s.font,l=s.fontSize,u=s.fontDirection,d=a.vertical?1:-1,f=s.charSpacing,g=s.wordSpacing,m=s.textHScale*u,v=s.fontMatrix||qf,b=e.length,S=s.textRenderingMode===qe.INVISIBLE;let w,A,_,E;if(S||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),s.textMatrix&&n.transform(...s.textMatrix),n.translate(s.x,s.y+s.textRise),n.scale(m,u);const x=this.dependencyTracker;for(this.dependencyTracker=x?new wu(x,t):null,w=0;w<b;++w){if(A=e[w],typeof A=="number"){E=d*A*l/1e3,this.ctx.translate(E,0),s.x+=E*m;continue}const O=(A.isSpace?g:0)+f,C=a.charProcOperatorList[A.operatorListId];C?this.contentVisible&&(this.save(),n.scale(l,l),n.transform(...v),this.executeOperatorList(C),this.restore()):Tt(`Type3 character "${A.operatorListId}" is not available.`);const D=[A.width,0];ut.applyTransform(D,v),_=D[0]*l+O,n.translate(_,0),s.x+=_*m}n.restore(),x&&(this.dependencyTracker=x)}setCharWidth(t,e,n){}setCharWidthAndBounds(t,e,n,s,a,l,u){const d=new Path2D;d.rect(s,a,l-s,u-a),this.ctx.clip(d),this.dependencyTracker?.recordBBox(t,this.ctx,s,l,a,u).recordClipBox(t,this.ctx,s,l,a,u),this.endPath(t)}getColorN_Pattern(t,e){let n;if(e[0]==="TilingPattern"){const s=this.baseTransform||ue(this.ctx),a={createCanvasGraphics:(l,u)=>new ma(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new wu(this.dependencyTracker,u,!0):null)};n=new Lg(e,this.ctx,a,s)}else n=this._getPattern(t,e[1],e[2]);return n}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,n=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=YC(this.getObject(t,e)),this.cachedPatterns.set(e,s)),n&&(s.matrix=n),s}shadingFill(t,e){if(!this.contentVisible)return;const n=this.ctx;this.save(t);const s=this._getPattern(t,e);n.fillStyle=s.getPattern(n,this,mi(n),Ge.SHADING,t);const a=mi(n);if(a){const{width:l,height:u}=n.canvas,d=da.slice();ut.axialAlignedBoundingBox([0,0,l,u],a,d);const[f,g,m,v]=d;this.ctx.fillRect(f,g,m-f,v-g)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Hn.transform).recordDependencies(t,Hn.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Zt("Should not call beginInlineImage")}beginImageData(){Zt("Should not call beginImageData")}paintFormXObjectBegin(t,e,n){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=ue(this.ctx),n)){ut.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[s,a,l,u]=n,d=new Path2D;d.rect(s,a,l-s,u-a),this.ctx.clip(d),this.dependencyTracker?.recordClipBox(t,this.ctx,s,l,a,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;e.isolated||Du("TODO: Support non-isolated groups."),e.knockout&&Tt("Knockout groups not supported.");const s=ue(n);if(e.matrix&&n.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let a=da.slice();ut.axialAlignedBoundingBox(e.bbox,ue(n),a);const l=[0,0,n.canvas.width,n.canvas.height];a=ut.intersect(a,l)||[0,0,0,0];const u=Math.floor(a[0]),d=Math.floor(a[1]),f=Math.max(Math.ceil(a[2])-u,1),g=Math.max(Math.ceil(a[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,g]);let m="groupAt"+this.groupLevel;e.smask&&(m+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(m,f,g),b=v.context;b.translate(-u,-d),b.transform(...s);let S=new Path2D;const[w,A,_,E]=e.bbox;if(S.rect(w,A,_-w,E-A),e.matrix){const x=new Path2D;x.addPath(S,new DOMMatrix(e.matrix)),S=x}b.clip(S),e.smask&&this.smaskStack.push({canvas:v.canvas,context:b,offsetX:u,offsetY:d,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(u,d),n.save()),Io(n,b),this.ctx=b,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=ue(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...a);const l=da.slice();ut.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],a,l),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,e,n,s,a,l){if(this.#t(),iu(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const u=n[2]-n[0],d=n[3]-n[1];if(l&&this.annotationCanvasMap){s=s.slice(),s[4]-=n[0],s[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=u,n[3]=d,ut.singularValueDecompose2dScale(ue(this.ctx),Rn);const{viewportScale:f}=this,g=Math.ceil(u*this.outputScaleX*f),m=Math.ceil(d*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(g,m);const{canvas:v,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(e,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(Rn[0],0,0,-Rn[1],0,d*Rn[1]),iu(this.ctx)}else{iu(this.ctx),this.endPath(t);const f=new Path2D;f.rect(n[0],n[1],u,d),this.ctx.clip(f)}}this.current=new o0(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...s),this.transform(t,...a)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const n=e.count;e=this.getObject(t,e.data,e),e.count=n;const s=this.ctx,a=this._createMaskCanvas(t,e),l=a.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(l,a.offsetX,a.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,a.offsetX,a.offsetX+l.width,a.offsetY,a.offsetY+l.height).recordOperation(t),s.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n,s=0,a=0,l,u){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const d=this.ctx;d.save();const f=ue(d);d.transform(n,s,a,l,0,0);const g=this._createMaskCanvas(t,e);d.setTransform(1,0,0,1,g.offsetX-f[4],g.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let m=0,v=u.length;m<v;m+=2){const b=ut.transform(f,[n,s,a,l,u[m],u[m+1]]);d.drawImage(g.canvas,b[4],b[5]),this.dependencyTracker?.recordBBox(t,this.ctx,b[4],b[4]+g.canvas.width,b[5],b[5]+g.canvas.height)}d.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx,s=this.current.fillColor,a=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Hn.transformAndFill);for(const l of e){const{data:u,width:d,height:f,transform:g}=l,m=this.cachedCanvases.getCanvas("maskCanvas",d,f),v=m.context;v.save();const b=this.getObject(t,u,l);c0(v,b),v.globalCompositeOperation="source-in",v.fillStyle=a?s.getPattern(v,this,mi(n),Ge.FILL,t):s,v.fillRect(0,0,d,f),v.restore(),n.save(),n.transform(...g),n.scale(1,-1),nu(n,m.canvas,0,0,d,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,n,0,d,0,f),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const n=this.getObject(t,e);if(!n){Tt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,n)}paintImageXObjectRepeat(t,e,n,s,a){if(!this.contentVisible)return;const l=this.getObject(t,e);if(!l){Tt("Dependent image isn't ready yet");return}const u=l.width,d=l.height,f=[];for(let g=0,m=a.length;g<m;g+=2)f.push({transform:[n,0,0,s,a[g],a[g+1]],x:0,y:0,w:u,h:d});this.paintInlineImageXObjectGroup(t,l,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:s}=t,a=this.cachedCanvases.getCanvas("inlineImage",n,s),l=a.context;return l.filter=this.current.transferMaps,l.drawImage(e,0,0),l.filter="none",a.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const n=e.width,s=e.height,a=this.ctx;this.save(t);const{filter:l}=a;l!=="none"&&l!==""&&(a.filter="none"),a.scale(1/n,-1/s);let u;if(e.bitmap)u=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)u=e;else{const g=this.cachedCanvases.getCanvas("inlineImage",n,s).context;l0(g,e),u=this.applyTransferMapsToCanvas(g)}const d=this._scaleImage(u,mi(a));a.imageSmoothingEnabled=u0(ue(a),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,a,0,n,-s,0).recordDependencies(t,Hn.imageXObject).recordOperation(t),nu(a,d.img,0,0,d.paintWidth,d.paintHeight,0,-s,n,s),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,n){if(!this.contentVisible)return;const s=this.ctx;let a;if(e.bitmap)a=e.bitmap;else{const l=e.width,u=e.height,f=this.cachedCanvases.getCanvas("inlineImage",l,u).context;l0(f,e),a=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const l of n)s.save(),s.transform(...l.transform),s.scale(1,-1),nu(s,a,l.x,l.y,l.w,l.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,1,-1,0),s.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Hn.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,n){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,n){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,n){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const a=this.ctx;this.pendingClip?(s||(this.pendingClip===h0?a.clip(e,"evenodd"):a.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ue(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:s,d:a}=this.ctx.getTransform();let l,u;if(n===0&&s===0){const d=Math.abs(e),f=Math.abs(a);if(d===f)if(t===0)l=u=1/d;else{const g=d*t;l=u=g<1?1/g:1}else if(t===0)l=1/d,u=1/f;else{const g=d*t,m=f*t;l=g<1?1/g:1,u=m<1?1/m:1}}else{const d=Math.abs(e*a-n*s),f=Math.hypot(e,n),g=Math.hypot(s,a);if(t===0)l=g/d,u=f/d;else{const m=t*d;l=g>m?g/m:1,u=f>m?f/m:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:n,current:{lineWidth:s}}=this,[a,l]=this.getScaleForStroking();if(a===l){n.lineWidth=(s||1)*a,n.stroke(t);return}const u=n.getLineDash();e&&n.save(),n.scale(a,l),wf.a=1/a,wf.d=1/l;const d=new Path2D;if(d.addPath(t,wf),u.length>0){const f=Math.max(a,l);n.setLineDash(u.map(g=>g/f)),n.lineDashOffset/=f}n.lineWidth=s||1,n.stroke(d),e&&n.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const o in Ea)ma.prototype[o]!==void 0&&(ma.prototype[Ea[o]]=ma.prototype[o]);class ya{#t;#e;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,n={};let s=0;for(const f of ya.strings){const g=e.encode(t[f]);n[f]=g,s+=4+g.length}const a=new ArrayBuffer(s),l=new Uint8Array(a),u=new DataView(a);let d=0;for(const f of ya.strings){const g=n[f],m=g.length;u.setUint32(d,m),l.set(g,d+4),d+=4+m}return Lt(d===a.byteLength,"CssFontInfo.write: Buffer overflow"),a}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}#n(t){Lt(t<ya.strings.length,"Invalid string index");let e=0;for(let s=0;s<t;s++)e+=this.#e.getUint32(e)+4;const n=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,n))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class va{#t;#e;#i;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,n={};let s=0;for(const v of va.strings){const b=e.encode(t[v]);n[v]=b,s+=4+b.length}s+=4;let a,l,u=1+s;t.style&&(a=e.encode(t.style.style),l=e.encode(t.style.weight),u+=4+a.length+4+l.length);const d=new ArrayBuffer(u),f=new Uint8Array(d),g=new DataView(d);let m=0;g.setUint8(m++,t.guessFallback?1:0),g.setUint32(m,0),m+=4,s=0;for(const v of va.strings){const b=n[v],S=b.length;s+=4+S,g.setUint32(m,S),f.set(b,m+4),m+=4+S}return g.setUint32(m-s-4,s),t.style&&(g.setUint32(m,a.length),f.set(a,m+4),m+=4+a.length,g.setUint32(m,l.length),f.set(l,m+4),m+=4+l.length),Lt(m<=d.byteLength,"SubstitionInfo.write: Buffer overflow"),d.transferToFixedLength(m)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#n(t){Lt(t<va.strings.length,"Invalid string index");let e=5;for(let s=0;s<t;s++)e+=this.#e.getUint32(e)+4;const n=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,n))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),n=this.#i.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const s=this.#e.getUint32(t),a=this.#i.decode(new Uint8Array(this.#t,t+4,s));return{style:n,weight:a}}}class Xt{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#i=this.#e+1+2*4;static#n=this.#i+1+8*6;static#a=this.#n+1+2*3;#s;#r;#o;constructor({data:t,extra:e}){this.#s=t,this.#r=new TextDecoder,this.#o=new DataView(this.#s),e&&Object.assign(this,e)}#c(t){Lt(t<Xt.bools.length,"Invalid boolean index");const e=Math.floor(t/4),n=t*2%8,s=this.#o.getUint8(e)>>n&3;return s===0?void 0:s===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Lt(t<Xt.numbers.length,"Invalid number index"),this.#o.getFloat64(Xt.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=Xt.#e;if(this.#o.getUint8(t)===0)return;t+=1;const n=[];for(let s=0;s<4;s++)n.push(this.#o.getInt16(t,!0)),t+=2;return n}get fontMatrix(){let t=Xt.#i;if(this.#o.getUint8(t)===0)return;t+=1;const n=[];for(let s=0;s<6;s++)n.push(this.#o.getFloat64(t,!0)),t+=8;return n}get defaultVMetrics(){let t=Xt.#n;if(this.#o.getUint8(t)===0)return;t+=1;const n=[];for(let s=0;s<3;s++)n.push(this.#o.getInt16(t,!0)),t+=2;return n}#d(t){Lt(t<Xt.strings.length,"Invalid string index");let e=Xt.#a+4;for(let a=0;a<t;a++)e+=this.#o.getUint32(e)+4;const n=this.#o.getUint32(e),s=new Uint8Array(n);return s.set(new Uint8Array(this.#s,e+4,n)),this.#r.decode(s)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Xt.#a;const e=this.#o.getUint32(t);t+=4+e;const n=this.#o.getUint32(t);t+=4+n;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);if(a!==0)return new Uint8Array(this.#s,t+4,a)}clearData(){let t=Xt.#a;const e=this.#o.getUint32(t);t+=4+e;const n=this.#o.getUint32(t);t+=4+n;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);new Uint8Array(this.#s,t+4,a).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=Xt.#a;const e=this.#o.getUint32(t);t+=4+e;const n=this.#o.getUint32(t);t+=4+n;const s=this.#o.getUint32(t);if(s===0)return null;const a=new Uint8Array(s);return a.set(new Uint8Array(this.#s,t+4,s)),new ya(a.buffer)}get systemFontInfo(){let t=Xt.#a;const e=this.#o.getUint32(t);t+=4+e;const n=this.#o.getUint32(t);if(n===0)return null;const s=new Uint8Array(n);return s.set(new Uint8Array(this.#s,t+4,n)),new va(s.buffer)}static write(t){const e=t.systemFontInfo?va.write(t.systemFontInfo):null,n=t.cssFontInfo?ya.write(t.cssFontInfo):null,s=new TextEncoder,a={};let l=0;for(const w of Xt.strings)a[w]=s.encode(t[w]),l+=4+a[w].length;const u=Xt.#a+4+l+4+(e?e.byteLength:0)+4+(n?n.byteLength:0)+4+(t.data?t.data.length:0),d=new ArrayBuffer(u),f=new Uint8Array(d),g=new DataView(d);let m=0;const v=Xt.bools.length;let b=0,S=0;for(let w=0;w<v;w++){const A=t[Xt.bools[w]];b|=(A===void 0?0:A?2:1)<<S,S+=2,(S===8||w===v-1)&&(g.setUint8(m++,b),b=0,S=0)}Lt(m===Xt.#t,"FontInfo.write: Boolean properties offset mismatch");for(const w of Xt.numbers)g.setFloat64(m,t[w]),m+=8;if(Lt(m===Xt.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){g.setUint8(m++,4);for(const w of t.bbox)g.setInt16(m,w,!0),m+=2}else g.setUint8(m++,0),m+=2*4;if(Lt(m===Xt.#i,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){g.setUint8(m++,6);for(const w of t.fontMatrix)g.setFloat64(m,w,!0),m+=8}else g.setUint8(m++,0),m+=8*6;if(Lt(m===Xt.#n,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){g.setUint8(m++,1);for(const w of t.defaultVMetrics)g.setInt16(m,w,!0),m+=2}else g.setUint8(m++,0),m+=3*2;Lt(m===Xt.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),g.setUint32(Xt.#a,0),m+=4;for(const w of Xt.strings){const A=a[w],_=A.length;g.setUint32(m,_),f.set(A,m+4),m+=4+_}if(g.setUint32(Xt.#a,m-Xt.#a-4),!e)g.setUint32(m,0),m+=4;else{const w=e.byteLength;g.setUint32(m,w),Lt(m+4+w<=d.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(e),m+4),m+=4+w}if(!n)g.setUint32(m,0),m+=4;else{const w=n.byteLength;g.setUint32(m,w),Lt(m+4+w<=d.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(n),m+4),m+=4+w}return t.data===void 0?(g.setUint32(m,0),m+=4):(g.setUint32(m,t.data.length),f.set(t.data,m+4),m+=4+t.data.length),Lt(m<=d.byteLength,"FontInfo.write: Buffer overflow"),d.transferToFixedLength(m)}}class Es{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class nR{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const ha=Symbol("INTERNAL");class iR{#t=!1;#e=!1;#i=!1;#n=!0;constructor(t,{name:e,intent:n,usage:s,rbGroups:a}){this.#t=!!(t&xn.DISPLAY),this.#e=!!(t&xn.PRINT),this.name=e,this.intent=n,this.usage=s,this.rbGroups=a}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,n=!1){t!==ha&&Zt("Internal method `_setVisible` called."),this.#i=n,this.#n=e}}class sR{#t=null;#e=new Map;#i=null;#n=null;constructor(t,e=xn.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#n=t.order;for(const n of t.groups)this.#e.set(n.id,new iR(e,n));if(t.baseState==="OFF")for(const n of this.#e.values())n._setVisible(ha,!1);for(const n of t.on)this.#e.get(n)._setVisible(ha,!0);for(const n of t.off)this.#e.get(n)._setVisible(ha,!1);this.#i=this.getHash()}}#a(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let s=1;s<e;s++){const a=t[s];let l;if(Array.isArray(a))l=this.#a(a);else if(this.#e.has(a))l=this.#e.get(a).visible;else return Tt(`Optional content group not found: ${a}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Du("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(Tt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return Tt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return Tt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return Tt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return Tt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return Tt(`Unknown optional content policy ${t.policy}.`),!0}return Tt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){const s=this.#e.get(t);if(!s){Tt(`Optional content group not found: ${t}`);return}if(n&&e&&s.rbGroups.length)for(const a of s.rbGroups)for(const l of a)l!==t&&this.#e.get(l)?._setVisible(ha,!1,!0);s._setVisible(ha,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let n;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const a=this.#e.get(s);if(a)switch(n){case"ON":this.setVisibility(s,!0,e);break;case"OFF":this.setVisibility(s,!1,e);break;case"Toggle":this.setVisibility(s,!a.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new e_;for(const[e,n]of this.#e)t.update(`${e}:${n.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class rR{constructor(t,{disableRange:e=!1,disableStream:n=!1}){Lt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:a,progressiveDone:l,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=u,a?.length>0){const d=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(d)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((d,f)=>{this._onReceiveData({begin:d,chunk:f})}),t.addProgressListener((d,f)=>{this._onProgress({loaded:d,total:f})}),t.addProgressiveReadListener(d=>{this._onReceiveData({chunk:d})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(a){return a._begin!==t?!1:(a._enqueue(n),!0)});Lt(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Lt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new aR(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new oR(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class aR{constructor(t,e,n=!1,s=null){this._stream=t,this._done=n||!1,this._filename=Mu(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class oR{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function lR(o){let t=!0,e=n("filename\\*","i").exec(o);if(e){e=e[1];let g=u(e);return g=unescape(g),g=d(g),g=f(g),a(g)}if(e=l(o),e){const g=f(e);return a(g)}if(e=n("filename","i").exec(o),e){e=e[1];let g=u(e);return g=f(g),a(g)}function n(g,m){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function s(g,m){if(g){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const v=new TextDecoder(g,{fatal:!0}),b=ml(m);m=v.decode(b),t=!1}catch{}}return m}function a(g){return t&&/[\x80-\xff]/.test(g)&&(g=s("utf-8",g),t&&(g=s("iso-8859-1",g))),g}function l(g){const m=[];let v;const b=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=b.exec(g))!==null;){let[,w,A,_]=v;if(w=parseInt(w,10),w in m){if(w===0)break;continue}m[w]=[A,_]}const S=[];for(let w=0;w<m.length&&w in m;++w){let[A,_]=m[w];_=u(_),A&&(_=unescape(_),w===0&&(_=d(_))),S.push(_)}return S.join("")}function u(g){if(g.startsWith('"')){const m=g.slice(1).split('\\"');for(let v=0;v<m.length;++v){const b=m[v].indexOf('"');b!==-1&&(m[v]=m[v].slice(0,b),m.length=v+1),m[v]=m[v].replaceAll(/\\(.)/g,"$1")}g=m.join('"')}return g}function d(g){const m=g.indexOf("'");if(m===-1)return g;const v=g.slice(0,m),S=g.slice(m+1).replace(/^[^']*'/,"");return s(v,S)}function f(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,v,b,S){if(b==="q"||b==="Q")return S=S.replaceAll("_"," "),S=S.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,A){return String.fromCharCode(parseInt(A,16))}),s(v,S);try{S=atob(S)}catch{}return s(v,S)})}return""}function c_(o,t){const e=new Headers;if(!o||!t||typeof t!="object")return e;for(const n in t){const s=t[n];s!==void 0&&e.append(n,s)}return e}function ku(o){return URL.parse(o)?.origin??null}function u_({responseHeaders:o,isHttp:t,rangeChunkSize:e,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(o.get("Content-Length"),10);return!Number.isInteger(a)||(s.suggestedLength=a,a<=2*e)||n||!t||o.get("Accept-Ranges")!=="bytes"||(o.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function h_(o){const t=o.get("Content-Disposition");if(t){let e=lR(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Mu(e))return e}return null}function _l(o,t){return new al(`Unexpected server response (${o}) while retrieving PDF "${t}".`,o,o===404||o===0&&t.startsWith("file:"))}function d_(o){return o===200||o===206}function f_(o,t,e){return{method:"GET",headers:o,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function g_(o){return o instanceof Uint8Array?o.buffer:o instanceof ArrayBuffer?o:(Tt(`getArrayBuffer - unexpected data format: ${o}`),new Uint8Array(o).buffer)}class cR{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=c_(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Lt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new uR(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new hR(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class uR{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),s=e.url;fetch(s,f_(n,this._withCredentials,this._abortController)).then(a=>{if(t._responseOrigin=ku(a.url),!d_(a.status))throw _l(a.status,s);this._reader=a.body.getReader(),this._headersCapability.resolve();const l=a.headers,{allowRangeRequests:u,suggestedLength:d}=u_({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=d||this._contentLength,this._filename=h_(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new $i("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:g_(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class hR{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const s=t.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const a=new Headers(t.headers);a.append("Range",`bytes=${e}-${n-1}`);const l=s.url;fetch(l,f_(a,this._withCredentials,this._abortController)).then(u=>{const d=ku(u.url);if(d!==t._responseOrigin)throw new Error(`Expected range response-origin "${d}" to match "${t._responseOrigin}".`);if(!d_(u.status))throw _l(u.status,l);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:g_(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const _f=200,Sf=206;function dR(o){const t=o.response;return typeof t!="string"?t:ml(t).buffer}class fR{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:n}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=c_(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[a,l]of this.headers)e.setRequestHeader(a,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=Sf):s.expectedStatus=_f,e.responseType="arraybuffer",Lt(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){const n=this.pendingRequests[t];n&&n.onProgress?.(e)}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],s.status===0&&this.isHttp){n.onError(s.status);return}const a=s.status||_f;if(!(a===_f&&n.expectedStatus===Sf)&&a!==n.expectedStatus){n.onError(s.status);return}const u=dR(s);if(a===Sf){const d=s.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);f?n.onDone({begin:parseInt(f[1],10),chunk:u}):(Tt('Missing or invalid "Content-Range" header.'),n.onError(0))}else u?n.onDone({begin:0,chunk:u}):n.onError(s.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class gR{constructor(t){this._source=t,this._manager=new fR(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Lt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new pR(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new mR(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class pR{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=ku(e.responseURL);const n=e.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[d,...f]=u.split(": ");return[d,f.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:l}=u_({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=h_(s),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=_l(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class mR{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=ku(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=_l(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const yR=/^[a-z][a-z0-9\-+.]+:/i;function vR(o){if(yR.test(o))return new URL(o);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(o))}class bR{constructor(t){this.source=t,this.url=vR(t.url),Lt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Lt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new wR(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new _R(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class wR{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=_l(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new $i("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class _R{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=t.source;this._isStreamingSupported=!s.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Uo=Symbol("INITIAL_DATA");class p_{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Uo}}get(t,e=null){if(e){const s=this.#e(t);return s.promise.then(()=>e(s.data)),null}const n=this.#t[t];if(!n||n.data===Uo)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=this.#t[t];return!!e&&e.data!==Uo}delete(t){const e=this.#t[t];return!e||e.data===Uo?!1:(delete this.#t[t],!0)}resolve(t,e=null){const n=this.#e(t);n.data=e,n.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==Uo&&(yield[t,e])}}}const SR=1e5,d0=30;let ll=class $n{#t=Promise.withResolvers();#e=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#a=null;#s=null;#r=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#m=[];#g=null;#u=[];#p=new WeakMap;#y=null;static#b=new Map;static#v=new Map;static#T=new WeakMap;static#A=null;static#w=new Set;constructor({textContentSource:t,container:e,viewport:n}){if(t instanceof ReadableStream)this.#g=t;else if(typeof t=="object")this.#g=new ReadableStream({start(d){d.enqueue(t),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#h=n.scale*ii.pixelRatio,this.#d=n.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:a,pageX:l,pageY:u}=n.rawDims;this.#y=[1,0,0,-1,-l,u+a],this.#o=s,this.#r=a,$n.#D(),xs(e,n),this.#t.promise.finally(()=>{$n.#w.delete(this),this.#s=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Ue.platform;return Ct(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:n})=>{if(n){this.#t.resolve();return}this.#a??=e.lang,Object.assign(this.#f,e.styles),this.#C(e.items),t()},this.#t.reject)};return this.#c=this.#g.getReader(),$n.#w.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const n=t.scale*ii.pixelRatio,s=t.rotation;if(s!==this.#d&&(e?.(),this.#d=s,xs(this.#l,{rotation:s})),n!==this.#h){e?.(),this.#h=n;const a={div:null,properties:null,ctx:$n.#O(this.#a)};for(const l of this.#u)a.properties=this.#p.get(l),a.div=l,this.#E(a)}}cancel(){const t=new $i("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#C(t){if(this.#i)return;this.#s.ctx??=$n.#O(this.#a);const e=this.#u,n=this.#m;for(const s of t){if(e.length>SR){Tt("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const a=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),s.id&&this.#e.setAttribute("id",`${s.id}`),a.append(this.#e)}else s.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}n.push(s.str),this.#S(s)}}#S(t){const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(e);const s=ut.transform(this.#y,t.transform);let a=Math.atan2(s[1],s[0]);const l=this.#f[t.fontName];l.vertical&&(a+=Math.PI/2);let u=this.#n&&l.fontSubstitution||l.fontFamily;u=$n.fontFamilyMap.get(u)||u;const d=Math.hypot(s[2],s[3]),f=d*$n.#j(u,l,this.#a);let g,m;a===0?(g=s[4],m=s[5]-f):(g=s[4]+f*Math.sin(a),m=s[5]-f*Math.cos(a));const v="calc(var(--total-scale-factor) *",b=e.style;this.#e===this.#l?(b.left=`${(100*g/this.#o).toFixed(2)}%`,b.top=`${(100*m/this.#r).toFixed(2)}%`):(b.left=`${v}${g.toFixed(2)}px)`,b.top=`${v}${m.toFixed(2)}px)`),b.fontSize=`${v}${($n.#A*d).toFixed(2)}px)`,b.fontFamily=u,n.fontSize=d,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#n&&(e.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),a!==0&&(n.angle=a*(180/Math.PI));let S=!1;if(t.str.length>1)S=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const w=Math.abs(t.transform[0]),A=Math.abs(t.transform[3]);w!==A&&Math.max(w,A)/Math.min(w,A)>1.5&&(S=!0)}if(S&&(n.canvasWidth=l.vertical?t.height:t.width),this.#p.set(e,n),this.#s.div=e,this.#s.properties=n,this.#E(this.#s),n.hasText&&this.#e.append(e),n.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this.#e.append(w)}}#E(t){const{div:e,properties:n,ctx:s}=t,{style:a}=e;let l="";if($n.#A>1&&(l=`scale(${1/$n.#A})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:u}=a,{canvasWidth:d,fontSize:f}=n;$n.#R(s,f*this.#h,u);const{width:g}=s.measureText(e.textContent);g>0&&(l=`scaleX(${d*this.#h/g}) ${l}`)}n.angle!==0&&(l=`rotate(${n.angle}deg) ${l}`),l.length>0&&(a.transform=l)}static cleanup(){if(!(this.#w.size>0)){this.#b.clear();for(const{canvas:t}of this.#v.values())t.remove();this.#v.clear()}}static#O(t=null){let e=this.#v.get(t||="");if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(t,e),this.#T.set(e,{size:0,family:""})}return e}static#R(t,e,n){const s=this.#T.get(t);e===s.size&&n===s.family||(t.font=`${e}px ${n}`,s.size=e,s.family=n)}static#D(){if(this.#A!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#A=t.getBoundingClientRect().height,t.remove()}static#j(t,e,n){const s=this.#b.get(t);if(s)return s;const a=this.#O(n);a.canvas.width=a.canvas.height=d0,this.#R(a,d0,t);const l=a.measureText(""),u=l.fontBoundingBoxAscent,d=Math.abs(l.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let f=.8;return u?f=u/(u+d):(Ue.platform.isFirefox&&Tt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#b.set(t,f),f}};const AR=100;function Bg(o={}){typeof o=="string"||o instanceof URL?o={url:o}:(o instanceof ArrayBuffer||ArrayBuffer.isView(o))&&(o={data:o});const t=new jg,{docId:e}=t,n=o.url?MC(o.url):null,s=o.data?kC(o.data):null,a=o.httpHeaders||null,l=o.withCredentials===!0,u=o.password??null,d=o.range instanceof Ig?o.range:null,f=Number.isInteger(o.rangeChunkSize)&&o.rangeChunkSize>0?o.rangeChunkSize:2**16;let g=o.worker instanceof Ta?o.worker:null;const m=o.verbosity,v=typeof o.docBaseUrl=="string"&&!vl(o.docBaseUrl)?o.docBaseUrl:null,b=Zc(o.cMapUrl),S=o.cMapPacked!==!1,w=o.CMapReaderFactory||(rn?UC:Zb),A=Zc(o.iccUrl),_=Zc(o.standardFontDataUrl),E=o.StandardFontDataFactory||(rn?FC:Jb),x=Zc(o.wasmUrl),O=o.WasmFactory||(rn?zC:t0),C=o.stopAtErrors!==!0,D=Number.isInteger(o.maxImageSize)&&o.maxImageSize>-1?o.maxImageSize:-1,R=o.isEvalSupported!==!1,k=typeof o.isOffscreenCanvasSupported=="boolean"?o.isOffscreenCanvasSupported:!rn,L=typeof o.isImageDecoderSupported=="boolean"?o.isImageDecoderSupported:!rn&&(Ue.platform.isFirefox||!globalThis.chrome),V=Number.isInteger(o.canvasMaxAreaInBytes)?o.canvasMaxAreaInBytes:-1,q=typeof o.disableFontFace=="boolean"?o.disableFontFace:rn,it=o.fontExtraProperties===!0,rt=o.enableXfa===!0,st=o.ownerDocument||globalThis.document,ot=o.disableRange===!0,B=o.disableStream===!0,H=o.disableAutoFetch===!0,tt=o.pdfBug===!0,lt=o.CanvasFactory||(rn?IC:LC),P=o.FilterFactory||(rn?jC:BC),z=o.enableHWA===!0,Y=o.useWasm!==!1,U=d?d.length:o.length??NaN,et=typeof o.useSystemFonts=="boolean"?o.useSystemFonts:!rn&&!q,nt=typeof o.useWorkerFetch=="boolean"?o.useWorkerFetch:!!(w===Zb&&E===Jb&&O===t0&&b&&_&&x&&qo(b,document.baseURI)&&qo(_,document.baseURI)&&qo(x,document.baseURI)),at=null;dC(m);const ft={canvasFactory:new lt({ownerDocument:st,enableHWA:z}),filterFactory:new P({docId:e,ownerDocument:st}),cMapReaderFactory:nt?null:new w({baseUrl:b,isCompressed:S}),standardFontDataFactory:nt?null:new E({baseUrl:_}),wasmFactory:nt?null:new O({baseUrl:x})};g||(g=Ta.create({verbosity:m,port:Es.workerPort}),t._worker=g);const vt={docId:e,apiVersion:"5.4.296",data:s,password:u,disableAutoFetch:H,rangeChunkSize:f,length:U,docBaseUrl:v,enableXfa:rt,evaluatorOptions:{maxImageSize:D,disableFontFace:q,ignoreErrors:C,isEvalSupported:R,isOffscreenCanvasSupported:k,isImageDecoderSupported:L,canvasMaxAreaInBytes:V,fontExtraProperties:it,useSystemFonts:et,useWasm:Y,useWorkerFetch:nt,cMapUrl:b,iccUrl:A,standardFontDataUrl:_,wasmUrl:x}},It={ownerDocument:st,pdfBug:tt,styleElement:at,loadingParams:{disableAutoFetch:H,enableXfa:rt}};return g.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const St=g.messageHandler.sendWithPromise("GetDocRequest",vt,s?[s.buffer]:null);let Ae;if(d)Ae=new rR(d,{disableRange:ot,disableStream:B});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");const le=qo(n)?cR:rn?bR:gR;Ae=new le({url:n,length:U,httpHeaders:a,withCredentials:l,rangeChunkSize:f,disableRange:ot,disableStream:B})}return St.then(le=>{if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const Dt=new Go(e,le,g.port),Pt=new xR(Dt,t,Ae,It,ft,z);t._transport=Pt,Dt.send("Ready",null)})}).catch(t._capability.reject),t}class jg{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${jg.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}let Ig=class{#t=Promise.withResolvers();#e=[];#i=[];#n=[];#a=[];constructor(t,e,n=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=s}addRangeListener(t){this.#a.push(t)}addProgressListener(t){this.#n.push(t)}addProgressiveReadListener(t){this.#i.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const n of this.#a)n(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const n of this.#n)n(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#i)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){Zt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class ER{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ct(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class TR{#t=!1;constructor(t,e,n,s=!1){this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=s?new Gb:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new p_,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:a=!1}={}){return new yl({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:s,dontFlip:a})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ct(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:n,intent:s="display",annotationMode:a=_i.ENABLE,transform:l=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:g=null,printAnnotationStorage:m=null,isEditing:v=!1,recordOperations:b=!1,operationsFilter:S=null}){this._stats?.time("Overall");const w=this._transport.getRenderingIntent(s,a,m,v),{renderingIntent:A,cacheKey:_}=w;this.#t=!1,d||=this._transport.getOptionalContentConfig(A);let E=this._intentStates.get(_);E||(E=Object.create(null),this._intentStates.set(_,E)),E.streamReaderCancelTimeout&&(clearTimeout(E.streamReaderCancelTimeout),E.streamReaderCancelTimeout=null);const x=!!(A&xn.PRINT);E.displayReadyCapability||(E.displayReadyCapability=Promise.withResolvers(),E.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(w));const O=!!(this._pdfBug&&globalThis.StepperManager?.enabled),C=!this.recordedBBoxes&&(b||O),D=L=>{if(E.renderTasks.delete(R),C){const V=R.gfx?.dependencyTracker.take();V&&(R.stepper&&R.stepper.setOperatorBBoxes(V,R.gfx.dependencyTracker.takeDebugMetadata()),b&&(this.recordedBBoxes=V))}x&&(this.#t=!0),this.#e(),L?(R.capability.reject(L),this._abortOperatorList({intentState:E,reason:L instanceof Error?L:new Error(L)})):R.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},R=new fa({callback:D,params:{canvas:e,canvasContext:t,dependencyTracker:C?new $C(e,E.operatorList.length,O):null,viewport:n,transform:l,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:E.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:g,enableHWA:this._transport.enableHWA,operationsFilter:S});(E.renderTasks||=new Set).add(R);const k=R.task;return Promise.all([E.displayReadyCapability.promise,d]).then(([L,V])=>{if(this.destroyed){D();return}if(this._stats?.time("Rendering"),!(V.renderingIntent&A))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");R.initializeGraphics({transparency:L,optionalContentConfig:V}),R.operatorListChanged()}).catch(D),k}getOperatorList({intent:t="display",annotationMode:e=_i.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){function a(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const l=this._transport.getRenderingIntent(t,e,n,s,!0);let u=this._intentStates.get(l.cacheKey);u||(u=Object.create(null),this._intentStates.set(l.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=a,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>ol.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,s){function a(){l.read().then(function({value:d,done:f}){if(f){n(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),a()},s)}const l=e.getReader(),u={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new Gb),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const n=this._intentStates.get(e);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let n=0,s=t.length;n<s;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:s}){const{map:a,transfer:l}=n,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:a,modifiedIds:s},l).getReader(),f=this._intentStates.get(e);f.streamReader=d;const g=()=>{d.read().then(({value:m,done:v})=>{if(v){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,f),g())},m=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const v of f.renderTasks)v.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(m);else if(f.opListReadCapability)f.opListReadCapability.reject(m);else throw m}})};g()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof Ou){let s=AR;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s);return}}if(t.streamReader.cancel(new $i(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,a]of this._intentStates)if(a===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var As,ti,Hi,rr,_u,ar,or,an,ou,m_,y_,Vo,_a,lu;const oe=class oe{constructor({name:t=null,port:e=null,verbosity:n=fC()}={}){fi(this,an);fi(this,As,Promise.withResolvers());fi(this,ti,null);fi(this,Hi,null);fi(this,rr,null);if(this.name=t,this.destroyed=!1,this.verbosity=n,e){if(ae(oe,or).has(e))throw new Error("Cannot use more than one PDFWorker per port.");ae(oe,or).set(e,this),gi(this,an,m_).call(this,e)}else gi(this,an,y_).call(this)}get promise(){return ae(this,As).promise}get port(){return ae(this,Hi)}get messageHandler(){return ae(this,ti)}destroy(){this.destroyed=!0,ae(this,rr)?.terminate(),dn(this,rr,null),ae(oe,or).delete(ae(this,Hi)),dn(this,Hi,null),ae(this,ti)?.destroy(),dn(this,ti,null)}static create(t){const e=ae(this,or).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new oe(t)}static get workerSrc(){if(Es.workerSrc)return Es.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ct(this,"_setupFakeWorkerGlobal",(async()=>ae(this,_a,lu)?ae(this,_a,lu):(await import(this.workerSrc)).WorkerMessageHandler)())}};As=new WeakMap,ti=new WeakMap,Hi=new WeakMap,rr=new WeakMap,_u=new WeakMap,ar=new WeakMap,or=new WeakMap,an=new WeakSet,ou=function(){ae(this,As).resolve(),ae(this,ti).send("configure",{verbosity:this.verbosity})},m_=function(t){dn(this,Hi,t),dn(this,ti,new Go("main","worker",t)),ae(this,ti).on("ready",()=>{}),gi(this,an,ou).call(this)},y_=function(){if(ae(oe,ar)||ae(oe,_a,lu)){gi(this,an,Vo).call(this);return}let{workerSrc:t}=oe;try{oe._isSameOrigin(window.location,t)||(t=oe._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new Go("main","worker",e),s=()=>{a.abort(),n.destroy(),e.terminate(),this.destroyed?ae(this,As).reject(new Error("Worker was destroyed")):gi(this,an,Vo).call(this)},a=new AbortController;e.addEventListener("error",()=>{ae(this,rr)||s()},{signal:a.signal}),n.on("test",u=>{if(a.abort(),this.destroyed||!u){s();return}dn(this,ti,n),dn(this,Hi,e),dn(this,rr,e),gi(this,an,ou).call(this)}),n.on("ready",u=>{if(a.abort(),this.destroyed){s();return}try{l()}catch{gi(this,an,Vo).call(this)}});const l=()=>{const u=new Uint8Array;n.send("test",u,[u.buffer])};l();return}catch{Du("The worker has been disabled.")}gi(this,an,Vo).call(this)},Vo=function(){ae(oe,ar)||(Tt("Setting up fake worker."),dn(oe,ar,!0)),oe._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){ae(this,As).reject(new Error("Worker was destroyed"));return}const e=new NC;dn(this,Hi,e);const n=`fake${Dv(oe,_u)._++}`,s=new Go(n+"_worker",n,e);t.setup(s,e),dn(this,ti,new Go(n,n+"_worker",e)),gi(this,an,ou).call(this)}).catch(t=>{ae(this,As).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},_a=new WeakSet,lu=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},fi(oe,_a),fi(oe,_u,0),fi(oe,ar,!1),fi(oe,or,new WeakMap),rn&&(dn(oe,ar,!0),Es.workerSrc||="./pdf.worker.mjs"),oe._isSameOrigin=(t,e)=>{const n=URL.parse(t);if(!n?.origin||n.origin==="null")return!1;const s=new URL(e,n);return n.origin===s.origin},oe._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},oe.fromPort=t=>{if(SC("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return oe.create(t)};let Ta=oe;class xR{#t=new Map;#e=new Map;#i=new Map;#n=new Map;#a=null;constructor(t,e,n,s,a,l){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new p_,this.fontLoader=new DC({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}#s(t,e=null){const n=this.#t.get(t);if(n)return n;const s=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,s),s}get annotationStorage(){return Ct(this,"annotationStorage",new kg)}getRenderingIntent(t,e=_i.ENABLE,n=null,s=!1,a=!1){let l=xn.DISPLAY,u=Vf;switch(t){case"any":l=xn.ANY;break;case"display":break;case"print":l=xn.PRINT;break;default:Tt(`getRenderingIntent - invalid intent: ${t}`)}const d=l&xn.PRINT&&n instanceof n_?n:this.annotationStorage;switch(e){case _i.DISABLE:l+=xn.ANNOTATIONS_DISABLE;break;case _i.ENABLE:break;case _i.ENABLE_FORMS:l+=xn.ANNOTATIONS_FORMS;break;case _i.ENABLE_STORAGE:l+=xn.ANNOTATIONS_STORAGE,u=d.serializable;break;default:Tt(`getRenderingIntent - invalid annotationMode: ${e}`)}s&&(l+=xn.IS_EDITING),a&&(l+=xn.OPLIST);const{ids:f,hash:g}=d.modifiedIds,m=[l,u.hash,g];return{renderingIntent:l,cacheKey:m.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of this.#e.values())t.push(n._destroy());this.#e.clear(),this.#i.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),ll.cleanup(),this._networkStream?.cancelAllRequests(new $i("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,s)=>{Lt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},s.onPull=()=>{this._fullReader.read().then(function({value:a,done:l}){if(l){s.close();return}Lt(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{this._fullReader.cancel(a),s.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:a,contentLength:l}=this._fullReader;return(!s||!a)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{e.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:s,isRangeSupported:a,contentLength:l}}),t.on("GetRangeReader",(n,s)=>{Lt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(n.begin,n.end);if(!a){s.close();return}s.onPull=()=>{a.read().then(function({value:l,done:u}){if(u){s.close();return}Lt(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{s.error(l)})},s.onCancel=l=>{a.cancel(l),s.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new ER(n,this))}),t.on("DocException",n=>{e._capability.reject(fn(n))}),t.on("PasswordRequest",n=>{this.#a=Promise.withResolvers();try{if(!e.onPassword)throw fn(n);const s=a=>{a instanceof Error?this.#a.reject(a):this.#a.resolve({password:a})};e.onPassword(s,n.code)}catch(s){this.#a.reject(s)}return this.#a.promise}),t.on("DataLoaded",n=>{e.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;this.#e.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,s,a])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":if("error"in a){const g=a.error;Tt(`Error during font loading: ${g}`),this.commonObjs.resolve(n,g);break}const l=new Xt(a),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(g,m)=>globalThis.FontInspector.fontAdded(g,m):null,d=new OC(l,u,a.extra,a.charProcOperatorList);this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!d.fontExtraProperties&&d.data&&d.clearData(),this.commonObjs.resolve(n,d)});break;case"CopyLocalImage":const{imageRef:f}=a;Lt(f,"The imageRef must be defined.");for(const g of this.#e.values())for(const[,m]of g.objs)if(m?.ref===f)return m.dataLen?(this.commonObjs.resolve(n,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,a);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([n,s,a,l])=>{if(this.destroyed)return;const u=this.#e.get(s);if(!u.objs.has(n)){if(u._intentStates.size===0){l?.bitmap?.close();return}switch(a){case"Image":case"Pattern":u.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${a}`)}}}),t.on("DocProgress",n=>{this.destroyed||e.onProgress?.({loaded:n.loaded,total:n.total})}),t.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[n.type];if(!s)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Tt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=this.#i.get(e);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&this.#n.set(a.refStr,t);const l=new TR(e,a,this,this._params.pdfBug);return this.#e.set(e,l),l});return this.#i.set(e,s),s}getPageIndex(t){return Xf(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#s("GetOptionalContentConfig").then(e=>new sR(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(s=>({info:s[0],metadata:s[1]?new nR(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),ll.cleanup()}}cachedPageNumber(t){if(!Xf(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#n.get(e)??null}}class CR{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class fa{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:n,commonObjs:s,annotationCanvasMap:a,operatorList:l,pageIndex:u,canvasFactory:d,filterFactory:f,useRequestAnimationFrame:g=!1,pdfBug:m=!1,pageColors:v=null,enableHWA:b=!1,operationsFilter:S=null}){this.callback=t,this.params=e,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=f,this._pdfBug=m,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new CR(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=b,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=S}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(fa.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");fa.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:s,background:a,dependencyTracker:l}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new ma(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:s,viewport:n,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),fa.#e.delete(this._canvas),t||=new Ou(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),fa.#e.delete(this._canvas),this.callback())))}}const v_="5.4.296",b_="f56dc8601";class Cn{#t=null;#e=null;#i;#n=null;#a=!1;#s=!1;#r=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return Ct(this,"_keyboardManager",new bl([[["Escape","mac+Escape"],Cn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Cn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Cn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Cn.prototype._moveToPrevious],[["Home","mac+Home"],Cn.prototype._moveToBeginning],[["End","mac+End"],Cn.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#s=!1,this.#r=t):this.#s=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#i=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Cn.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#r&&(t.ariaControls=`${this.#r.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#g.bind(this),{signal:e}),t.addEventListener("keydown",this.#m.bind(this),{signal:e});const n=this.#e=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#i,t.append(n),t}renderMainDropdown(){const t=this.#n=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",Mn,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#r&&(t.id=`${this.#r.id}_colorpicker_dropdown`);for(const[n,s]of this.#l.highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",s),a.title=n,a.setAttribute("data-l10n-id",Cn.#d[n]);const l=document.createElement("span");a.append(l),l.className="swatch",l.style.backgroundColor=s,a.ariaSelected=s===this.#i,a.addEventListener("click",this.#f.bind(this,s),{signal:e}),t.append(a)}return t.addEventListener("keydown",this.#m.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Nt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#g(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#p){this.#g(t);return}if(t.target===this.#t){this.#n.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#n?.firstChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#g(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#g(t);return}this.#n.firstChild?.focus()}_moveToEnd(t){if(!this.#p){this.#g(t);return}this.#n.lastChild?.focus()}#m(t){Cn._keyboardManager.exec(this,t)}#g(t){if(this.#p){this.hideDropdown();return}if(this.#a=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const e=this.#n=this.#h();this.#t.append(e)}#u(t){this.#n?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#p){this.#r?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#n)return;const e=this.#l.highlightColors.values();for(const n of this.#n.children)n.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#n?.remove(),this.#n=null}}class cl{#t=null;#e=null;#i=null;static#n=null;constructor(t){this.#e=t,this.#i=t._uiManager,cl.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,colorValue:n}=this.#e,s=this.#t=document.createElement("input");return s.type="color",s.value=n||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",cl.#n[t]),s.addEventListener("input",()=>{this.#i.updateParams(e,s.value)},{signal:this.#i._signal}),s}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function f0(o){return Math.floor(Math.max(0,Math.min(1,o))*255).toString(16).padStart(2,"0")}function Fo(o){return Math.max(0,Math.min(255,255*o))}class g0{static CMYK_G([t,e,n,s]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Fo(t),[t,t,t]}static G_HTML([t]){const e=f0(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(Fo)}static RGB_HTML(t){return`#${t.map(f0).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,n+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,n,s]){return[Fo(1-Math.min(1,t+s)),Fo(1-Math.min(1,n+s)),Fo(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const s=1-t,a=1-e,l=1-n,u=Math.min(s,a,l);return["CMYK",s,a,l,u]}}class RR{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Zt("Abstract method `_createSVG` called.")}}class ul extends RR{_createSVG(t){return document.createElementNS(Fi,t)}}const DR=9,cr=new WeakSet,OR=new Date().getTimezoneOffset()*60*1e3;class p0{static create(t){switch(t.data.annotationType){case _e.LINK:return new Ug(t);case _e.TEXT:return new kR(t);case _e.WIDGET:switch(t.data.fieldType){case"Tx":return new PR(t);case"Btn":return t.data.radioButton?new w_(t):t.data.checkBox?new LR(t):new BR(t);case"Ch":return new jR(t);case"Sig":return new NR(t)}return new fr(t);case _e.POPUP:return new Kf(t);case _e.FREETEXT:return new __(t);case _e.LINE:return new UR(t);case _e.SQUARE:return new FR(t);case _e.CIRCLE:return new zR(t);case _e.POLYLINE:return new S_(t);case _e.CARET:return new $R(t);case _e.INK:return new Fg(t);case _e.POLYGON:return new HR(t);case _e.HIGHLIGHT:return new A_(t);case _e.UNDERLINE:return new qR(t);case _e.SQUIGGLY:return new GR(t);case _e.STRIKEOUT:return new VR(t);case _e.STAMP:return new E_(t);case _e.FILEATTACHMENT:return new XR(t);default:return new fe(t)}}}class fe{#t=null;#e=!1;#i=null;constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return fe._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:n,rect:s}=this.data;let a=-1/0,l=-1/0;if(e?.length>=8){for(let u=0;u<e.length;u+=8)e[u+1]>l?(l=e[u+1],a=e[u+2]):e[u+1]===l&&(a=Math.max(a,e[u+2]));return[a,l]}if(n?.length>=1){for(const u of n)for(let d=0,f=u.length;d<f;d+=2)u[d+1]>l?(l=u[d+1],a=u[d]):u[d+1]===l&&(a=Math.max(a,u[d]));if(a!==1/0)return[a,l]}return s?[s[2],s[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:n,pageHeight:s,pageX:a,pageY:l}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-a)/n,t[1]=100*(t[1]-l)/s,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${rl}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,n={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:n})||this.annotationStorage.setValue(`${rl}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:n}=t;e&&this.#n(e);let s=this.#i?.popup||this.popup;!s&&n?.text&&(this._createPopup(n),s=this.#i.popup),s&&(s.updateEdited(t),n?.deleted&&(s.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#t&&(this.#n(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#n(t){const{container:{style:e},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:l,pageX:u,pageY:d}}}}=this;n?.splice(0,4,...t),e.left=`${100*(t[0]-u)/a}%`,e.top=`${100*(l-t[3]+d)/l}%`,s===0?(e.width=`${100*(t[2]-t[0])/a}%`,e.height=`${100*(t[3]-t[1])/l}%`):this.setRotation(s)}_createContainer(t){const{data:e,parent:{page:n,viewport:s}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",e.id),!(this instanceof fr)&&!(this instanceof Ug)&&(a.tabIndex=0);const{style:l}=a;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(a.title=e.alternativeText),e.noRotate&&a.classList.add("norotate"),!e.rect||this instanceof Kf){const{rotation:w}=e;return!e.hasOwnCanvas&&w!==0&&this.setRotation(w,a),a}const{width:u,height:d}=this;if(!t&&e.borderStyle.width>0){l.borderWidth=`${e.borderStyle.width}px`;const w=e.borderStyle.horizontalCornerRadius,A=e.borderStyle.verticalCornerRadius;if(w>0||A>0){const E=`calc(${w}px * var(--total-scale-factor)) / calc(${A}px * var(--total-scale-factor))`;l.borderRadius=E}else if(this instanceof w_){const E=`calc(${u}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;l.borderRadius=E}switch(e.borderStyle.style){case ua.SOLID:l.borderStyle="solid";break;case ua.DASHED:l.borderStyle="dashed";break;case ua.BEVELED:Tt("Unimplemented border style: beveled");break;case ua.INSET:Tt("Unimplemented border style: inset");break;case ua.UNDERLINE:l.borderBottomStyle="solid";break}const _=e.borderColor||null;_?(this.#e=!0,l.borderColor=ut.makeHexColor(_[0]|0,_[1]|0,_[2]|0)):l.borderWidth=0}const f=ut.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:g,pageHeight:m,pageX:v,pageY:b}=s.rawDims;l.left=`${100*(f[0]-v)/g}%`,l.top=`${100*(f[1]-b)/m}%`;const{rotation:S}=e;return e.hasOwnCanvas||S===0?(l.width=`${100*u/g}%`,l.height=`${100*d/m}%`):this.setRotation(S,a),a}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims;let{width:a,height:l}=this;t%180!==0&&([a,l]=[l,a]),e.style.width=`${100*a/n}%`,e.style.height=`${100*l/s}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,s)=>{const a=s.detail[e],l=a[0],u=a.slice(1);s.target.style[n]=g0[`${l}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[n]:g0[`${l}_rgb`](u)})};return Ct(this,"_commonActions",{display:e=>{const{display:n}=e.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const s of Object.keys(e.detail))(t[s]||n[s])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[s,a]of Object.entries(e)){const l=n[s];if(l){const u={detail:{[s]:a},target:t};l(u),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,s,a]=this.data.rect.map(w=>Math.fround(w));if(t.length===8){const[w,A,_,E]=t.subarray(2,6);if(s===w&&a===A&&e===_&&n===E)return}const{style:l}=this.container;let u;if(this.#e){const{borderColor:w,borderWidth:A}=l;l.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${A}">`],this.container.classList.add("hasBorder")}const d=s-e,f=a-n,{svgFactory:g}=this,m=g.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0),m.role="none";const v=g.createElement("defs");m.append(v);const b=g.createElement("clipPath"),S=`clippath_${this.data.id}`;b.setAttribute("id",S),b.setAttribute("clipPathUnits","objectBoundingBox"),v.append(b);for(let w=2,A=t.length;w<A;w+=8){const _=t[w],E=t[w+1],x=t[w+2],O=t[w+3],C=g.createElement("rect"),D=(x-e)/d,R=(a-E)/f,k=(_-x)/d,L=(E-O)/f;C.setAttribute("x",D),C.setAttribute("y",R),C.setAttribute("width",k),C.setAttribute("height",L),b.append(C),u?.push(`<rect vector-effect="non-scaling-stroke" x="${D}" y="${R}" width="${k}" height="${L}"/>`)}this.#e&&(u.push("</g></svg>')"),l.backgroundImage=u.join("")),this.container.append(m),this.container.style.clipPath=`url(#${S})`}_createPopup(t=null){const{data:e}=this;let n,s;t?(n={str:t.text},s=t.date):(n=e.contentsObj,s=e.modificationDate);const a=this.#i=new Kf({data:{color:e.color,titleObj:e.titleObj,modificationDate:s,contentsObj:n,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent._commentManager||this.parent.div.append(a.render())}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){Zt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:a,id:l,exportValues:u}of s){if(a===-1||l===e)continue;const d=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!cr.has(f)){Tt(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:d,domElement:f})}return n}for(const s of document.getElementsByName(t)){const{exportValue:a}=s,l=s.getAttribute("data-element-id");l!==e&&cr.has(s)&&n.push({id:l,exportValue:a,domElement:s})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class MR extends fe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&(this._createPopup(t.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}class Ug extends fe{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let s=!1;return t.url?(e.addLinkAttributes(n,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(n,t.action,t.overlaidText),s=!0):t.attachment?(this.#e(n,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(this.#i(n,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(n,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),s=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(n),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,n=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),n&&(t.title=n)}_bindNamedAction(t,e,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),n&&(t.title=n),this.#t()}#e(t,e,n="",s=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:n&&(t.title=n),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,s),!1),this.#t()}#i(t,e,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),n&&(t.title=n),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(e.actions)){const a=n.get(s);a&&(t[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:s}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){Tt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(t.onclick=()=>!1);return}t.onclick=()=>{n?.();const{fields:s,refs:a,include:l}=e,u=[];if(s.length!==0||a.length!==0){const g=new Set(a);for(const m of s){const v=this._fieldObjects[m]||[];for(const{id:b}of v)g.add(b)}for(const m of Object.values(this._fieldObjects))for(const v of m)g.has(v.id)===l&&u.push(v)}else for(const g of Object.values(this._fieldObjects))u.push(...g);const d=this.annotationStorage,f=[];for(const g of u){const{id:m}=g;switch(f.push(m),g.type){case"text":{const b=g.defaultValue||"";d.setValue(m,{value:b});break}case"checkbox":case"radiobutton":{const b=g.defaultValue===g.exportValues;d.setValue(m,{value:b});break}case"combobox":case"listbox":{const b=g.defaultValue||"";d.setValue(m,{value:b});break}default:continue}const v=document.querySelector(`[data-element-id="${m}"]`);if(v){if(!cr.has(v)){Tt(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class kR extends fe{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class fr extends fe{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Ue.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,s,a){n.includes("mouse")?t.addEventListener(n,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:a(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(n,l=>{if(n==="blur"){if(!e.focused||!l.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:a(l)}})})}_setEventListeners(t,e,n,s){for(const[a,l]of n)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,a,l,s),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":ut.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||DR,a=t.style;let l;const u=2,d=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),g=Math.round(f/(pf*s))||1,m=f/g;l=Math.min(s,d(m/pf))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);l=Math.min(s,d(f/pf))}a.fontSize=`calc(${l}px * var(--total-scale-factor))`,a.color=ut.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(a.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class PR extends fr{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,s){const a=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[e]=n),a.setValue(l.id,{[s]:n})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const s=t.getValue(e,{value:this.data.fieldValue});let a=s.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let u=s.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=u??a,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",u??a),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),cr.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:f,datetimeType:g,timeStep:m}=this.data,v=!!g&&this.enableScripting;f&&(n.title=f),this._setRequired(n,this.data.required),l&&(n.maxLength=l),n.addEventListener("input",S=>{t.setValue(e,{value:S.target.value}),this.setPropertyOnSiblings(n,"value",S.target.value,"value"),d.formattedValue=null}),n.addEventListener("resetform",S=>{const w=this.data.defaultFieldValue??"";n.value=d.userValue=w,d.formattedValue=null});let b=S=>{const{formattedValue:w}=d;w!=null&&(S.target.value=w),S.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",w=>{if(d.focused)return;const{target:A}=w;if(v&&(A.type=g,m&&(A.step=m)),d.userValue){const _=d.userValue;if(v)if(g==="time"){const E=new Date(_),x=[E.getHours(),E.getMinutes(),E.getSeconds()];A.value=x.map(O=>O.toString().padStart(2,"0")).join(":")}else A.value=new Date(_-OR).toISOString().split(g==="date"?"T":".",1)[0];else A.value=_}d.lastCommittedValue=A.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),n.addEventListener("updatefromsandbox",w=>{this.showElementAndHideCanvas(w.target);const A={value(_){d.userValue=_.detail.value??"",v||t.setValue(e,{value:d.userValue.toString()}),_.target.value=d.userValue},formattedValue(_){const{formattedValue:E}=_.detail;d.formattedValue=E,E!=null&&_.target!==document.activeElement&&(_.target.value=E);const x={formattedValue:E};v&&(x.value=E),t.setValue(e,x)},selRange(_){_.target.setSelectionRange(..._.detail.selRange)},charLimit:_=>{const{charLimit:E}=_.detail,{target:x}=_;if(E===0){x.removeAttribute("maxLength");return}x.setAttribute("maxLength",E);let O=d.userValue;!O||O.length<=E||(O=O.slice(0,E),x.value=d.userValue=O,t.setValue(e,{value:O}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:O,willCommit:!0,commitKey:1,selStart:x.selectionStart,selEnd:x.selectionEnd}}))}};this._dispatchEventFromSandbox(A,w)}),n.addEventListener("keydown",w=>{d.commitKey=1;let A=-1;if(w.key==="Escape"?A=0:w.key==="Enter"&&!this.data.multiLine?A=2:w.key==="Tab"&&(d.commitKey=3),A===-1)return;const{value:_}=w.target;d.lastCommittedValue!==_&&(d.lastCommittedValue=_,d.userValue=_,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:A,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}))});const S=b;b=null,n.addEventListener("blur",w=>{if(!d.focused||!w.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{target:A}=w;let{value:_}=A;if(v){if(_&&g==="time"){const E=_.split(":").map(x=>parseInt(x,10));_=new Date(2e3,0,1,E[0],E[1],E[2]||0).valueOf(),A.step=""}else _.includes("T")||(_=`${_}T00:00`),_=new Date(_).valueOf();A.type="text"}d.userValue=_,d.lastCommittedValue!==_&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:d.commitKey,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}),S(w)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",w=>{d.lastCommittedValue=null;const{data:A,target:_}=w,{value:E,selectionStart:x,selectionEnd:O}=_;let C=x,D=O;switch(w.inputType){case"deleteWordBackward":{const R=E.substring(0,x).match(/\w*[^\w]*$/);R&&(C-=R[0].length);break}case"deleteWordForward":{const R=E.substring(x).match(/^[^\w]*\w*/);R&&(D+=R[0].length);break}case"deleteContentBackward":x===O&&(C-=1);break;case"deleteContentForward":x===O&&(D+=1);break}w.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,change:A||"",willCommit:!1,selStart:C,selEnd:D}})}),this._setEventListeners(n,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],w=>w.target.value)}if(b&&n.addEventListener("blur",b),this.data.comb){const w=(this.data.rect[2]-this.data.rect[0])/l;n.classList.add("comb"),n.style.letterSpacing=`calc(${w}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class NR extends fr{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class LR extends fr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let s=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",t.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return cr.add(a),a.setAttribute("data-element-id",n),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=e.fieldName,s&&a.setAttribute("checked",!0),a.setAttribute("exportValue",e.exportValue),a.tabIndex=0,a.addEventListener("change",l=>{const{name:u,checked:d}=l.target;for(const f of this._getElementsByName(u,n)){const g=d&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=g),t.setValue(f.id,{value:g})}t.setValue(n,{value:d})}),a.addEventListener("resetform",l=>{const u=e.defaultFieldValue||"Off";l.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",l=>{const u={value(d){d.target.checked=d.detail.value!=="Off",t.setValue(n,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class w_ extends fr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let s=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof s=="string"&&(s=s!==e.buttonValue,t.setValue(n,{value:s})),s)for(const l of this._getElementsByName(e.fieldName,n))t.setValue(l.id,{value:!1});const a=document.createElement("input");if(cr.add(a),a.setAttribute("data-element-id",n),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=e.fieldName,s&&a.setAttribute("checked",!0),a.tabIndex=0,a.addEventListener("change",l=>{const{name:u,checked:d}=l.target;for(const f of this._getElementsByName(u,n))t.setValue(f.id,{value:!1});t.setValue(n,{value:d})}),a.addEventListener("resetform",l=>{const u=e.defaultFieldValue;l.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const l=e.buttonValue;a.addEventListener("updatefromsandbox",u=>{const d={value:f=>{const g=l===f.detail.value;for(const m of this._getElementsByName(f.target.name)){const v=g&&m.id===n;m.domElement&&(m.domElement.checked=v),t.setValue(m.id,{value:v})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class BR extends Ug{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class jR extends fr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");cr.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",g=>{const m=this.data.defaultFieldValue;for(const v of s.options)v.selected=v.value===m});for(const g of this.data.options){const m=document.createElement("option");m.textContent=g.displayValue,m.value=g.exportValue,n.value.includes(g.exportValue)&&(m.setAttribute("selected",!0),a=!1),s.append(m)}let l=null;if(a){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),s.prepend(g),l=()=>{g.remove(),s.removeEventListener("input",l),l=null},s.addEventListener("input",l)}const u=g=>{const m=g?"value":"textContent",{options:v,multiple:b}=s;return b?Array.prototype.filter.call(v,S=>S.selected).map(S=>S[m]):v.selectedIndex===-1?null:v[v.selectedIndex][m]};let d=u(!1);const f=g=>{const m=g.target.options;return Array.prototype.map.call(m,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",g=>{const m={value(v){l?.();const b=v.detail.value,S=new Set(Array.isArray(b)?b:[b]);for(const w of s.options)w.selected=S.has(w.value);t.setValue(e,{value:u(!0)}),d=u(!1)},multipleSelection(v){s.multiple=!0},remove(v){const b=s.options,S=v.detail.remove;b[S].selected=!1,s.remove(S),b.length>0&&Array.prototype.findIndex.call(b,A=>A.selected)===-1&&(b[0].selected=!0),t.setValue(e,{value:u(!0),items:f(v)}),d=u(!1)},clear(v){for(;s.length!==0;)s.remove(0);t.setValue(e,{value:null,items:[]}),d=u(!1)},insert(v){const{index:b,displayValue:S,exportValue:w}=v.detail.insert,A=s.children[b],_=document.createElement("option");_.textContent=S,_.value=w,A?A.before(_):s.append(_),t.setValue(e,{value:u(!0),items:f(v)}),d=u(!1)},items(v){const{items:b}=v.detail;for(;s.length!==0;)s.remove(0);for(const S of b){const{displayValue:w,exportValue:A}=S,_=document.createElement("option");_.textContent=w,_.value=A,s.append(_)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:u(!0),items:f(v)}),d=u(!1)},indices(v){const b=new Set(v.detail.indices);for(const S of v.target.options)S.selected=b.has(S.index);t.setValue(e,{value:u(!0)}),d=u(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(m,g)}),s.addEventListener("input",g=>{const m=u(!0),v=u(!1);t.setValue(e,{value:m}),g.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:d,change:v,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):s.addEventListener("input",function(g){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Kf extends fe{constructor(t){const{data:e,elements:n,parent:s}=t,a=!!s._commentManager;if(super(t,{isRenderable:!a&&fe._hasPopupData(e)}),this.elements=n,a&&fe._hasPopupData(e)){const l=this.popup=this.#t();for(const u of n)u.popup=l}else this.popup=null}#t(){return new IR({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),n=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",n.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(s=>`${Cg}${s}`).join(",")),this.container}}class IR{#t=null;#e=this.#q.bind(this);#i=this.#U.bind(this);#n=this.#P.bind(this);#a=this.#_.bind(this);#s=null;#r=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#m=null;#g=null;#u=null;#p=null;#y=null;#b=null;#v=null;#T=null;#A=null;#w=null;#C=!1;#S=null;#E=null;constructor({container:t,color:e,elements:n,titleObj:s,modificationDate:a,contentsObj:l,richText:u,parent:d,rect:f,parentRect:g,open:m,commentManager:v=null}){this.#r=t,this.#A=s,this.#o=l,this.#T=u,this.#d=d,this.#s=e,this.#v=f,this.#h=g,this.#l=n,this.#t=v,this.#S=n[0],this.#c=vu.toDateObject(a),this.trigger=n.flatMap(b=>b.getElementsToTriggerPopup()),v?this.renderCommentButton():(this.#O(),this.#r.hidden=!0,m&&this.#_())}#O(){if(this.#g)return;this.#g=new AbortController;const{signal:t}=this.#g;for(const e of this.trigger)e.addEventListener("click",this.#a,{signal:t}),e.addEventListener("pointerenter",this.#n,{signal:t}),e.addEventListener("pointerleave",this.#i,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#R(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p||(this.#y||this.#R(),!this.#y))return;const{signal:t}=this.#g=new AbortController,e=!!this.#S.extraPopupElement,n=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},s=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},a=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#p=this.#S.container;for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",n,{signal:t}),l.addEventListener("pointerenter",s,{signal:t}),l.addEventListener("pointerleave",a,{signal:t}),l.classList.add("popupTriggerArea")}else{const l=this.#p=document.createElement("button");l.className="annotationCommentButton";const u=this.#S.container;l.style.zIndex=u.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#j(),this.#D(),l.addEventListener("keydown",this.#e,{signal:t}),l.addEventListener("click",n,{signal:t}),l.addEventListener("pointerenter",s,{signal:t}),l.addEventListener("pointerleave",a,{signal:t}),u.after(l)}}#D(){if(this.#S.extraPopupElement&&!this.#S.editor)return;this.renderCommentButton();const[t,e]=this.#y,{style:n}=this.#p;n.left=`calc(${t}%)`,n.top=`calc(${e}% - var(--comment-button-dim))`}#j(){this.#S.extraPopupElement||(this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#S.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:e,opacity:n,creationDate:s,modificationDate:a}=this.#S.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:n,creationDate:s,modificationDate:a}}get elementBeforePopup(){return this.#p}get comment(){return this.#E||=this.#S.commentText,this.#E}set comment(t){t!==this.comment&&(this.#S.commentText=this.#E=t)}get parentBoundingClientRect(){return this.#S.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=e)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#b)return this.#b;const{x:t,y:e,height:n}=this.#p.getBoundingClientRect(),{x:s,y:a,width:l,height:u}=this.#S.layer.getBoundingClientRect();return[(t-s)/l,(e+n-a)/u]}set commentPopupPosition(t){this.#b=t}hasDefaultPopupPosition(){return this.#b===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,n]=this.#b||this.commentButtonPosition.map(f=>f/100),s=this.parentBoundingClientRect,{x:a,y:l,width:u,height:d}=s;this.#t.showDialog(null,this,a+e*u,l+n*d,{...t,parentDimensions:s})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#s){const n=t.style.outlineColor=ut.makeHexColor(...this.#s);t.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#A?.str){const n=document.createElement("span");n.className="title",e.append(n),{dir:n.dir,str:n.textContent}=this.#A}if(t.append(e),this.#c){const n=document.createElement("time");n.className="popupDate",n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),n.dateTime=this.#c.toISOString(),e.append(n)}Dg({html:this.#k||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#r.append(t)}get#k(){const t=this.#T,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#T.html||null}get#N(){return this.#k?.attributes?.style?.fontSize||0}get#I(){return this.#k?.attributes?.style?.color||null}#L(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:this.#I,fontSize:this.#N?`calc(${this.#N}px * var(--total-scale-factor))`:""}};for(const a of t.split(`
`))e.push({name:"span",value:a,attributes:s});return n}#q(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#_()}updateEdited({rect:t,popup:e,deleted:n}){if(this.#t){n?(this.remove(),this.#E=null):e&&(e.deleted?this.remove():(this.#j(),this.#E=e.text)),t&&(this.#y=null,this.#R(),this.#D());return}if(n||e?.deleted){this.remove();return}this.#O(),this.#w||={contentsObj:this.#o,richText:this.#T},t&&(this.#u=null),e&&e.text&&(this.#T=this.#L(e.text),this.#c=vu.toDateObject(e.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#w&&({contentsObj:this.#o,richText:this.#T}=this.#w,this.#w=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#m?.remove(),this.#m=null,this.#C=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#x(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:s,pageY:a}}}=this.#d;let l=!!this.#h,u=l?this.#h:this.#v;for(const S of this.#l)if(!u||ut.intersect(S.data.rect,u)!==null){u=S.data.rect,l=!0;break}const d=ut.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),g=l?u[2]-u[0]+5:0,m=d[0]+g,v=d[1];this.#u=[100*(m-s)/e,100*(v-a)/n];const{style:b}=this.#r;b.left=`${this.#u[0]}%`,b.top=`${this.#u[1]}%`}#_(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#P(),this.#r.addEventListener("click",this.#a),this.#r.addEventListener("keydown",this.#e)):(this.#U(),this.#r.removeEventListener("click",this.#a),this.#r.removeEventListener("keydown",this.#e))}#P(){this.#m||this.render(),this.isVisible?this.#f&&this.#r.classList.add("focused"):(this.#x(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#U(){this.#r.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#r.hidden=!0)}maybeShow(){this.#t||(this.#O(),this.#C&&(this.#m||this.#P(),this.#C=!1,this.#r.hidden=!1))}get isVisible(){return this.#t?!1:this.#r.hidden===!1}}class __ extends fe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Et.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class UR extends fe{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:n}=this,s=this.svgFactory.create(e,n,!0),a=this.#t=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class FR extends fe{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:n}=this,s=this.svgFactory.create(e,n,!0),a=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",a/2),l.setAttribute("y",a/2),l.setAttribute("width",e-a),l.setAttribute("height",n-a),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class zR extends fe{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:n}=this,s=this.svgFactory.create(e,n,!0),a=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",e/2),l.setAttribute("cy",n/2),l.setAttribute("rx",e/2-a/2),l.setAttribute("ry",n/2-a/2),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class S_ extends fe{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:n,popupRef:s},width:a,height:l}=this;if(!e)return this.container;const u=this.svgFactory.create(a,l,!0);let d=[];for(let g=0,m=e.length;g<m;g+=2){const v=e[g]-t[0],b=t[3]-e[g+1];d.push(`${v},${b}`)}d=d.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",d),f.setAttribute("stroke-width",n.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class HR extends S_{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class $R extends fe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Fg extends fe{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Et.HIGHLIGHT:Et.INK}#i(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:n,borderStyle:s,popupRef:a}}=this,{transform:l,width:u,height:d}=this.#i(e,t),f=this.svgFactory.create(u,d,!0),g=this.#t=this.svgFactory.createElement("svg:g");f.append(g),g.setAttribute("stroke-width",s.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",l);for(let m=0,v=n.length;m<v;m++){const b=this.svgFactory.createElement(this.svgElementName);this.#e.push(b),b.setAttribute("points",n[m].join(",")),g.append(b)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:n,rect:s}=t,a=this.#t;if(e>=0&&a.setAttribute("stroke-width",e||1),n)for(let l=0,u=this.#e.length;l<u;l++)this.#e[l].setAttribute("points",n[l].join(","));if(s){const{transform:l,width:u,height:d}=this.#i(this.data.rotation,s);a.parentElement.setAttribute("viewBox",`0 0 ${u} ${d}`),a.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class A_ extends fe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Et.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class qR extends fe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class GR extends fe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class VR extends fe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class E_ extends fe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Et.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class XR extends fe{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let n;e.hasAppearance||e.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#e.bind(this)),this.#t=n;const{isMac:s}=Ue.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(s?a.metaKey:a.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}let zg=class T_{#t=null;#e=null;#i=null;#n=new Map;#a=null;#s=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:s,page:a,viewport:l,structTreeLayer:u,commentManager:d,linkService:f,annotationStorage:g}){this.div=t,this.#t=e,this.#e=n,this.#a=u||null,this.#s=f||null,this.#i=g||new kg,this.page=a,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=d||null}hasEditableAnnotations(){return this.#n.size>0}async#r(t,e,n){const s=t.firstChild||t,a=s.id=`${Cg}${e}`,l=await this.#a?.getAriaAttributes(a);if(l)for(const[u,d]of l)s.setAttribute(u,d);n?n.at(-1).container.after(t):(this.div.append(t),this.#t?.moveElementInDOM(this.div,t,s,!1))}async render(t){const{annotations:e}=t,n=this.div;xs(n,this.viewport);const s=new Map,a={data:null,layer:n,linkService:this.#s,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new ul,annotationStorage:this.#i,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of e){if(l.noHTML)continue;const u=l.annotationType===_e.POPUP;if(u){const g=s.get(l.id);if(!g)continue;a.elements=g}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;a.data=l;const d=p0.create(a);if(!d.isRenderable)continue;if(!u&&l.popupRef){const g=s.get(l.popupRef);g?g.push(d):s.set(l.popupRef,[d])}const f=d.render();l.hidden&&(f.style.visibility="hidden"),await this.#r(f,l.id,a.elements),d.extraPopupElement?.popup?.renderCommentButton(),d._isEditable&&(this.#n.set(d.data.id,d),this._annotationEditorUIManager?.renderAnnotationElement(d))}this.#o()}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#s,svgFactory:new ul,parent:this};for(const n of t){n.borderStyle||=T_._defaultBorderStyle,e.data=n;const s=p0.create(e);if(!s.isRenderable)continue;const a=s.render();await this.#r(a,n.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,xs(e,{rotation:t.rotation}),this.#o(),e.hidden=!1}#o(){if(!this.#e)return;const t=this.div;for(const[e,n]of this.#e){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:a}=s;a?a.nodeName==="CANVAS"?a.replaceWith(n):a.classList.contains("annotationContent")?a.after(n):a.before(n):s.append(n);const l=this.#n.get(e);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,s.id,n),l._hasNoCanvas=!1):l.canvas=n)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:n,rotation:s}=t,a=new MR({data:{id:n,rect:t.getPDFRect(),rotation:s},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#s,annotationStorage:this.#i}),l=a.render();return e.append(l),this.#t?.moveElementInDOM(e,l,l,!1),a.createOrUpdatePopup(),a}static get _defaultBorderStyle(){return Ct(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:ua.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};const su=/\r\n?|\n/g;class Be extends pt{#t="";#e=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Be.prototype,e=a=>a.isEmpty(),n=qi.TRANSLATE_SMALL,s=qi.TRANSLATE_BIG;return Ct(this,"_keyboardManager",new bl([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}]]))}static _type="freetext";static _editorType=Et.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||Be._defaultColor||pt._defaultLineColor,this.#n=t.fontSize||Be._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(t,e){pt.initialize(t,e);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Nt.FREETEXT_SIZE:Be._defaultFontSize=e;break;case Nt.FREETEXT_COLOR:Be._defaultColor=e;break}}updateParams(t,e){switch(t){case Nt.FREETEXT_SIZE:this.#a(e);break;case Nt.FREETEXT_COLOR:this.#s(e);break}}static get defaultPropertiesToUpdate(){return[[Nt.FREETEXT_SIZE,Be._defaultFontSize],[Nt.FREETEXT_COLOR,Be._defaultColor||pt._defaultLineColor]]}get propertiesToUpdate(){return[[Nt.FREETEXT_SIZE,this.#n],[Nt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new cl(this),[["colorPicker",this._colorPicker]]}get colorType(){return Nt.FREETEXT_COLOR}#a(t){const e=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#n)*this.parentScale),this.#n=s,this.#o()},n=this.#n;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#s(t){const e=s=>{this.color=s,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Be._internalPadding*t,-(Be._internalPadding+this.#n)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#r(){const t=[];this.editorDiv.normalize();let e=null;for(const n of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(t.push(Be.#c(n)),e=n);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:a}=this,l=a.style.display,u=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",s.div.append(this.div),n=a.getBoundingClientRect(),a.remove(),a.style.display=l,a.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=n.width/t,this.height=n.height/e):(this.width=n.height/t,this.height=n.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#r().trimEnd();if(t===e)return;const n=s=>{if(this.#t=s,!s){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{n(e)},undo:()=>{n(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Be._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,a]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[f,g]=this.pageDimensions,[m,v]=this.pageTranslation;let b,S;switch(this.rotation){case 0:b=t+(l[0]-m)/f,S=e+this.height-(l[1]-v)/g;break;case 90:b=t+(l[0]-m)/f,S=e-(l[1]-v)/g,[u,d]=[d,-u];break;case 180:b=t-this.width+(l[0]-m)/f,S=e-(l[1]-v)/g,[u,d]=[-u,-d];break;case 270:b=t+(l[0]-m-this.height*g)/f,S=e+(l[1]-v-this.width*f)/g,[u,d]=[-d,u];break}this.setAt(b*s,S*a,u,d)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(su,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:n}=e;if(n.length===1&&n[0]==="text/plain")return;t.preventDefault();const s=Be.#h(e.getData("text")||"").replaceAll(su,`
`);if(!s)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const l=a.getRangeAt(0);if(!s.includes(`
`)){l.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:u,startOffset:d}=l,f=[],g=[];if(u.nodeType===Node.TEXT_NODE){const b=u.parentElement;if(g.push(u.nodeValue.slice(d).replaceAll(su,"")),b!==this.editorDiv){let S=f;for(const w of this.editorDiv.childNodes){if(w===b){S=g;continue}S.push(Be.#c(w))}}f.push(u.nodeValue.slice(0,d).replaceAll(su,""))}else if(u===this.editorDiv){let b=f,S=0;for(const w of this.editorDiv.childNodes)S++===d&&(b=g),b.push(Be.#c(w))}this.#t=`${f.join(`
`)}${s}${g.join(`
`)}`,this.#l();const m=new Range;let v=Math.sumPrecise(f.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const S=b.nodeValue.length;if(v<=S){m.setStart(b,v),m.setEnd(b,v);break}v-=S}a.removeAllRanges(),a.addRange(m)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Be._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,n){let s=null;if(t instanceof __){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:d,rotation:f,id:g,popupRef:m,richText:v,contentsObj:b,creationDate:S,modificationDate:w},textContent:A,textPosition:_,parent:{page:{pageNumber:E}}}=t;if(!A||A.length===0)return null;s=t={annotationType:Et.FREETEXT,color:Array.from(u),fontSize:l,value:A.join(`
`),position:_,pageIndex:E-1,rect:d.slice(0),rotation:f,annotationElementId:g,id:g,deleted:!1,popupRef:m,comment:b?.str||null,richText:v,creationDate:S,modificationDate:w}}const a=await super.deserialize(t,e,n);return a.#n=t.fontSize,a.color=ut.makeHexColor(...t.color),a.#t=Be.#h(t.value),a._initialData=s,t.comment&&a.setCommentData(t),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=pt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(t),{color:e,fontSize:this.#n,value:this.#d()});return this.addComment(n),t?(n.isCopy=!0,n):this.annotationElementId&&!this.#f(n)?null:(n.id=this.annotationElementId,n)}#f(t){const{value:e,fontSize:n,color:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==n||t.color.some((l,u)=>l!==s[u])||t.pageIndex!==a}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:n}=e;n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,e.replaceChildren();for(const s of this.#t.split(`
`)){const a=document.createElement("div");a.append(s?document.createTextNode(s):document.createElement("br")),e.append(a)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class ct{static PRECISION=1e-4;toSVGPath(){Zt("Abstract method `toSVGPath` must be implemented.")}get box(){Zt("Abstract getter `box` must be implemented.")}serialize(t,e){Zt("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,s,a,l){l||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)l[u]=e+t[u]*s,l[u+1]=n+t[u+1]*a;return l}static _rescaleAndSwap(t,e,n,s,a,l){l||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)l[u]=e+t[u+1]*s,l[u+1]=n+t[u]*a;return l}static _translate(t,e,n,s){s||=new Float32Array(t.length);for(let a=0,l=t.length;a<l;a+=2)s[a]=e+t[a],s[a+1]=n+t[a+1];return s}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,n,s,a){switch(a){case 90:return[1-e/n,t/s];case 180:return[1-t/n,1-e/s];case 270:return[e/n,1-t/s];default:return[t/n,e/s]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,s,a,l){return[(t+5*n)/6,(e+5*s)/6,(5*n+a)/6,(5*s+l)/6,(n+a)/2,(s+l)/2]}}class sr{#t;#e=[];#i;#n;#a=[];#s=new Float32Array(18);#r;#o;#c;#l;#d;#h;#f=[];static#m=8;static#g=2;static#u=sr.#m+sr.#g;constructor({x:t,y:e},n,s,a,l,u=0){this.#t=n,this.#h=a*s,this.#n=l,this.#s.set([NaN,NaN,NaN,NaN,t,e],6),this.#i=u,this.#l=sr.#m*s,this.#c=sr.#u*s,this.#d=s,this.#f.push(t,e)}isEmpty(){return isNaN(this.#s[8])}#p(){const t=this.#s.subarray(4,6),e=this.#s.subarray(16,18),[n,s,a,l]=this.#t;return[(this.#r+(t[0]-e[0])/2-n)/a,(this.#o+(t[1]-e[1])/2-s)/l,(this.#r+(e[0]-t[0])/2-n)/a,(this.#o+(e[1]-t[1])/2-s)/l]}add({x:t,y:e}){this.#r=t,this.#o=e;const[n,s,a,l]=this.#t;let[u,d,f,g]=this.#s.subarray(8,12);const m=t-f,v=e-g,b=Math.hypot(m,v);if(b<this.#c)return!1;const S=b-this.#l,w=S/b,A=w*m,_=w*v;let E=u,x=d;u=f,d=g,f+=A,g+=_,this.#f?.push(t,e);const O=-_/S,C=A/S,D=O*this.#h,R=C*this.#h;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([f+D,g+R],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([f-D,g-R],16),isNaN(this.#s[6])?(this.#a.length===0&&(this.#s.set([u+D,d+R],2),this.#a.push(NaN,NaN,NaN,NaN,(u+D-n)/a,(d+R-s)/l),this.#s.set([u-D,d-R],14),this.#e.push(NaN,NaN,NaN,NaN,(u-D-n)/a,(d-R-s)/l)),this.#s.set([E,x,u,d,f,g],6),!this.isEmpty()):(this.#s.set([E,x,u,d,f,g],6),Math.abs(Math.atan2(x-d,E-u)-Math.atan2(_,A))<Math.PI/2?([u,d,f,g]=this.#s.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((u+f)/2-n)/a,((d+g)/2-s)/l),[u,d,E,x]=this.#s.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((E+u)/2-n)/a,((x+d)/2-s)/l),!0):([E,x,u,d,f,g]=this.#s.subarray(0,6),this.#a.push(((E+5*u)/6-n)/a,((x+5*d)/6-s)/l,((5*u+f)/6-n)/a,((5*d+g)/6-s)/l,((u+f)/2-n)/a,((d+g)/2-s)/l),[f,g,u,d,E,x]=this.#s.subarray(12,18),this.#e.push(((E+5*u)/6-n)/a,((x+5*d)/6-s)/l,((5*u+f)/6-n)/a,((5*d+g)/6-s)/l,((u+f)/2-n)/a,((d+g)/2-s)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#a,e=this.#e;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#y();const n=[];n.push(`M${t[4]} ${t[5]}`);for(let s=6;s<t.length;s+=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);this.#v(n);for(let s=e.length-6;s>=6;s-=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);return this.#b(n),n.join(" ")}#y(){const[t,e,n,s]=this.#t,[a,l,u,d]=this.#p();return`M${(this.#s[2]-t)/n} ${(this.#s[3]-e)/s} L${(this.#s[4]-t)/n} ${(this.#s[5]-e)/s} L${a} ${l} L${u} ${d} L${(this.#s[16]-t)/n} ${(this.#s[17]-e)/s} L${(this.#s[14]-t)/n} ${(this.#s[15]-e)/s} Z`}#b(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#v(t){const[e,n,s,a]=this.#t,l=this.#s.subarray(4,6),u=this.#s.subarray(16,18),[d,f,g,m]=this.#p();t.push(`L${(l[0]-e)/s} ${(l[1]-n)/a} L${d} ${f} L${g} ${m} L${(u[0]-e)/s} ${(u[1]-n)/a}`)}newFreeDrawOutline(t,e,n,s,a,l){return new x_(t,e,n,s,a,l)}getOutlines(){const t=this.#a,e=this.#e,n=this.#s,[s,a,l,u]=this.#t,d=new Float32Array((this.#f?.length??0)+2);for(let m=0,v=d.length-2;m<v;m+=2)d[m]=(this.#f[m]-s)/l,d[m+1]=(this.#f[m+1]-a)/u;if(d[d.length-2]=(this.#r-s)/l,d[d.length-1]=(this.#o-a)/u,isNaN(n[6])&&!this.isEmpty())return this.#T(d);const f=new Float32Array(this.#a.length+24+this.#e.length);let g=t.length;for(let m=0;m<g;m+=2){if(isNaN(t[m])){f[m]=f[m+1]=NaN;continue}f[m]=t[m],f[m+1]=t[m+1]}g=this.#w(f,g);for(let m=e.length-6;m>=6;m-=6)for(let v=0;v<6;v+=2){if(isNaN(e[m+v])){f[g]=f[g+1]=NaN,g+=2;continue}f[g]=e[m+v],f[g+1]=e[m+v+1],g+=2}return this.#A(f,g),this.newFreeDrawOutline(f,d,this.#t,this.#d,this.#i,this.#n)}#T(t){const e=this.#s,[n,s,a,l]=this.#t,[u,d,f,g]=this.#p(),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(e[2]-n)/a,(e[3]-s)/l,NaN,NaN,NaN,NaN,(e[4]-n)/a,(e[5]-s)/l,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,(e[16]-n)/a,(e[17]-s)/l,NaN,NaN,NaN,NaN,(e[14]-n)/a,(e[15]-s)/l],0),this.newFreeDrawOutline(m,t,this.#t,this.#d,this.#i,this.#n)}#A(t,e){const n=this.#e;return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6}#w(t,e){const n=this.#s.subarray(4,6),s=this.#s.subarray(16,18),[a,l,u,d]=this.#t,[f,g,m,v]=this.#p();return t.set([NaN,NaN,NaN,NaN,(n[0]-a)/u,(n[1]-l)/d,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,m,v,NaN,NaN,NaN,NaN,(s[0]-a)/u,(s[1]-l)/d],e),e+=24}}class x_ extends ct{#t;#e=new Float32Array(4);#i;#n;#a;#s;#r;constructor(t,e,n,s,a,l){super(),this.#r=t,this.#a=e,this.#t=n,this.#s=s,this.#i=a,this.#n=l,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(l);const[u,d,f,g]=this.#e;for(let m=0,v=t.length;m<v;m+=2)t[m]=(t[m]-u)/f,t[m+1]=(t[m+1]-d)/g;for(let m=0,v=e.length;m<v;m+=2)e[m]=(e[m]-u)/f,e[m+1]=(e[m+1]-d)/g}toSVGPath(){const t=[`M${this.#r[4]} ${this.#r[5]}`];for(let e=6,n=this.#r.length;e<n;e+=6){if(isNaN(this.#r[e])){t.push(`L${this.#r[e+4]} ${this.#r[e+5]}`);continue}t.push(`C${this.#r[e]} ${this.#r[e+1]} ${this.#r[e+2]} ${this.#r[e+3]} ${this.#r[e+4]} ${this.#r[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,n,s],a){const l=n-t,u=s-e;let d,f;switch(a){case 0:d=ct._rescale(this.#r,t,s,l,-u),f=ct._rescale(this.#a,t,s,l,-u);break;case 90:d=ct._rescaleAndSwap(this.#r,t,e,l,u),f=ct._rescaleAndSwap(this.#a,t,e,l,u);break;case 180:d=ct._rescale(this.#r,n,e,-l,u),f=ct._rescale(this.#a,n,e,-l,u);break;case 270:d=ct._rescaleAndSwap(this.#r,n,s,-l,-u),f=ct._rescaleAndSwap(this.#a,n,s,-l,-u);break}return{outline:Array.from(d),points:[Array.from(f)]}}#o(t){const e=this.#r;let n=e[4],s=e[5];const a=[n,s,n,s];let l=n,u=s,d=n,f=s;const g=t?Math.max:Math.min,m=new Float32Array(4);for(let b=6,S=e.length;b<S;b+=6){const w=e[b+4],A=e[b+5];isNaN(e[b])?(ut.pointBoundingBox(w,A,a),u>A?(l=w,u=A):u===A&&(l=g(l,w)),f<A?(d=w,f=A):f===A&&(d=g(d,w))):(m[0]=m[1]=1/0,m[2]=m[3]=-1/0,ut.bezierBoundingBox(n,s,...e.slice(b,b+6),m),ut.rectBoundingBox(m[0],m[1],m[2],m[3],a),u>m[1]?(l=m[0],u=m[1]):u===m[1]&&(l=g(l,m[0])),f<m[3]?(d=m[2],f=m[3]):f===m[3]&&(d=g(d,m[2]))),n=w,s=A}const v=this.#e;v[0]=a[0]-this.#i,v[1]=a[1]-this.#i,v[2]=a[2]-a[0]+2*this.#i,v[3]=a[3]-a[1]+2*this.#i,this.firstPoint=[l,u],this.lastPoint=[d,f]}get box(){return this.#e}newOutliner(t,e,n,s,a,l=0){return new sr(t,e,n,s,a,l)}getNewOutline(t,e){const[n,s,a,l]=this.#e,[u,d,f,g]=this.#t,m=a*f,v=l*g,b=n*f+u,S=s*g+d,w=this.newOutliner({x:this.#a[0]*m+b,y:this.#a[1]*v+S},this.#t,this.#s,t,this.#n,e??this.#i);for(let A=2;A<this.#a.length;A+=2)w.add({x:this.#a[A]*m+b,y:this.#a[A+1]*v+S});return w.getOutlines()}}class Qf{#t;#e;#i;#n=[];#a=[];constructor(t,e=0,n=0,s=!0){const a=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:w,y:A,width:_,height:E}of t){const x=Math.floor((w-e)/l)*l,O=Math.ceil((w+_+e)/l)*l,C=Math.floor((A-e)/l)*l,D=Math.ceil((A+E+e)/l)*l,R=[x,C,D,!0],k=[O,C,D,!1];this.#n.push(R,k),ut.rectBoundingBox(x,C,O,D,a)}const u=a[2]-a[0]+2*n,d=a[3]-a[1]+2*n,f=a[0]-n,g=a[1]-n;let m=s?-1/0:1/0,v=1/0;const b=this.#n.at(s?-1:-2),S=[b[0],b[2]];for(const w of this.#n){const[A,_,E,x]=w;!x&&s?_<v?(v=_,m=A):_===v&&(m=Math.max(m,A)):x&&!s&&(_<v?(v=_,m=A):_===v&&(m=Math.min(m,A))),w[0]=(A-f)/u,w[1]=(_-g)/d,w[2]=(E-g)/d}this.#t=new Float32Array([f,g,u,d]),this.#e=[m,v],this.#i=S}getOutlines(){this.#n.sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#s(t)}#s(t){const e=[],n=new Set;for(const l of t){const[u,d,f]=l;e.push([u,d,l],[u,f,l])}e.sort((l,u)=>l[1]-u[1]||l[0]-u[0]);for(let l=0,u=e.length;l<u;l+=2){const d=e[l][2],f=e[l+1][2];d.push(f),f.push(d),n.add(d),n.add(f)}const s=[];let a;for(;n.size>0;){const l=n.values().next().value;let[u,d,f,g,m]=l;n.delete(l);let v=u,b=d;for(a=[u,f],s.push(a);;){let S;if(n.has(g))S=g;else if(n.has(m))S=m;else break;n.delete(S),[u,d,f,g,m]=S,v!==u&&(a.push(v,b,u,b===d?d:f),v=u),b=b===d?f:d}a.push(v,b)}return new YR(s,this.#t,this.#e,this.#i)}#r(t){const e=this.#a;let n=0,s=e.length-1;for(;n<=s;){const a=n+s>>1,l=e[a][0];if(l===t)return a;l<t?n=a+1:s=a-1}return s+1}#o([,t,e]){const n=this.#r(t);this.#a.splice(n,0,[t,e])}#c([,t,e]){const n=this.#r(t);for(let s=n;s<this.#a.length;s++){const[a,l]=this.#a[s];if(a!==t)break;if(a===t&&l===e){this.#a.splice(s,1);return}}for(let s=n-1;s>=0;s--){const[a,l]=this.#a[s];if(a!==t)break;if(a===t&&l===e){this.#a.splice(s,1);return}}}#l(t){const[e,n,s]=t,a=[[e,n,s]],l=this.#r(s);for(let u=0;u<l;u++){const[d,f]=this.#a[u];for(let g=0,m=a.length;g<m;g++){const[,v,b]=a[g];if(!(f<=v||b<=d)){if(v>=d){if(b>f)a[g][1]=f;else{if(m===1)return[];a.splice(g,1),g--,m--}continue}a[g][2]=d,b>f&&a.push([e,f,b])}}}return a}}class YR extends ct{#t;#e;constructor(t,e,n,s){super(),this.#e=t,this.#t=e,this.firstPoint=n,this.lastPoint=s}toSVGPath(){const t=[];for(const e of this.#e){let[n,s]=e;t.push(`M${n} ${s}`);for(let a=2;a<e.length;a+=2){const l=e[a],u=e[a+1];l===n?(t.push(`V${u}`),s=u):u===s&&(t.push(`H${l}`),n=l)}t.push("Z")}return t.join(" ")}serialize([t,e,n,s],a){const l=[],u=n-t,d=s-e;for(const f of this.#e){const g=new Array(f.length);for(let m=0;m<f.length;m+=2)g[m]=t+f[m]*u,g[m+1]=s-f[m+1]*d;l.push(g)}return l}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Zf extends sr{newFreeDrawOutline(t,e,n,s,a,l){return new WR(t,e,n,s,a,l)}}class WR extends x_{newOutliner(t,e,n,s,a,l=0){return new Zf(t,e,n,s,a,l)}}class Se extends pt{#t=null;#e=0;#i;#n=null;#a=null;#s=null;#r=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#m=null;#g=null;#u="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Et.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=Se.prototype;return Ct(this,"_keyboardManager",new bl([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||Se._defaultColor,this.#p=t.thickness||Se._defaultThickness,this.opacity=t.opacity||Se._defaultOpacity,this.#i=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#v(t),this.#S()):this.#i&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#r=t.focusNode,this.#o=t.focusOffset,this.#b(),this.#S(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#b(){const t=new Qf(this.#i,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new Qf(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#s=e.getOutlines();const{firstPoint:n}=this.#l;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height];const{lastPoint:s}=this.#s;this.#m=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#v({highlightOutlines:t,highlightId:e,clipPathId:n}){this.#l=t;const s=1.5;if(this.#s=t.getNewOutline(this.#p/2+s,.0025),e>=0)this.#d=e,this.#n=n,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:Se.#E(this.#l.box,(m-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:Se.#E(this.#s.box,m),path:{d:this.#s.toSVGPath()}})}const[a,l,u,d]=t.box;switch(this.rotation){case 0:this.x=a,this.y=l,this.width=u,this.height=d;break;case 90:{const[m,v]=this.parentDimensions;this.x=l,this.y=1-a,this.width=u*v/m,this.height=d*m/v;break}case 180:this.x=1-a,this.y=1-l,this.width=u,this.height=d;break;case 270:{const[m,v]=this.parentDimensions;this.x=1-l,this.y=a,this.width=u*v/m,this.height=d*m/v;break}}const{firstPoint:f}=t;this.#f=[(f[0]-a)/u,(f[1]-l)/d];const{lastPoint:g}=this.#s;this.#m=[(g[0]-a)/u,(g[1]-l)/d]}static initialize(t,e){pt.initialize(t,e),Se._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case Nt.HIGHLIGHT_COLOR:Se._defaultColor=e;break;case Nt.HIGHLIGHT_THICKNESS:Se._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case Nt.HIGHLIGHT_COLOR:this.#T(e);break;case Nt.HIGHLIGHT_THICKNESS:this.#A(e);break}}static get defaultPropertiesToUpdate(){return[[Nt.HIGHLIGHT_COLOR,Se._defaultColor],[Nt.HIGHLIGHT_THICKNESS,Se._defaultThickness]]}get propertiesToUpdate(){return[[Nt.HIGHLIGHT_COLOR,this.color||Se._defaultColor],[Nt.HIGHLIGHT_THICKNESS,this.#p||Se._defaultThickness],[Nt.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#T(t){const e=(a,l)=>{this.color=a,this.opacity=l,this.onUpdatedColor()},n=this.color,s=this.opacity;this.addCommands({cmd:e.bind(this,t,Se._defaultOpacity),undo:e.bind(this,n,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#A(t){const e=this.#p,n=s=>{this.#p=s,this.#w(s)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Nt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new Cn({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#S(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#C():t&&(this.#S(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#w(t){this.#h&&(this.#v({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#S(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#n}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#g=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#n))}static#E([t,e,n,s],a){switch(a){case 90:return[1-e-s,t,s,n];case 180:return[1-t-n,1-e-s,n,s];case 270:return[e,1-t-n,s,n]}return[t,e,n,s]}rotate(t){const{drawLayer:e}=this.parent;let n;this.#h?(t=(t-this.rotation+360)%360,n=Se.#E(this.#l.box,t)):n=Se.#E([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:n,root:{"data-main-rotation":t}}),e.updateProperties(this.#g,{bbox:Se.#E(this.#s.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#O.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#n,this.setDims(this.width,this.height),t_(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#O(t){Se._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#R(!0);break;case 1:case 3:this.#R(!1);break}}#R(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#r,this.#o)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#h||this.#R(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!t}}))}#D(){return this.#h?this.rotation:0}#j(){if(this.#h)return null;const[t,e]=this.pageDimensions,[n,s]=this.pageTranslation,a=this.#i,l=new Float32Array(a.length*8);let u=0;for(const{x:d,y:f,width:g,height:m}of a){const v=d*t+n,b=(1-f)*e+s;l[u]=l[u+4]=v,l[u+1]=l[u+3]=b,l[u+2]=l[u+6]=v+g*t,l[u+5]=l[u+7]=b-m*e,u+=8}return l}#k(t){return this.#l.serialize(t,this.#D())}static startHighlighting(t,e,{target:n,x:s,y:a}){const{x:l,y:u,width:d,height:f}=n.getBoundingClientRect(),g=new AbortController,m=t.combinedSignal(g),v=b=>{g.abort(),this.#I(t,b)};window.addEventListener("blur",v,{signal:m}),window.addEventListener("pointerup",v,{signal:m}),window.addEventListener("pointerdown",de,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Mn,{signal:m}),n.addEventListener("pointermove",this.#N.bind(this,t),{signal:m}),this._freeHighlight=new Zf({x:s,y:a},[l,u,d,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#N(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#I(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,n){let s=null;if(t instanceof A_){const{data:{quadPoints:S,rect:w,rotation:A,id:_,color:E,opacity:x,popupRef:O,richText:C,contentsObj:D,creationDate:R,modificationDate:k},parent:{page:{pageNumber:L}}}=t;s=t={annotationType:Et.HIGHLIGHT,color:Array.from(E),opacity:x,quadPoints:S,boxes:null,pageIndex:L-1,rect:w.slice(0),rotation:A,annotationElementId:_,id:_,deleted:!1,popupRef:O,richText:C,comment:D?.str||null,creationDate:R,modificationDate:k}}else if(t instanceof Fg){const{data:{inkLists:S,rect:w,rotation:A,id:_,color:E,borderStyle:{rawWidth:x},popupRef:O,richText:C,contentsObj:D,creationDate:R,modificationDate:k},parent:{page:{pageNumber:L}}}=t;s=t={annotationType:Et.HIGHLIGHT,color:Array.from(E),thickness:x,inkLists:S,boxes:null,pageIndex:L-1,rect:w.slice(0),rotation:A,annotationElementId:_,id:_,deleted:!1,popupRef:O,richText:C,comment:D?.str||null,creationDate:R,modificationDate:k}}const{color:a,quadPoints:l,inkLists:u,opacity:d}=t,f=await super.deserialize(t,e,n);f.color=ut.makeHexColor(...a),f.opacity=d||1,u&&(f.#p=t.thickness),f._initialData=s,t.comment&&f.setCommentData(t);const[g,m]=f.pageDimensions,[v,b]=f.pageTranslation;if(l){const S=f.#i=[];for(let w=0;w<l.length;w+=8)S.push({x:(l[w]-v)/g,y:1-(l[w+1]-b)/m,width:(l[w+2]-l[w])/g,height:(l[w+1]-l[w+5])/m});f.#b(),f.#S(),f.rotate(f.rotation)}else if(u){f.#h=!0;const S=u[0],w={x:S[0]-v,y:m-(S[1]-b)},A=new Zf(w,[0,0,g,m],1,f.#p/2,!0,.001);for(let x=0,O=S.length;x<O;x+=2)w.x=S[x]-v,w.y=m-(S[x+1]-b),A.add(w);const{id:_,clipPathId:E}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:A.toSVGPath()}},!0,!0);f.#v({highlightOutlines:A.getOutlines(),highlightId:_,clipPathId:E}),f.#S(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=pt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(t);return Object.assign(n,{color:e,opacity:this.opacity,thickness:this.#p,quadPoints:this.#j(),outlines:this.#k(n.rect)}),this.addComment(n),this.annotationElementId&&!this.#L(n)?null:(n.id=this.annotationElementId,n)}#L(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((n,s)=>n!==e[s])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class C_{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,n)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Zt("Not implemented")}}class wt extends pt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#a=null;static#s=NaN;static#r=null;static#o=null;static#c=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#l(t),this.#f())}#l({drawOutlines:t,drawId:e,drawingOptions:n}){this.#t=t,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#u(t.box)}#d(t,e){const{id:n}=e.drawLayer.draw(wt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(t,e){const n=new Set(Object.keys(t));for(const[s,a]of Object.entries(e))n.has(s)?Object.assign(t[s],a):t[s]=a;return t}static getDefaultDrawingOptions(t){Zt("Not implemented")}static get typesMap(){Zt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,e),this._currentParent&&(wt.#i.updateProperty(n,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[n,s]of this.typesMap)t.push([n,e[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[n,s]of this.constructor.typesMap)t.push([n,e[s]]);return t}_updateProperty(t,e,n){const s=this._drawingOptions,a=s[e],l=u=>{s.updateProperty(e,u);const d=this.#t.updateProperty(e,u);d&&this.#u(d),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,n),undo:l.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#g()),{bbox:this.#p()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#g()),{bbox:this.#p()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#p()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#g(),this.parentDimensions),{bbox:this.#p()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#h(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#u(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#h()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#h(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#m([t,e,n,s]){const{parentDimensions:[a,l],rotation:u}=this;switch(u){case 90:return[e,1-t,n*(l/a),s*(a/l)];case 180:return[1-t,1-e,n,s];case 270:return[1-e,t,n*(l/a),s*(a/l)];default:return[t,e,n,s]}}#g(){const{x:t,y:e,width:n,height:s,parentDimensions:[a,l],rotation:u}=this;switch(u){case 90:return[1-e,t,n*(a/l),s*(l/a)];case 180:return[1-t,1-e,n,s];case 270:return[e,1-t,n*(a/l),s*(l/a)];default:return[t,e,n,s]}}#u(t){[this.x,this.y,this.width,this.height]=this.#m(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#p(){const{x:t,y:e,width:n,height:s,rotation:a,parentRotation:l,parentDimensions:[u,d]}=this;switch((a*4+l)/90){case 1:return[1-e-s,t,s,n];case 2:return[1-t-n,1-e-s,n,s];case 3:return[e,1-t-n,s,n];case 4:return[t,e-n*(u/d),s*(d/u),n*(u/d)];case 5:return[1-e,t,n*(u/d),s*(d/u)];case 6:return[1-t-s*(d/u),1-e,s*(d/u),n*(u/d)];case 7:return[e-n*(u/d),1-t-s*(d/u),n*(u/d),s*(d/u)];case 8:return[t-n,e-s,n,s];case 9:return[1-e,t-n,s,n];case 10:return[1-t,1-e,n,s];case 11:return[e-s,1-t,s,n];case 12:return[t-s*(d/u),e,s*(d/u),n*(u/d)];case 13:return[1-e-n*(u/d),t-s*(d/u),n*(u/d),s*(d/u)];case 14:return[1-t,1-e-n*(u/d),s*(d/u),n*(u/d)];case 15:return[e,1-t,n*(u/d),s*(d/u)];default:return[t,e,n,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,wt._mergeSVGProperties({bbox:this.#p()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#u(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const n=super.render();n.classList.add("draw");const s=document.createElement("div");return n.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),n}static createDrawerInstance(t,e,n,s,a){Zt("Not implemented")}static startDrawing(t,e,n,s){const{target:a,offsetX:l,offsetY:u,pointerId:d,pointerType:f}=s;if(wt.#r&&wt.#r!==f)return;const{viewport:{rotation:g}}=t,{width:m,height:v}=a.getBoundingClientRect(),b=wt.#n=new AbortController,S=t.combinedSignal(b);if(wt.#s||=d,wt.#r??=f,window.addEventListener("pointerup",w=>{wt.#s===w.pointerId?this._endDraw(w):wt.#o?.delete(w.pointerId)},{signal:S}),window.addEventListener("pointercancel",w=>{wt.#s===w.pointerId?this._currentParent.endDrawingSession():wt.#o?.delete(w.pointerId)},{signal:S}),window.addEventListener("pointerdown",w=>{wt.#r===w.pointerType&&((wt.#o||=new Set).add(w.pointerId),wt.#i.isCancellable()&&(wt.#i.removeLastElement(),wt.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:S}),window.addEventListener("contextmenu",Mn,{signal:S}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:S}),a.addEventListener("touchmove",w=>{w.timeStamp===wt.#c&&de(w)},{signal:S}),t.toggleDrawing(),e._editorUndoBar?.hide(),wt.#i){t.drawLayer.updateProperties(this._currentDrawId,wt.#i.startNew(l,u,m,v,g));return}e.updateUIForDefaultProperties(this),wt.#i=this.createDrawerInstance(l,u,m,v,g),wt.#a=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(wt.#a.toSVGProperties(),wt.#i.defaultSVGProperties),!0,!1)}static _drawMove(t){if(wt.#c=-1,!wt.#i)return;const{offsetX:e,offsetY:n,pointerId:s}=t;if(wt.#s===s){if(wt.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,wt.#i.add(e,n)),wt.#c=t.timeStamp,de(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,wt.#i=null,wt.#a=null,wt.#r=null,wt.#c=NaN),wt.#n&&(wt.#n.abort(),wt.#n=null,wt.#s=NaN,wt.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,wt.#i.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const n=wt.#i,s=this._currentDrawId,a=n.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(s,n.setLastElement(a))},undo:()=>{e.drawLayer.updateProperties(s,n.removeLastElement())},mustExec:!1,type:Nt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(Nt.DRAW_STEP),!wt.#i.isEmpty()){const{pageDimensions:[n,s],scale:a}=e,l=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:wt.#i.getOutlines(n*a,s*a,a,this._INNER_MARGIN),drawingOptions:wt.#a,mustBeCommitted:!t});return this._cleanup(!0),l}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,n,s,a,l){Zt("Not implemented")}static async deserialize(t,e,n){const{rawDims:{pageWidth:s,pageHeight:a,pageX:l,pageY:u}}=e.viewport,d=this.deserializeDraw(l,u,s,a,this._INNER_MARGIN,t),f=await super.deserialize(t,e,n);return f.createDrawingOptions(t),f.#l({drawOutlines:d}),f.#f(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,n]=this.pageTranslation,[s,a]=this.pageDimensions;return this.#t.serialize([e,n,s,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class KR{#t=new Float64Array(6);#e;#i;#n;#a;#s;#r="";#o=0;#c=new Sl;#l;#d;constructor(t,e,n,s,a,l){this.#l=n,this.#d=s,this.#n=a,this.#a=l,[t,e]=this.#h(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#s=[t,e],this.#i=[{line:u,points:this.#s}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#a=e)}#h(t,e){return ct._normalizePoint(t,e,this.#l,this.#d,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#s.length<=10}add(t,e){[t,e]=this.#h(t,e);const[n,s,a,l]=this.#t.subarray(2,6),u=t-a,d=e-l;return Math.hypot(this.#l*u,this.#d*d)<=2?null:(this.#s.push(t,e),isNaN(n)?(this.#t.set([a,l,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([n,s,a,l,t,e],0),this.#e.push(...ct.createBezierPoints(n,s,a,l,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const n=this.add(t,e);return n||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,s,a){this.#l=n,this.#d=s,this.#n=a,[t,e]=this.#h(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#s=[t,e];const u=this.#i.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#i.push({line:l,points:this.#s}),this.#t.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(t){return this.#i?(this.#i.push(t),this.#e=t.line,this.#s=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#r="";for(let t=0,e=this.#i.length;t<e;t++){const{line:n,points:s}=this.#i[t];this.#e=n,this.#s=s,this.#o=0,this.toSVGPath()}return{path:{d:this.#r}}}toSVGPath(){const t=ct.svgRound(this.#e[4]),e=ct.svgRound(this.#e[5]);if(this.#s.length===2)return this.#r=`${this.#r} M ${t} ${e} Z`,this.#r;if(this.#s.length<=6){const s=this.#r.lastIndexOf("M");this.#r=`${this.#r.slice(0,s)} M ${t} ${e}`,this.#o=6}if(this.#s.length===4){const s=ct.svgRound(this.#e[10]),a=ct.svgRound(this.#e[11]);return this.#r=`${this.#r} L ${s} ${a}`,this.#o=12,this.#r}const n=[];this.#o===0&&(n.push(`M ${t} ${e}`),this.#o=6);for(let s=this.#o,a=this.#e.length;s<a;s+=6){const[l,u,d,f,g,m]=this.#e.slice(s,s+6).map(ct.svgRound);n.push(`C${l} ${u} ${d} ${f} ${g} ${m}`)}return this.#r+=n.join(" "),this.#o=this.#e.length,this.#r}getOutlines(t,e,n,s){const a=this.#i.at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),this.#c.build(this.#i,t,e,n,this.#n,this.#a,s),this.#t=null,this.#e=null,this.#i=null,this.#r=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Sl extends ct{#t;#e=0;#i;#n;#a;#s;#r;#o;#c;build(t,e,n,s,a,l,u){this.#a=e,this.#s=n,this.#r=s,this.#o=a,this.#c=l,this.#i=u??0,this.#n=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#n.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#n){if(t.push(`M${ct.svgRound(e[4])} ${ct.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${ct.svgRound(e[10])} ${ct.svgRound(e[11])}`);continue}for(let n=6,s=e.length;n<s;n+=6){const[a,l,u,d,f,g]=e.subarray(n,n+6).map(ct.svgRound);t.push(`C${a} ${l} ${u} ${d} ${f} ${g}`)}}return t.join("")}serialize([t,e,n,s],a){const l=[],u=[],[d,f,g,m]=this.#d();let v,b,S,w,A,_,E,x,O;switch(this.#o){case 0:O=ct._rescale,v=t,b=e+s,S=n,w=-s,A=t+d*n,_=e+(1-f-m)*s,E=t+(d+g)*n,x=e+(1-f)*s;break;case 90:O=ct._rescaleAndSwap,v=t,b=e,S=n,w=s,A=t+f*n,_=e+d*s,E=t+(f+m)*n,x=e+(d+g)*s;break;case 180:O=ct._rescale,v=t+n,b=e,S=-n,w=s,A=t+(1-d-g)*n,_=e+f*s,E=t+(1-d)*n,x=e+(f+m)*s;break;case 270:O=ct._rescaleAndSwap,v=t+n,b=e+s,S=-n,w=-s,A=t+(1-f-m)*n,_=e+(1-d-g)*s,E=t+(1-f)*n,x=e+(1-d)*s;break}for(const{line:C,points:D}of this.#n)l.push(O(C,v,b,S,w,a?new Array(C.length):null)),u.push(O(D,v,b,S,w,a?new Array(D.length):null));return{lines:l,points:u,rect:[A,_,E,x]}}static deserialize(t,e,n,s,a,{paths:{lines:l,points:u},rotation:d,thickness:f}){const g=[];let m,v,b,S,w;switch(d){case 0:w=ct._rescale,m=-t/n,v=e/s+1,b=1/n,S=-1/s;break;case 90:w=ct._rescaleAndSwap,m=-e/s,v=-t/n,b=1/s,S=1/n;break;case 180:w=ct._rescale,m=t/n+1,v=-e/s,b=-1/n,S=1/s;break;case 270:w=ct._rescaleAndSwap,m=e/s+1,v=t/n+1,b=-1/s,S=-1/n;break}if(!l){l=[];for(const _ of u){const E=_.length;if(E===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,_[0],_[1]]));continue}if(E===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,_[0],_[1],NaN,NaN,NaN,NaN,_[2],_[3]]));continue}const x=new Float32Array(3*(E-2));l.push(x);let[O,C,D,R]=_.subarray(0,4);x.set([NaN,NaN,NaN,NaN,O,C],0);for(let k=4;k<E;k+=2){const L=_[k],V=_[k+1];x.set(ct.createBezierPoints(O,C,D,R,L,V),(k-2)*3),[O,C,D,R]=[D,R,L,V]}}}for(let _=0,E=l.length;_<E;_++)g.push({line:w(l[_].map(x=>x??NaN),m,v,b,S),points:w(u[_].map(x=>x??NaN),m,v,b,S)});const A=new this.prototype.constructor;return A.build(g,n,s,1,d,f,a),A}#l(t=this.#c){const e=this.#i+t/2*this.#r;return this.#o%180===0?[e/this.#a,e/this.#s]:[e/this.#s,e/this.#a]}#d(){const[t,e,n,s]=this.#t,[a,l]=this.#l(0);return[t+a,e+l,n-2*a,s-2*l]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#n){if(s.length<=12){for(let u=4,d=s.length;u<d;u+=6)ut.pointBoundingBox(s[u],s[u+1],t);continue}let a=s[4],l=s[5];for(let u=6,d=s.length;u<d;u+=6){const[f,g,m,v,b,S]=s.subarray(u,u+6);ut.bezierBoundingBox(a,l,f,g,m,v,b,S,t),a=b,l=S}}const[e,n]=this.#l();t[0]=Je(t[0]-e,0,1),t[1]=Je(t[1]-n,0,1),t[2]=Je(t[2]+e,0,1),t[3]=Je(t[3]+n,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,n]=this.#l();this.#c=t;const[s,a]=this.#l(),[l,u]=[s-e,a-n],d=this.#t;return d[0]-=l,d[1]-=u,d[2]+=2*l,d[3]+=2*u,d}updateParentDimensions([t,e],n){const[s,a]=this.#l();this.#a=t,this.#s=e,this.#r=n;const[l,u]=this.#l(),d=l-s,f=u-a,g=this.#t;return g[0]-=d,g[1]-=f,g[2]+=2*d,g[3]+=2*f,g}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(ct.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ct.svgRound(t)} ${ct.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let n=0,s=0,a=0,l=0,u=0,d=0;switch(this.#e){case 90:s=e/t,a=-t/e,u=t;break;case 180:n=-1,l=-1,u=t,d=e;break;case 270:s=-e/t,a=t/e,d=e;break;default:return""}return`matrix(${n} ${s} ${a} ${l} ${ct.svgRound(u)} ${ct.svgRound(d)})`}getPathResizingSVGProperties([t,e,n,s]){const[a,l]=this.#l(),[u,d,f,g]=this.#t;if(Math.abs(f-a)<=ct.PRECISION||Math.abs(g-l)<=ct.PRECISION){const w=t+n/2-(u+f/2),A=e+s/2-(d+g/2);return{path:{"transform-origin":`${ct.svgRound(t)} ${ct.svgRound(e)}`,transform:`${this.rotationTransform} translate(${w} ${A})`}}}const m=(n-2*a)/(f-2*a),v=(s-2*l)/(g-2*l),b=f/n,S=g/s;return{path:{"transform-origin":`${ct.svgRound(u)} ${ct.svgRound(d)}`,transform:`${this.rotationTransform} scale(${b} ${S}) translate(${ct.svgRound(a)} ${ct.svgRound(l)}) scale(${m} ${v}) translate(${ct.svgRound(-a)} ${ct.svgRound(-l)})`}}}getPathResizedSVGProperties([t,e,n,s]){const[a,l]=this.#l(),u=this.#t,[d,f,g,m]=u;if(u[0]=t,u[1]=e,u[2]=n,u[3]=s,Math.abs(g-a)<=ct.PRECISION||Math.abs(m-l)<=ct.PRECISION){const A=t+n/2-(d+g/2),_=e+s/2-(f+m/2);for(const{line:E,points:x}of this.#n)ct._translate(E,A,_,E),ct._translate(x,A,_,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ct.svgRound(t)} ${ct.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(n-2*a)/(g-2*a),b=(s-2*l)/(m-2*l),S=-v*(d+a)+t+a,w=-b*(f+l)+e+l;if(v!==1||b!==1||S!==0||w!==0)for(const{line:A,points:_}of this.#n)ct._rescale(A,S,w,v,b,A),ct._rescale(_,S,w,v,b,_);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ct.svgRound(t)} ${ct.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],n){const[s,a]=n,l=this.#t,u=t-l[0],d=e-l[1];if(this.#a===s&&this.#s===a)for(const{line:f,points:g}of this.#n)ct._translate(f,u,d,f),ct._translate(g,u,d,g);else{const f=this.#a/s,g=this.#s/a;this.#a=s,this.#s=a;for(const{line:m,points:v}of this.#n)ct._rescale(m,u,d,f,g,m),ct._rescale(v,u,d,f,g,v);l[2]*=f,l[3]*=g}return l[0]=t,l[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ct.svgRound(t)} ${ct.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ct.svgRound(t[0])} ${ct.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class Pu extends C_{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:pt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new Pu(this._viewParameters);return t.updateAll(this),t}}class Hg extends wt{static _type="ink";static _editorType=Et.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){pt.initialize(t,e),this._defaultDrawingOptions=new Pu(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ct(this,"typesMap",new Map([[Nt.INK_THICKNESS,"stroke-width"],[Nt.INK_COLOR,"stroke"],[Nt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,n,s,a){return new KR(t,e,n,s,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,n,s,a,l){return Sl.deserialize(t,e,n,s,a,l)}static async deserialize(t,e,n){let s=null;if(t instanceof Fg){const{data:{inkLists:l,rect:u,rotation:d,id:f,color:g,opacity:m,borderStyle:{rawWidth:v},popupRef:b,richText:S,contentsObj:w,creationDate:A,modificationDate:_},parent:{page:{pageNumber:E}}}=t;s=t={annotationType:Et.INK,color:Array.from(g),thickness:v,opacity:m,paths:{points:l},boxes:null,pageIndex:E-1,rect:u.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:b,richText:S,comment:w?.str||null,creationDate:A,modificationDate:_}}const a=await super.deserialize(t,e,n);return a._initialData=s,t.comment&&a.setCommentData(t),a}get toolbarButtons(){return this._colorPicker||=new cl(this),[["colorPicker",this._colorPicker]]}get colorType(){return Nt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:n}=this;e.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:n}){this._drawingOptions=Hg.getDefaultDrawingOptions({stroke:ut.makeHexColor(...t),"stroke-width":e,"stroke-opacity":n})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:n}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":a,"stroke-width":l}}=this,u=Object.assign(super.serialize(t),{color:pt._colorManager.convert(s),opacity:a,thickness:l,paths:{lines:e,points:n}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:n,opacity:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,u)=>l!==e[u])||t.thickness!==n||t.opacity!==s||t.pageIndex!==a}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:n}=this.serializeDraw(!1);return t.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class Jf extends Sl{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const ru=8,zo=3;class nr{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,n,s){return n-=t,s-=e,n===0?s>0?0:4:n===1?s+6:2-s}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(t,e,n,s,a,l,u){const d=this.#e(n,s,a,l);for(let f=0;f<8;f++){const g=(-f+d-u+16)%8,m=this.#i[2*g],v=this.#i[2*g+1];if(t[(n+m)*e+(s+v)]!==0)return g}return-1}static#a(t,e,n,s,a,l,u){const d=this.#e(n,s,a,l);for(let f=0;f<8;f++){const g=(f+d+u+16)%8,m=this.#i[2*g],v=this.#i[2*g+1];if(t[(n+m)*e+(s+v)]!==0)return g}return-1}static#s(t,e,n,s){const a=t.length,l=new Int32Array(a);for(let g=0;g<a;g++)l[g]=t[g]<=s?1:0;for(let g=1;g<n-1;g++)l[g*e]=l[g*e+e-1]=0;for(let g=0;g<e;g++)l[g]=l[e*n-1-g]=0;let u=1,d;const f=[];for(let g=1;g<n-1;g++){d=1;for(let m=1;m<e-1;m++){const v=g*e+m,b=l[v];if(b===0)continue;let S=g,w=m;if(b===1&&l[v-1]===0)u+=1,w-=1;else if(b>=1&&l[v+1]===0)u+=1,w+=1,b>1&&(d=b);else{b!==1&&(d=Math.abs(b));continue}const A=[m,g],_=w===m+1,E={isHole:_,points:A,id:u,parent:0};f.push(E);let x;for(const q of f)if(q.id===d){x=q;break}x?x.isHole?E.parent=_?x.parent:d:E.parent=_?d:x.parent:E.parent=_?d:0;const O=this.#n(l,e,g,m,S,w,0);if(O===-1){l[v]=-u,l[v]!==1&&(d=Math.abs(l[v]));continue}let C=this.#i[2*O],D=this.#i[2*O+1];const R=g+C,k=m+D;S=R,w=k;let L=g,V=m;for(;;){const q=this.#a(l,e,L,V,S,w,1);C=this.#i[2*q],D=this.#i[2*q+1];const it=L+C,rt=V+D;A.push(rt,it);const st=L*e+V;if(l[st+1]===0?l[st]=-u:l[st]===1&&(l[st]=u),it===g&&rt===m&&L===R&&V===k){l[v]!==1&&(d=Math.abs(l[v]));break}else S=L,w=V,L=it,V=rt}}}return f}static#r(t,e,n,s){if(n-e<=4){for(let R=e;R<n-2;R+=2)s.push(t[R],t[R+1]);return}const a=t[e],l=t[e+1],u=t[n-4]-a,d=t[n-3]-l,f=Math.hypot(u,d),g=u/f,m=d/f,v=g*l-m*a,b=d/u,S=1/f,w=Math.atan(b),A=Math.cos(w),_=Math.sin(w),E=S*(Math.abs(A)+Math.abs(_)),x=S*(1-E+E**2),O=Math.max(Math.atan(Math.abs(_+A)*x),Math.atan(Math.abs(_-A)*x));let C=0,D=e;for(let R=e+2;R<n-2;R+=2){const k=Math.abs(v-g*t[R+1]+m*t[R]);k>C&&(D=R,C=k)}C>(f*O)**2?(this.#r(t,e,D+2,s),this.#r(t,D,n,s)):s.push(a,l)}static#o(t){const e=[],n=t.length;return this.#r(t,0,n,e),e.push(t[n-2],t[n-1]),e.length<=4?null:e}static#c(t,e,n,s,a,l){const u=new Float32Array(l**2),d=-2*s**2,f=l>>1;for(let w=0;w<l;w++){const A=(w-f)**2;for(let _=0;_<l;_++)u[w*l+_]=Math.exp((A+(_-f)**2)/d)}const g=new Float32Array(256),m=-2*a**2;for(let w=0;w<256;w++)g[w]=Math.exp(w**2/m);const v=t.length,b=new Uint8Array(v),S=new Uint32Array(256);for(let w=0;w<n;w++)for(let A=0;A<e;A++){const _=w*e+A,E=t[_];let x=0,O=0;for(let D=0;D<l;D++){const R=w+D-f;if(!(R<0||R>=n))for(let k=0;k<l;k++){const L=A+k-f;if(L<0||L>=e)continue;const V=t[R*e+L],q=u[D*l+k]*g[Math.abs(V-E)];x+=V*q,O+=q}}const C=b[_]=Math.round(x/O);S[C]++}return[b,S]}static#l(t){const e=new Uint32Array(256);for(const n of t)e[n]++;return e}static#d(t){const e=t.length,n=new Uint8ClampedArray(e>>2);let s=-1/0,a=1/0;for(let u=0,d=n.length;u<d;u++){const f=n[u]=t[u<<2];s=Math.max(s,f),a=Math.min(a,f)}const l=255/(s-a);for(let u=0,d=n.length;u<d;u++)n[u]=(n[u]-a)*l;return n}static#h(t){let e,n=-1/0,s=-1/0;const a=t.findIndex(d=>d!==0);let l=a,u=a;for(e=a;e<256;e++){const d=t[e];d>n&&(e-l>s&&(s=e-l,u=e-1),n=d,l=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:n,height:s}=t,{maxDim:a}=this.#t;let l=n,u=s;if(n>a||s>a){let v=n,b=s,S=Math.log2(Math.max(n,s)/a);const w=Math.floor(S);S=S===w?w-1:w;for(let _=0;_<S;_++){l=Math.ceil(v/2),u=Math.ceil(b/2);const E=new OffscreenCanvas(l,u);E.getContext("2d").drawImage(t,0,0,v,b,0,0,l,u),v=l,b=u,t!==e&&t.close(),t=E.transferToImageBitmap()}const A=Math.min(a/l,a/u);l=Math.round(l*A),u=Math.round(u*A)}const f=new OffscreenCanvas(l,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,l,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,l,u);const g=f.getImageData(0,0,l,u).data;return[this.#d(g),l,u]}static extractContoursFromText(t,{fontFamily:e,fontStyle:n,fontWeight:s},a,l,u,d){let f=new OffscreenCanvas(1,1),g=f.getContext("2d",{alpha:!1});const m=200,v=g.font=`${n} ${s} ${m}px ${e}`,{actualBoundingBoxLeft:b,actualBoundingBoxRight:S,actualBoundingBoxAscent:w,actualBoundingBoxDescent:A,fontBoundingBoxAscent:_,fontBoundingBoxDescent:E,width:x}=g.measureText(t),O=1.5,C=Math.ceil(Math.max(Math.abs(b)+Math.abs(S)||0,x)*O),D=Math.ceil(Math.max(Math.abs(w)+Math.abs(A)||m,Math.abs(_)+Math.abs(E)||m)*O);f=new OffscreenCanvas(C,D),g=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),g.font=v,g.filter="grayscale(1)",g.fillStyle="white",g.fillRect(0,0,C,D),g.fillStyle="black",g.fillText(t,C*(O-1)/2,D*(3-O)/2);const R=this.#d(g.getImageData(0,0,C,D).data),k=this.#l(R),L=this.#h(k),V=this.#s(R,C,D,L);return this.processDrawnLines({lines:{curves:V,width:C,height:D},pageWidth:a,pageHeight:l,rotation:u,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(t,e,n,s,a){const[l,u,d]=this.#f(t),[f,g]=this.#c(l,u,d,Math.hypot(u,d)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),m=this.#h(g),v=this.#s(f,u,d,m);return this.processDrawnLines({lines:{curves:v,width:u,height:d},pageWidth:e,pageHeight:n,rotation:s,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:s,innerMargin:a,mustSmooth:l,areContours:u}){s%180!==0&&([e,n]=[n,e]);const{curves:d,width:f,height:g}=t,m=t.thickness??0,v=[],b=Math.min(e/f,n/g),S=b/e,w=b/n,A=[];for(const{points:E}of d){const x=l?this.#o(E):E;if(!x)continue;A.push(x);const O=x.length,C=new Float32Array(O),D=new Float32Array(3*(O===2?2:O-2));if(v.push({line:D,points:C}),O===2){C[0]=x[0]*S,C[1]=x[1]*w,D.set([NaN,NaN,NaN,NaN,C[0],C[1]],0);continue}let[R,k,L,V]=x;R*=S,k*=w,L*=S,V*=w,C.set([R,k,L,V],0),D.set([NaN,NaN,NaN,NaN,R,k],0);for(let q=4;q<O;q+=2){const it=C[q]=x[q]*S,rt=C[q+1]=x[q+1]*w;D.set(ct.createBezierPoints(R,k,L,V,it,rt),(q-2)*3),[R,k,L,V]=[L,V,it,rt]}}if(v.length===0)return null;const _=u?new Jf:new Sl;return _.build(v,e,n,1,s,u?0:m,a),{outline:_,newCurves:A,areContours:u,thickness:m,width:f,height:g}}static async compressSignature({outlines:t,areContours:e,thickness:n,width:s,height:a}){let l=1/0,u=-1/0,d=0;for(const x of t){d+=x.length;for(let O=2,C=x.length;O<C;O++){const D=x[O]-x[O-2];l=Math.min(l,D),u=Math.max(u,D)}}let f;l>=-128&&u<=127?f=Int8Array:l>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const g=t.length,m=ru+zo*g,v=new Uint32Array(m);let b=0;v[b++]=m*Uint32Array.BYTES_PER_ELEMENT+(d-2*g)*f.BYTES_PER_ELEMENT,v[b++]=0,v[b++]=s,v[b++]=a,v[b++]=e?0:1,v[b++]=Math.max(0,Math.floor(n??0)),v[b++]=g,v[b++]=f.BYTES_PER_ELEMENT;for(const x of t)v[b++]=x.length-2,v[b++]=x[0],v[b++]=x[1];const S=new CompressionStream("deflate-raw"),w=S.writable.getWriter();await w.ready,w.write(v);const A=f.prototype.constructor;for(const x of t){const O=new A(x.length-2);for(let C=2,D=x.length;C<D;C++)O[C-2]=x[C]-x[C-2];w.write(O)}w.close();const _=await new Response(S.readable).arrayBuffer(),E=new Uint8Array(_);return Xw(E)}static async decompressSignature(t){try{const e=_C(t),{readable:n,writable:s}=new DecompressionStream("deflate-raw"),a=s.getWriter();await a.ready,a.write(e).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let l=null,u=0;for await(const x of n)l||=new Uint8Array(new Uint32Array(x.buffer,0,4)[0]),l.set(x,u),u+=x.length;const d=new Uint32Array(l.buffer,0,l.length>>2),f=d[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const g=d[2],m=d[3],v=d[4]===0,b=d[5],S=d[6],w=d[7],A=[],_=(ru+zo*S)*Uint32Array.BYTES_PER_ELEMENT;let E;switch(w){case Int8Array.BYTES_PER_ELEMENT:E=new Int8Array(l.buffer,_);break;case Int16Array.BYTES_PER_ELEMENT:E=new Int16Array(l.buffer,_);break;case Int32Array.BYTES_PER_ELEMENT:E=new Int32Array(l.buffer,_);break}u=0;for(let x=0;x<S;x++){const O=d[zo*x+ru],C=new Float32Array(O+2);A.push(C);for(let D=0;D<zo-1;D++)C[D]=d[zo*x+ru+D+1];for(let D=0;D<O;D++)C[D+2]=C[D]+E[u++]}return{areContours:v,thickness:b,outlines:A,width:g,height:m}}catch(e){return Tt(`decompressSignature: ${e}`),null}}}class $g extends C_{constructor(){super(),super.updateProperties({fill:pt._defaultLineColor,"stroke-width":0})}clone(){const t=new $g;return t.updateAll(this),t}}class qg extends Pu{constructor(t){super(t),super.updateProperties({stroke:pt._defaultLineColor,"stroke-width":1})}clone(){const t=new qg(this._viewParameters);return t.updateAll(this),t}}class vi extends wt{#t=!1;#e=null;#i=null;#n=null;static _type="signature";static _editorType=Et.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){pt.initialize(t,e),this._defaultDrawingOptions=new $g,this._defaultDrawnSignatureOptions=new qg(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ct(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:s,mustSmooth:a,areContours:l,description:u,uuid:d,heightInPage:f}=this.#i,{rawDims:{pageWidth:g,pageHeight:m},rotation:v}=this.parent.viewport,b=nr.processDrawnLines({lines:s,pageWidth:g,pageHeight:m,rotation:v,innerMargin:vi._INNER_MARGIN,mustSmooth:a,areContours:l});this.addSignature(b,f,u,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#n=t,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:n,width:s,height:a}=this.#i,l=Math.max(s,a),u=nr.processDrawnLines({lines:{curves:t.map(d=>({points:d})),thickness:n,width:s,height:a},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,n,s){const{x:a,y:l}=this,{outline:u}=this.#i=t;this.#t=u instanceof Jf,this.description=n;let d;this.#t?d=vi.getDefaultDrawingOptions():(d=vi._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:d});const[,f]=this.pageDimensions;let g=e/f;g=g>=1?.5:g,this.width*=g/this.height,this.width>=1&&(g*=.9/this.width,this.width=.9),this.height=g,this.setDims(),this.x=a,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:s}=this.parent.viewport;return nr.process(t,e,n,s,vi._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:n,pageHeight:s},rotation:a}=this.parent.viewport;return nr.extractContoursFromText(t,e,n,s,a,vi._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:s}=this.parent.viewport;return nr.processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:s,innerMargin:vi._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=vi.getDefaultDrawingOptions():(this._drawingOptions=vi._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:n}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,a=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:s});return this.addComment(a),t?(a.paths={lines:e,points:n},a.uuid=this.#n,a.isCopy=!0):a.lines=e,this.#e&&(a.accessibilityData={type:"Figure",alt:this.#e}),a}static deserializeDraw(t,e,n,s,a,l){return l.areContours?Jf.deserialize(t,e,n,s,a,l):Sl.deserialize(t,e,n,s,a,l)}static async deserialize(t,e,n){const s=await super.deserialize(t,e,n);return s.#t=t.areContours,s.description=t.accessibilityData?.alt||"",s.#n=t.uuid,s}}class QR extends pt{#t=null;#e=null;#i=null;#n=null;#a=null;#s="";#r=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=Et.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#n=t.bitmapUrl,this.#a=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){pt.initialize(t,e)}static isHandlingMimeForPasting(t){return bu.includes(t)}static paste(t,e){e.pasteEditor({mode:Et.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#h(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#s=t.file.name),this.#g()}#f(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#r){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:a,height:l}=t||this.copyCanvas(null,null,!0).imageData,u=await n.guess({name:"altText",request:{data:s,width:a,height:l,channels:s.length/(a*l)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const d=u.output;return await this.setGuessedAltText(d),e&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(n=>this.#h(n,!0)).finally(()=>this.#f());return}if(this.#n){const n=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(n).then(s=>this.#h(s)).finally(()=>this.#f());return}if(this.#a){const n=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(n).then(s=>this.#h(s)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=bu.join(",");const e=this._uiManager._signal;this.#i=new Promise(n=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(s)}n()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),n()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#r?.remove(),this.#r=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#r===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#n||this.#a||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#g():this.#m()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:n,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#e=n,s&&(this.#t=s),this.#o=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#g(){const{div:t}=this;let{width:e,height:n}=this.#t;const[s,a]=this.pageDimensions,l=.75;if(this.width)e=this.width*s,n=this.height*a;else if(e>l*s||n>l*a){const d=Math.min(l*s/e,l*a/n);e*=d,n*=d}this._uiManager.enableWaiting(!1);const u=this.#r=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=e/s,this.height=n/a,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&this.div.setAttribute("aria-description",this.#s),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,n=!1){t||(t=224);const{width:s,height:a}=this.#t,l=new ii;let u=this.#t,d=s,f=a,g=null;if(e){if(s>e||a>e){const D=Math.min(e/s,e/a);d=Math.floor(s*D),f=Math.floor(a*D)}g=document.createElement("canvas");const v=g.width=Math.ceil(d*l.sx),b=g.height=Math.ceil(f*l.sy);this.#l||(u=this.#u(v,b));const S=g.getContext("2d");S.filter=this._uiManager.hcmFilter;let w="white",A="#cfcfd8";this._uiManager.hcmFilter!=="none"?A="black":EC.isDarkMode&&(w="#8f8f9d",A="#42414d");const _=15,E=_*l.sx,x=_*l.sy,O=new OffscreenCanvas(E*2,x*2),C=O.getContext("2d");C.fillStyle=w,C.fillRect(0,0,E*2,x*2),C.fillStyle=A,C.fillRect(0,0,E,x),C.fillRect(E,x,E,x),S.fillStyle=S.createPattern(O,"repeat"),S.fillRect(0,0,v,b),S.drawImage(u,0,0,u.width,u.height,0,0,v,b)}let m=null;if(n){let v,b;if(l.symmetric&&u.width<t&&u.height<t)v=u.width,b=u.height;else if(u=this.#t,s>t||a>t){const A=Math.min(t/s,t/a);v=Math.floor(s*A),b=Math.floor(a*A),this.#l||(u=this.#u(v,b))}const w=new OffscreenCanvas(v,b).getContext("2d",{willReadFrequently:!0});w.drawImage(u,0,0,u.width,u.height,0,0,v,b),m={width:v,height:b,data:w.getImageData(0,0,v,b).data}}return{canvas:g,width:d,height:f,imageData:m}}#u(t,e){const{width:n,height:s}=this.#t;let a=n,l=s,u=this.#t;for(;a>2*t||l>2*e;){const d=a,f=l;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const g=new OffscreenCanvas(a,l);g.getContext("2d").drawImage(u,0,0,d,f,0,0,a,l),u=g.transferToImageBitmap()}return u}#p(){const[t,e]=this.parentDimensions,{width:n,height:s}=this,a=new ii,l=Math.ceil(n*t*a.sx),u=Math.ceil(s*e*a.sy),d=this.#r;if(!d||d.width===l&&d.height===u)return;d.width=l,d.height=u;const f=this.#l?this.#t:this.#u(l,u),g=d.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(f,0,0,f.width,f.height,0,0,l,u)}#y(t){if(t){if(this.#l){const s=this._uiManager.imageManager.getSvgUrl(this.#e);if(s)return s}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,n]=this.pageDimensions,s=Math.round(this.width*e*lr.PDF_TO_CSS_UNITS),a=Math.round(this.height*n*lr.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(s,a);return l.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,s,a),l.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,n){let s=null,a=!1;if(t instanceof E_){const{data:{rect:w,rotation:A,id:_,structParent:E,popupRef:x,richText:O,contentsObj:C,creationDate:D,modificationDate:R},container:k,parent:{page:{pageNumber:L}},canvas:V}=t;let q,it;V?(delete t.canvas,{id:q,bitmap:it}=n.imageManager.getFromCanvas(k.id,V),V.remove()):(a=!0,t._hasNoCanvas=!0);const rt=(await e._structTree.getAriaAttributes(`${Cg}${_}`))?.get("aria-label")||"";s=t={annotationType:Et.STAMP,bitmapId:q,bitmap:it,pageIndex:L-1,rect:w.slice(0),rotation:A,annotationElementId:_,id:_,deleted:!1,accessibilityData:{decorative:!1,altText:rt},isSvg:!1,structParent:E,popupRef:x,richText:O,comment:C?.str||null,creationDate:D,modificationDate:R}}const l=await super.deserialize(t,e,n),{rect:u,bitmap:d,bitmapUrl:f,bitmapId:g,isSvg:m,accessibilityData:v}=t;a?(n.addMissingCanvas(t.id,l),l.#o=!0):g&&n.imageManager.isValidId(g)?(l.#e=g,d&&(l.#t=d)):l.#n=f,l.#l=m;const[b,S]=l.pageDimensions;return l.width=(u[2]-u[0])/b,l.height=(u[3]-u[1])/S,v&&(l.altTextData=v),l._initialData=s,t.comment&&l.setCommentData(t),l.#d=!!s,l}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(n),t)return n.bitmapUrl=this.#y(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:s,altText:a}=this.serializeAltText(!1);if(!s&&a&&(n.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const u=this.#b(n);return u.isSame?null:(u.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(e===null)return n;e.stamps||=new Map;const l=this.#l?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:l,serialized:n}),n.bitmap=this.#y(!1);else if(this.#l){const u=e.stamps.get(this.#e);l>u.area&&(u.area=l,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return n}#b(t){const{pageIndex:e,accessibilityData:{altText:n}}=this._initialData,s=t.pageIndex===e,a=(t.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&a,isSameAltText:a}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class wi{#t;#e=!1;#i=null;#n=null;#a=null;#s=new Map;#r=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#m=null;#g=-1;#u;static _initialized=!1;static#p=new Map([Be,Hg,QR,Se,vi].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:s,accessibilityManager:a,annotationLayer:l,drawLayer:u,textLayer:d,viewport:f,l10n:g}){const m=[...wi.#p.values()];if(!wi._initialized){wi._initialized=!0;for(const v of m)v.initialize(g,t)}t.registerEditorTypes(m),this.#u=t,this.pageIndex=e,this.div=n,this.#t=a,this.#i=l,this.viewport=f,this.#h=d,this.drawLayer=u,this._structTree=s,this.#u.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===Et.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#w(),t){case Et.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Et.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Et.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===Et.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const n of wi.#p.values())e.toggle(`${n._type}Editing`,t===n._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.div.classList.toggle("disabled",!t)}get#y(){return this.#s.size!==0?this.#s.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const n of this.#y)n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#u.removeChangedExistingAnnotation(n),t.add(n.annotationElementId));const e=this.#i;if(e)for(const n of e.getEditableAnnotations()){if(n.hide(),this.#u.isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const s=await this.deserialize(n);s&&(this.addOrRebuild(s),s.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const n=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",s=>{const{clientX:l,clientY:u,timeStamp:d}=s,f=this.#g;if(d-f>500){this.#g=d;return}this.#g=-1;const{classList:g}=this.div;g.toggle("getElements",!0);const m=document.elementsFromPoint(l,u);if(g.toggle("getElements",!1),!this.div.contains(m[0]))return;let v;const b=new RegExp(`^${rl}[0-9]+$`);for(const w of m)if(b.test(w.id)){v=w.id;break}if(!v)return;const S=this.#s.get(v);S?.annotationElementId===null&&(s.stopPropagation(),s.preventDefault(),S.dblclick(s))},{signal:n,capture:!0})}const t=this.#i;if(t){const n=new Map,s=new Map;for(const l of this.#y){if(l.disableEditing(),!l.annotationElementId){l.updateFakeAnnotationElement(t);continue}if(l.serialize()!==null){n.set(l.annotationElementId,l);continue}else s.set(l.annotationElementId,l);this.getEditableAnnotation(l.annotationElementId)?.show(),l.remove()}const a=t.getEditableAnnotations();for(const l of a){const{id:u}=l.data;if(this.#u.isDeletedAnnotationElement(u)){l.updateEdited({deleted:!0});continue}let d=s.get(u);if(d){d.resetAnnotationElement(l),d.show(!1),l.show();continue}d=n.get(u),d&&(this.#u.addChangedExistingAnnotation(d),d.renderAnnotationElement(l)&&d.show(!1)),l.show()}}this.#w(),this.isEmpty&&(this.div.hidden=!0);const{classList:e}=this.div;for(const n of wi.#p.values())e.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#b.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#b(t){this.#u.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:n}=Ue.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),Se.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const t=this.#u.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#n?.abort(),this.#n=null}attach(t){this.#s.set(t.id,t);const{annotationElementId:e}=t;e&&this.#u.isDeletedAnnotationElement(e)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#s.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t.annotationElementId),pt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#a&&(t._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getEditorByUID(t){for(const e of this.#s.values())if(e.uid===t)return e;return null}getNextId(){return this.#u.getId()}get#v(){return wi.#p.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#T(t){const e=this.#v;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#v?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:n,offsetY:s}=this.#A(),a=this.getNextId(),l=this.#T({parent:this,id:a,x:n,y:s,uiManager:this.#u,isCentered:!0,...e});l&&this.add(l)}async deserialize(t){return await wi.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,e,n={}){const s=this.getNextId(),a=this.#T({parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:e,...n});return a&&this.add(a),a}get boundingClientRect(){return this.div.getBoundingClientRect()}#A(){const{x:t,y:e,width:n,height:s}=this.boundingClientRect,a=Math.max(0,t),l=Math.max(0,e),u=Math.min(window.innerWidth,t+n),d=Math.min(window.innerHeight,e+s),f=(a+u)/2-t,g=(l+d)/2-e,[m,v]=this.viewport.rotation%180===0?[f,g]:[g,f];return{offsetX:m,offsetY:v}}addNewEditor(t={}){this.createAndAddNewEditor(this.#A(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:e}=Ue.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#r||(this.#r=!1,this.#v?.isDrawer&&this.#v.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const n=this.#u.getMode();if(n===Et.STAMP||n===Et.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===Et.HIGHLIGHT&&this.enableTextSelection(),this.#r){this.#r=!1;return}const{isMac:e}=Ue.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#r=!0,this.#v?.isDrawer){this.startDrawingSession(t);return}const n=this.#u.getActive();this.#e=!n||n.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#v.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#v.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#v.endDrawing(t)):null}findNewParent(t,e,n){const s=this.#u.findParent(e,n);return s===null||s===this?!1:(s.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#v.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const t of this.#s.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#s.clear(),this.#u.removeLayer(this)}#w(){for(const t of this.#s.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,xs(this.div,t);for(const e of this.#u.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#w();const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,xs(this.div,{rotation:n}),e!==n)for(const s of this.#s.values())s.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#u.viewParameters.realScale}}class je{#t=null;#e=new Map;#i=new Map;static#n=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Ct(this,"_svgFactory",new ul)}static#a(t,[e,n,s,a]){const{style:l}=t;l.top=`${100*n}%`,l.left=`${100*e}%`,l.width=`${100*s}%`,l.height=`${100*a}%`}#s(){const t=je._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#r(t,e){const n=je._svgFactory.createElement("clipPath");t.append(n);const s=`clip_${e}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const a=je._svgFactory.createElement("use");return n.append(a),a.setAttribute("href",`#${e}`),a.classList.add("clip"),s}#o(t,e){for(const[n,s]of Object.entries(e))s===null?t.removeAttribute(n):t.setAttribute(n,s)}draw(t,e=!1,n=!1){const s=je.#n++,a=this.#s(),l=je._svgFactory.createElement("defs");a.append(l);const u=je._svgFactory.createElement("path");l.append(u);const d=`path_p${this.pageIndex}_${s}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(s,u);const f=n?this.#r(l,d):null,g=je._svgFactory.createElement("use");return a.append(g),g.setAttribute("href",`#${d}`),this.updateProperties(a,t),this.#e.set(s,a),{id:s,clipPathId:`url(#${f})`}}drawOutline(t,e){const n=je.#n++,s=this.#s(),a=je._svgFactory.createElement("defs");s.append(a);const l=je._svgFactory.createElement("path");a.append(l);const u=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke");let d;if(e){const m=je._svgFactory.createElement("mask");a.append(m),d=`mask_p${this.pageIndex}_${n}`,m.setAttribute("id",d),m.setAttribute("maskUnits","objectBoundingBox");const v=je._svgFactory.createElement("rect");m.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const b=je._svgFactory.createElement("use");m.append(b),b.setAttribute("href",`#${u}`),b.setAttribute("stroke","none"),b.setAttribute("fill","black"),b.setAttribute("fill-rule","nonzero"),b.classList.add("mask")}const f=je._svgFactory.createElement("use");s.append(f),f.setAttribute("href",`#${u}`),d&&f.setAttribute("mask",`url(#${d})`);const g=f.cloneNode();return s.append(g),f.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(s,t),this.#e.set(n,s),n}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:n,bbox:s,rootClass:a,path:l}=e,u=typeof t=="number"?this.#e.get(t):t;if(u){if(n&&this.#o(u,n),s&&je.#a(u,s),a){const{classList:d}=u;for(const[f,g]of Object.entries(a))d.toggle(f,g)}if(l){const f=u.firstChild.firstChild;this.#o(f,l)}}}updateParent(t,e){if(e===this)return;const n=this.#e.get(t);n&&(e.#t.append(n),this.#e.delete(t),e.#e.set(t,n))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Qf};globalThis.pdfjsLib={AbortException:$i,AnnotationEditorLayer:wi,AnnotationEditorParamsType:Nt,AnnotationEditorType:Et,AnnotationEditorUIManager:qi,AnnotationLayer:zg,AnnotationMode:_i,AnnotationType:_e,applyOpacity:Zw,build:b_,ColorPicker:Cn,createValidAbsoluteUrl:Eg,CSSConstants:Qw,DOMSVGFactory:ul,DrawLayer:je,FeatureTest:Ue,fetchData:ka,findContrastColor:Jw,getDocument:Bg,getFilenameFromUrl:Yw,getPdfFilenameFromUrl:Ww,getRGB:Pa,getUuid:xg,getXfaPageViewport:Kw,GlobalWorkerOptions:Es,ImageKind:Jo,InvalidPDFException:yu,isDataScheme:vl,isPdfFile:Mu,isValidExplicitDest:i_,MathClamp:Je,noContextMenu:Mn,normalizeUnicode:Vw,OPS:Ea,OutputScale:ii,PasswordResponses:qw,PDFDataRangeTransport:Ig,PDFDateString:vu,PDFWorker:Ta,PermissionFlag:$w,PixelsPerInch:lr,RenderingCancelledException:Ou,renderRichText:Dg,ResponseException:al,setLayerDimensions:xs,shadow:Ct,SignatureExtractor:nr,stopEvent:de,SupportedImageMimeTypes:bu,TextLayer:ll,TouchManager:wl,updateUrlHash:Tg,Util:ut,VerbosityLevel:pl,version:v_,XfaLayer:Rg};const ZR=Object.freeze(Object.defineProperty({__proto__:null,AbortException:$i,AnnotationEditorLayer:wi,AnnotationEditorParamsType:Nt,AnnotationEditorType:Et,AnnotationEditorUIManager:qi,AnnotationLayer:zg,AnnotationMode:_i,AnnotationType:_e,CSSConstants:Qw,ColorPicker:Cn,DOMSVGFactory:ul,DrawLayer:je,FeatureTest:Ue,GlobalWorkerOptions:Es,ImageKind:Jo,InvalidPDFException:yu,MathClamp:Je,OPS:Ea,OutputScale:ii,PDFDataRangeTransport:Ig,PDFDateString:vu,PDFWorker:Ta,PasswordResponses:qw,PermissionFlag:$w,PixelsPerInch:lr,RenderingCancelledException:Ou,ResponseException:al,SignatureExtractor:nr,SupportedImageMimeTypes:bu,TextLayer:ll,TouchManager:wl,Util:ut,VerbosityLevel:pl,XfaLayer:Rg,applyOpacity:Zw,build:b_,createValidAbsoluteUrl:Eg,fetchData:ka,findContrastColor:Jw,getDocument:Bg,getFilenameFromUrl:Yw,getPdfFilenameFromUrl:Ww,getRGB:Pa,getUuid:xg,getXfaPageViewport:Kw,isDataScheme:vl,isPdfFile:Mu,isValidExplicitDest:i_,noContextMenu:Mn,normalizeUnicode:Vw,renderRichText:Dg,setLayerDimensions:xs,shadow:Ct,stopEvent:de,updateUrlHash:Tg,version:v_},Symbol.toStringTag,{value:"Module"}));var m0=Object.prototype.hasOwnProperty;function y0(o,t,e){for(e of o.keys())if(ba(e,t))return e}function ba(o,t){var e,n,s;if(o===t)return!0;if(o&&t&&(e=o.constructor)===t.constructor){if(e===Date)return o.getTime()===t.getTime();if(e===RegExp)return o.toString()===t.toString();if(e===Array){if((n=o.length)===t.length)for(;n--&&ba(o[n],t[n]););return n===-1}if(e===Set){if(o.size!==t.size)return!1;for(n of o)if(s=n,s&&typeof s=="object"&&(s=y0(t,s),!s)||!t.has(s))return!1;return!0}if(e===Map){if(o.size!==t.size)return!1;for(n of o)if(s=n[0],s&&typeof s=="object"&&(s=y0(t,s),!s)||!ba(n[1],t.get(s)))return!1;return!0}if(e===ArrayBuffer)o=new Uint8Array(o),t=new Uint8Array(t);else if(e===DataView){if((n=o.byteLength)===t.byteLength)for(;n--&&o.getInt8(n)===t.getInt8(n););return n===-1}if(ArrayBuffer.isView(o)){if((n=o.byteLength)===t.byteLength)for(;n--&&o[n]===t[n];);return n===-1}if(!e||typeof o=="object"){n=0;for(e in o)if(m0.call(o,e)&&++n&&!m0.call(t,e)||!(e in t)||!ba(o[e],t[e]))return!1;return Object.keys(t).length===n}}return o!==o&&t!==t}function Al(o){let t=!1;return{promise:new Promise((n,s)=>{o.then(a=>!t&&n(a)).catch(a=>!t&&s(a))}),cancel(){t=!0}}}const JR=["onCopy","onCut","onPaste"],tD=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],eD=["onFocus","onBlur"],nD=["onInput","onInvalid","onReset","onSubmit"],iD=["onLoad","onError"],sD=["onKeyDown","onKeyPress","onKeyUp"],rD=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],aD=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],oD=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],lD=["onSelect"],cD=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],uD=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],hD=["onScroll"],dD=["onWheel"],fD=["onAnimationStart","onAnimationEnd","onAnimationIteration"],gD=["onTransitionEnd"],pD=["onToggle"],mD=["onChange"],yD=[...JR,...tD,...eD,...nD,...iD,...sD,...rD,...aD,...oD,...lD,...cD,...uD,...hD,...dD,...fD,...gD,...mD,...pD];function R_(o,t){const e={};for(const n of yD){const s=o[n];s&&(t?e[n]=a=>s(a,t(n)):e[n]=s)}return e}var vD="Invariant failed";function Qt(o,t){if(!o)throw new Error(vD)}var Af,v0;function bD(){if(v0)return Af;v0=1;var o=function(){};return Af=o,Af}var wD=bD();const en=ng(wD),D_=j.createContext(null),_D="noopener noreferrer nofollow";class SD{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(t){this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setExternalLinkRel(t){this.externalLinkRel=t}setExternalLinkTarget(t){this.externalLinkTarget=t}setHash(){}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Qt(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(t){Qt(this.pdfViewer),this.pdfViewer.currentPageNumber=t}get rotation(){return 0}set rotation(t){}addLinkAttributes(t,e,n){t.href=e,t.rel=this.externalLinkRel||_D,t.target=n?"_blank":this.externalLinkTarget||""}goToDestination(t){return new Promise(e=>{Qt(this.pdfDocument),Qt(t),typeof t=="string"?this.pdfDocument.getDestination(t).then(e):Array.isArray(t)?e(t):t.then(e)}).then(e=>{Qt(Array.isArray(e));const n=e[0];new Promise(s=>{Qt(this.pdfDocument),n instanceof Object?this.pdfDocument.getPageIndex(n).then(a=>{s(a)}).catch(()=>{Qt(!1)}):typeof n=="number"?s(n):Qt(!1)}).then(s=>{const a=s+1;Qt(this.pdfViewer),Qt(a>=1&&a<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:e,pageIndex:s,pageNumber:a})})})}goToPage(t){const e=t-1;Qt(this.pdfViewer),Qt(t>=1&&t<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:e,pageNumber:t})}goToXY(){}cachePageRef(){}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}executeNamedAction(){}executeSetOCGState(){}isPageVisible(){return!0}isPageCached(){return!0}navigateTo(t){this.goToDestination(t)}}function wa({children:o,type:t}){return Q.jsx("div",{className:`react-pdf__message react-pdf__message--${t}`,children:o})}const b0={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function AD(o,t){switch(t.type){case"RESOLVE":return{value:t.value,error:void 0};case"REJECT":return{value:!1,error:t.error};case"RESET":return{value:void 0,error:void 0};default:return o}}function xa(){return j.useReducer(AD,{value:void 0,error:void 0})}const Nu=typeof window<"u",O_=Nu&&window.location.protocol==="file:";function ED(o){return typeof o<"u"}function Zs(o){return ED(o)&&o!==null}function TD(o){return typeof o=="string"}function xD(o){return o instanceof ArrayBuffer}function CD(o){return Qt(Nu),o instanceof Blob}function tg(o){return TD(o)&&/^data:/.test(o)}function w0(o){Qt(tg(o));const[t="",e=""]=o.split(",");return t.split(";").indexOf("base64")!==-1?atob(e):unescape(e)}function RD(){return Nu&&window.devicePixelRatio||1}const M_="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function _0(){en(!O_,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${M_}`)}function DD(){en(!O_,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${M_}`)}function ur(o){o?.cancel&&o.cancel()}function eg(o,t){return Object.defineProperty(o,"width",{get(){return this.view[2]*t},configurable:!0}),Object.defineProperty(o,"height",{get(){return this.view[3]*t},configurable:!0}),Object.defineProperty(o,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(o,"originalHeight",{get(){return this.view[3]},configurable:!0}),o}function OD(o){return o.name==="RenderingCancelledException"}function MD(o){return new Promise((t,e)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return e(new Error("Error while reading a file."));t(n.result)},n.onerror=s=>{if(!s.target)return e(new Error("Error while reading a file."));const{error:a}=s.target;if(!a)return e(new Error("Error while reading a file."));switch(a.code){case a.NOT_FOUND_ERR:return e(new Error("Error while reading a file: File not found."));case a.SECURITY_ERR:return e(new Error("Error while reading a file: Security error."));case a.ABORT_ERR:return e(new Error("Error while reading a file: Aborted."));default:return e(new Error("Error while reading a file."))}},n.readAsArrayBuffer(o)})}const{PDFDataRangeTransport:kD}=ZR,PD=(o,t)=>{switch(t){case b0.NEED_PASSWORD:{const e=prompt("Enter the password to open this PDF file.");o(e);break}case b0.INCORRECT_PASSWORD:{const e=prompt("Invalid password. Please try again.");o(e);break}}};function S0(o){return typeof o=="object"&&o!==null&&("data"in o||"range"in o||"url"in o)}const k_=j.forwardRef(function({children:t,className:e,error:n="Failed to load PDF file.",externalLinkRel:s,externalLinkTarget:a,file:l,inputRef:u,imageResourcesPath:d,loading:f="Loading PDF",noData:g="No PDF file specified.",onItemClick:m,onLoadError:v,onLoadProgress:b,onLoadSuccess:S,onPassword:w=PD,onSourceError:A,onSourceSuccess:_,options:E,renderMode:x,rotate:O,scale:C,...D},R){const[k,L]=xa(),{value:V,error:q}=k,[it,rt]=xa(),{value:st,error:ot}=it,B=j.useRef(new SD),H=j.useRef([]),tt=j.useRef(void 0),lt=j.useRef(void 0);l&&l!==tt.current&&S0(l)&&(en(!ba(l,tt.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),tt.current=l),E&&E!==lt.current&&(en(!ba(E,lt.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),lt.current=E);const P=j.useRef({scrollPageIntoView:Dt=>{const{dest:Pt,pageNumber:Jt,pageIndex:Yt=Jt-1}=Dt;if(m){m({dest:Pt,pageIndex:Yt,pageNumber:Jt});return}const Ee=H.current[Yt];if(Ee){Ee.scrollIntoView();return}en(!1,`An internal link leading to page ${Jt} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});j.useImperativeHandle(R,()=>({linkService:B,pages:H,viewer:P}),[]);function z(){_&&_()}function Y(){q&&(en(!1,q.toString()),A&&A(q))}function U(){L({type:"RESET"})}j.useEffect(U,[l,L]);const et=j.useCallback(async()=>{if(!l)return null;if(typeof l=="string")return tg(l)?{data:w0(l)}:(_0(),{url:l});if(l instanceof kD)return{range:l};if(xD(l))return{data:l};if(Nu&&CD(l))return{data:await MD(l)};if(Qt(typeof l=="object"),Qt(S0(l)),"url"in l&&typeof l.url=="string"){if(tg(l.url)){const{url:Dt,...Pt}=l;return{data:w0(Dt),...Pt}}_0()}return l},[l]);j.useEffect(()=>{const Dt=Al(et());return Dt.promise.then(Pt=>{L({type:"RESOLVE",value:Pt})}).catch(Pt=>{L({type:"REJECT",error:Pt})}),()=>{ur(Dt)}},[et,L]),j.useEffect(()=>{if(!(typeof V>"u")){if(V===!1){Y();return}z()}},[V]);function nt(){st&&(S&&S(st),H.current=new Array(st.numPages),B.current.setDocument(st))}function at(){ot&&(en(!1,ot.toString()),v&&v(ot))}j.useEffect(function(){rt({type:"RESET"})},[rt,V]),j.useEffect(function(){if(!V)return;const Pt=E?{...V,...E}:V,Jt=Bg(Pt);b&&(Jt.onProgress=b),w&&(Jt.onPassword=w);const Yt=Jt,Ee=Yt.promise.then(si=>{rt({type:"RESOLVE",value:si})}).catch(si=>{Yt.destroyed||rt({type:"REJECT",error:si})});return()=>{Ee.finally(()=>Yt.destroy())}},[E,rt,V]),j.useEffect(()=>{if(!(typeof st>"u")){if(st===!1){at();return}nt()}},[st]),j.useEffect(function(){B.current.setViewer(P.current),B.current.setExternalLinkRel(s),B.current.setExternalLinkTarget(a)},[s,a]);const ft=j.useCallback((Dt,Pt)=>{H.current[Dt]=Pt},[]),vt=j.useCallback(Dt=>{delete H.current[Dt]},[]),It=j.useMemo(()=>({imageResourcesPath:d,linkService:B.current,onItemClick:m,pdf:st,registerPage:ft,renderMode:x,rotate:O,scale:C,unregisterPage:vt}),[d,m,st,ft,x,O,C,vt]),St=j.useMemo(()=>R_(D,()=>st),[D,st]);function Ae(){function Dt(Jt){return!!Jt?.pdf}if(!Dt(It))throw new Error("pdf is undefined");const Pt=typeof t=="function"?t(It):t;return Q.jsx(D_.Provider,{value:It,children:Pt})}function le(){return l?st==null?Q.jsx(wa,{type:"loading",children:typeof f=="function"?f():f}):st===!1?Q.jsx(wa,{type:"error",children:typeof n=="function"?n():n}):Ae():Q.jsx(wa,{type:"no-data",children:typeof g=="function"?g():g})}return Q.jsx("div",{className:Vn("react-pdf__Document",e),ref:u,...St,children:le()})});function P_(){return j.useContext(D_)}function N_(){for(var o=[],t=0;t<arguments.length;t++)o[t]=arguments[t];var e=o.filter(Boolean);if(e.length<=1){var n=e[0];return n||null}return function(a){for(var l=0,u=e;l<u.length;l++){var d=u[l];typeof d=="function"?d(a):d&&(d.current=a)}}}const L_=j.createContext(null);function Lu(){return j.useContext(L_)}function ND(){const o=P_(),t=Lu();Qt(t);const e={...o,...t},{imageResourcesPath:n,linkService:s,onGetAnnotationsError:a,onGetAnnotationsSuccess:l,onRenderAnnotationLayerError:u,onRenderAnnotationLayerSuccess:d,page:f,pdf:g,renderForms:m,rotate:v,scale:b=1}=e;Qt(g),Qt(f),Qt(s);const[S,w]=xa(),{value:A,error:_}=S,E=j.useRef(null);en(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function x(){A&&l&&l(A)}function O(){_&&(en(!1,_.toString()),a&&a(_))}j.useEffect(function(){w({type:"RESET"})},[w,f]),j.useEffect(function(){if(!f)return;const L=Al(f.getAnnotations()),V=L;return L.promise.then(q=>{w({type:"RESOLVE",value:q})}).catch(q=>{w({type:"REJECT",error:q})}),()=>{ur(V)}},[w,f]),j.useEffect(()=>{if(A!==void 0){if(A===!1){O();return}x()}},[A]);function C(){d&&d()}function D(k){en(!1,`${k}`),u&&u(k)}const R=j.useMemo(()=>f.getViewport({scale:b,rotation:v}),[f,v,b]);return j.useEffect(function(){if(!g||!f||!s||!A)return;const{current:L}=E;if(!L)return;const V=R.clone({dontFlip:!0}),q={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,annotationStorage:g.annotationStorage,commentManager:null,div:L,l10n:null,linkService:s,page:f,structTreeLayer:null,viewport:V},it={annotations:A,annotationStorage:g.annotationStorage,div:L,imageResourcesPath:n,linkService:s,page:f,renderForms:m,viewport:V};L.innerHTML="";try{new zg(q).render(it),C()}catch(rt){D(rt)}return()=>{}},[A,n,s,f,g,m,R]),Q.jsx("div",{className:Vn("react-pdf__Page__annotations","annotationLayer"),ref:E})}const B_={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},LD=/^H(\d+)$/;function BD(o){return o in B_}function Bu(o){return"children"in o}function j_(o){return Bu(o)?o.children.length===1&&0 in o.children&&"id"in o.children[0]:!1}function jD(o){const t={};if(Bu(o)){const{role:e}=o,n=e.match(LD);if(n)t.role="heading",t["aria-level"]=Number(n[1]);else if(BD(e)){const s=B_[e];s&&(t.role=s)}}return t}function I_(o){const t={};if(Bu(o)){if(o.alt!==void 0&&(t["aria-label"]=o.alt),o.lang!==void 0&&(t.lang=o.lang),j_(o)){const[e]=o.children;if(e){const n=I_(e);return{...t,...n}}}}else"id"in o&&(t["aria-owns"]=o.id);return t}function ID(o){return o?{...jD(o),...I_(o)}:null}function U_({className:o,node:t}){const e=j.useMemo(()=>ID(t),[t]),n=j.useMemo(()=>!Bu(t)||j_(t)?null:t.children.map((s,a)=>Q.jsx(U_,{node:s},a)),[t]);return Q.jsx("span",{className:o,...e,children:n})}function UD(){const o=Lu();Qt(o);const{onGetStructTreeError:t,onGetStructTreeSuccess:e}=o,[n,s]=xa(),{value:a,error:l}=n,{customTextRenderer:u,page:d}=o;function f(){a&&e&&e(a)}function g(){l&&(en(!1,l.toString()),t&&t(l))}return j.useEffect(function(){s({type:"RESET"})},[s,d]),j.useEffect(function(){if(u||!d)return;const v=Al(d.getStructTree()),b=v;return v.promise.then(S=>{s({type:"RESOLVE",value:S})}).catch(S=>{s({type:"REJECT",error:S})}),()=>ur(b)},[u,d,s]),j.useEffect(()=>{if(a!==void 0){if(a===!1){g();return}f()}},[a]),a?Q.jsx(U_,{className:"react-pdf__Page__structTree structTree",node:a}):null}const A0=_i;function FD(o){const t=Lu();Qt(t);const e={...t,...o},{_className:n,canvasBackground:s,devicePixelRatio:a=RD(),onRenderError:l,onRenderSuccess:u,page:d,renderForms:f,renderTextLayer:g,rotate:m,scale:v}=e,{canvasRef:b}=o;Qt(d);const S=j.useRef(null);function w(){d&&u&&u(eg(d,v))}function A(O){OD(O)||(en(!1,O.toString()),l&&l(O))}const _=j.useMemo(()=>d.getViewport({scale:v*a,rotation:m}),[a,d,m,v]),E=j.useMemo(()=>d.getViewport({scale:v,rotation:m}),[d,m,v]);j.useEffect(function(){if(!d)return;d.cleanup();const{current:C}=S;if(!C)return;C.width=_.width,C.height=_.height,C.style.width=`${Math.floor(E.width)}px`,C.style.height=`${Math.floor(E.height)}px`,C.style.visibility="hidden";const D={annotationMode:f?A0.ENABLE_FORMS:A0.ENABLE,canvas:C,canvasContext:C.getContext("2d",{alpha:!1}),viewport:_};s&&(D.background=s);const R=d.render(D),k=R;return R.promise.then(()=>{C.style.visibility="",w()}).catch(A),()=>ur(k)},[s,d,f,_,E]);const x=j.useCallback(()=>{const{current:O}=S;O&&(O.width=0,O.height=0)},[]);return j.useEffect(()=>x,[x]),Q.jsx("canvas",{className:`${n}__canvas`,dir:"ltr",ref:N_(b,S),style:{display:"block",userSelect:"none"},children:g?Q.jsx(UD,{}):null})}function zD(o){return"str"in o}function HD(){const o=Lu();Qt(o);const{customTextRenderer:t,onGetTextError:e,onGetTextSuccess:n,onRenderTextLayerError:s,onRenderTextLayerSuccess:a,page:l,pageIndex:u,pageNumber:d,rotate:f,scale:g}=o;Qt(l);const[m,v]=xa(),{value:b,error:S}=m,w=j.useRef(null);en(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function A(){b&&n&&n(b)}function _(){S&&(en(!1,S.toString()),e&&e(S))}j.useEffect(function(){v({type:"RESET"})},[l,v]),j.useEffect(function(){if(!l)return;const k=Al(l.getTextContent()),L=k;return k.promise.then(V=>{v({type:"RESOLVE",value:V})}).catch(V=>{v({type:"REJECT",error:V})}),()=>ur(L)},[l,v]),j.useEffect(()=>{if(b!==void 0){if(b===!1){_();return}A()}},[b]);const E=j.useCallback(()=>{a&&a()},[a]),x=j.useCallback(R=>{en(!1,R.toString()),s&&s(R)},[s]);function O(){const R=w.current;R&&R.classList.add("selecting")}function C(){const R=w.current;R&&R.classList.remove("selecting")}const D=j.useMemo(()=>l.getViewport({scale:g,rotation:f}),[l,f,g]);return j.useLayoutEffect(function(){if(!l||!b)return;const{current:k}=w;if(!k)return;k.innerHTML="";const L=l.streamTextContent({includeMarkedContent:!0}),V={container:k,textContentSource:L,viewport:D},q=new ll(V),it=q;return q.render().then(()=>{const rt=document.createElement("div");rt.className="endOfContent",k.append(rt);const st=k.querySelectorAll('[role="presentation"]');if(t){let ot=0;b.items.forEach((B,H)=>{if(!zD(B))return;const tt=st[ot];if(!tt)return;const lt=t({pageIndex:u,pageNumber:d,itemIndex:H,...B});tt.innerHTML=lt,ot+=B.str&&B.hasEOL?2:1})}E()}).catch(x),()=>ur(it)},[t,x,E,l,u,d,b,D]),Q.jsx("div",{className:Vn("react-pdf__Page__textContent","textLayer"),onMouseUp:C,onMouseDown:O,ref:w})}const E0=1;function F_(o){const e={...P_(),...o},{_className:n="react-pdf__Page",_enableRegisterUnregisterPage:s=!0,canvasBackground:a,canvasRef:l,children:u,className:d,customRenderer:f,customTextRenderer:g,devicePixelRatio:m,error:v="Failed to load the page.",height:b,inputRef:S,loading:w="Loading page",noData:A="No page specified.",onGetAnnotationsError:_,onGetAnnotationsSuccess:E,onGetStructTreeError:x,onGetStructTreeSuccess:O,onGetTextError:C,onGetTextSuccess:D,onLoadError:R,onLoadSuccess:k,onRenderAnnotationLayerError:L,onRenderAnnotationLayerSuccess:V,onRenderError:q,onRenderSuccess:it,onRenderTextLayerError:rt,onRenderTextLayerSuccess:st,pageIndex:ot,pageNumber:B,pdf:H,registerPage:tt,renderAnnotationLayer:lt=!0,renderForms:P=!1,renderMode:z="canvas",renderTextLayer:Y=!0,rotate:U,scale:et=E0,unregisterPage:nt,width:at,...ft}=e,[vt,It]=xa(),{value:St,error:Ae}=vt,le=j.useRef(null);Qt(H);const Dt=Zs(B)?B-1:ot??null,Pt=B??(Zs(ot)?ot+1:null),Jt=U??(St?St.rotate:null),Yt=j.useMemo(()=>{if(!St)return null;let Ft=1;const ge=et??E0;if(at||b){const $t=St.getViewport({scale:1,rotation:Jt});at?Ft=at/$t.width:b&&(Ft=b/$t.height)}return ge*Ft},[b,St,Jt,et,at]);j.useEffect(function(){return()=>{Zs(Dt)&&s&&nt&&nt(Dt)}},[s,H,Dt,nt]);function Ee(){if(k){if(!St||!Yt)return;k(eg(St,Yt))}if(s&&tt){if(!Zs(Dt)||!le.current)return;tt(Dt,le.current)}}function si(){Ae&&(en(!1,Ae.toString()),R&&R(Ae))}j.useEffect(function(){It({type:"RESET"})},[It,H,Dt]),j.useEffect(function(){if(!H||!Pt)return;const ge=Al(H.getPage(Pt)),$t=ge;return ge.promise.then(Vi=>{It({type:"RESOLVE",value:Vi})}).catch(Vi=>{It({type:"REJECT",error:Vi})}),()=>ur($t)},[It,H,Pt]),j.useEffect(()=>{if(St!==void 0){if(St===!1){si();return}Ee()}},[St,Yt]);const ri=j.useMemo(()=>Zs(Dt)&&Pt&&Zs(Jt)&&Zs(Yt)?{_className:n,canvasBackground:a,customTextRenderer:g,devicePixelRatio:m,onGetAnnotationsError:_,onGetAnnotationsSuccess:E,onGetStructTreeError:x,onGetStructTreeSuccess:O,onGetTextError:C,onGetTextSuccess:D,onRenderAnnotationLayerError:L,onRenderAnnotationLayerSuccess:V,onRenderError:q,onRenderSuccess:it,onRenderTextLayerError:rt,onRenderTextLayerSuccess:st,page:St,pageIndex:Dt,pageNumber:Pt,renderForms:P,renderTextLayer:Y,rotate:Jt,scale:Yt}:null,[n,a,g,m,_,E,x,O,C,D,L,V,q,it,rt,st,St,Dt,Pt,P,Y,Jt,Yt]),mn=j.useMemo(()=>R_(ft,()=>St&&(Yt?eg(St,Yt):void 0)),[ft,St,Yt]),on=`${Dt}@${Yt}/${Jt}`;function Gi(){switch(z){case"custom":return Qt(f),Q.jsx(f,{},`${on}_custom`);case"none":return null;case"canvas":default:return Q.jsx(FD,{canvasRef:l},`${on}_canvas`)}}function Ds(){return Y?Q.jsx(HD,{},`${on}_text`):null}function gr(){return lt?Q.jsx(ND,{},`${on}_annotations`):null}function Na(){function Ft($t){return!!$t?.page}if(!Ft(ri))throw new Error("page is undefined");const ge=typeof u=="function"?u(ri):u;return Q.jsxs(L_.Provider,{value:ri,children:[Gi(),Ds(),gr(),ge]})}function Si(){return Pt?H===null||St===void 0||St===null?Q.jsx(wa,{type:"loading",children:typeof w=="function"?w():w}):H===!1||St===!1?Q.jsx(wa,{type:"error",children:typeof v=="function"?v():v}):Na():Q.jsx(wa,{type:"no-data",children:typeof A=="function"?A():A})}return Q.jsx("div",{className:Vn(n,d),"data-page-number":Pt,ref:N_(S,le),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${Yt}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:a||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"},...mn,children:Si()})}DD();Es.workerSrc="pdf.worker.mjs";const $D=j.forwardRef(({note:o,onDelete:t,onEdit:e,onResize:n,scale:s,onAddReply:a,onToggleReadStatus:l},u)=>{const d=()=>{t(o.id)},[f,g]=j.useState(!1),m=j.useRef(null),[v,b]=j.useState(o.text),[S,w]=j.useState({width:o.width||200,height:o.height||100}),[A,_]=j.useState(!1),[E,x]=j.useState(""),O=j.useRef(null),C=j.useRef(null),D=j.useRef(!1),{attributes:R,listeners:k,setNodeRef:L,transform:V,isDragging:q}=Of({id:o.id,disabled:f}),it=j.useCallback(U=>{L(U),u&&(typeof u=="function"?u(U):u.current=U)},[L,u]),rt={position:"absolute",left:o.x,top:o.y,transform:V?`translate3d(${V.x/s}px, ${V.y/s}px, 0)`:void 0,opacity:q?.8:1,zIndex:q?1e3:f?999:1,cursor:f?"auto":q?"grabbing":"grab"};j.useEffect(()=>{if(f&&m.current){m.current.focus();const U=m.current.value.length;m.current.setSelectionRange(U,U)}},[f]);const st=j.useCallback(()=>{v.trim()!==""?e(o.id,v):b(o.text),g(!1)},[v,o.id,o.text,e]),ot=j.useCallback(U=>{k?.onMouseDown?.(U),U.stopPropagation(),D.current=!1,C.current=window.setTimeout(()=>{D.current=!0},300)},[k]),B=j.useCallback(()=>{C.current&&(clearTimeout(C.current),C.current=null),!D.current&&!q&&g(!0)},[q]),H=j.useCallback(U=>{U.key==="Enter"&&!U.shiftKey&&(U.preventDefault(),st())},[st]),tt=j.useCallback(()=>{st()},[st]),lt=j.useCallback((U,et)=>{const{size:nt}=et;w(nt),n(o.id,nt.width,nt.height)},[o.id,n]),P=()=>{_(!0)},z=()=>{E.trim()!==""&&(a(o.id,E),x(""),_(!1))};j.useEffect(()=>{A&&O.current&&O.current.focus()},[A]);const Y=U=>{U.stopPropagation(),l(o.id)};return Q.jsxs(hC.ResizableBox,{width:S.width,height:S.height,minConstraints:[100,50],maxConstraints:[800,600],onResize:lt,className:"note-container",style:rt,"data-note-id":o.id,children:[Q.jsxs("div",{ref:it,className:Vn("note",{"note-red":o.color==="r","note-blue":o.color==="b","note-read":o.isRead,"note-pdf":o.type==="pdf"}),...f?{}:R,...f?{}:k,onMouseDown:f?void 0:ot,onMouseUp:f?void 0:B,"data-note-id":o.id,children:[o.type==="pdf"&&o.file_url?Q.jsx("div",{className:"w-full h-full overflow-hidden bg-white",children:Q.jsx(k_,{file:o.file_url,loading:"Loading...",children:Q.jsx(F_,{pageNumber:o.page_index||1,width:S.width,renderAnnotationLayer:!0,renderTextLayer:!1})})}):f?Q.jsx("textarea",{ref:m,className:Vn("edit-textarea",{"edit-textarea-red":o.color==="r","edit-textarea-blue":o.color==="b"}),value:v,onChange:U=>b(U.target.value),onBlur:tt,onKeyDown:H}):Q.jsx("textarea",{className:Vn("note-text-readonly",{"note-text-readonly-red":o.color==="r","note-text-readonly-blue":o.color==="b"}),value:o.text,readOnly:!0}),o.icon&&Q.jsx("div",{className:"icon-container",children:Q.jsx("img",{src:o.icon,alt:"user icon",className:"user-icon"})})]}),Q.jsx("div",{className:"replies-container",children:o.replies?.map(U=>Q.jsxs("div",{className:"reply",children:[U.icon&&Q.jsx("img",{src:U.icon,alt:"reply icon",className:"reply-icon"}),Q.jsx("p",{className:"reply-text",children:U.text})]},U.id))}),Q.jsx("div",{className:"read-checkbox-container",onClick:Y,children:o.isRead?"":""}),A?Q.jsxs("div",{className:"reply-input-area",children:[Q.jsx("textarea",{ref:O,value:E,onChange:U=>x(U.target.value),placeholder:"..."}),Q.jsx("button",{onClick:z,children:""}),Q.jsx("button",{onClick:()=>_(!1),children:""})]}):Q.jsx("button",{className:"reply-button",onClick:P,children:""}),Q.jsx("button",{className:"delete-button",onClick:d,onPointerDown:U=>U.stopPropagation(),children:""})]})});function qD({notes:o,onDelete:t,onEdit:e,onResize:n,scale:s,onAddReply:a,onToggleReadStatus:l}){return Q.jsx(Q.Fragment,{children:o.map(u=>Q.jsx($D,{note:u,onDelete:t,onEdit:e,onResize:n,scale:s,onAddReply:a,onToggleReadStatus:l},u.id))})}function GD({onAddNote:o}){const[t,e]=j.useState(""),[n,s]=j.useState("r"),a=u=>{e(u.target.value)},l=u=>{u.preventDefault(),t.trim()!==""&&(o(t,n),e("")),s(n==="r"?"b":"r")};return Q.jsxs("form",{className:"note-input-container",onSubmit:l,children:[Q.jsx("input",{type:"text",className:"note-input",value:t,onChange:a,placeholder:"...",autoFocus:!0}),Q.jsx("button",{type:"submit",className:"add-note-button",children:""})]})}Es.workerSrc=new URL("/assets/pdf.worker.min-qwK7q_zL.mjs",import.meta.url).toString();const VD=({onAddPdfNote:o,onAddAllPages:t})=>{const[e,n]=j.useState(null),[s,a]=j.useState(""),[l,u]=j.useState(!1),[d,f]=j.useState(null),g=({numPages:A})=>{f(A)},m=async A=>{a("Supabase..."),u(!0);try{const _=A.name.split(".").pop(),x=`pdfs/${`${Sg()}.${_}`}`,{error:O}=await Ze.storage.from("uploads").upload(x,A,{contentType:"application/pdf"});if(O)throw O;const{data:C}=Ze.storage.from("uploads").getPublicUrl(x);if(!C.publicUrl)throw new Error("URL");n(C.publicUrl),a(""),console.log("PDF URL:",C.publicUrl)}catch(_){console.error(_),a(`: ${_.message}`)}finally{u(!1)}},v=A=>{A&&A.type==="application/pdf"?m(A):alert("PDF")},b=A=>{const _=A.target.files?.[0];_&&v(_)},S=j.useCallback(A=>{A.preventDefault();const _=A.dataTransfer.files?.[0];_&&v(_)},[]),w=j.useCallback(A=>{A.preventDefault()},[]);return Q.jsxs("div",{className:"p-6 max-w-3xl mx-auto bg-white rounded shadow-lg",children:[" ",Q.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:"PDF"}),Q.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Q.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"PDF"}),e&&d&&Q.jsxs("button",{onClick:()=>t(e,d),className:"bg-green-600 text-white font-bold py-2 px-4 rounded hover:bg-green-700 shadow-lg transition-transform transform hover:scale-105",children:["",d,""]})]}),Q.jsx("div",{onDrop:S,onDragOver:w,className:`mb-4 border-2 border-dashed rounded-lg h-32 flex items-center justify-center text-gray-600 transition
            ${l?"bg-gray-200 border-gray-400 cursor-wait":"border-blue-400 hover:bg-blue-50 cursor-pointer"}`,children:l?"...":"PDF"}),Q.jsx("input",{type:"file",accept:"application/pdf",onChange:b,className:"mb-4",disabled:l}),s&&Q.jsx("p",{className:"text-sm text-blue-600 mb-2 font-bold",children:s}),e&&Q.jsx("div",{className:"flex-1 overflow-x-auto bg-gray-100 p-4 border rounded-lg",children:Q.jsx(k_,{file:e,onLoadSuccess:g,className:"flex flex-row gap-4",loading:Q.jsx("div",{className:"text-center p-4",children:"PDF"}),error:Q.jsx("div",{className:"text-red-500",children:""}),children:Array.from(new Array(d),(A,_)=>Q.jsxs("div",{className:"shadow-md",children:[Q.jsx(F_,{pageNumber:_+1,width:300,renderAnnotationLayer:!0,renderTextLayer:!1}),Q.jsx("button",{onClick:()=>o(e,_+1),className:"bg-blue-500 text-white text-sm py-1 px-2 rounded-b hover:bg-blue-600",children:""}),Q.jsxs("p",{className:"text-center text-sm mt-1 text-gray-500",children:[_+1,""]})]},`page_${_+1}`))})}),e&&Q.jsxs("p",{className:"text-xs text-gray-400 mt-2 break-all",children:["URL: ",e]})]})},oa={x:50,y:150},T0={width:200,height:100};function XD(){const[o,t]=j.useState([]),[e,n]=j.useState(null),s=j.useRef(null),[a,l]=j.useState(null),[u,d]=j.useState(1),[f,g]=j.useState({x:0,y:0}),[m,v]=j.useState(!1),b=j.useRef({x:0,y:0}),[S,w]=j.useState(!1),A=j.useRef(f);j.useEffect(()=>{A.current=f},[f]);const _=async(P,z)=>{const Y={text:"",x:oa.x,y:oa.y,width:320,height:450,color:"white",type:"pdf",file_url:P,page_index:z,replies:[],isRead:!1},{data:U}=await Ze.from("notes").insert(Y).select();U&&t(et=>[...et,U[0]])},E=async(P,z)=>{const et=[];for(let nt=0;nt<z;nt++)et.push({text:"",x:oa.x+nt*340,y:oa.y,width:320,height:450,color:"white",type:"pdf",file_url:P,page_index:nt+1,replies:[],isRead:!1});try{const{data:nt,error:at}=await Ze.from("notes").insert(et).select();if(at)throw at;nt&&(t(ft=>[...ft,...nt]),console.log(`${nt.length} PDF`))}catch(nt){console.error(":",nt),alert("")}},x=j.useRef({x:0,y:0});j.useEffect(()=>{(async()=>{console.log("Supabase");try{const{data:Y,error:U}=await Ze.from("notes").select("*").order("created_at",{ascending:!0});if(U)throw U;Y&&(t(Y),console.log(":",Y))}catch(Y){console.error(":",Y),alert(`: ${Y.message}`)}})(),console.log("( `)");const z=Ze.channel("notes-realtime-channel");return z.on("postgres_changes",{event:"*",schema:"public",table:"notes"},Y=>{if(console.log("",Y),Y.eventType==="INSERT"){const U=Y.new;t(et=>[...et,U])}if(Y.eventType==="UPDATE"){const U=Y.new;t(et=>et.map(nt=>nt.id===U.id?U:nt))}if(Y.eventType==="DELETE"){const U=Y.old.id;t(et=>et.filter(nt=>nt.id!==U))}}).subscribe(),()=>{console.log(""),Ze.removeChannel(z)}},[]);const O=vE(z0,{activationConstraint:{distance:10}}),C=bE(O),D=P=>{if(n(P.active.id),"clientX"in P.activatorEvent&&"clientY"in P.activatorEvent){const z=P.activatorEvent;x.current={x:z.clientX,y:z.clientY}}P.active.data.current?.type},R=async(P,z,Y,U)=>{const et={text:P,x:Y!==void 0?Y:oa.x,y:U!==void 0?U:oa.y,width:T0.width,height:T0.height,color:z,icon:a,isRead:!1,replies:[]};try{const{data:nt,error:at}=await Ze.from("notes").insert(et).select();if(at)throw at;if(nt){const ft=nt[0];t(vt=>[...vt,ft]),console.log("DB",ft)}}catch(nt){console.error(":",nt),alert(`: ${nt.message}`)}},k=async(P,z,Y)=>{try{const{error:U}=await Ze.from("notes").update({width:z,height:Y}).eq("id",P);if(U)throw U;t(et=>et.map(nt=>nt.id===P?{...nt,width:z,height:Y}:nt))}catch(U){console.error(":",U),alert(`: ${U.message}`)}},L=async P=>{try{const{error:z}=await Ze.from("notes").delete().eq("id",P);if(z)throw z;t(Y=>Y.filter(U=>U.id!==P)),console.log(` (id: ${P}) DB`)}catch(z){console.error(":",z),alert(`: ${z.message}`)}},V=async(P,z)=>{try{const{error:Y}=await Ze.from("notes").update({text:z}).eq("id",P);if(Y)throw Y;t(U=>U.map(et=>et.id===P?{...et,text:z}:et))}catch(Y){console.error(":",Y),alert(`: ${Y.message}`)}},q=async P=>{const{active:z,delta:Y}=P,U=z.id;if(U){const et=z.data.current;if(et?.type==="note-template"){if(s.current&&P.active.rect.current.translated){const nt=s.current.getBoundingClientRect(),at=x.current.x+Y.x,ft=x.current.y+Y.y,vt=at-nt.left,It=ft-nt.top,St=A.current,Ae=(vt-St.x)/u,le=(It-St.y)/u;await R(et.text||"",et.color||"r",Ae,le)}}else{const nt=o.find(vt=>vt.id===U);if(!nt)return;const at=nt.x+Y.x/u,ft=nt.y+Y.y/u;try{const{error:vt}=await Ze.from("notes").update({x:at,y:ft}).eq("id",U);if(vt)throw vt;t(It=>It.map(St=>St.id===z.id?{...St,x:at,y:ft}:St))}catch(vt){console.error(":",vt),alert(`: ${vt.message}`)}}}n(null)},it=async(P,z)=>{const Y={id:Sg(),noteId:P,text:z,icon:a,createdAt:new Date},U=o.find(nt=>nt.id===P);if(!U)return;const et=U.replies?[...U.replies,Y]:[Y];try{const{error:nt}=await Ze.from("notes").update({replies:et}).eq("id",P);if(nt)throw nt;t(at=>at.map(ft=>ft.id===P?{...ft,replies:et}:ft)),console.log(` (id: ${P}) DB!`)}catch(nt){console.error(":",nt),alert(`: ${nt.message}`)}},rt=async P=>{const z=o.find(U=>U.id===P);if(!z)return;const Y=!z.isRead;try{const{error:U}=await Ze.from("notes").update({isRead:Y}).eq("id",P);if(U)throw U;t(et=>et.map(nt=>nt.id===P?{...nt,isRead:Y}:nt))}catch(U){console.error(":",U),alert(`: ${U.message}`)}},st=()=>{d(P=>Math.min(P*1.2,2))},ot=()=>{d(P=>Math.max(P/1.2,.5))},B=()=>{d(1)},H=j.useCallback(P=>{const z=P.target;z.closest('[data-dnd-draggable="true"]')||z.closest('[data-no-pan="true"]')||(P.preventDefault(),b.current={x:P.clientX,y:P.clientY},v(!0))},[]),tt=j.useCallback(P=>{if(!m)return;P.preventDefault();const z=P.clientX-b.current.x,Y=P.clientY-b.current.y;g(U=>({x:U.x+z,y:U.y+Y})),b.current={x:P.clientX,y:P.clientY}},[m]),lt=j.useCallback(()=>{v(!1)},[]);return j.useEffect(()=>(m?(window.addEventListener("mousemove",tt),window.addEventListener("mouseup",lt)):(window.removeEventListener("mousemove",tt),window.removeEventListener("mouseup",lt)),()=>{window.removeEventListener("mousemove",tt),window.removeEventListener("mouseup",lt)}),[m,tt,lt]),Q.jsx(wT,{onDragEnd:q,onDragStart:D,sensors:C,children:Q.jsxs("div",{className:"app-layout relative",children:[Q.jsx(sE,{className:"header-area","data-no-pan":"true"}),Q.jsx(Z1,{className:"left-sidebar-area",onIconUpload:l,onTogglePdfViewer:()=>w(P=>!P),"data-no-pan":"true"}),Q.jsx(eC,{className:"main-content-area",ref:s,scale:u,viewpoint:f,onPanStart:H,children:Q.jsx(qD,{notes:o,onDelete:L,onEdit:V,onResize:k,scale:u,onAddReply:it,onToggleReadStatus:rt})}),Q.jsx(tC,{className:"right-sidebar-area",notes:o,onAddReply:it,onToggleReadStatus:rt}),Q.jsx(GD,{onAddNote:R}),Q.jsxs("div",{className:"zoom-controls","data-no-pan":"true",children:[Q.jsx("button",{onClick:ot,className:"zoom-button",children:"-"}),Q.jsxs("span",{className:"zoom-display",onClick:B,children:[Math.round(u*100),"%"]}),Q.jsx("button",{onClick:st,className:"zoom-button",children:"+"})]}),S&&Q.jsx("div",{className:"modal-overlay",onClick:()=>w(!1),children:Q.jsx("div",{className:"modal-content",onClick:P=>P.stopPropagation(),children:Q.jsx(VD,{onAddPdfNote:(P,z)=>{_(P,z)},onAddAllPages:(P,z)=>{E(P,z),w(!1)}})})})]})})}iE.createRoot(document.getElementById("root")).render(Q.jsx(j.StrictMode,{children:Q.jsx(XD,{})}));
